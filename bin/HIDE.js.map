{
"version":3,
"file":"HIDE.js",
"sourceRoot":"file://",
"sources":["D:/Denis/PortableSoft/HaxeToolkit/haxe/std/js/_std/EReg.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/js/_std/haxe/ds/StringMap.hx","D:/Denis/PortableSoft/HIDE/src/HIDE.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/js/_std/HxOverrides.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/Lambda.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/List.hx","D:/Denis/PortableSoft/HIDE/src/Main.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/js/_std/Reflect.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/js/_std/Std.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/StringBuf.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/StringTools.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/js/_std/Type.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/js/_std/Xml.hx","D:/Denis/PortableSoft/HIDE/src/about/About.hx","D:/Denis/PortableSoft/HIDE/src/autoformat/HaxePrinter.hx","D:/Denis/PortableSoft/HIDE/src/autoformat/HaxePrinterLoader.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/hxparse/3,0,0/byte/js/ByteData.hx","D:/Denis/PortableSoft/HIDE/src/cm/CMDoc.hx","D:/Denis/PortableSoft/HIDE/src/cm/CodeMirrorEditor.hx","D:/Denis/PortableSoft/HIDE/src/cm/CodeMirrorZoom.hx","D:/Denis/PortableSoft/HIDE/src/core/Alerts.hx","D:/Denis/PortableSoft/HIDE/src/core/Bootbox.hx","D:/Denis/PortableSoft/HIDE/src/core/Changelog.hx","D:/Denis/PortableSoft/HIDE/src/core/CompilationOutput.hx","D:/Denis/PortableSoft/HIDE/src/core/Completion.hx","D:/Denis/PortableSoft/HIDE/src/core/DeveloperTools.hx","D:/Denis/PortableSoft/HIDE/src/core/DragAndDrop.hx","D:/Denis/PortableSoft/HIDE/src/core/EditingTheme.hx","D:/Denis/PortableSoft/HIDE/src/core/EditorConfiguration.hx","D:/Denis/PortableSoft/HIDE/src/core/FileDialog.hx","D:/Denis/PortableSoft/HIDE/src/core/FileTools.hx","D:/Denis/PortableSoft/HIDE/src/core/FunctionParametersHelper.hx","D:/Denis/PortableSoft/HIDE/src/core/HaxeClient.hx","D:/Denis/PortableSoft/HIDE/src/core/HaxeCompletionClient.hx","D:/Denis/PortableSoft/HIDE/src/core/HaxeLint.hx","D:/Denis/PortableSoft/HIDE/src/core/HaxeParserProvider.hx","D:/Denis/PortableSoft/HIDE/src/core/HaxeServer.hx","D:/Denis/PortableSoft/HIDE/src/core/Hotkeys.hx","D:/Denis/PortableSoft/HIDE/src/core/PreserveWindowState.hx","D:/Denis/PortableSoft/HIDE/src/core/RunProject.hx","D:/Denis/PortableSoft/HIDE/src/core/Splitpane.hx","D:/Denis/PortableSoft/HIDE/src/core/ToggleFullscreen.hx","D:/Denis/PortableSoft/HIDE/src/core/Utils.hx","D:/Denis/PortableSoft/HIDE/src/core/Zoom.hx","D:/Denis/PortableSoft/HIDE/src/filetree/ContextMenu.hx","D:/Denis/PortableSoft/HIDE/src/filetree/FileTree.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/nodejs/2,2,4/haxe/Json.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/haxe/Resource.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/haxe/Serializer.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/haxe/Timer.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/haxe/Unserializer.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/nodejs/2,2,4/haxe/io/Bytes.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/haxe/crypto/Base64.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/haxe/crypto/BaseCode.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/haxe/ds/GenericStack.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/js/_std/haxe/ds/IntMap.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/js/_std/haxe/ds/ObjectMap.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/haxe/io/Eof.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/haxe/macro/ExprTools.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/haxe/macro/Printer.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/haxe/xml/Fast.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/haxe/xml/Parser.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/haxeparser/1,0,0/haxeparser/Data.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/haxeparser/1,0,0/haxeparser/HaxeLexer.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/hxparse/3,0,0/hxparse/Lexer.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/hxparse/3,0,0/hxparse/LexEngine.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/hxparse/3,0,0/hxparse/Ruleset.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/hxparse/3,0,0/hxparse/Position.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/js/Boot.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/hxparse/3,0,0/hxparse/Parser.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/haxeparser/1,0,0/haxeparser/HaxeParser.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/hxparse/3,0,0/hxparse/ParserBuilderImpl.hx","D:/Denis/PortableSoft/HIDE/libs/haxeprinter/src/haxeprinter/Printer.hx","D:/Denis/PortableSoft/HIDE/src/haxeproject/HaxeProject.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/hxparse/3,0,0/hxparse/NoMatch.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/hxparse/3,0,0/hxparse/State.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/hxparse/3,0,0/hxparse/Unexpected.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/hxparse/3,0,0/hxparse/UnexpectedChar.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/js/Browser.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/js/Lib.hx","D:/Denis/PortableSoft/HIDE/src/menu/BootstrapMenu.hx","D:/Denis/PortableSoft/HIDE/src/menu/Menu.hx","D:/Denis/PortableSoft/HIDE/src/newprojectdialog/Category.hx","D:/Denis/PortableSoft/HIDE/src/newprojectdialog/Item.hx","D:/Denis/PortableSoft/HIDE/src/newprojectdialog/NewProjectDialog.hx","D:/Denis/PortableSoft/HIDE/src/newprojectdialog/NewProjectDialogLoader.hx","D:/Denis/PortableSoft/HIDE/src/openflproject/CreateOpenFLProject.hx","D:/Denis/PortableSoft/HIDE/src/openflproject/OpenFLProject.hx","D:/Denis/PortableSoft/HIDE/src/openflproject/OpenFLTools.hx","D:/Denis/PortableSoft/HIDE/src/openproject/OpenProject.hx","D:/Denis/PortableSoft/HIDE/src/openproject/OpenProjectLoader.hx","D:/Denis/PortableSoft/HIDE/src/projectaccess/Project.hx","D:/Denis/PortableSoft/HIDE/src/projectaccess/ProjectAccess.hx","D:/Denis/PortableSoft/HIDE/src/projectaccess/ProjectOptions.hx","D:/Denis/PortableSoft/HIDE/src/tabmanager/TabManager.hx","D:/Denis/PortableSoft/HIDE/src/tabmanager/TabManagerContextMenu.hx","D:/Denis/PortableSoft/HIDE/src/tabmanager/TabManagerMain.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/tjson/1,2,1/tjson/TJSON.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/std/Math.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/nodejs/2,2,4/nodejs/webkit/UI.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/nodejs/2,2,4/nodejs/webkit/Window.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/nodejs/2,2,4/js/Node.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/nodejs/2,2,4/nodejs/webkit/Menu.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/nodejs/2,2,4/nodejs/webkit/MenuItem.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/nodejs/2,2,4/nodejs/webkit/Shell.hx","D:/Denis/PortableSoft/HaxeToolkit/haxe/lib/hxparse/3,0,0/hxparse/RuleBuilder.hx"],
"sourcesContent":["/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n@:coreApi class EReg {\n\n\tvar r : Dynamic;\n\n\tpublic function new( r : String, opt : String ) : Void {\n\t\topt = opt.split(\"u\").join(\"\"); // 'u' (utf8) depends on page encoding\n\t\tthis.r = untyped __new__(\"RegExp\",r,opt);\n\t}\n\n\tpublic function match( s : String ) : Bool {\n\t\tif( r.global ) r.lastIndex = 0;\n\t\tr.m = r.exec(s);\n\t\tr.s = s;\n\t\treturn (r.m != null);\n\t}\n\n\tpublic function matched( n : Int ) : String {\n\t\treturn if( r.m != null && n >= 0 && n < r.m.length ) r.m[n] else throw \"EReg::matched\";\n\t}\n\n\tpublic function matchedLeft() : String {\n\t\tif( r.m == null ) throw \"No string matched\";\n\t\treturn r.s.substr(0,r.m.index);\n\t}\n\n\tpublic function matchedRight() : String {\n\t\tif( r.m == null ) throw \"No string matched\";\n\t\tvar sz = r.m.index+r.m[0].length;\n\t\treturn r.s.substr(sz,r.s.length-sz);\n\t}\n\n\tpublic function matchedPos() : { pos : Int, len : Int } {\n\t\tif( r.m == null ) throw \"No string matched\";\n\t\treturn { pos : r.m.index, len : r.m[0].length };\n\t}\n\n\tpublic function matchSub( s : String, pos : Int, len : Int = -1):Bool {\n\t\treturn if (r.global) {\n\t\t\tr.lastIndex = pos;\n\t\t\tr.m = r.exec(len < 0 ? s : s.substr(0, pos + len));\n\t\t\tvar b = r.m != null;\n\t\t\tif (b) {\n\t\t\t\tr.s = s;\n\t\t\t}\n\t\t\tb;\n\t\t} else {\n\t\t\t// TODO: check some ^/$ related corner cases\n\t\t\tvar b = match( len < 0 ? s.substr(pos) : s.substr(pos,len) );\n\t\t\tif (b) {\n\t\t\t\tr.s = s;\n\t\t\t\tr.m.index += pos;\n\t\t\t}\n\t\t\tb;\n\t\t}\n\t}\n\n\tpublic function split( s : String ) : Array<String> {\n\t\t// we can't use directly s.split because it's ignoring the 'g' flag\n\t\tvar d = \"#__delim__#\";\n\t\treturn untyped s.replace(r,d).split(d);\n\t}\n\n\tpublic function replace( s : String, by : String ) : String {\n\t\treturn untyped s.replace(r,by);\n\t}\n\n\tpublic function map( s : String, f : EReg -> String ) : String {\n\t\tvar offset = 0;\n\t\tvar buf = new StringBuf();\n\t\tdo {\n\t\t\tif (offset >= s.length)\n\t\t\t\tbreak;\n\t\t\telse if (!matchSub(s, offset)) {\n\t\t\t\tbuf.add(s.substr(offset));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar p = matchedPos();\n\t\t\tbuf.add(s.substr(offset, p.pos - offset));\n\t\t\tbuf.add(f(this));\n\t\t\tif (p.len == 0) {\n\t\t\t\tbuf.add(s.substr(p.pos, 1));\n\t\t\t\toffset = p.pos + 1;\n\t\t\t}\n\t\t\telse\n\t\t\t\toffset = p.pos + p.len;\n\t\t} while (r.global);\n\t\tif (!r.global && offset > 0 && offset < s.length)\n\t\t\tbuf.add(s.substr(offset));\n\t\treturn buf.toString();\n\t}\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.ds;\n\n@:coreApi class StringMap<T> implements Map.IMap<String,T> {\n\n\tprivate var h : Dynamic;\n\n\tpublic function new() : Void {\n\t\th = {};\n\t}\n\n\tpublic function set( key : String, value : T ) : Void {\n\t\tuntyped h[\"$\"+key] = value;\n\t}\n\n\tpublic function get( key : String ) : Null<T> {\n\t\treturn untyped h[\"$\"+key];\n\t}\n\n\tpublic function exists( key : String ) : Bool {\n\t\treturn untyped h.hasOwnProperty(\"$\"+key);\n\t}\n\n\tpublic function remove( key : String ) : Bool {\n\t\tkey = \"$\"+key;\n\t\tif( untyped !h.hasOwnProperty(key) ) return false;\n\t\tuntyped __js__(\"delete\")(h[key]);\n\t\treturn true;\n\t}\n\n\tpublic function keys() : Iterator<String> {\n\t\tvar a = [];\n\t\tuntyped {\n\t\t\t__js__(\"for( var key in this.h ) {\");\n\t\t\t\tif( h.hasOwnProperty(key) )\n\t\t\t\t\ta.push(key.substr(1));\n\t\t\t__js__(\"}\");\n\t\t}\n\t\treturn a.iterator();\n\t}\n\n\tpublic function iterator() : Iterator<T> {\n\t\treturn untyped {\n\t\t\tref : h,\n\t\t\tit : keys(),\n\t\t\thasNext : function() { return __this__.it.hasNext(); },\n\t\t\tnext : function() { var i = __this__.it.next(); return __this__.ref[\"$\"+i]; }\n\t\t};\n\t}\n\n\tpublic function toString() : String {\n\t\tvar s = new StringBuf();\n\t\ts.add(\"{\");\n\t\tvar it = keys();\n\t\tfor( i in it ) {\n\t\t\ts.add(i);\n\t\t\ts.add(\" => \");\n\t\t\ts.add(Std.string(get(i)));\n\t\t\tif( it.hasNext() )\n\t\t\t\ts.add(\", \");\n\t\t}\n\t\ts.add(\"}\");\n\t\treturn s.toString();\n\t}\n\n}\n","package ;\nimport haxe.ds.StringMap.StringMap;\nimport haxe.Serializer;\nimport js.Browser;\nimport js.html.LinkElement;\nimport js.html.ScriptElement;\nimport js.Node;\nimport nodejs.webkit.Window;\n\n/**\n * ...\n * @author AS3Boyan\n */\n \n //This class is a global HIDE API for plugins\n //Using this API plugins can load JS and CSS scripts in specified order \n //To use it in plugins you may need to add path to externs for this class, they are located at externs/plugins/hide\n \ntypedef PluginDependenciesData =\n{\n\tvar name:String;\n\tvar plugins:Array<String>;\n\tvar onLoaded:Void->Void;\n\tvar callOnLoadWhenAtLeastOnePluginLoaded:Bool;\n}\n \n@:keepSub @:expose class HIDE\n{\t\n\tpublic static var plugins:Array<String> = new Array();\n\tpublic static var pathToPlugins:StringMap<String> = new StringMap();\n\tpublic static var inactivePlugins:Array<String> = [];\n\t\n\tpublic static var requestedPluginsData:Array<PluginDependenciesData> = new Array();\n\t\n\tpublic static var pluginsMTime:StringMap<Int> = new StringMap();\n\t\n\tpublic static var windows:Array<Dynamic> = [];\n\t\n\tpublic static var firstRun:Bool = false;\n\t\n\t//Loads JS scripts in specified order and calls onLoad function when last item of urls array was loaded\n\tpublic static function loadJS(name:String, urls:Array<String>, ?onLoad:Dynamic):Void\n\t{\t\t\n\t\tif (name != null)\n\t\t{\n\t\t\tfor (i in 0...urls.length)\n\t\t\t{\n\t\t\t\turls[i] = js.Node.path.join(getPluginPath(name), urls[i]);\n\t\t\t}\n\t\t}\n\n\t\tloadJSAsync(name, urls, onLoad);\n\t}\n\t\n\t//Asynchronously loads multiple CSS scripts\n\tpublic static function loadCSS(name:String, urls:Array<String>, ?onLoad:Dynamic):Void\n\t{\n\t\tif (name != null)\n\t\t{\n\t\t\tfor (i in 0...urls.length)\n\t\t\t{\n\t\t\t\turls[i] = js.Node.path.join(getPluginPath(name), urls[i]);\n\t\t\t}\n\t\t}\n\n\t\tloadCSSAsync(name, urls, onLoad);\n\t}\n\t\n\tprivate static function loadCSSAsync(name:String, urls:Array<String>, ?onLoad:Dynamic):Void\n\t{\n\t\tvar link:LinkElement = Browser.document.createLinkElement();\n\t\tlink.href = urls.splice(0, 1)[0];\n\t\tlink.type = \"text/css\";\n\t\tlink.rel = \"stylesheet\";\n\t\tlink.onload = function (e)\n\t\t{\n\t\t\ttraceScriptLoadingInfo(name, link.href);\n\t\t\t\n\t\t\tif (urls.length > 0)\n\t\t\t{\n\t\t\t\tloadCSSAsync(name, urls, onLoad);\n\t\t\t}\n\t\t\telse if (onLoad != null)\n\t\t\t{\n\t\t\t\tonLoad();\n\t\t\t}\n\t\t};\n\t\t\n\t\tBrowser.document.head.appendChild(link);\n\t}\t\n\t\n\tprivate static function traceScriptLoadingInfo(name:String, url:String):Void\n\t{\n\t\tvar str:String;\n\t\t\t\t\n\t\tif (name != null)\n\t\t{\n\t\t\tstr = \"\\n\" + name + \":\\n\" + url + \"\\n\";\n\t\t}\n\t\telse \n\t\t{\n\t\t\tstr = url + \" loaded\";\n\t\t}\n\t\t\n\t\t//trace(str);\n\t}\n\t\n\tpublic static function getPluginPath(name:String):String\n\t{\n\t\tvar pathToPlugin:String = pathToPlugins.get(name);\n\t\t\t\t\n\t\tif (pathToPlugin == null)\n\t\t{\n\t\t\ttrace(\"HIDE can't find path for plugin: \" + name + \"\\nPlease check folder structure of plugin, make sure that it corresponds to it's 'name'\");\n\t\t}\n\t\t\n\t\treturn pathToPlugin;\n\t}\n\t\n\tpublic static function waitForDependentPluginsToBeLoaded(name:String, plugins:Array<String>, onLoaded:Void->Void, ?callOnLoadWhenAtLeastOnePluginLoaded:Bool = false):Void\n\t{\t\n\t\tvar data:PluginDependenciesData = { name:name, plugins:plugins, onLoaded:onLoaded, callOnLoadWhenAtLeastOnePluginLoaded:callOnLoadWhenAtLeastOnePluginLoaded };\n\t\trequestedPluginsData.push(data);\n\t\tcheckRequiredPluginsData();\n\t}\n\t\n\tpublic static function notifyLoadingComplete(name:String):Void\n\t{\n\t\t//trace(\"Object \" + name);\n\t\tplugins.push(name);\n\t\tcheckRequiredPluginsData();\n\t}\n\t\n\tpublic static function openPageInNewWindow(name:String, url:String, ?params:Dynamic):Dynamic\n\t{\t\n\t\tvar fullPath:String = url;\n\t\t\n\t\tif (!StringTools.startsWith(url, \"http\") && name != null)\n\t\t{\n\t\t\tfullPath = js.Node.path.join(getPluginPath(name), url);\n\t\t}\n\t\t\n\t\tvar window = Window.open(fullPath, params);\n\t\twindows.push(window);\n\t\t\n\t\twindow.on(\"close\", function (e)\n\t\t{\n\t\t\twindows.remove(window);\n\t\t\twindow.close(true);\n\t\t}\n\t\t);\n\t\t\n\t\treturn window;\n\t}\n\n\tpublic static function compilePlugins(?onComplete:Dynamic, ?onFailed:Dynamic):Void\n\t{\n\t\tvar pluginCount:Int = Lambda.count(HIDE.pathToPlugins);\n\t\tvar compiledPluginCount:Int = 0;\n\n\t\tvar relativePathToPlugin:String;\n\t\tvar absolutePathToPlugin:String;\n\n\t\tfor (name in HIDE.pathToPlugins.keys())\n\t\t{\n\t\t\trelativePathToPlugin = HIDE.pathToPlugins.get(name);\n\t\t\tabsolutePathToPlugin = js.Node.require(\"path\").resolve(relativePathToPlugin);\n\n\t\t\tMain.compilePlugin(name, absolutePathToPlugin, function ():Void\n\t\t\t{\n\t\t\t\tcompiledPluginCount++;\n\n\t\t\t\tif (compiledPluginCount == pluginCount)\n\t\t\t\t{\n\t\t\t\t\tonComplete();\n\t\t\t\t}\n\t\t\t}\n\t\t\t, onFailed);\n\t\t}\n\t}\n\t\n\tpublic static function readFile(name:String, path:String, onComplete:Dynamic):Void\n\t{\n\t\tvar options:js.Node.NodeFsFileOptions = { };\n\t\toptions.encoding = js.Node.NodeC.UTF8;\n\t\t\n\t\tvar fullPath:String = path;\n\t\t\n\t\tif (name != null) \n\t\t{\n\t\t\tfullPath = js.Node.path.join(pathToPlugins.get(name), path);\n\t\t}\n\t\t\n\t\tjs.Node.fs.readFile(fullPath, options, function (error:js.Node.NodeErr, data:String):Void\n\t\t{\n\t\t\tif (error != null)\n\t\t\t{\n\t\t\t\ttrace(error);\n\t\t\t}\n\t\t\telse \n\t\t\t{\n\t\t\t\tonComplete(data);\n\t\t\t}\n\t\t}\n\t\t);\n\t}\n\t\n\tpublic static function writeFile(name:String, path:String, contents:String, ?onComplete:Dynamic):Void\n\t{\n\t\tjs.Node.fs.writeFile(js.Node.path.join(pathToPlugins.get(name), path), contents, js.Node.NodeC.UTF8, function (error:js.Node.NodeErr)\n\t\t{\n\t\t\tif (onComplete != null && error == null)\n\t\t\t{\n\t\t\t\tonComplete();\n\t\t\t}\n\t\t}\n\t\t);\n\t}\n\t\n\tpublic static function surroundWithQuotes(path:String):String\n\t{\n\t\treturn '\"' + path + '\"';\n\t}\n\t\n\tprivate static function checkRequiredPluginsData():Void\n\t{\t\t\n\t\tif (requestedPluginsData.length > 0)\n\t\t{\n\t\t\tvar pluginData:PluginDependenciesData;\n\t\t\n\t\t\tvar j:Int = 0;\n\t\t\twhile (j < requestedPluginsData.length)\n\t\t\t{\n\t\t\t\tpluginData = requestedPluginsData[j];\n\t\t\t\t\n\t\t\t\tvar pluginsLoaded:Bool;\n\t\t\t\t\n\t\t\t\tif (pluginData.callOnLoadWhenAtLeastOnePluginLoaded == false)\n\t\t\t\t{\n\t\t\t\t\tpluginsLoaded = Lambda.foreach(pluginData.plugins, function (plugin:String):Bool\n\t\t\t\t\t{\n\t\t\t\t\t\treturn Lambda.has(HIDE.plugins, plugin);\n\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse \n\t\t\t\t{\n\t\t\t\t\tpluginsLoaded = !Lambda.foreach(pluginData.plugins, function (plugin:String):Bool\n\t\t\t\t\t{\n\t\t\t\t\t\treturn !Lambda.has(HIDE.plugins, plugin);\n\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (pluginsLoaded)\n\t\t\t\t{\n\t\t\t\t\trequestedPluginsData.splice(j, 1);\n\t\t\t\t\ttrace(pluginData.name);\n\t\t\t\t\tpluginData.onLoaded();\n\t\t\t\t}\n\t\t\t\telse \n\t\t\t\t{\n\t\t\t\t\tj++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (Lambda.count(pathToPlugins) == plugins.length)\n\t\t{\t\t\t\n\t\t\ttrace(\"all plugins loaded\");\n\t\t\t\n\t\t\tvar delta:Float = Date.now().getTime() - Main.currentTime;\n\t\t\t\n\t\t\ttrace(\"Loading took: \" + Std.string(delta) + \" ms\");\n\t\t\t\n\t\t\tvar options:js.Node.NodeFsFileOptions = { };\n\t\t\toptions.encoding = js.Node.NodeC.UTF8;\n\t\t\tjs.Node.fs.readFile(\"../.travis.yml.template\", options, function(error, data:String):Void\n\t\t\t{\n\t\t\t\tif (data != null)\n\t\t\t\t{\n\t\t\t\t\tvar updatedData:String = StringTools.replace(data,\"::plugins::\", Main.pluginsTestingData);\n\n\t\t\t\t\tjs.Node.fs.writeFile(\"../.travis.yml\", updatedData,js.Node.NodeC.UTF8, function(error):Void\n\t\t\t\t\t{\n\t\t\t\t\t\ttrace(\".travis.yml was updated according to active plugins list\");\n\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttrace(error);\n\t\t\t\t}\n\t\t\t}\n\t\t\t);\n\t\t\t\n\t\t\tsavePluginsMTime();\n\t\t\t\n\t\t\tMain.window.show();\n\t\t}\n\t}\n\t\n\tpublic static function savePluginsMTime() \n\t{\n\t\tvar pathToPluginsMTime:String = js.Node.path.join(\"..\", \"pluginsMTime.dat\");\n\t\t\t\n\t\tvar data:String = Serializer.run(HIDE.pluginsMTime);\n\t\t\n\t\tjs.Node.fs.writeFile(pathToPluginsMTime, data, js.Node.NodeC.UTF8, function (error:js.Node.NodeErr)\n\t\t{\n\t\t\t\n\t\t}\n\t\t);\n\t}\n\t\n\t//Private function which loads JS scripts in strict order\n\tprivate static function loadJSAsync(name:String, urls:Array<String>, ?onLoad:Dynamic):Void\n\t{\n\t\tvar script:ScriptElement = Browser.document.createScriptElement();\n\t\tscript.src = urls.splice(0, 1)[0];\n\t\tscript.onload = function (e)\n\t\t{\t\t\t\n\t\t\ttraceScriptLoadingInfo(name, script.src);\n\t\t\t\n\t\t\tif (urls.length > 0)\n\t\t\t{\n\t\t\t\tloadJSAsync(name, urls, onLoad);\n\t\t\t}\n\t\t\telse if (onLoad != null)\n\t\t\t{\n\t\t\t\tonLoad();\n\t\t\t}\n\t\t};\n\t\t\n\t\tBrowser.document.body.appendChild(script);\n\t}\n}","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n@:noDoc\nclass HxOverrides {\n\n\tstatic function dateStr( date :Date ) : String {\n\t\tvar m = date.getMonth() + 1;\n\t\tvar d = date.getDate();\n\t\tvar h = date.getHours();\n\t\tvar mi = date.getMinutes();\n\t\tvar s = date.getSeconds();\n\t\treturn date.getFullYear()\n\t\t\t+\"-\"+(if( m < 10 ) \"0\"+m else \"\"+m)\n\t\t\t+\"-\"+(if( d < 10 ) \"0\"+d else \"\"+d)\n\t\t\t+\" \"+(if( h < 10 ) \"0\"+h else \"\"+h)\n\t\t\t+\":\"+(if( mi < 10 ) \"0\"+mi else \"\"+mi)\n\t\t\t+\":\"+(if( s < 10 ) \"0\"+s else \"\"+s);\n\t}\n\n\tstatic function strDate( s : String ) : Date {\n\t\tswitch( s.length ) {\n\t\tcase 8: // hh:mm:ss\n\t\t\tvar k = s.split(\":\");\n\t\t\tvar d : Date = untyped __new__(Date);\n\t\t\tuntyped d[\"setTime\"](0);\n\t\t\tuntyped d[\"setUTCHours\"](k[0]);\n\t\t\tuntyped d[\"setUTCMinutes\"](k[1]);\n\t\t\tuntyped d[\"setUTCSeconds\"](k[2]);\n\t\t\treturn d;\n\t\tcase 10: // YYYY-MM-DD\n\t\t\tvar k = s.split(\"-\");\n\t\t\treturn new Date(cast k[0],cast untyped k[1] - 1,cast k[2],0,0,0);\n\t\tcase 19: // YYYY-MM-DD hh:mm:ss\n\t\t\tvar k = s.split(\" \");\n\t\t\tvar y = k[0].split(\"-\");\n\t\t\tvar t = k[1].split(\":\");\n\t\t\treturn new Date(cast y[0],cast untyped y[1] - 1,cast y[2],cast t[0],cast t[1],cast t[2]);\n\t\tdefault:\n\t\t\tthrow \"Invalid date format : \" + s;\n\t\t}\n\t}\n\n\tstatic function cca( s : String, index : Int ) : Null<Int> {\n\t\t#if mt\n\t\tvar x = (cast s).cca(index);\n\t\t#else\n\t\tvar x = (cast s).charCodeAt(index);\n\t\t#end\n\t\tif( x != x ) // fast isNaN\n\t\t\treturn untyped undefined; // isNaN will still return true\n\t\treturn x;\n\t}\n\n\tstatic function substr( s : String, pos : Int, ?len : Int ) : String {\n\t\tif( pos != null && pos != 0 && len != null && len < 0 ) return \"\";\n\t\tif( len == null ) len = s.length;\n\t\tif( pos < 0 ){\n\t\t\tpos = s.length + pos;\n\t\t\tif( pos < 0 ) pos = 0;\n\t\t}else if( len < 0 ){\n\t\t\tlen = s.length + len - pos;\n\t\t}\n\n\t\treturn (untyped s).substr(pos, len);\n\t}\n\n\tstatic function indexOf<T>( a : Array<T>, obj : T, i : Int) {\n\t\tvar len = a.length;\n\t\tif (i < 0) {\n\t\t\ti += len;\n\t\t\tif (i < 0) i = 0;\n\t\t}\n\t\twhile (i < len)\n\t\t{\n\t\t\tif (untyped __js__(\"a[i] === obj\"))\n\t\t\t\treturn i;\n\t\t\ti++;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tstatic function lastIndexOf<T>( a : Array<T>, obj : T, i : Int) {\n\t\tvar len = a.length;\n\t\tif (i >= len)\n\t\t\ti = len - 1;\n\t\telse if (i < 0)\n\t\t\ti += len;\n\t\twhile (i >= 0)\n\t\t{\n\t\t\tif (untyped __js__(\"a[i] === obj\"))\n\t\t\t\treturn i;\n\t\t\ti--;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tstatic function remove<T>( a : Array<T>, obj : T ) {\n\t\tvar i = a.indexOf(obj);\n\t\tif( i == -1 ) return false;\n\t\ta.splice(i,1);\n\t\treturn true;\n\t}\n\n\tstatic function iter<T>( a : Array<T> ) : Iterator<T> untyped {\n\t\treturn {\n\t\t\tcur : 0,\n\t\t\tarr : a,\n\t\t\thasNext : function() {\n\t\t\t\treturn __this__.cur < __this__.arr.length;\n\t\t\t},\n\t\t\tnext : function() {\n\t\t\t\treturn __this__.arr[__this__.cur++];\n\t\t\t}\n\t\t};\n\t}\n\n\tstatic function __init__() untyped {\n#if !js_es5\n\t\t__feature__('HxOverrides.indexOf', if( Array.prototype.indexOf ) __js__(\"HxOverrides\").indexOf = function(a,o,i) return Array.prototype.indexOf.call(a, o, i));\n\t\t__feature__('HxOverrides.lastIndexOf', if( Array.prototype.lastIndexOf ) __js__(\"HxOverrides\").lastIndexOf = function(a,o,i) return Array.prototype.lastIndexOf.call(a, o, i));\n#end\n\n#if mt\n\t\tif( String.prototype.cca == null ) String.prototype.cca = String.prototype.charCodeAt;\n#end\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n\n/**\n\tThe `Lambda` class is a collection of methods to support functional\n\tprogramming. It is ideally used with 'using Lambda' and then acts as an\n\textension to Iterable types.\n\n\tOn static platforms, working with the Iterable structure might be slower\n\tthan performing the operations directly on known types, such as Array and\n\tList.\n\n\tIf the first argument to any of the methods is null, the result is\n\tunspecified.\n**/\nclass Lambda {\n\n\t/**\n\t\tCreates an Array from Iterable `it`.\n\n\t\tIf `it` is an Array, this function returns a copy of it.\n\t**/\n\tpublic static function array<A>( it : Iterable<A> ) : Array<A> {\n\t\tvar a = new Array<A>();\n\t\tfor(i in it)\n\t\t\ta.push(i);\n\t\treturn a;\n\t}\n\n\t/**\n\t\tCreates a List form Iterable `it`.\n\n\t\tIf `it` is a List, this function returns a copy of it.\n\t**/\n\tpublic static function list<A>( it : Iterable<A> ) : List<A> {\n\t\tvar l = new List<A>();\n\t\tfor(i in it)\n\t\t\tl.add(i);\n\t\treturn l;\n\t}\n\n\t/**\n\t\tCreates a new List by applying function `f` to all elements of `it`.\n\n\t\tThe order of elements is preserved.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function map<A,B>( it : Iterable<A>, f : A -> B ) : List<B> {\n\t\tvar l = new List<B>();\n\t\tfor( x in it )\n\t\t\tl.add(f(x));\n\t\treturn l;\n\t}\n\n\t/**\n\t\tSimilar to map, but also passes the index of each element to `f`.\n\n\t\tThe order of elements is preserved.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function mapi<A,B>( it : Iterable<A>, f : Int -> A -> B ) : List<B> {\n\t\tvar l = new List<B>();\n\t\tvar i = 0;\n\t\tfor( x in it )\n\t\t\tl.add(f(i++,x));\n\t\treturn l;\n\t}\n\n\t/**\n\t\tTells if `it` contains `elt`.\n\n\t\tThis function returns true as soon as an element is found which is equal\n\t\tto `elt` according to the `==` operator.\n\n\t\tIf no such element is found, the result is false.\n\t**/\n\tpublic static function has<A>( it : Iterable<A>, elt : A ) : Bool {\n\t\tfor( x in it )\n\t\t\tif( x == elt )\n\t\t\t\treturn true;\n\t\treturn false;\n\t}\n\n\t/**\n\t\tTells if `it` contains an element for which `f` is true.\n\n\t\tThis function returns true as soon as an element is found for which a\n\t\tcall to `f` returns true.\n\n\t\tIf no such element is found, the result is false.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function exists<A>( it : Iterable<A>, f : A -> Bool ) {\n\t\tfor( x in it )\n\t\t\tif( f(x) )\n\t\t\t\treturn true;\n\t\treturn false;\n\t}\n\n\t/**\n\t\tTells if `f` is true for all elements of `it`.\n\n\t\tThis function returns false as soon as an element is found for which a\n\t\tcall to `f` returns false.\n\n\t\tIf no such element is found, the result is true.\n\n\t\tIn particular, this function always returns true if `it` is empty.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function foreach<A>( it : Iterable<A>, f : A -> Bool ) {\n\t\tfor( x in it )\n\t\t\tif( !f(x) )\n\t\t\t\treturn false;\n\t\treturn true;\n\t}\n\n\t/**\n\t\tCalls `f` on all elements of `it`, in order.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function iter<A>( it : Iterable<A>, f : A -> Void ) {\n\t\tfor( x in it )\n\t\t\tf(x);\n\t}\n\n\t/**\n\t\tReturns a List containing those elements of `it` for which `f` returned\n\t\ttrue.\n\n\t\tIf `it` is empty, the result is the empty List even if `f` is null.\n\n\t\tOtherwise if `f` is null, the result is unspecified.\n\t**/\n\tpublic static function filter<A>( it : Iterable<A>, f : A -> Bool ) {\n\t\tvar l = new List<A>();\n\t\tfor( x in it )\n\t\t\tif( f(x) )\n\t\t\t\tl.add(x);\n\t\treturn l;\n\t}\n\n\t/**\n\t\tFunctional fold on Iterable `it`, using function `f` with start argument\n\t\t`first`.\n\n\t\tIf `it` has no elements, the result is `first`.\n\n\t\tOtherwise the first element of `it` is passed to `f` alongside `first`.\n\t\tThe result of that call is then passed to `f` with the next element of\n\t\t`it`, and so on until `it` has no more elements.\n\n\t\tIf `it` or `f` are null, the result is unspecified.\n\t**/\n\tpublic static function fold<A,B>( it : Iterable<A>, f : A -> B -> B, first : B ) : B {\n\t\tfor( x in it )\n\t\t\tfirst = f(x,first);\n\t\treturn first;\n\t}\n\n\t/**\n\t\tReturns the number of elements in `it` for which `pred` is true, or the\n\t\ttotal number of elements in `it` if `pred` is null.\n\n\t\tThis function traverses all elements.\n\t**/\n\tpublic static function count<A>( it : Iterable<A>, ?pred : A -> Bool ) {\n\t\tvar n = 0;\n\t\tif( pred == null )\n\t\t\tfor( _ in it )\n\t\t\t\tn++;\n\t\telse\n\t\t\tfor( x in it )\n\t\t\t\tif( pred(x) )\n\t\t\t\t\tn++;\n\t\treturn n;\n\t}\n\n\t/**\n\t\tTells if Iterable `it` does not contain any element.\n\t**/\n\tpublic static function empty<T>( it : Iterable<T> ) : Bool {\n\t\treturn !it.iterator().hasNext();\n\t}\n\n\t/**\n\t\tReturns the index of the first element `v` within Iterable `it`.\n\n\t\tThis function uses operator `==` to check for equality.\n\n\t\tIf `v` does not exist in `it`, the result is -1.\n\t**/\n\tpublic static function indexOf<T>( it : Iterable<T>, v : T ) : Int {\n\t\tvar i = 0;\n\t\tfor( v2 in it ) {\n\t\t\tif( v == v2 )\n\t\t\t\treturn i;\n\t\t\ti++;\n\t\t}\n\t\treturn -1;\n\t}\n\n\t/**\n\t\tReturns the first element of `it` for which `f` is true.\n\n\t\tThis function returns as soon as an element is found for which a call to\n\t\t`f` returns true.\n\n\t\tIf no such element is found, the result is null.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function find<T>( it : Iterable<T>, f : T -> Bool ) : Null<T> {\n\t\tfor( v in it ) {\n\t\t\tif(f(v)) return v;\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t\tReturns a new List containing all elements of Iterable `a` followed by\n\t\tall elements of Iterable `b`.\n\n\t\tIf `a` or `b` are null, the result is unspecified.\n\t**/\n\tpublic static function concat<T>( a : Iterable<T>, b : Iterable<T> ) : List<T> {\n\t\tvar l = new List();\n\t\tfor( x in a )\n\t\t\tl.add(x);\n\t\tfor( x in b )\n\t\t\tl.add(x);\n\t\treturn l;\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n/**\n\tA linked-list of elements. The list is composed of two-elements arrays\n\tthat are chained together. It is optimized so that adding or removing an\n\telement does not imply copying the whole array content every time.\n**/\nclass List<T> {\n\n\tprivate var h : Array<Dynamic>;\n\tprivate var q : Array<Dynamic>;\n\n\t/**\n\t\tThe length of `this` List.\n\t**/\n\tpublic var length(default,null) : Int;\n\n\t/**\n\t\tCreates a new empty list.\n\t**/\n\tpublic function new() {\n\t\tlength = 0;\n\t}\n\n\t/**\n\t\tAdds element `item` at the end of `this` List.\n\t\t\n\t\t`this.length` increases by 1.\n\t**/\n\tpublic function add( item : T ) {\n\t\tvar x:Array<Dynamic> = #if neko untyped __dollar__array(item,null) #else [item] #end;\n\t\tif( h == null )\n\t\t\th = x;\n\t\telse\n\t\t\tq[1] = x;\n\t\tq = x;\n\t\tlength++;\n\t}\n\n\t/**\n\t\tAdds element `item` at the beginning of `this` List.\n\t\t\n\t\t`this.length` increases by 1.\n\t**/\n\tpublic function push( item : T ) {\n\t\tvar x : Array<Dynamic> = #if neko\n\t\t\tuntyped __dollar__array(item,h)\n\t\t#else\n\t\t\t[item,h]\n\t\t#end;\n\t\th = x;\n\t\tif( q == null )\n\t\t\tq = x;\n\t\tlength++;\n\t}\n\n\t/**\n\t\tReturns the first element of `this` List, or null if no elements exist.\n\t\t\n\t\tThis function does not modify `this` List.\n\t**/\n\tpublic function first() : Null<T> {\n\t\treturn if( h == null ) null else h[0];\n\t}\n\n\t/**\n\t\tReturns the last element of `this` List, or null if no elements exist.\n\t\t\n\t\tThis function does not modify `this` List.\n\t**/\n\tpublic function last() : Null<T> {\n\t\treturn if( q == null ) null else q[0];\n\t}\n\n\n\t/**\n\t\tReturns the first element of `this` List, or null if no elements exist.\n\t\t\n\t\tThe element is removed from `this` List.\n\t**/\n\tpublic function pop() : Null<T> {\n\t\tif( h == null )\n\t\t\treturn null;\n\t\tvar x = h[0];\n\t\th = h[1];\n\t\tif( h == null )\n\t\t\tq = null;\n\t\tlength--;\n\t\treturn x;\n\t}\n\n\t/**\n\t\tTells if `this` List is empty.\n\t**/\n\tpublic function isEmpty() : Bool {\n\t\treturn (h == null);\n\t}\n\n\t/**\n\t\tEmpties `this` List.\n\t\t\n\t\tThis function does not traverse the elements, but simply sets the\n\t\tinternal references to null and `this.length` to 0.\n\t**/\n\tpublic function clear() : Void {\n\t\th = null;\n\t\tq = null;\n\t\tlength = 0;\n\t}\n\n\t/**\n\t\tRemoves the first occurence of `v` in `this` List.\n\t\t\n\t\tIf `v` is found by checking standard equality, it is removed from `this`\n\t\tList and the function returns true.\n\t\t\n\t\tOtherwise, false is returned.\n\t**/\n\tpublic function remove( v : T ) : Bool {\n\t\tvar prev = null;\n\t\tvar l = h;\n\t\twhile( l != null ) {\n\t\t\tif( l[0] == v ) {\n\t\t\t\tif( prev == null )\n\t\t\t\t\th = l[1];\n\t\t\t\telse\n\t\t\t\t\tprev[1] = l[1];\n\t\t\t\tif( q == l )\n\t\t\t\t\tq = prev;\n\t\t\t\tlength--;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tprev = l;\n\t\t\tl = l[1];\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t\tReturns an iterator on the elements of the list.\n\t**/\n\tpublic function iterator() : Iterator<T> {\n\t\t#if (java || cs)\n\t\tvar h = h;\n\t\treturn cast {\n\t\t\thasNext : function() {\n\t\t\t\treturn (h != null);\n\t\t\t},\n\t\t\tnext : function() {\n\t\t\t\t{\n\t\t\t\t\tif( h == null )\n\t\t\t\t\t\treturn null;\n\t\t\t\t\tvar x = h[0];\n\t\t\t\t\th = h[1];\n\t\t\t\t\treturn x;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t#else\n\t\treturn cast {\n\t\t\th : h,\n\t\t\thasNext : function() {\n\t\t\t\treturn untyped (__this__.h != null);\n\t\t\t},\n\t\t\tnext : function() {\n\t\t\t\tuntyped {\n\t\t\t\t\tif( __this__.h == null )\n\t\t\t\t\t\treturn null;\n\t\t\t\t\tvar x = __this__.h[0];\n\t\t\t\t\t__this__.h = __this__.h[1];\n\t\t\t\t\treturn x;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t#end\n\t}\n\n\t/**\n\t\tReturns a string representation of `this` List.\n\t\t\n\t\tThe result is enclosed in { } with the individual elements being\n\t\tseparated by a comma.\n\t**/\n\tpublic function toString() {\n\t\tvar s = new StringBuf();\n\t\tvar first = true;\n\t\tvar l = h;\n\t\ts.add(\"{\");\n\t\twhile( l != null ) {\n\t\t\tif( first )\n\t\t\t\tfirst = false;\n\t\t\telse\n\t\t\t\ts.add(\", \");\n\t\t\ts.add(Std.string(l[0]));\n\t\t\tl = l[1];\n\t\t}\n\t\ts.add(\"}\");\n\t\treturn s.toString();\n\t}\n\n\t/**\n\t\tReturns a string representation of `this` List, with `sep` separating\n\t\teach element.\n\t**/\n\tpublic function join(sep : String) {\n\t\tvar s = new StringBuf();\n\t\tvar first = true;\n\t\tvar l = h;\n\t\twhile( l != null ) {\n\t\t\tif( first )\n\t\t\t\tfirst = false;\n\t\t\telse\n\t\t\t\ts.add(sep);\n\t\t\ts.add(l[0]);\n\t\t\tl = l[1];\n\t\t}\n\t\treturn s.toString();\n\t}\n\n\t/**\n\t\tReturns a list filtered with `f`. The returned list will contain all\n\t\telements for which `f(x) == true`.\n\t**/\n\tpublic function filter( f : T -> Bool ) {\n\t\tvar l2 = new List();\n\t\tvar l = h;\n\t\twhile( l != null ) {\n\t\t\tvar v = l[0];\n\t\t\tl = l[1];\n\t\t\tif( f(v) )\n\t\t\t\tl2.add(v);\n\t\t}\n\t\treturn l2;\n\t}\n\n\t/**\n\t\tReturns a new list where all elements have been converted by the\n\t\tfunction `f`.\n\t**/\n\tpublic function map<X>(f : T -> X) : List<X> {\n\t\tvar b = new List();\n\t\tvar l = h;\n\t\twhile( l != null ) {\n\t\t\tvar v = l[0];\n\t\t\tl = l[1];\n\t\t\tb.add(f(v));\n\t\t}\n\t\treturn b;\n\t}\n\n}\n","package ;\n\nimport about.About;\nimport autoformat.HaxePrinterLoader;\nimport cm.CodeMirrorEditor;\nimport cm.CodeMirrorZoom;\nimport core.Changelog;\nimport core.CompilationOutput;\nimport core.Completion;\nimport core.DeveloperTools;\nimport core.DragAndDrop;\nimport core.EditingTheme;\nimport core.EditorConfiguration;\nimport core.FileDialog;\nimport core.HaxeLint;\nimport core.HaxeParserProvider;\nimport core.HaxeServer;\nimport core.Hotkeys;\nimport core.PreserveWindowState;\nimport core.RunProject;\nimport core.Splitpane;\nimport core.ToggleFullscreen;\nimport core.Utils;\nimport core.Zoom;\nimport filetree.FileTree;\nimport haxe.Timer;\nimport haxe.Unserializer;\nimport haxeproject.HaxeProject;\nimport js.Browser;\nimport js.html.Element;\nimport js.html.TextAreaElement;\nimport js.Node;\nimport menu.BootstrapMenu;\nimport newprojectdialog.NewProjectDialogLoader;\nimport nodejs.webkit.Window;\nimport openflproject.OpenFLProject;\nimport openproject.OpenProjectLoader;\nimport projectaccess.ProjectAccess;\nimport projectaccess.ProjectOptions;\nimport tabmanager.TabManagerMain;\n\n/**\n * ...\n * @author AS3Boyan\n */\n\nclass Main \n{\n\tpublic static var currentTime:Float;\n\tpublic static var pluginsTestingData:String = \"  - cd plugins\";\n\tpublic static var window:Window;\n\t\n\tstatic function main() \n\t{        \n\t\twindow = Window.get();\n\t\t\n\t\twindow.showDevTools();\n\t\t\n\t\tjs.Node.process.on('uncaughtException', function (err)\n\t\t{\n\t\t\twindow.show();\n\t\t\ttrace(err);\n\t\t}\n\t\t);\n\t\t\n\t\tHotkeys.prepare();\n\t\t\n\t\tBrowser.window.addEventListener(\"load\", function (e):Void\n\t\t{\n\t\t\tUtils.prepare();\n\t\t\tBootstrapMenu.createMenuBar();\n\t\t\tNewProjectDialogLoader.load();\n\t\t\tDeveloperTools.addToMenu();\n\t\t\tCodeMirrorZoom.load();\n\t\t\tToggleFullscreen.addToMenu();\n\t\t\tZoom.addToMenu();\n\t\t\tChangelog.addToMenu();\n\t\t\tAbout.addToMenu();\n\t\t\tEditorConfiguration.addToMenu();\n\t\t\tEditingTheme.addToMenu();\n\t\t\tSplitpane.createSplitPane();\n\t\t\tSplitpane.activateSplitpane();\n\t\t\tPreserveWindowState.init();\n\t\t\tFileTree.init();\n\t\t\tProjectOptions.create();\n\t\t\tFileDialog.create();\n\t\t\tTabManagerMain.load();\n\t\t\tCompletion.registerHelper();\n\t\t\tHaxeLint.prepare();\n\t\t\tCodeMirrorEditor.load();\n\t\t\t\n\t\t\tHaxePrinterLoader.load();\n\t\t\tHaxeServer.check();\n\t\t\t\n\t\t\tRunProject.load();\n\t\t\t\n\t\t\tProjectAccess.registerSaveOnCloseListener();\n\t\t\t\n\t\t\tHaxeProject.load();\n\t\t\tOpenFLProject.load();\n\t\t\t\n\t\t\tCompilationOutput.load();\n\t\t\t\n\t\t\tOpenProjectLoader.load();\n\t\t\tDragAndDrop.prepare();\n\t\t\t\n\t\t\t//HaxeParserProvider.test();\n            \n\t\t\tcurrentTime = Date.now().getTime();\n\t\t\t\n\t\t\tcheckHaxeInstalled(function ()\n\t\t\t{\n\t\t\t\tloadPlugins();\n\t\t\t}\n\t\t\t,\n\t\t\tfunction ()\n\t\t\t{\n\t\t\t\tloadPlugins(false);\n\t\t\t}\n\t\t\t);\n\t\t}\n\t\t);\n\t\t\n\t\twindow.on(\"close\", function (e)\n\t\t{\n\t\t\tfor (w in HIDE.windows)\n\t\t\t{\n\t\t\t\tw.close(true);\n\t\t\t}\n\t\t\t\n\t\t\twindow.close(true);\n\t\t}\n\t\t);\n\t}\n\t\n\tpublic static function loadPlugins(?compile:Bool = true):Void\n\t{\n\t\tvar pathToPlugins:String = js.Node.path.join(\"..\", \"plugins\");\n\t\t\t\n\t\tvar pathToPluginsMTime:String = js.Node.path.join(\"..\", \"pluginsMTime.dat\");\n\t\t\n\t\tvar args:Array<String>;\n\t\t\n\t\tif (js.Node.fs.existsSync(pathToPluginsMTime))\n\t\t{\n\t\t\tvar options:js.Node.NodeFsFileOptions = { };\n\t\t\toptions.encoding = js.Node.NodeC.UTF8;\n\t\t\tvar data:String = js.Node.fs.readFileSync(pathToPluginsMTime, options);\n\t\t\tif (data != \"\") \n\t\t\t{\n\t\t\t\tHIDE.pluginsMTime = Unserializer.run(data);\n\t\t\t}\n\t\t}\n\t\telse \n\t\t{\n\t\t\tHIDE.firstRun = true;\n\t\t}\n\t\t\n\t\treadDir(pathToPlugins, \"\", function (path:String, pathToPlugin:String):Void\n\t\t{\n\t\t\tvar pluginName:String = StringTools.replace(pathToPlugin, js.Node.path.sep, \".\");\n\t\t\t\n\t\t\tvar relativePathToPlugin:String = js.Node.path.join(path, pathToPlugin);\n\t\t\t\n\t\t\t//Store path to plugin, so we can load JS and CSS scripts by specifying path relative to plugin's directory\n\t\t\tHIDE.pathToPlugins.set(pluginName, relativePathToPlugin);\n\t\t\t\n\t\t\tvar absolutePathToPlugin:String = js.Node.require(\"path\").resolve(relativePathToPlugin);\n\t\t\t\n\t\t\tif (HIDE.firstRun)\n\t\t\t{\n\t\t\t\tHIDE.pluginsMTime.set(pluginName, Std.parseInt(Std.string(Date.now().getTime())));\n\t\t\t}\n\t\t\t\n\t\t\tif (compile && (!HIDE.pluginsMTime.exists(pluginName) || HIDE.pluginsMTime.get(pluginName) < walk(absolutePathToPlugin)))\n\t\t\t{\t\t\t\t\n\t\t\t\t//Compile each plugin and load\n\t\t\t\tcompilePlugin(pluginName, absolutePathToPlugin, loadPlugin);\n\t\t\t}\n\t\t\telse \n\t\t\t{\n\t\t\t\t//Load plugin\n\t\t\t\tloadPlugin(absolutePathToPlugin);\n\t\t\t}\n\t\t});\n\t\t\n\t\tTimer.delay(function ():Void\n\t\t{\n\t\t\tif (HIDE.requestedPluginsData.length > 0)\n\t\t\t{\n\t\t\t\ttrace(\"still not loaded plugins: \");\n\t\t\t\n\t\t\t\tfor (pluginData in HIDE.requestedPluginsData)\n\t\t\t\t{\n\t\t\t\t\ttrace(pluginData.name + \": can't load plugin, required plugins are not found\");\n\t\t\t\t\ttrace(pluginData.plugins);\n\t\t\t\t\t\n\t\t\t\t\twindow.show();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tHIDE.savePluginsMTime();\n\t\t\t}\n\t\t}\n\t\t, 10000);\n\t}\n\t\n\tprivate static function walk(pathToPlugin:String):Int\n\t{\n\t\tvar pathToItem:String;\n\t\tvar time:Int = -1;\n\t\tvar mtime:Int;\n\t\tvar extension:String;\n\t\t\n\t\tfor (item in js.Node.fs.readdirSync(pathToPlugin))\n\t\t{\n\t\t\tpathToItem = js.Node.path.join(pathToPlugin, item);\n\t\t\t\n\t\t\tvar stat = js.Node.fs.statSync(pathToItem);\n\t\t\t\n\t\t\textension = js.Node.path.extname(pathToItem);\n\t\t\t\n\t\t\tif (stat.isFile() && (extension == \".hx\" || extension == \".hxml\"))\n\t\t\t{\n\t\t\t\tmtime = stat.mtime.getTime();\n\t\t\t\t\n\t\t\t\tif (time < mtime)\n\t\t\t\t{\n\t\t\t\t\ttime = mtime;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (stat.isDirectory()) \n\t\t\t{\n\t\t\t\tmtime = walk(pathToItem);\n\t\t\t\t\n\t\t\t\tif (time < mtime)\n\t\t\t\t{\n\t\t\t\t\ttime = mtime;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn time;\n\t}\n\t\n\tprivate static function readDir(path:String, pathToPlugin:String, onLoad:Dynamic):Void\n\t{\n\t\tvar pathToFolder:String;\n\t\t\n\t\tjs.Node.fs.readdir(js.Node.path.join(path, pathToPlugin), function (error:js.Node.NodeErr, folders:Array<String>):Void\n\t\t{\n\t\t\tif (error != null)\n\t\t\t{\n\t\t\t\ttrace(error);\n\t\t\t}\n\t\t\telse \n\t\t\t{\n\t\t\t\tfor (item in folders)\n\t\t\t\t{\n\t\t\t\t\tif (item != \"inactive\")\n\t\t\t\t\t{\n\t\t\t\t\t\tpathToFolder = js.Node.path.join(path, pathToPlugin, item);\n\t\t\t\t\t\n\t\t\t\t\t\tjs.Node.fs.stat(pathToFolder, function (error:js.Node.NodeErr, stat:js.Node.NodeStat)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (error != null)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t//trace(error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse \n\t\t\t\t\t\t\t{\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tvar pluginName:String = StringTools.replace(pathToPlugin, js.Node.path.sep, \".\");\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif (stat.isDirectory())\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\treadDir(path, js.Node.path.join(pathToPlugin,item), onLoad);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if (item == \"plugin.hxml\" && !Lambda.has(HIDE.inactivePlugins, pluginName))\n\t\t\t\t\t\t\t\t{\t\n\t\t\t\t\t\t\t\t\tvar levels:String = \"\";\n\t\t\t\t\t\t\t\t\tfor (i in 0...pathToPlugin.split(\"\\\\\").length)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tlevels += \"../\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tpluginsTestingData += \"\\n  - cd \" + StringTools.replace(pathToPlugin, \"\\\\\", \"/\") + \"\\n  - haxe plugin.hxml\\n  - cd \" + levels;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tonLoad(path, pathToPlugin);\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t);\n\t}\n\t\n\tprivate static function loadPlugin(pathToPlugin:String):Void\n\t{\t\t\n\t\tvar pathToMain:String = js.Node.path.join(pathToPlugin, \"bin\", \"Main.js\");\n\t\t\n\t\tjs.Node.fs.exists(pathToMain, function (exists:Bool)\n\t\t{\n\t\t\tif (exists)\n\t\t\t{\n\t\t\t\tHIDE.loadJS(null, [pathToMain]);\n\t\t\t}\n\t\t\telse \n\t\t\t{\n\t\t\t\ttrace(pathToMain + \" is not found/nPlease compile \" + pathToPlugin + \" plugin\");\n\t\t\t}\n\t\t}\n\t\t);\n\t}\n\t\n\tpublic static function compilePlugin(name:String, pathToPlugin:String, onSuccess:Dynamic, ?onFailed:String->Void):Void\n\t{\n\t\tvar pathToBin:String =  js.Node.path.join(pathToPlugin, \"bin\");\n\t\t\n\t\tjs.Node.fs.exists(pathToBin, function (exists:Bool)\n\t\t{\n\t\t\tif (exists)\n\t\t\t{\n\t\t\t\tstartPluginCompilation(name, pathToPlugin, onSuccess, onFailed);\n\t\t\t}\n\t\t\telse \n\t\t\t{\n\t\t\t\tjs.Node.fs.mkdir(pathToBin, function (error):Void\n\t\t\t\t{\n\t\t\t\t\tstartPluginCompilation(name, pathToPlugin, onSuccess, onFailed);\n\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\t);\n\t}\n\t\n\tprivate static function startPluginCompilation(name:String, pathToPlugin:String, onSuccess:Dynamic, ?onFailed:String->Void):Void\n\t{\n\t\tvar startTime:Float = Date.now().getTime();\n\t\tvar delta:Float;\n\t\t\n\t\tvar command:String = [\"haxe\", \"--cwd\", HIDE.surroundWithQuotes(pathToPlugin), \"plugin.hxml\"].join(\" \");\n\t\t\n\t\ttrace(command);\n\t\t\n\t\tvar haxeCompilerProcess:js.Node.NodeChildProcess = js.Node.child_process.exec(command, { }, function (err, stdout, stderr)\n\t\t{\t\t\t\n\t\t\tif (err == null)\n\t\t\t{\n\t\t\t\tdelta = Date.now().getTime() - startTime;\n\t\t\t\t\n\t\t\t\ttrace(name + \" compilation took \" + Std.string(delta)) + \" ms\";\n\t\t\t\t\n\t\t\t\tonSuccess(pathToPlugin);\n\t\t\t\tHIDE.pluginsMTime.set(name, Std.parseInt(Std.string(Date.now().getTime())));\n\t\t\t}\n\t\t\telse \n\t\t\t{\n\t\t\t\tvar element:Element = Browser.document.getElementById(\"plugin-compilation-console\");\n\n\t\t\t\tvar textarea:TextAreaElement;\n\t\t\t\t\n\t\t\t\tif (element == null)\n\t\t\t\t{\n\t\t\t\t\ttextarea = Browser.document.createTextAreaElement();\n\t\t\t\t\ttextarea.id = \"plugin-compilation-console\";\n\t\t\t\t\ttextarea.value = \"Plugins compile-time errors:\\n\";\n\t\t\t\t\tBrowser.document.body.appendChild(textarea);\n\t\t\t\t}\n\t\t\t\telse  \n\t\t\t\t{\n\t\t\t\t\ttextarea = cast(element, TextAreaElement);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\ttrace(pathToPlugin + ' stderr: ' + stderr);\n\t\t\t\t\n\t\t\t\ttextarea.value += name + \"\\n\" + stderr + \"\\n\";\n\t\t\t\ttrace(\"can't load \" + name + \" plugin, compilation failed\");\n\t\t\t\t\n\t\t\t\tvar regex:EReg = new EReg(\"haxelib install (.+) \", \"gim\");\n\t\t\t\tregex.map(stderr, function (ereg:EReg)\n\t\t\t\t{\n\t\t\t\t\ttrace(ereg);\n\t\t\t\t\treturn \"\";\n\t\t\t\t}\n\t\t\t\t);\n\t\t\t\t\n\t\t\t\tif (onFailed != null)\n\t\t\t\t{\n\t\t\t\t\tonFailed(stderr);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t);\n\t}\n\t\n\tprivate static function checkHaxeInstalled(onSuccess:Dynamic, onFailed:Dynamic):Void\n\t{\n\t\tjs.Node.child_process.exec(\"haxe\", { }, function (error, stdout, stderr) \n\t\t{\t\t\t\n\t\t\tif (error == null)\n\t\t\t{\n\t\t\t\tonSuccess();\n\t\t\t}\n\t\t\telse \n\t\t\t{\n\t\t\t\t//if (error.code = 1)\n\t\t\t\t//{\n\t\t\t\t\t//\n\t\t\t\t//}\n\t\t\t\t\n\t\t\t\ttrace(error);\n\t\t\t\ttrace(stdout);\n\t\t\t\ttrace(stderr);\n\t\t\t\tonFailed();\n\t\t\t}\n\t\t}\n\t\t);\n\t}\n}","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n@:coreApi class Reflect {\n\n\tpublic inline static function hasField( o : Dynamic, field : String ) : Bool {\n\t\treturn untyped __js__('Object').prototype.hasOwnProperty.call(o, field);\n\t}\n\n\tpublic static function field( o : Dynamic, field : String ) : Dynamic untyped {\n\t\treturn try o[field] catch( e : Dynamic ) null;\n\t}\n\n\tpublic inline static function setField( o : Dynamic, field : String, value : Dynamic ) : Void untyped {\n\t\to[field] = value;\n\t}\n\n\tpublic static inline function getProperty( o : Dynamic, field : String ) : Dynamic untyped {\n\t\tvar tmp;\n\t\treturn if( o == null ) __define_feature__(\"Reflect.getProperty\",null) else if( o.__properties__ && (tmp=o.__properties__[\"get_\"+field]) ) o[tmp]() else o[field];\n\t}\n\n\tpublic static inline function setProperty( o : Dynamic, field : String, value : Dynamic ) : Void untyped {\n\t\tvar tmp;\n\t\tif( o.__properties__ && (tmp=o.__properties__[\"set_\"+field]) ) o[tmp](value) else o[field] = __define_feature__(\"Reflect.setProperty\",value);\n\t}\n\n\tpublic inline static function callMethod( o : Dynamic, func : Dynamic, args : Array<Dynamic> ) : Dynamic untyped {\n\t\treturn func.apply(o,args);\n\t}\n\n\tpublic static function fields( o : Dynamic ) : Array<String> {\n\t\tvar a = [];\n\t\tif (o != null) untyped {\n\t\t\tvar hasOwnProperty = __js__('Object').prototype.hasOwnProperty;\n\t\t\t__js__(\"for( var f in o ) {\");\n\t\t\tif( f != \"__id__\" && f != \"hx__closures__\" && hasOwnProperty.call(o, f) ) a.push(f);\n\t\t\t__js__(\"}\");\n\t\t}\n\t\treturn a;\n\t}\n\n\tpublic static function isFunction( f : Dynamic ) : Bool untyped {\n\t\treturn __js__(\"typeof(f)\") == \"function\" && !(js.Boot.isClass(f) || js.Boot.isEnum(f));\n\t}\n\n\tpublic static function compare<T>( a : T, b : T ) : Int {\n\t\treturn ( a == b ) ? 0 : (((cast a) > (cast b)) ? 1 : -1);\n\t}\n\n\tpublic static function compareMethods( f1 : Dynamic, f2 : Dynamic ) : Bool {\n\t\tif( f1 == f2 )\n\t\t\treturn true;\n\t\tif( !isFunction(f1) || !isFunction(f2) )\n\t\t\treturn false;\n\t\treturn f1.scope == f2.scope && f1.method == f2.method && f1.method != null;\n\t}\n\n\tpublic static function isObject( v : Dynamic ) : Bool untyped {\n\t\tif( v == null )\n\t\t\treturn false;\n\t\tvar t = __js__(\"typeof(v)\");\n\t\treturn (t == \"string\" || (t == \"object\" && v.__enum__ == null)) || (t == \"function\" && (js.Boot.isClass(v) || js.Boot.isEnum(v)) != null);\n\t}\n\t\n\tpublic static function isEnumValue( v : Dynamic ) : Bool {\n\t\treturn v != null && v.__enum__ != null;\n\t}\n\n\tpublic static function deleteField( o : Dynamic, field : String ) : Bool untyped {\n\t\tif( !hasField(o,field) ) return false;\n\t\t__js__(\"delete\")(o[field]);\n\t\treturn true;\n\t}\n\n\tpublic static function copy<T>( o : T ) : T {\n\t\tvar o2 : Dynamic = {};\n\t\tfor( f in Reflect.fields(o) )\n\t\t\tReflect.setField(o2,f,Reflect.field(o,f));\n\t\treturn o2;\n\t}\n\n\t@:overload(function( f : Array<Dynamic> -> Void ) : Dynamic {})\n\tpublic static function makeVarArgs( f : Array<Dynamic> -> Dynamic ) : Dynamic {\n\t\treturn function() {\n\t\t\tvar a = untyped Array.prototype.slice.call(__js__(\"arguments\"));\n\t\t\treturn f(a);\n\t\t};\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\nimport js.Boot;\n\n@:keepInit\n@:coreApi class Std {\n\n\tpublic static inline function is( v : Dynamic, t : Dynamic ) : Bool {\n\t\treturn untyped js.Boot.__instanceof(v,t);\n\t}\n\t\n\tpublic static inline function instance<T:{},S:T>( value : T, c : Class<S> ) : S {\n\t\treturn untyped __instanceof__(value, c) ? cast value : null;\n\t}\n\n\tpublic static function string( s : Dynamic ) : String {\n\t\treturn untyped js.Boot.__string_rec(s,\"\");\n\t}\n\n\tpublic static inline function int( x : Float ) : Int {\n\t\treturn cast(x) | 0;\n\t}\n\n\tpublic static function parseInt( x : String ) : Null<Int> {\n\t\tvar v = untyped __js__(\"parseInt\")(x, 10);\n\t\t// parse again if hexadecimal\n\t\tif( v == 0 && (x.charCodeAt(1) == 'x'.code || x.charCodeAt(1) == 'X'.code) )\n\t\t\tv = untyped __js__(\"parseInt\")(x);\n\t\tif( untyped __js__(\"isNaN\")(v) )\n\t\t\treturn null;\n\t\treturn cast v;\n\t}\n\n\tpublic static function parseFloat( x : String ) : Float {\n\t\treturn untyped __js__(\"parseFloat\")(x);\n\t}\n\n\tpublic static function random( x : Int ) : Int {\n\t\treturn untyped x <= 0 ? 0 : Math.floor(Math.random()*x);\n\t}\n\n\tstatic function __init__() : Void untyped {\n\t\t__feature__(\"js.Boot.getClass\",String.prototype.__class__ = __feature__(\"Type.resolveClass\",$hxClasses[\"String\"] = String,String));\n\t\t__feature__(\"js.Boot.isClass\",String.__name__ = __feature__(\"Type.getClassName\",[\"String\"],true));\n\t\t__feature__(\"Type.resolveClass\",$hxClasses[\"Array\"] = Array);\n\t\t__feature__(\"js.Boot.isClass\",Array.__name__ = __feature__(\"Type.getClassName\",[\"Array\"],true));\n\t\t__feature__(\"Date.*\", {\n\t\t\t__feature__(\"js.Boot.getClass\",__js__('Date').prototype.__class__ = __feature__(\"Type.resolveClass\",$hxClasses[\"Date\"] = __js__('Date'),__js__('Date')));\n\t\t\t__feature__(\"js.Boot.isClass\",__js__('Date').__name__ = [\"Date\"]);\n\t\t});\n\t\t__feature__(\"Int.*\",{\n\t\t\tvar Int = __feature__(\"Type.resolveClass\", $hxClasses[\"Int\"] = { __name__ : [\"Int\"] }, { __name__ : [\"Int\"] });\n\t\t});\n\t\t__feature__(\"Dynamic.*\",{\n\t\t\tvar Dynamic = __feature__(\"Type.resolveClass\", $hxClasses[\"Dynamic\"] = { __name__ : [\"Dynamic\"] }, { __name__ : [\"Dynamic\"] });\n\t\t});\n\t\t__feature__(\"Float.*\",{\n\t\t\tvar Float = __feature__(\"Type.resolveClass\", $hxClasses[\"Float\"] = __js__(\"Number\"), __js__(\"Number\"));\n\t\t\tFloat.__name__ = [\"Float\"];\n\t\t});\n\t\t__feature__(\"Bool.*\",{\n\t\t\tvar Bool = __feature__(\"Type.resolveEnum\",$hxClasses[\"Bool\"] = __js__(\"Boolean\"), __js__(\"Boolean\"));\n\t\t\tBool.__ename__ = [\"Bool\"];\n\t\t});\n\t\t__feature__(\"Class.*\",{\n\t\t\tvar Class = __feature__(\"Type.resolveClass\", $hxClasses[\"Class\"] = { __name__ : [\"Class\"] }, { __name__ : [\"Class\"] });\n\t\t});\n\t\t__feature__(\"Enum.*\",{\n\t\t\tvar Enum = {};\n\t\t});\n\t\t__feature__(\"Void.*\",{\n\t\t\tvar Void = __feature__(\"Type.resolveEnum\", $hxClasses[\"Void\"] = { __ename__ : [\"Void\"] }, { __ename__ : [\"Void\"] });\n\t\t});\n\n#if !js_es5\n\t\t__feature__(\"Array.map\",\n\t\t\tif( Array.prototype.map == null )\n\t\t\t\tArray.prototype.map = function(f) {\n\t\t\t\t\tvar a = [];\n\t\t\t\t\tfor( i in 0...__this__.length )\n\t\t\t\t\t\ta[i] = f(__this__[i]);\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\t\t);\n\t\t__feature__(\"Array.filter\",\n\t\t\tif( Array.prototype.filter == null )\n\t\t\t\tArray.prototype.filter = function(f) {\n\t\t\t\t\tvar a = [];\n\t\t\t\t\tfor( i in 0...__this__.length ) {\n\t\t\t\t\t\tvar e = __this__[i];\n\t\t\t\t\t\tif( f(e) ) a.push(e);\n\t\t\t\t\t}\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\t\t);\n#end\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n/**\n\tA String buffer is an efficient way to build a big string by appending small\n\telements together.\n\t\n\tIts cross-platform implementation uses String concatenation internally, but\n\tStringBuf may be optimized for different targets.\n\t\n\tUnlike String, an instance of StringBuf is not immutable in the sense that\n\tit can be passed as argument to functions which modify it by appending more\n\tvalues. However, the internal buffer cannot be modified.\n**/\nclass StringBuf {\n\n\tvar b:String = \"\";\n\t\n\t/**\n\t\tThe length of `this` StringBuf in characters.\n\t**/\n\tpublic var length(get,never) : Int;\n\n\t/**\n\t\tCreates a new StringBuf instance.\n\t\t\n\t\tThis may involve initialization of the internal buffer.\n\t**/\n\tpublic function new() {}\n\n\tinline function get_length() : Int {\n\t\treturn b.length;\n\t}\n\n\t/**\n\t\tAppends the representation of `x` to `this` StringBuf.\n\t\t\n\t\tThe exact representation of `x` may vary per platform. To get more\n\t\tconsistent behavior, this function should be called with\n\t\tStd.string(x).\n\t\t\n\t\tIf `x` is null, the String \"null\" is appended.\n\t**/\n\tpublic inline function add<T>( x : T ) : Void {\n\t\tb += x;\n\t}\n\n\t/**\n\t\tAppends the character identified by `c` to `this` StringBuf.\n\t\t\n\t\tIf `c` is negative or has another invalid value, the result is\n\t\tunspecified.\n\t**/\n\tpublic inline function addChar( c : Int ) : Void {\n\t\tb += String.fromCharCode(c);\n\t}\n\n\t/**\n\t\tAppends a substring of `s` to `this` StringBuf.\n\t\t\n\t\tThis function expects `pos` and `len` to describe a valid substring of\n\t\t`s`, or else the result is unspecified. To get more robust behavior,\n\t\t`this.add(s.substr(pos,len))` can be used instead.\n\t\t\n\t\tIf `s` or `pos` are null, the result is unspecified.\n\t\t\n\t\tIf `len` is omitted or null, the substring ranges from `pos` to the end\n\t\tof `s`.\n\t**/\n\tpublic inline function addSub( s : String, pos : Int, ?len : Int) : Void {\n\t\tb += (len == null ? s.substr(pos) : s.substr(pos, len));\n\t}\n\n\t/**\n\t\tReturns the content of `this` StringBuf as String.\n\t\t\n\t\tThe buffer is not emptied by this operation.\n\t**/\n\tpublic inline function toString() : String {\n\t\treturn b;\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n/**\n\tThis class provides advanced methods on Strings. It is ideally used with\n\t'using StringTools' and then acts as an extension to the String class.\n\n\tIf the first argument to any of the methods is null, the result is\n\tunspecified.\n**/\n#if cs\n@:keep\n#end\nclass StringTools {\n\t/**\n\t\tEncode an URL by using the standard format.\n\t**/\n\t#if !java inline #end public static function urlEncode( s : String ) : String untyped {\n\t\t#if flash9\n\t\t\treturn __global__[\"encodeURIComponent\"](s);\n\t\t#elseif flash\n\t\t\treturn _global[\"escape\"](s);\n\t\t#elseif neko\n\t\t\treturn new String(_urlEncode(s.__s));\n\t\t#elseif js\n\t\t\treturn encodeURIComponent(s);\n\t\t#elseif cpp\n\t\t\treturn s.__URLEncode();\n\t\t#elseif java\n\t\t\ttry\n\t\t\t\treturn untyped __java__(\"java.net.URLEncoder.encode(s, \\\"UTF-8\\\")\")\n\t\t\tcatch (e:Dynamic) throw e;\n\t\t#elseif cs\n\t\t\treturn cs.system.Uri.EscapeUriString(s);\n\t\t#else\n\t\t\treturn null;\n\t\t#end\n\t}\n\n\t/**\n\t\tDecode an URL using the standard format.\n\t**/\n\t#if !java inline #end public static function urlDecode( s : String ) : String untyped {\n\t\t#if flash9\n\t\t\treturn __global__[\"decodeURIComponent\"](s.split(\"+\").join(\" \"));\n\t\t#elseif flash\n\t\t\treturn _global[\"unescape\"](s);\n\t\t#elseif neko\n\t\t\treturn new String(_urlDecode(s.__s));\n\t\t#elseif js\n\t\t\treturn decodeURIComponent(s.split(\"+\").join(\" \"));\n\t\t#elseif cpp\n\t\t\treturn s.__URLDecode();\n\t\t#elseif java\n\t\t\ttry\n\t\t\t\treturn untyped __java__(\"java.net.URLDecoder.decode(s, \\\"UTF-8\\\")\")\n\t\t\tcatch (e:Dynamic) throw e;\n\t\t#elseif cs\n\t\t\treturn cs.system.Uri.UnescapeDataString(s);\n\t\t#else\n\t\t\treturn null;\n\t\t#end\n\t}\n\n\t/**\n\t\tEscapes HTML special characters of the string `s`.\n\n\t\tThe following replacements are made:\n\t\t\t\n\t\t- `&` becomes `&amp`;\n\t\t- `<` becomes `&lt`;\n\t\t- `>` becomes `&gt`;\n\t\t\n\t\tIf `quotes` is true, the following characters are also replaced:\n\t\t\n\t\t- `\"` becomes `&quot`;\n\t\t- `'` becomes `&#039`;\n\t**/\n\tpublic static function htmlEscape( s : String, ?quotes : Bool ) : String {\n\t\ts = s.split(\"&\").join(\"&amp;\").split(\"<\").join(\"&lt;\").split(\">\").join(\"&gt;\");\n\t\treturn quotes ? s.split('\"').join(\"&quot;\").split(\"'\").join(\"&#039;\") : s;\n\t}\n\n\t/**\n\t\tUnescapes HTML special characters of the string `s`.\n\n\t\tThis is the inverse operation to htmlEscape, i.e. the following always\n\t\tholds: htmlUnescape(htmlEscape(s)) == s\n\n\t\tThe replacements follow:\n\t\t\t\n\t\t- `&amp;` becomes `&`\n\t\t- `&lt;` becomes `<`\n\t\t- `&gt;` becomes `>`\n\t\t- `&quot;` becomes `\"`\n\t\t- `&#039;` becomes `'`\n\t**/\n\tpublic static function htmlUnescape( s : String ) : String {\n\t\treturn s.split(\"&gt;\").join(\">\").split(\"&lt;\").join(\"<\").split(\"&quot;\").join('\"').split(\"&#039;\").join(\"'\").split(\"&amp;\").join(\"&\");\n\t}\n\n\t/**\n\t\tTells if the string `s` starts with the string `start`.\n\n\t\tIf `start` is null, the result is unspecified.\n\n\t\tIf `start` is the empty String \"\", the result is true.\n\t**/\n\tpublic static #if (cs || java) inline #end function startsWith( s : String, start : String ) : Bool {\n\t\t#if java\n\t\treturn untyped s.startsWith(start);\n\t\t#elseif cs\n\t\treturn untyped s.StartsWith(start);\n\t\t#else\n\t\treturn( s.length >= start.length && s.substr(0, start.length) == start );\n\t\t#end\n\t}\n\n\t/**\n\t\tTells if the string `s` ends with the string `end`.\n\n\t\tIf `end` is null, the result is unspecified.\n\n\t\tIf `end` is the empty String \"\", the result is true.\n\t**/\n\tpublic static #if (cs || java) inline #end function endsWith( s : String, end : String ) : Bool {\n\t\t#if java\n\t\treturn untyped s.endsWith(end);\n\t\t#elseif cs\n\t\treturn untyped s.EndsWith(end);\n\t\t#else\n\t\tvar elen = end.length;\n\t\tvar slen = s.length;\n\t\treturn( slen >= elen && s.substr(slen - elen, elen) == end );\n\t\t#end\n\t}\n\n\t/**\n\t\tTells if the character in the string `s` at position `pos` is a space.\n\n\t\tA character is considered to be a space character if its character code\n\t\tis 9,10,11,12,13 or 32.\n\n\t\tIf `s` is the empty String \"\", or if pos is not a valid position within\n\t\t`s`, the result is false.\n\t**/\n\tpublic static function isSpace( s : String, pos : Int ) : Bool {\n\t\tvar c = s.charCodeAt( pos );\n\t\treturn (c > 8 && c < 14) || c == 32;\n\t}\n\n\t/**\n\t\tRemoves leading space characters of `s`.\n\n\t\tThis function internally calls isSpace() to decide which characters to\n\t\tremove.\n\n\t\tIf `s` is the empty String \"\" or consists only of space characters, the\n\t\tresult is the empty String \"\".\n\t**/\n\tpublic #if cs inline #end static function ltrim( s : String ) : String {\n\t\t#if cs\n\t\treturn untyped s.TrimStart();\n\t\t#else\n\t\tvar l = s.length;\n\t\tvar r = 0;\n\t\twhile( r < l && isSpace(s,r) ){\n\t\t\tr++;\n\t\t}\n\t\tif( r > 0 )\n\t\t\treturn s.substr(r, l-r);\n\t\telse\n\t\t\treturn s;\n\t\t#end\n\t}\n\n\t/**\n\t\tRemoves trailing space characters of `s`.\n\n\t\tThis function internally calls isSpace() to decide which characters to\n\t\tremove.\n\n\t\tIf `s` is the empty String \"\" or consists only of space characters, the\n\t\tresult is the empty String \"\".\n\t**/\n\tpublic #if cs inline #end static function rtrim( s : String ) : String {\n\t\t#if cs\n\t\treturn untyped s.TrimEnd();\n\t\t#else\n\t\tvar l = s.length;\n\t\tvar r = 0;\n\t\twhile( r < l && isSpace(s,l-r-1) ){\n\t\t\tr++;\n\t\t}\n\t\tif( r > 0 ){\n\t\t\treturn s.substr(0, l-r);\n\t\t}else{\n\t\t\treturn s;\n\t\t}\n\t\t#end\n\t}\n\n\t/**\n\t\tRemoves leading and trailing space characters of `s`.\n\n\t\tThis is a convenience function for ltrim(rtrim(s)).\n\t**/\n\tpublic #if (cs || java) inline #end static function trim( s : String ) : String {\n\t\t#if cs\n\t\treturn untyped s.Trim();\n\t\t#elseif java\n\t\treturn untyped s.trim();\n\t\t#else\n\t\treturn ltrim(rtrim(s));\n\t\t#end\n\t}\n\n\t/**\n\t\tConcatenates `c` to `s` until `s.length` is at least `l`.\n\n\t\tIf `c` is the empty String \"\" or if `l` does not exceed `s.length`,\n\t\t`s` is returned unchanged.\n\n\t\tIf `c.length` is 1, the resulting String length is exactly `l`.\n\n\t\tOtherwise the length may exceed `l`.\n\n\t\tIf `c` is null, the result is unspecified.\n\t**/\n\tpublic static function lpad( s : String, c : String, l : Int ) : String {\n\t\tif (c.length <= 0)\n\t\t\treturn s;\n\n\t\twhile (s.length < l) {\n\t\t\ts = c + s;\n\t\t}\n\t\treturn s;\n\t}\n\n\t/**\n\t\tAppends `c` to `s` until `s.length` is at least `l`.\n\n\t\tIf `c` is the empty String \"\" or if `l` does not exceed `s.length`,\n\t\t`s` is returned unchanged.\n\n\t\tIf `c.length` is 1, the resulting String length is exactly `l`.\n\n\t\tOtherwise the length may exceed `l`.\n\n\t\tIf `c` is null, the result is unspecified.\n\t**/\n\tpublic static function rpad( s : String, c : String, l : Int ) : String {\n\t\tif (c.length <= 0)\n\t\t\treturn s;\n\n\t\twhile (s.length < l) {\n\t\t\ts = s + c;\n\t\t}\n\t\treturn s;\n\t}\n\n\t/**\n\t\tReplace all occurences of the String `sub` in the String `s` by the\n\t\tString `by`.\n\n\t\tIf `sub` is the empty String \"\", `by` is inserted after each character\n\t\tof `s`. If `by` is also the empty String \"\", `s` remains unchanged.\n\n\t\tThis is a convenience function for `s.split(sub).join(by)`.\n\n\t\tIf `sub` or `by` are null, the result is unspecified.\n\t**/\n\tpublic static function replace( s : String, sub : String, by : String ) : String {\n\t\t#if java\n\t\tif (sub.length == 0)\n\t\t\treturn s.split(sub).join(by);\n\t\telse\n\t\t\treturn untyped s.replace(sub, by);\n\t\t#elseif cs\n\t\tif (sub.length == 0)\n\t\t\treturn s.split(sub).join(by);\n\t\telse\n\t\t\treturn untyped s.Replace(sub, by);\n\t\t#else\n\t\treturn s.split(sub).join(by);\n\t\t#end\n\t}\n\n\t/**\n\t\tEncodes `n` into a hexadecimal representation.\n\n\t\tIf `digits` is specified, the resulting String is padded with \"0\" until\n\t\tits length equals `digits`.\n\t**/\n\tpublic static function hex( n : Int, ?digits : Int ) {\n\t\t#if flash9\n\t\t\tvar n : UInt = n;\n\t\t\tvar s : String = untyped n.toString(16);\n\t\t\ts = s.toUpperCase();\n\t\t#else\n\t\t\tvar s = \"\";\n\t\t\tvar hexChars = \"0123456789ABCDEF\";\n\t\t\tdo {\n\t\t\t\ts = hexChars.charAt(n&15) + s;\n\t\t\t\tn >>>= 4;\n\t\t\t} while( n > 0 );\n\t\t#end\n\t\tif( digits != null )\n\t\t\twhile( s.length < digits )\n\t\t\t\ts = \"0\"+s;\n\t\treturn s;\n\t}\n\n\t/**\n\t\tReturns the character code at position `index` of String `s`.\n\n\t\tThis method is faster than String.charCodeAt() on most platforms.\n\t\tHowever, unlike String.charCodeAt(), the result is unspecified if\n\t\t`index` is negative or exceeds `s.length`.\n\n\t\tThis operation is not guaranteed to work if `s` contains the \\0\n\t\tcharacter.\n\t**/\n\tpublic static inline function fastCodeAt( s : String, index : Int ) : Int untyped {\n\t\t#if neko\n\t\treturn untyped __dollar__sget(s.__s, index);\n\t\t#elseif cpp\n\t\treturn s.cca(index);\n\t\t#elseif flash9\n\t\treturn s.cca(index);\n\t\t#elseif flash\n\t\treturn s[\"cca\"](index);\n\t\t#elseif java\n\t\treturn ( index < s.length ) ? cast(_charAt(s, index), Int) : -1;\n\t\t#elseif cs\n\t\treturn ( cast(index, UInt) < s.length ) ? cast(untyped s[index], Int) : -1;\n\t\t#elseif js\n\t\t\t#if mt\n\t\treturn (untyped s).cca(index);\n\t\t\t#else\n\t\treturn (untyped s).charCodeAt(index);\n\t\t\t#end\n\t\t#else\n\t\treturn s.cca(index);\n\t\t#end\n\t}\n\n\t/*\n\t\tTells if `c` represents the end-of-file (EOF) character.\n\t*/\n\t@:noUsing public static inline function isEof( c : Int ) : Bool {\n\t\t#if (flash9 || cpp)\n\t\treturn c == 0;\n\t\t#elseif flash8\n\t\treturn c <= 0; // fast NaN\n\t\t#elseif js\n\t\treturn c != c; // fast NaN\n\t\t#elseif neko\n\t\treturn c == null;\n\t\t#elseif cs\n\t\treturn c == -1;\n\t\t#elseif java\n\t\treturn c == -1;\n\t\t#else\n\t\treturn false;\n\t\t#end\n\t}\n\n\t#if java\n\tprivate static inline function _charAt(str:String, idx:Int):java.StdTypes.Char16 return untyped str._charAt(idx);\n\t#end\n\n\t#if neko\n\tprivate static var _urlEncode = neko.Lib.load(\"std\",\"url_encode\",1);\n\tprivate static var _urlDecode = neko.Lib.load(\"std\",\"url_decode\",1);\n\t#end\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\nenum ValueType {\n\tTNull;\n\tTInt;\n\tTFloat;\n\tTBool;\n\tTObject;\n\tTFunction;\n\tTClass( c : Class<Dynamic> );\n\tTEnum( e : Enum<Dynamic> );\n\tTUnknown;\n}\n\n@:coreApi class Type {\n\n\tpublic static function getClass<T>( o : T ) : Class<T> untyped {\n\t\tif( o == null )\n\t\t\treturn null;\n\t\treturn js.Boot.getClass(o);\n\t}\n\n\tpublic static function getEnum( o : EnumValue ) : Enum<Dynamic> untyped {\n\t\tif( o == null )\n\t\t\treturn null;\n\t\treturn o.__enum__;\n\t}\n\n\tpublic static function getSuperClass( c : Class<Dynamic> ) : Class<Dynamic> untyped {\n\t\treturn c.__super__;\n\t}\n\n\n\tpublic static function getClassName( c : Class<Dynamic> ) : String {\n\t\tvar a : Array<String> = untyped c.__name__;\n\t\treturn a.join(\".\");\n\t}\n\n\tpublic static function getEnumName( e : Enum<Dynamic> ) : String {\n\t\tvar a : Array<String> = untyped e.__ename__;\n\t\treturn a.join(\".\");\n\t}\n\n\tpublic static function resolveClass( name : String ) : Class<Dynamic> untyped {\n\t\tvar cl : Class<Dynamic> = $hxClasses[name];\n\t\t// ensure that this is a class\n\t\tif( cl == null || !js.Boot.isClass(cl) )\n\t\t\treturn null;\n\t\treturn cl;\n\t}\n\n\tpublic static function resolveEnum( name : String ) : Enum<Dynamic> untyped {\n\t\tvar e : Dynamic = $hxClasses[name];\n\t\t// ensure that this is an enum\n\t\tif( e == null || !js.Boot.isEnum(e) )\n\t\t\treturn null;\n\t\treturn e;\n\t}\n\n\tpublic static function createInstance<T>( cl : Class<T>, args : Array<Dynamic> ) : T untyped {\n\t\tswitch( args.length ) {\n\t\tcase 0:\n\t\t\treturn __new__(cl);\n\t\tcase 1:\n\t\t\treturn __new__(cl,args[0]);\n\t\tcase 2:\n\t\t\treturn __new__(cl,args[0],args[1]);\n\t\tcase 3:\n\t\t\treturn __new__(cl,args[0],args[1],args[2]);\n\t\tcase 4:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3]);\n\t\tcase 5:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4]);\n\t\tcase 6:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5]);\n\t\tcase 7:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5],args[6]);\n\t\tcase 8:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7]);\n\t\tdefault:\n\t\t\tthrow \"Too many arguments\";\n\t\t}\n\t\treturn null;\n\t}\n\n\tpublic static function createEmptyInstance<T>( cl : Class<T> ) : T untyped {\n\t\t__js__(\"function empty() {}; empty.prototype = cl.prototype\");\n\t\treturn __js__(\"new empty()\");\n\t}\n\n\tpublic static function createEnum<T>( e : Enum<T>, constr : String, ?params : Array<Dynamic> ) : T {\n\t\tvar f = Reflect.field(e,constr);\n\t\tif( f == null ) throw \"No such constructor \"+constr;\n\t\tif( Reflect.isFunction(f) ) {\n\t\t\tif( params == null ) throw \"Constructor \"+constr+\" need parameters\";\n\t\t\treturn Reflect.callMethod(e,f,params);\n\t\t}\n\t\tif( params != null && params.length != 0 )\n\t\t\tthrow \"Constructor \"+constr+\" does not need parameters\";\n\t\treturn f;\n\t}\n\n\tpublic static function createEnumIndex<T>( e : Enum<T>, index : Int, ?params : Array<Dynamic> ) : T {\n\t\tvar c : String = (untyped e.__constructs__)[index];\n\t\tif( c == null ) throw index+\" is not a valid enum constructor index\";\n\t\treturn createEnum(e,c,params);\n\t}\n\n\tpublic static function getInstanceFields( c : Class<Dynamic> ) : Array<String> {\n\t\tvar a = [];\n\t\tuntyped __js__(\"for(var i in c.prototype) a.push(i)\");\n\t\ta.remove(\"__class__\");\n\t\ta.remove(\"__properties__\");\n\t\treturn a;\n\t}\n\n\tpublic static function getClassFields( c : Class<Dynamic> ) : Array<String> {\n\t\tvar a = Reflect.fields(c);\n\t\ta.remove(\"__name__\");\n\t\ta.remove(\"__interfaces__\");\n\t\ta.remove(\"__properties__\");\n\t\ta.remove(\"__super__\");\n\t\ta.remove(\"prototype\");\n\t\treturn a;\n\t}\n\n\tpublic static function getEnumConstructs( e : Enum<Dynamic> ) : Array<String> {\n\t\tvar a : Array<String> = untyped e.__constructs__;\n\t\treturn a.copy();\n\t}\n\n\tpublic static function typeof( v : Dynamic ) : ValueType untyped {\n\t\tswitch( __js__(\"typeof\")(v) ) {\n\t\tcase \"boolean\": return TBool;\n\t\tcase \"string\": return TClass(String);\n\t\tcase \"number\":\n\t\t\t// this should handle all cases : NaN, +/-Inf and Floats outside range\n\t\t\tif( Math.ceil(v) == v%2147483648.0 )\n\t\t\t\treturn TInt;\n\t\t\treturn TFloat;\n\t\tcase \"object\":\n\t\t\tif( v == null )\n\t\t\t\treturn TNull;\n\t\t\tvar e = v.__enum__;\n\t\t\tif( e != null )\n\t\t\t\treturn TEnum(e);\n\t\t\tvar c = js.Boot.getClass(v);\n\t\t\tif( c != null )\n\t\t\t\treturn TClass(c);\n\t\t\treturn TObject;\n\t\tcase \"function\":\n\t\t\tif( js.Boot.isClass(v) || js.Boot.isEnum(v) )\n\t\t\t\treturn TObject;\n\t\t\treturn TFunction;\n\t\tcase \"undefined\":\n\t\t\treturn TNull;\n\t\tdefault:\n\t\t\treturn TUnknown;\n\t\t}\n\t}\n\n\tpublic static function enumEq<T>( a : T, b : T ) : Bool untyped {\n\t\tif( a == b )\n\t\t\treturn true;\n\t\ttry {\n\t\t\tif( a[0] != b[0] )\n\t\t\t\treturn false;\n\t\t\tfor( i in 2...a.length )\n\t\t\t\tif( !enumEq(a[i],b[i]) )\n\t\t\t\t\treturn false;\n\t\t\tvar e = a.__enum__;\n\t\t\tif( e != b.__enum__ || e == null )\n\t\t\t\treturn false;\n\t\t} catch( e : Dynamic ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tpublic inline static function enumConstructor( e : EnumValue ) : String {\n\t\treturn untyped e[0];\n\t}\n\n\tpublic inline static function enumParameters( e : EnumValue ) : Array<Dynamic> {\n\t\treturn untyped e.slice(2);\n\t}\n\n\tpublic inline static function enumIndex( e : EnumValue ) : Int {\n\t\treturn untyped e[1];\n\t}\n\n\tpublic static function allEnums<T>( e : Enum<T> ) : Array<T> {\n\t\tvar all = [];\n\t\tvar cst : Array<String> = untyped e.__constructs__;\n\t\tfor( c in cst ) {\n\t\t\tvar v = Reflect.field(e,c);\n\t\t\tif( !Reflect.isFunction(v) )\n\t\t\t\tall.push(v);\n\t\t}\n\t\treturn all;\n\t}\n\n}\n\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\nenum XmlType {\n}\n\n@:coreApi class Xml {\n\n\tpublic static var Element(default,null) : XmlType;\n\tpublic static var PCData(default,null) : XmlType;\n\tpublic static var CData(default,null) : XmlType;\n\tpublic static var Comment(default,null) : XmlType;\n\tpublic static var DocType(default,null) : XmlType;\n\tpublic static var ProcessingInstruction(default,null) : XmlType;\n\tpublic static var Document(default,null) : XmlType;\n\n\tpublic var nodeType(default,null) : XmlType;\n\tpublic var nodeName(get,set) : String;\n\tpublic var nodeValue(get,set) : String;\n\tpublic var parent(get,null) : Xml;\n\n\tvar _nodeName : String;\n\tvar _nodeValue : String;\n\tvar _attributes : haxe.ds.StringMap<String>;\n\tvar _children : Array<Xml>;\n\tvar _parent : Xml;\n\n\tpublic static function parse( str : String ) : Xml {\n\t\treturn haxe.xml.Parser.parse(str);\n\t}\n\n\tprivate function new() : Void {\n\t}\n\n\tpublic static function createElement( name : String ) : Xml {\n\t\tvar r = new Xml();\n\t\tr.nodeType = Xml.Element;\n\t\tr._children = new Array();\n\t\tr._attributes = new haxe.ds.StringMap();\n\t\tr.set_nodeName( name );\n\t\treturn r;\n\t}\n\n\tpublic static function createPCData( data : String ) : Xml {\n\t\tvar r = new Xml();\n\t\tr.nodeType = Xml.PCData;\n\t\tr.set_nodeValue( data );\n\t\treturn r;\n\t}\n\n\tpublic static function createCData( data : String ) : Xml {\n\t\tvar r = new Xml();\n\t\tr.nodeType = Xml.CData;\n\t\tr.set_nodeValue( data );\n\t\treturn r;\n\t}\n\n\tpublic static function createComment( data : String ) : Xml {\n\t\tvar r = new Xml();\n\t\tr.nodeType = Xml.Comment;\n\t\tr.set_nodeValue( data );\n\t\treturn r;\n\t}\n\n\tpublic static function createDocType( data : String ) : Xml {\n\t\tvar r = new Xml();\n\t\tr.nodeType = Xml.DocType;\n\t\tr.set_nodeValue( data );\n\t\treturn r;\n\t}\n\n\tpublic static function createProcessingInstruction( data : String ) : Xml {\n\t\tvar r = new Xml();\n\t\tr.nodeType = Xml.ProcessingInstruction;\n\t\tr.set_nodeValue( data );\n\t\treturn r;\n\t}\n\n\tpublic static function createDocument() : Xml {\n\t\tvar r = new Xml();\n\t\tr.nodeType = Xml.Document;\n\t\tr._children = new Array();\n\t\treturn r;\n\t}\n\n\tprivate function get_nodeName() : String {\n\t\tif( nodeType != Xml.Element )\n\t\t\tthrow \"bad nodeType\";\n\t\treturn _nodeName;\n\t}\n\n\tprivate function set_nodeName( n : String ) : String {\n\t\tif( nodeType != Xml.Element )\n\t\t\tthrow \"bad nodeType\";\n\t\treturn _nodeName = n;\n\t}\n\n\tprivate function get_nodeValue() : String {\n\t\tif( nodeType == Xml.Element || nodeType == Xml.Document )\n\t\t\tthrow \"bad nodeType\";\n\t\treturn _nodeValue;\n\t}\n\n\tprivate function set_nodeValue( v : String ) : String {\n\t\tif( nodeType == Xml.Element || nodeType == Xml.Document )\n\t\t\tthrow \"bad nodeType\";\n\t\treturn _nodeValue = v;\n\t}\n\n\tprivate function get_parent() : Xml {\n\t\treturn _parent;\n\t}\n\n\tpublic function get( att : String ) : String {\n\t\tif( nodeType != Xml.Element )\n\t\t\tthrow \"bad nodeType\";\n\t\treturn _attributes.get( att );\n\t}\n\n\tpublic function set( att : String, value : String ) : Void {\n\t\tif( nodeType != Xml.Element )\n\t\t\tthrow \"bad nodeType\";\n\t\t_attributes.set( att, value );\n\t}\n\n\tpublic function remove( att : String ) : Void{\n\t\tif( nodeType != Xml.Element )\n\t\t\tthrow \"bad nodeType\";\n\t\t_attributes.remove( att );\n\t}\n\n\tpublic function exists( att : String ) : Bool {\n\t\tif( nodeType != Xml.Element )\n\t\t\tthrow \"bad nodeType\";\n\t\treturn _attributes.exists( att );\n\t}\n\n\tpublic function attributes() : Iterator<String> {\n\t\tif( nodeType != Xml.Element )\n\t\t\tthrow \"bad nodeType\";\n\t\treturn _attributes.keys();\n\t}\n\n\tpublic function iterator() : Iterator<Xml> {\n\t\tif( _children == null ) throw \"bad nodetype\";\n\t\treturn untyped {\n\t\t\tcur: 0,\n\t\t\tx: this._children,\n\t\t\thasNext : function(){\n\t\t\t\treturn __this__.cur < __this__.x.length;\n\t\t\t},\n\t\t\tnext : function(){\n\t\t\t\treturn __this__.x[__this__.cur++];\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic function elements() : Iterator<Xml> {\n\t\tif( _children == null ) throw \"bad nodetype\";\n\t\treturn untyped {\n\t\t\tcur: 0,\n\t\t\tx: this._children,\n\t\t\thasNext : function() {\n\t\t\t\tvar k = __this__.cur;\n\t\t\t\tvar l = __this__.x.length;\n\t\t\t\twhile( k < l ) {\n\t\t\t\t\tif( __this__.x[k].nodeType == Xml.Element )\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tk += 1;\n\t\t\t\t}\n\t\t\t\t__this__.cur = k;\n\t\t\t\treturn k < l;\n\t\t\t},\n\t\t\tnext : function() {\n\t\t\t\tvar k = __this__.cur;\n\t\t\t\tvar l = __this__.x.length;\n\t\t\t\twhile( k < l ) {\n\t\t\t\t\tvar n = __this__.x[k];\n\t\t\t\t\tk += 1;\n\t\t\t\t\tif( n.nodeType == Xml.Element ) {\n\t\t\t\t\t\t__this__.cur = k;\n\t\t\t\t\t\treturn n;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic function elementsNamed( name : String ) : Iterator<Xml> {\n\t\tif( _children == null ) throw \"bad nodetype\";\n\t\treturn untyped {\n\t\t\tcur: 0,\n\t\t\tx: this._children,\n\t\t\thasNext : function() {\n\t\t\t\tvar k = __this__.cur;\n\t\t\t\tvar l = __this__.x.length;\n\t\t\t\twhile( k < l ) {\n\t\t\t\t\tvar n = __this__.x[k];\n\t\t\t\t\tif( n.nodeType == Xml.Element && n._nodeName == name )\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tk++;\n\t\t\t\t}\n\t\t\t\t__this__.cur = k;\n\t\t\t\treturn k < l;\n\t\t\t},\n\t\t\tnext : function() {\n\t\t\t\tvar k = __this__.cur;\n\t\t\t\tvar l = __this__.x.length;\n\t\t\t\twhile( k < l ) {\n\t\t\t\t\tvar n = __this__.x[k];\n\t\t\t\t\tk++;\n\t\t\t\t\tif( n.nodeType == Xml.Element && n._nodeName == name ) {\n\t\t\t\t\t\t__this__.cur = k;\n\t\t\t\t\t\treturn n;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic function firstChild() : Xml {\n\t\tif( _children == null ) throw \"bad nodetype\";\n\t\treturn _children[0];\n\t}\n\n\tpublic function firstElement() : Xml {\n\t\tif( _children == null ) throw \"bad nodetype\";\n\t\tvar cur = 0;\n\t\tvar l = _children.length;\n\t\twhile( cur < l ) {\n\t\t\tvar n = _children[cur];\n\t\t\tif( n.nodeType == Xml.Element )\n\t\t\t\treturn n;\n\t\t\tcur++;\n\t\t}\n\t\treturn null;\n\t}\n\n\tpublic function addChild( x : Xml ) : Void {\n\t\tif( _children == null ) throw \"bad nodetype\";\n\t\tif( x._parent != null ) x._parent._children.remove(x);\n\t\tx._parent = this;\n\t\t_children.push( x );\n\t}\n\n\tpublic function removeChild( x : Xml ) : Bool {\n\t\tif( _children == null ) throw \"bad nodetype\";\n\t\tvar b = _children.remove( x );\n\t\tif( b )\n\t\t\tx._parent = null;\n\t\treturn b;\n\t}\n\n\tpublic function insertChild( x : Xml, pos : Int ) : Void {\n\t\tif( _children == null ) throw \"bad nodetype\";\n\t\tif( x._parent != null ) x._parent._children.remove(x);\n\t\tx._parent = this;\n\t\t_children.insert( pos, x );\n\t}\n\n\tpublic function toString() : String {\n\t\tif( nodeType == Xml.PCData )\n\t\t\treturn StringTools.htmlEscape(_nodeValue);\n\t\tif( nodeType == Xml.CData )\n\t\t\treturn \"<![CDATA[\"+_nodeValue+\"]]>\";\n\t\tif( nodeType == Xml.Comment )\n\t\t\treturn \"<!--\"+_nodeValue+\"-->\";\n\t\tif( nodeType == Xml.DocType )\n\t\t\treturn \"<!DOCTYPE \"+_nodeValue+\">\";\n\t\tif( nodeType == Xml.ProcessingInstruction )\n\t\t\treturn \"<?\"+_nodeValue+\"?>\";\n\t\tvar s = new StringBuf();\n\n\t\tif( nodeType == Xml.Element ) {\n\t\t\ts.add(\"<\");\n\t\t\ts.add(_nodeName);\n\t\t\tfor( k in _attributes.keys() ){\n\t\t\t\ts.add(\" \");\n\t\t\t\ts.add(k);\n\t\t\t\ts.add(\"=\\\"\");\n\t\t\t\ts.add(_attributes.get(k));\n\t\t\t\ts.add(\"\\\"\");\n\t\t\t}\n\t\t\tif( _children.length == 0 ) {\n\t\t\t\ts.add(\"/>\");\n\t\t\t\treturn s.toString();\n\t\t\t}\n\t\t\ts.add(\">\");\n\t\t}\n\n\t\tfor( x in iterator() )\n\t\t\ts.add(x.toString());\n\n\t\tif( nodeType == Xml.Element ) {\n\t\t\ts.add(\"</\");\n\t\t\ts.add(_nodeName);\n\t\t\ts.add(\">\");\n\t\t}\n\t\treturn s.toString();\n\t}\n\n\tstatic function __init__() : Void untyped {\n\t\tXml.Element = \"element\";\n\t\tXml.PCData = \"pcdata\";\n\t\tXml.CData = \"cdata\";\n\t\tXml.Comment = \"comment\";\n\t\tXml.DocType = \"doctype\";\n\t\tXml.ProcessingInstruction = \"processingInstruction\";\n\t\tXml.Document = \"document\";\n\t}\n\n}\n","package about;\r\nimport menu.BootstrapMenu;\r\n\r\n/**\r\n * ...\r\n * @author AS3Boyan\r\n */\r\nclass About\r\n{\r\n\tpublic static function addToMenu():Void\r\n\t{\t\t\r\n\t\tBootstrapMenu.getMenu(\"Help\").addMenuItem(\"About HIDE...\", 3, HIDE.openPageInNewWindow.bind(null, \"about.html\", {toolbar:false}));\r\n\t}\r\n\t\r\n}","package autoformat;\r\n\r\nimport haxe.io.Bytes;\r\nimport haxeprinter.Printer;\r\nimport hxparse.NoMatch;\r\nimport hxparse.Unexpected;\r\nimport js.Node;\r\nimport tjson.TJSON;\r\n\r\n/**\r\n * ...\r\n * @author David Peek\r\n */\r\nclass HaxePrinter\r\n{\r\n\tpublic static function formatSource(source:String)\r\n\t{\r\n\t\tvar input = byte.ByteData.ofString(source);\r\n\t\tvar parser = new haxeparser.HaxeParser(input, \"\");\r\n\r\n\t\tvar ast = try {\r\n\t\t\tparser.parse();\r\n\t\t} catch(e:NoMatch<Dynamic>) {\r\n\t\t\tthrow e.pos.format(input) + \": Unexpected \" +e.token.tok;\r\n\t\t} catch(e:Unexpected<Dynamic>) {\r\n\t\t\tthrow e.pos.format(input) + \": Unexpected \" + e.token.tok;\r\n\t\t}\r\n\r\n\t\tvar printer = new Printer();\r\n\t\t\r\n\t\tvar options:NodeFsFileOptions = { };\r\n\t\toptions.encoding = NodeC.UTF8;\r\n\t\tprinter.config = TJSON.parse(Node.fs.readFileSync(\"autoformat.json\", options));\r\n\t\treturn printer.printAST(ast);\r\n\t}\r\n}","package autoformat;\r\nimport cm.CodeMirrorEditor;\r\nimport menu.BootstrapMenu;\r\nimport tabmanager.TabManager;\r\n\r\n/**\r\n * ...\r\n * @author AS3Boyan\r\n */\r\nclass HaxePrinterLoader\r\n{\r\n\tpublic static function load():Void\r\n\t{\r\n\t\tBootstrapMenu.getMenu(\"Source\", 3).addMenuItem(\"Autoformat\", 1, function ()\r\n\t\t{\r\n\t\t\tif (js.Node.path.extname(TabManager.getCurrentDocumentPath()) == \".hx\") \r\n\t\t\t{\r\n\t\t\t\tvar data:String = CodeMirrorEditor.editor.getValue();\r\n\t\t\t\t\r\n\t\t\t\tif (data != \"\") \r\n\t\t\t\t{\r\n\t\t\t\t\tdata = HaxePrinter.formatSource(data);\r\n\t\t\t\t\tCodeMirrorEditor.editor.setValue(data);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t, \"Ctrl-Shift-F\");\r\n\t\t\r\n\t\tBootstrapMenu.getMenu(\"Options\").addMenuItem(\"Open autoformat configuration file\", 1, function ()\r\n\t\t{\r\n\t\t\tTabManager.openFileInNewTab(\"autoformat.json\");\r\n\t\t}\r\n\t\t);\r\n\t}\r\n\t\r\n}","package byte.js;\r\n\r\ntypedef NativeByteRepresentation = js.html.Int8Array;\r\n\r\nabstract ByteData(NativeByteRepresentation) {\r\n\t\r\n\tpublic var length(get, never):Int;\r\n\t#if as3 public #end\r\n\tfunction get_length():Int return this.length;\r\n\r\n\tpublic var reader(get, never):LittleEndianReader;\r\n\t#if as3 public #end\r\n\tinline function get_reader():LittleEndianReader return new LittleEndianReader(new ByteData(this));\r\n\r\n\tpublic var writer(get, never):LittleEndianWriter;\r\n\t#if as3 public #end\r\n\tinline function get_writer():LittleEndianWriter return new LittleEndianWriter(new ByteData(this));\r\n\t\r\n\tpublic inline function new(data:NativeByteRepresentation) {\r\n\t\tthis = data;\r\n\t}\r\n\t\t\r\n\tpublic inline function readByte(pos:Int):Int {\r\n\t\treturn this[pos];\r\n\t}\r\n\t\r\n\tpublic inline function writeByte(pos:Int, v:Int):Void {\r\n\t\tthis[pos] = v & 0xFF;\r\n\t}\r\n\t\r\n\tpublic function readString(pos:Int, len:Int):String {\r\n\t\tvar buf = new StringBuf();\r\n\t\tfor (i in pos...pos + len) buf.addChar(this[i]);\r\n\t\treturn buf.toString();\r\n\t}\r\n\t\r\n\tstatic public function alloc(length:Int):ByteData {\r\n\t\tvar b = new js.html.Int8Array(length);\r\n\t\treturn new ByteData(b);\r\n\t}\r\n\t\t\r\n\tstatic public function ofString(s:String):ByteData {\r\n\t\tvar a = new js.html.Int8Array(s.length);\r\n\t\tfor(i in 0...s.length) a[i] = StringTools.fastCodeAt(s, i);\r\n\t\treturn new ByteData(a);\r\n\t}\r\n}","package cm;\n\n/**\n * ...\n * @author AS3Boyan\n */\nclass CMDoc\n{\n\tpublic var name:String;\n\tpublic var doc:CodeMirror.Doc;\n\tpublic var path:String;\n\t\n\tpublic function new(_name:String, _doc:CodeMirror.Doc, _path:String) \n\t{\n\t\tname = _name;\n\t\tdoc = _doc;\n\t\tpath = _path;\n\t}\t\n}","package cm;\nimport core.Completion;\nimport core.FunctionParametersHelper;\nimport core.HaxeParserProvider;\nimport core.Splitpane;\nimport haxe.Json;\nimport haxe.Timer;\nimport js.Browser;\nimport js.html.svg.TextElement;\nimport js.html.TextAreaElement;\nimport js.Lib;\nimport js.Node;\nimport menu.BootstrapMenu;\nimport tabmanager.TabManager;\nimport tjson.TJSON;\n\n/**\n * ...\n * @author AS3Boyan\n */\nclass CodeMirrorEditor\n{\t\n\tpublic static var editor:CodeMirror;\n\t\n\tpublic static function load():Void\n\t{\t\t\n\t\tvar textarea:TextAreaElement = Browser.document.createTextAreaElement();\n\t\ttextarea.id = \"code\";\n\t\t\n\t\tSplitpane.components[1].appendChild(textarea);\n\t\t\n\t\tvar readFileOptions:NodeFsFileOptions = {};\n\t\treadFileOptions.encoding = NodeC.UTF8;\n\t\t\n\t\tvar options:Dynamic = { };\n\t\t\n\t\ttry \n\t\t{\n\t\t\toptions = TJSON.parse(Node.fs.readFileSync(\"editor.json\", readFileOptions));\n\t\t}\n\t\tcatch (err:Error)\n\t\t{\n\t\t\ttrace(err);\n\t\t}\n\t\t\n\t\twalk(options);\n\t\t\n\t\toptions.extraKeys = \n\t\t{\n\t\t\t\"Ctrl-Space\": triggerCompletion,\n\t\t\t\"Ctrl-Q\": \"toggleComment\",\n\t\t\t\".\" : \n\t\t\t\tfunction passAndHint(cm) \n\t\t\t\t{\n\t\t\t\t\tuntyped setTimeout(function() { triggerCompletion(cm); }, 100);\n\t\t\t\t\tuntyped __js__(\"return CodeMirror.Pass\");\n\t\t\t\t}\n\t\t}\n\t\t\n\t\teditor = CodeMirror.fromTextArea(textarea, options);\n\t\t \n\t\teditor.getWrapperElement().style.display = \"none\";\n\t\t\n\t\tloadThemes([\n\t\t\"3024-day\",\n\t\t\"3024-night\",\n\t\t\"ambiance\",\n\t\t\"base16-dark\",\n\t\t\"base16-light\",\n\t\t\"blackboard\",\n\t\t\"cobalt\",\n\t\t\"eclipse\",\n\t\t\"elegant\",\n\t\t\"erlang-dark\",\n\t\t\"lesser-dark\",\n\t\t\"midnight\",\n\t\t\"monokai\",\n\t\t\"neat\",\n\t\t\"night\",\n\t\t\"paraiso-dark\",\n\t\t\"paraiso-light\",\n\t\t\"rubyblue\",\n\t\t\"solarized\",\n\t\t\"the-matrix\",\n\t\t\"tomorrow-night-eighties\",\n\t\t\"twilight\",\n\t\t\"vibrant-ink\",\n\t\t\"xq-dark\",\n\t\t\"xq-light\",\n\t\t], loadTheme);\n\t\t\n\t\tvar value:String = \"\";\n\t\tvar map = CodeMirror.keyMap.sublime;\n\t\tvar mapK = untyped CodeMirror.keyMap[\"sublime-Ctrl-K\"];\n\t\t\n\t\t  for (key in Reflect.fields(map)) \n\t\t  {\n\t\t\t  //&& !/find/.test(map[key])\n\t\t\tif (key != \"Ctrl-K\" && key != \"fallthrough\")\n\t\t\t{\n\t\t\t\tvalue += \"  \\\"\" + key + \"\\\": \\\"\" + Reflect.field(map, key) + \"\\\",\\n\";\n\t\t\t}\n\t\t\t  \n\t\t  }\n\t\t  for (key in Reflect.fields(mapK)) \n\t\t  {\n\t\t\tif (key != \"auto\" && key != \"nofallthrough\")\n\t\t\t{\n\t\t\t\tvalue += \"  \\\"Ctrl-K \" + key + \"\\\": \\\"\" + Reflect.field(mapK, key) + \"\\\",\\n\";\n\t\t\t}\n\t\t\t  \n\t\t  }\n\t\t\n\t\tNode.fs.writeFileSync(\"bindings.txt\", value, NodeC.UTF8);\n\t\t\n\t\tBootstrapMenu.getMenu(\"Help\").addMenuItem(\"Show code editor key bindings\", 2, TabManager.openFileInNewTab.bind(\"bindings.txt\"));\n\t\t\n\t\tvar timer:Timer = null;\n\t\t\n\t\tBrowser.window.addEventListener(\"resize\", function (e)\n\t\t{\n\t\t\tif (timer != null) \n\t\t\t{\n\t\t\t\ttimer.stop();\n\t\t\t}\n\t\t\t\n\t\t\ttimer = new Timer(500);\n\t\t\ttimer.run = function ()\n\t\t\t{\n\t\t\t\teditor.refresh();\n\t\t\t\ttimer.stop();\n\t\t\t};\n\t\t}\n\t\t);\n\t\t\n\t\teditor.on(\"cursorActivity\", function (cm:CodeMirror)\n\t\t{\n\t\t\tvar extname:String = Node.path.extname(TabManager.getCurrentDocumentPath());\n\t\t\t\n\t\t\tif (extname == \".hx\") \n\t\t\t{\n\t\t\t\tvar cursor = cm.getCursor();\n\t\t\t\tvar data = cm.getLine(cursor.line);\n\t\t\t\t\n\t\t\t\tif (data.charAt(cursor.ch - 1) == \"(\") \n\t\t\t\t{\n\t\t\t\t\tvar pos = cursor.ch -1;\n\t\t\t\t\tvar p = untyped __js__(\"CodeMirror.Pos\");\n\t\t\t\t\t\n\t\t\t\t\tCompletion.getCompletion(function ()\n\t\t\t\t\t{\n\t\t\t\t\t\tvar found:Bool = false;\n\t\t\t\t\t\t\n\t\t\t\t\t\tfor (completion in Completion.completions) \n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (Completion.curWord == completion.n) \n\t\t\t\t\t\t\t{\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tvar info:String = \"(\";\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tvar args:Array<String> = completion.t.split(\"->\");\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif (args.length > 2) \n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tfor (i in 0...args.length - 1) \n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tinfo += args[i];\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tif (i != args.length - 2) \n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tinfo += \", \";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tinfo += \"):\" + args[args.length - 1];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse \n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tinfo += \"):\" + args[args.length - 1];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tFunctionParametersHelper.clear();\n\t\t\t\t\t\t\t\tFunctionParametersHelper.addWidget(\"function \" + completion.n + info, editor.getCursor().line);\n\t\t\t\t\t\t\t\tFunctionParametersHelper.updateScroll();\n\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (!found) \n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tFunctionParametersHelper.clear();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t, untyped p(cursor.line, pos));\n\t\t\t\t}\n\t\t\t\telse \n\t\t\t\t{\n\t\t\t\t\tFunctionParametersHelper.clear();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t);\n\t\t\n\t\ttrace(editor);\n\t\t\n\t\tvar timer:Timer = null;\n\t\t\n\t\teditor.on(\"change\", function (cm:CodeMirror):Void \n\t\t{\t\t\t\n\t\t\tvar extname:String = Node.path.extname(TabManager.getCurrentDocumentPath());\n\t\t\t\n\t\t\tif (extname == \".hx\") \n\t\t\t{\n\t\t\t\tif (timer != null) \n\t\t\t\t{\n\t\t\t\t\ttimer.stop();\n\t\t\t\t\ttimer = null;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\ttimer = new Timer(100);\n\t\t\t\ttimer.run = function ():Void \n\t\t\t\t{\n\t\t\t\t\ttimer.stop();\n\t\t\t\t\tHaxeParserProvider.getClassName();\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\t);\n\t}\n\t\n\tprivate static function triggerCompletion(cm:Dynamic) \n\t{\n\t\tvar extname:String = Node.path.extname(TabManager.getCurrentDocumentPath());\n\t\t\n\t\tswitch (extname) \n\t\t{\n\t\t\tcase \".hx\":\n\t\t\t\tHaxeParserProvider.getClassName();\n\t\t\n\t\t\t\t//TabManager.saveActiveFile(function ():Void \n\t\t\t\t//{\n\t\t\t\t\t//Completion.getCompletion(function ()\n\t\t\t\t\t//{\n\t\t\t\t\t\t//cm.execCommand(\"autocomplete\");\n\t\t\t\t\t//}\n\t\t\t\t\t//);\n\t\t\t\t//});\n\t\t\tdefault:\n\t\t\t\ttrace(extname);\n\t\t}\n\t}\n\t\n\tprivate static function walk(object:Dynamic)\n\t{\t\t\n\t\tvar regexp = untyped __js__(\"RegExp\");\n\t\t\n\t\tfor (field in Reflect.fields(object))\n\t\t{\n\t\t\tvar value = Reflect.field(object, field);\n\t\t\t\n\t\t\tif (Std.is(value, String)) \n\t\t\t{\n\t\t\t\tif (StringTools.startsWith(value, \"regexp\")) \n\t\t\t\t{\n\t\t\t\t\ttry\n\t\t\t\t\t{\n\t\t\t\t\t\tReflect.setField(object, field, Type.createInstance(regexp, [value.substring(6)]));\n\t\t\t\t\t}\n\t\t\t\t\tcatch (err:Error)\n\t\t\t\t\t{\n\t\t\t\t\t\ttrace(err);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (StringTools.startsWith(value, \"eval\")) \n\t\t\t\t{\n\t\t\t\t\ttry \n\t\t\t\t\t{\n\t\t\t\t\t\tReflect.setField(object, field, Lib.eval(value.substring(4)));\n\t\t\t\t\t}\n\t\t\t\t\tcatch (err:Error)\n\t\t\t\t\t{\n\t\t\t\t\t\ttrace(err);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\n\t\t\tif (Reflect.isObject(value) && !Std.is(value, Array) && Type.typeof(value).getName() == \"TObject\") \n\t\t\t{\n\t\t\t\twalk(value);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tprivate static function loadTheme() \n\t{\n\t\tvar localStorage = Browser.getLocalStorage();\n\t\t\n\t\tif (localStorage != null)\n\t\t{\n\t\t\tvar theme:String = localStorage.getItem(\"theme\");\n\t\t\t\n\t\t\tif (theme != null) \n\t\t\t{\n\t\t\t\tsetTheme(theme);\n\t\t\t}\n\t\t}\n\t\t\n\t}\n\t\n\tprivate static function loadThemes(themes:Array<String>, onComplete:Dynamic):Void\n\t{\n\t\tvar themesSubmenu = BootstrapMenu.getMenu(\"View\").getSubmenu(\"Themes\");\n\t\tvar theme:String;\n\t\t\n\t\tvar pathToThemeArray:Array<String> = new Array();\n\t\t\n\t\tthemesSubmenu.addMenuItem(\"default\", 0, setTheme.bind(\"default\"));\n\t\t\n\t\tfor (i in 0...themes.length)\n\t\t{\n\t\t\ttheme = themes[i];\n\t\t\tthemesSubmenu.addMenuItem(theme, i + 1, setTheme.bind(theme));\n\t\t}\n\t\t\n\t\tonComplete();\n\t}\n\t\n\tprivate static function setTheme(theme:String):Void\n\t{\n\t\teditor.setOption(\"theme\", theme);\n\t\tBrowser.getLocalStorage().setItem(\"theme\", theme);\n\t}\n\t\n}","package cm;\nimport js.Browser;\nimport js.html.WheelEvent;\nimport jQuery.JQuery;\nimport menu.BootstrapMenu;\n\n/**\n * ...\n * @author AS3Boyan\n */\nclass CodeMirrorZoom\n{\n\tpublic static function load():Void\n\t{\t\t\n\t\tBrowser.document.addEventListener(\"mousewheel\", function(e:WheelEvent)\n\t\t{\n\t\t\tif (e.altKey)\n\t\t\t{\n\t\t\t\tif (e.wheelDeltaY < 0)\n\t\t\t\t{\n\t\t\t\t\tvar fontSize:Int = Std.parseInt(new JQuery(\".CodeMirror\").css(\"font-size\"));\n\t\t\t\t\tfontSize--;\n\t\t\t\t\tsetFontSize(fontSize);\n\t\t\t\t\te.preventDefault(); \n\t\t\t\t\te.stopPropagation(); \n\t\t\t\t}\n\t\t\t\telse if (e.wheelDeltaY > 0)\n\t\t\t\t{\n\t\t\t\t\tvar fontSize:Int = Std.parseInt(new JQuery(\".CodeMirror\").css(\"font-size\"));\n\t\t\t\t\tfontSize++;\n\t\t\t\t\tsetFontSize(fontSize);\n\t\t\t\t\te.preventDefault(); \n\t\t\t\t\te.stopPropagation(); \n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t);\n\t\t\n\t\tBootstrapMenu.getMenu(\"View\").addMenuItem(\"Increase Font Size\", 10001, function ()\n\t\t{\n\t\t\tvar fontSize:Int = Std.parseInt(new JQuery(\".CodeMirror\").css(\"font-size\"));\n\t\t\tfontSize++;\n\t\t\tsetFontSize(fontSize);\n\t\t}\n\t\t, \"Ctrl-+\");\n\t\t\n\t\tBootstrapMenu.getMenu(\"View\").addMenuItem(\"Decrease Font Size\", 10002, function ()\n\t\t{\n\t\t\tvar fontSize:Int = Std.parseInt(new JQuery(\".CodeMirror\").css(\"font-size\"));\n\t\t\tfontSize--;\n\t\t\tsetFontSize(fontSize);\n\t\t}\n\t\t, \"Ctrl--\");\n\t}\n\t\n\tpublic static function setFontSize(fontSize:Int):Void\n\t{\n\t\tnew JQuery(\".CodeMirror\").css(\"font-size\", Std.string(fontSize) + \"px\");\n\t\tnew JQuery(\".CodeMirror-hint\").css(\"font-size\", Std.string(fontSize - 2) + \"px\");\n\t\tnew JQuery(\".CodeMirror-hints\").css(\"font-size\", Std.string(fontSize - 2) + \"px\");\n\t}\n\t\n}","package core;\nimport jQuery.JQuery;\nimport haxe.Timer;\nimport js.Browser;\nimport js.html.ButtonElement;\nimport js.html.DivElement;\n\n/**\n * ...\n * @author AS3Boyan\n */\n\n@:keepSub @:expose class Alerts\n{\t\n\tpublic static function showAlert(text:String):Void\n\t{        \n\t\tvar div:DivElement = Browser.document.createDivElement();\n\t\tdiv.className = \"alert alert-success alert-dismissable\";\n\t\t\n\t\tvar button:ButtonElement = Browser.document.createButtonElement();\n\t\tbutton.type = \"button\";\n\t\tbutton.className = \"close\";\n\t\tbutton.setAttribute(\"data-dismiss\", \"alert\");\n\t\tbutton.setAttribute(\"aria-hidden\", \"true\");\n\t\tbutton.innerHTML = \"&times;\";\n\t\t\n\t\tdiv.appendChild(button);\n\t\tdiv.appendChild(Browser.document.createTextNode(text));\n\t\t\n\t\tBrowser.document.body.appendChild(div);\n\t\t\n\t\tdiv.style.marginTop = Std.string(Std.int(-div.clientHeight / 2)) + \"px\";\n\t\tdiv.style.marginLeft  = Std.string(Std.int(-div.clientWidth / 2)) + \"px\";\n\t\t//new JQuery(\"#notify_position\").html(div.outerHTML);\n\t\t\n\t\tTimer.delay(function ()\n\t\t{\n\t\t\tif (div.parentElement != null) \n\t\t\t{\n\t\t\t\tnew JQuery(div).fadeOut(500, function ()\n\t\t\t\t{\n\t\t\t\t\tBrowser.document.body.removeChild(div);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t, 1500);\n\t}\n}\n","package core;\n\n/**\n * ...\n * @author AS3Boyan\n */\n@:keepSub @:expose class Bootbox\n{\n\tpublic static function prompt(question:String, defaultValue:String, onClick:Dynamic):Void\n\t{\n\t\tvar bootboxStatic:Dynamic = untyped __js__(\"bootbox\");\n\t\t\n\t\tbootboxStatic.prompt(\n\t\t{\n\t\t  title: question,\n\t\t  value: defaultValue,\n\t\t  callback: function(result) {\n\t\t\tif (result != null) \n\t\t\t{\n\t\t\t\tonClick(result);\n\t\t\t}\n\t\t  }\n\t\t}\n\t\t);      \n\t}\n}","package core;\nimport menu.BootstrapMenu;\nimport tabmanager.TabManager;\n\n/**\n * ...\n * @author AS3Boyan\n */\nclass Changelog\n{\n\tpublic static function addToMenu():Void\n\t{\n\t\tBootstrapMenu.getMenu(\"Help\").addMenuItem(\"changelog\", 1, TabManager.openFileInNewTab.bind(\"changes.md\"));\n\t}\n}","package core;\nimport js.Browser;\nimport js.html.TextAreaElement;\n\n/**\n * ...\n * @author AS3Boyan\n */\nclass CompilationOutput\n{\n\tpublic static function load():Void\n\t{\t\t\n\t\tvar output:TextAreaElement = Browser.document.createTextAreaElement();\n\t\toutput.id = \"output\";\n\t\toutput.readOnly = true;\n\t\t\n\t\tSplitpane.components[2].appendChild(output);\n\t}\n\t\n}","package core;\nimport cm.CodeMirrorEditor;\nimport CodeMirror;\nimport haxe.ds.StringMap.StringMap;\nimport haxe.xml.Fast;\nimport projectaccess.Project;\nimport projectaccess.ProjectAccess;\nimport tabmanager.TabManager;\n/**\n * ...\n * @author AS3Boyan\n */\n\ntypedef CompletionItem = \n{\n\t@:optional\n\tvar d:String;\n\t@:optional\n\tvar t:String;\n\tvar n:String;\n}\n \nclass Completion\n{\n\tstatic var list:Array<String>;\n\tstatic var seen:StringMap<Bool>;\n\tstatic var editor:CodeMirror;\n\tstatic var word:EReg;\n\tstatic var range:Int;\n\tstatic var cur:Pos;\n\tstatic private var end:Int;\n\tstatic private var start:Int;\n\tstatic var WORD:EReg = ~/[A-Z]+$/i;\n\tstatic var RANGE = 500;\n\tpublic static var curWord:String;\n\tpublic static var completions:Array<CompletionItem> = [];\n\t\n\tpublic static function registerHelper() \n\t{\n\t\tCodeMirror.registerHelper(\"hint\", \"haxe\", function(cm:CodeMirror, options) {\t\t\t\n\t\t\tword = null;\n\t\t\t\n\t\t\trange = null;\n\t\t\t\n\t\t\tif (options != null && options.range != null)\n\t\t\t{\n\t\t\t\trange = options.range;\n\t\t\t}\n\t\t\telse if (RANGE != null)\n\t\t\t{\n\t\t\t\trange = RANGE;\n\t\t\t}\n\t\t\t\n\t\t\tgetCurrentWord(cm, options);\n\n\t\t\tlist = new Array();\n\t\t\tseen = new StringMap();\n\t\t\t\n\t\t\tvar cmPos:Dynamic = untyped __js__(\"CodeMirror.Pos\");\n\t\t\t\n\t\t\tfor (completion in completions) \n\t\t\t{\n\t\t\t\tlist.push(completion.n);\n\t\t\t}\n\t\t\t\n\t\t\tif (list.length == 0) \n\t\t\t{\n\t\t\t\tscan(cm, -1);\n\t\t\t\tscan(cm, 1);\n\t\t\t}\n\t\t\t\n\t\t\tfilterCompletion();\n\t\t\t\n\t\t\treturn {list: list, from: cmPos(cur.line, start), to: cmPos(cur.line, end)};\n\t\t});\n\t}\n\t\n\tpublic static function getCurrentWord(cm:CodeMirror, ?options:Dynamic):String\n\t{\n\t\tif (options != null && options.word != null)\n\t\t{\n\t\t\tword = options.word;\n\t\t}\n\t\telse if (WORD != null)\n\t\t{\n\t\t\tword = WORD;\n\t\t}\n\t\t\n\t\tvar curLine:String = cm.getLine(cur.line);\n\t\tstart = cur.ch;\n\t\t\n\t\tend = start;\n\t\t\n\t\twhile (end < curLine.length && word.match(curLine.charAt(end))) ++end;\n\t\twhile (start > 0 && word.match(curLine.charAt(start - 1))) --start;\n\t\t\n\t\tcurWord = null;\n\t\t\n\t\tif (start != end) \n\t\t{\n\t\t\tcurWord = curLine.substring(start, end);\n\t\t}\n\t\t\n\t\treturn curWord;\n\t}\n\t\n\tprivate static function scan(cm:Dynamic, dir:Int):Void\n\t{\t\t\t\n\t\tvar line:Int = cur.line;\n\t\tvar end2 = Math.min(Math.max(line + dir * range, cm.firstLine()), cm.lastLine()) + dir;\n\t\twhile (line != end2) \n\t\t{\n\t\t\tvar text = cm.getLine(line);\n\t\t\tvar m:Dynamic = null;\n\t\t\t\n\t\t\tvar re:EReg = ~/([A-Z]+)/ig;\n\t\t\t\n\t\t\tre.map(text, function(e:EReg):String\n\t\t\t{\n\t\t\t\tm = e.matched(0);\n\t\t\t\t\n\t\t\t\tif (!(line == cur.line) || !(m == curWord))\n\t\t\t\t{\n\t\t\t\t\tif ((curWord == null || m.indexOf(curWord) == 0) && !seen.exists(m)) \n\t\t\t\t\t{\n\t\t\t\t\t\tseen.set(m, true);\n\t\t\t\t\t\tlist.push(m);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn e.matched(0);\n\t\t\t}\n\t\t\t);\n\t\t\t\n\t\t\tline += dir;\n\t\t}\n\t}\n\t\n\tpublic static function getCompletion(onComplete:Dynamic, ?_pos:Pos)\n\t{\n\t\tvar projectArguments:Array<String> = ProjectAccess.currentProject.args.copy();\n\t\t\t\t\t\n\t\tif (ProjectAccess.currentProject.type == Project.HXML) \n\t\t{\n\t\t\tprojectArguments.push(ProjectAccess.currentProject.main);\n\t\t}\n\t\t\n\t\tprojectArguments.push(\"--display\");\n\t\t\n\t\tvar cm:CodeMirror = CodeMirrorEditor.editor;\n\t\tcur = _pos;\n\t\t\n\t\tif (_pos == null) \n\t\t{\n\t\t\tcur = cm.getCursor();\n\t\t}\n\t\t\n\t\tgetCurrentWord(cm, null);\n\t\t\n\t\tif (curWord != null) \n\t\t{\n\t\t\tvar c = untyped __js__(\"CodeMirror.Pos\");\n\t\t\tcur = c(cur.line, start);\n\t\t}\n\t\t\n\t\tprojectArguments.push(TabManager.getCurrentDocumentPath() + \"@\" + Std.string(cm.indexFromPos(cur)));\n\t\t\n\t\tCompletion.completions = [];\n\t\t\n\t\tHaxeCompletionClient.runProcess(\"haxe\", [\"--connect\", \"5000\", \"--cwd\", HIDE.surroundWithQuotes(ProjectAccess.currentProject.path)].concat(projectArguments), function (stderr:String)\n\t\t{\n\t\t\tvar xml:Xml = Xml.parse(stderr);\n\t\t\t\n\t\t\tvar fast = new Fast(xml);\n\t\t\t\n\t\t\tif (fast.hasNode.list)\n\t\t\t{\n\t\t\t\tvar list = fast.node.list;\n\t\t\t\t\n\t\t\t\tvar completion:CompletionItem;\n\t\t\t\t\n\t\t\t\tif (list.hasNode.i)\n\t\t\t\t{\n\t\t\t\t\tfor (item in list.nodes.i) \n\t\t\t\t\t{\n\t\t\t\t\t\tif (item.has.n)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcompletion = {n: item.att.n};\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (item.hasNode.d)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar str = StringTools.trim(item.node.d.innerHTML);\n\t\t\t\t\t\t\t\tstr = StringTools.replace(str, \"\\t\", \"\");\n\t\t\t\t\t\t\t\tstr = StringTools.replace(str, \"\\n\", \"\");\n\t\t\t\t\t\t\t\tstr = StringTools.replace(str, \"*\", \"\");\n\t\t\t\t\t\t\t\tstr = StringTools.replace(str, \"&lt;\", \"<\");\n\t\t\t\t\t\t\t\tstr = StringTools.replace(str, \"&gt;\", \">\");\n\t\t\t\t\t\t\t\tstr = StringTools.trim(str);\n\t\t\t\t\t\t\t\tcompletion.d = str;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (item.hasNode.t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcompletion.t = item.node.t.innerData;\n\t\t\t\t\t\t\t\t//var type = item.node.t.innerData;\n\t\t\t\t\t\t\t\t//switch (type) \n\t\t\t\t\t\t\t\t//{\n\t\t\t\t\t\t\t\t\t//case \"Float\", \"Int\":\n\t\t\t\t\t\t\t\t\t\t//completion.type = \"number\";\n\t\t\t\t\t\t\t\t\t//case \"Bool\":\n\t\t\t\t\t\t\t\t\t\t//completion.type = \"bool\";\n\t\t\t\t\t\t\t\t\t//case \"String\":\n\t\t\t\t\t\t\t\t\t\t//completion.type = \"string\";\n\t\t\t\t\t\t\t\t\t//default:\n\t\t\t\t\t\t\t\t\t\t//completion.type = \"fn()\";\n\t\t\t\t\t\t\t\t//}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//else \n\t\t\t\t\t\t\t//{\n\t\t\t\t\t\t\t\t//completion.type = \"fn()\";\n\t\t\t\t\t\t\t//}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tcompletions.push(completion);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tonComplete();\n\t\t}, \n\t\tfunction (code:Int, stderr:String)\n\t\t{\n\t\t\ttrace(code);\n\t\t\ttrace(stderr);\n\t\t\t\n\t\t\tonComplete();\n\t\t}\n\t\t);\n\t}\n\t\n\tprivate static function filterCompletion()\n\t{\n\t\tif (curWord != null) \n\t\t{\n\t\t\tvar filtered_results = [];\n\t\t\tvar sorted_results = [];\n\t\t\t\n\t\t\tvar word:String = curWord.toLowerCase();\n\t\t\t\n\t\t\tfor (completion in list) \n\t\t\t{\n\t\t\t\tvar n = completion.toLowerCase();\n\t\t\t\tvar b = true;\n\t\t\t  \n\t\t\t\t  for (j in 0...word.length)\n\t\t\t\t  {\n\t\t\t\t\t  if (n.indexOf(word.charAt(j)) == -1)\n\t\t\t\t\t  {\n\t\t\t\t\t\t  b = false;\n\t\t\t\t\t\t  break;\n\t\t\t\t\t  }\n\t\t\t\t  }\n\n\t\t\t\tif (b)\n\t\t\t\t{\n\t\t\t\t\tfiltered_results.push(completion);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tvar results = [];\n\t\t\t\n\t\t\tfor (i in 0...filtered_results.length) \n\t\t\t{\n\t\t\t\tif (filtered_results[i].toLowerCase().indexOf(word) == 0)\n\t\t\t\t{\n\t\t\t\t\tsorted_results.push(filtered_results[i]);\n\t\t\t\t}\n\t\t\t\telse \n\t\t\t\t{\n\t\t\t\t\tresults.push(filtered_results[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tlist = [];\n\t\t\t\n\t\t\tfor (completion in sorted_results) \n\t\t\t{\n\t\t\t\tlist.push(completion);\n\t\t\t}\n\t\t\t\n\t\t\tfor (completion in results) \n\t\t\t{\n\t\t\t\tlist.push(completion);\n\t\t\t}\n\t\t}\n\t}\n}","package core;\r\nimport menu.BootstrapMenu;\r\nimport nodejs.webkit.Window;\r\n\r\n/**\r\n * ...\r\n * @author AS3Boyan\r\n */\r\nclass DeveloperTools\r\n{\r\n\t\r\n\t//If this plugin is selected as active in HIDE, then HIDE will call this function once on load\t\r\n\tpublic static function addToMenu():Void\r\n\t{\r\n\t\tBootstrapMenu.getMenu(\"Developer Tools\", 100).addMenuItem(\"Reload IDE\", 1, function ():Void\r\n\t\t{\r\n\t\t\t//HaxeServer.terminate();\r\n\t\t\t\r\n\t\t\tWindow.get().reloadIgnoringCache();\r\n\t\t}\r\n\t\t, \"Ctrl-Shift-R\");\r\n\r\n\t\tBootstrapMenu.getMenu(\"Developer Tools\").addMenuItem(\"Compile plugins and reload IDE\", 2, function ():Void\r\n\t\t{\r\n\t\t\t//HaxeServer.terminate();\r\n\t\t\t\r\n\t\t\tHIDE.compilePlugins(function ():Void\r\n\t\t\t{\r\n\t\t\t\t//Only when all plugins successfully loaded\r\n\t\t\t\tWindow.get().reloadIgnoringCache();\r\n\t\t\t}\r\n\t\t\t//On plugin compilation failed\r\n\t\t\t, function (data:String):Void\r\n\t\t\t{\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t);\r\n\t\t\t\r\n\t\t}\r\n\t\t, \"Shift-F5\");\r\n\t\t\r\n\t\tBootstrapMenu.getMenu(\"Developer Tools\").addMenuItem(\"Console\", 3, function ():Void\r\n\t\t{\r\n\t\t\tvar window = Window.get();\r\n\t\t\twindow.showDevTools();\r\n\t\t}\r\n\t\t);\r\n\t}\r\n\t\r\n}\r\n","package core;\nimport filetree.FileTree;\nimport js.Browser;\nimport openproject.OpenProject;\n\n/**\n * ...\n * @author AS3Boyan\n */\nclass DragAndDrop\n{\t\n\t//If this plugin is selected as active in HIDE, then HIDE will call this function once on load\t\n\tpublic static function prepare():Void\n\t{\t\t\n\t\tBrowser.window.addEventListener(\"dragover\", function(e) \n\t\t{\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\treturn false;\n\t\t}\n\t\t);\n\t\t\n\t\tBrowser.window.addEventListener(\"drop\", function(e:Dynamic) \n\t\t{\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\t\n\t\t\tfor (i in 0...e.dataTransfer.files.length) \n\t\t\t{\n\t\t\t\tvar path:String = e.dataTransfer.files[i].path;\n\t\t\t\tjs.Node.fs.stat(path, function (err, stats:js.Node.NodeStat)\n\t\t\t\t{\n\t\t\t\t\tif (stats.isDirectory())\n\t\t\t\t\t{\n\t\t\t\t\t\tFileTree.load(js.Node.path.basename(path), path);\n\t\t\t\t\t}\n\t\t\t\t\telse \n\t\t\t\t\t{\n\t\t\t\t\t\tOpenProject.openProject(path);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t);\n\t\t\t\t\n\t\t\t\t\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\t\t);\n\t}\n\t\n}","package core;\r\nimport menu.BootstrapMenu;\r\nimport tabmanager.TabManager;\r\n\r\n/**\r\n * ...\r\n * @author \r\n */\r\nclass EditingTheme\r\n{\r\n\tpublic static function addToMenu()\r\n\t{\r\n\t\tBootstrapMenu.getMenu(\"Options\").addMenuItem(\"Open stylesheet\", 1, TabManager.openFileInNewTab.bind(\"theme.css\"));\r\n\t}\r\n}","package core;\nimport menu.BootstrapMenu;\nimport tabmanager.TabManager;\n\n/**\n * ...\n * @author AS3Boyan\n */\nclass EditorConfiguration\n{\n\tpublic static function addToMenu():Void\n\t{\n\t\tBootstrapMenu.getMenu(\"Options\").addMenuItem(\"Open editor configuration file\", 1, TabManager.openFileInNewTab.bind(\"editor.json\"));\n\t}\n}","package core;\nimport js.Browser;\nimport js.html.InputElement;\n\n/**\n * ...\n * @author AS3Boyan\n */\n@:keepSub @:expose class FileDialog\n{\n\tprivate static var input:InputElement;\n\tprivate static var onClick:Dynamic;\n\t\n\tpublic static function create():Void\n\t{\n\t\tinput = Browser.document.createInputElement();\n\t\tinput.type = \"file\";\n\t\tinput.style.display = \"none\";\n\t\tinput.addEventListener(\"change\", function(e) \n\t\t{\n\t\t\tvar value:String = input.value;\n\t\t\tif (value != \"\") \n\t\t\t{\n\t\t\t\tonClick(value);\n\t\t\t}\n\t\t});\n\t\t\n\t\tBrowser.document.body.appendChild(input);\n\t}\n\t\n\tpublic static function openFile(_onClick:Dynamic):Void\n\t{\n\t\tinput.value = \"\";\n\t\t\n\t\tonClick = _onClick;\n\t\t\n\t\tif (input.hasAttribute(\"nwsaveas\"))\n\t\t{\n\t\t\tinput.removeAttribute(\"nwsaveas\");\n\t\t}\n\t\t\n\t\tif (input.hasAttribute(\"nwdirectory\"))\n\t\t{\n\t\t\tinput.removeAttribute(\"nwdirectory\");\n\t\t}\n\t\t\n\t\tinput.click();\n\t}\n\t\n\tpublic static function saveFile(_onClick:Dynamic, ?_name:String):Void\n\t{\n\t\tinput.value = \"\";\n\t\t\n\t\tonClick = _onClick;\n\t\t\n\t\tif (_name == null)\n\t\t{\n\t\t\t_name = \"\";\n\t\t}\n\t\t\n\t\tif (input.hasAttribute(\"nwdirectory\"))\n\t\t{\n\t\t\tinput.removeAttribute(\"nwdirectory\");\n\t\t}\n\t\t\n\t\tinput.setAttribute(\"nwsaveas\", _name);\n\t\tinput.click();\n\t}\n\t\n\tpublic static function openFolder(_onClick:Dynamic):Void\n\t{\n\t\tinput.value = \"\";\n\t\t\n\t\tonClick = _onClick;\n\t\t\n\t\tif (input.hasAttribute(\"nwsaveas\"))\n\t\t{\n\t\t\tinput.removeAttribute(\"nwsaveas\");\n\t\t}\n\t\t\n\t\tinput.setAttribute(\"nwdirectory\", \"\");\n\t\tinput.click();\n\t}\n\t\n}","package core;\n\n/**\n * ...\n * @author AS3Boyan\n */\nclass FileTools\n{\n\tpublic static function createDirectoryRecursively(path:String, folderPath:Array<String>, ?onCreated:Dynamic):Void\n\t{\n\t\tvar fullPath:String = js.Node.path.join(path, folderPath[0]);\n\t\t\n\t\tcreateDirectory(fullPath, function ():Void\n\t\t{\n\t\t\tfolderPath.splice(0, 1);\n\t\t\t\n\t\t\tif (folderPath.length > 0)\n\t\t\t{\n\t\t\t\tcreateDirectoryRecursively(fullPath, folderPath, onCreated);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tonCreated();\n\t\t\t}\n\t\t}\n\t\t);\n\t}\n\t\n\tpublic static function createDirectory(path:String, ?onCreated:Dynamic):Void\n\t{\n\t\tjs.Node.fs.mkdir(path, function (error):Void\n\t\t{\t\t\t\t\t\t\t\t\n\t\t\tif (error != null)\n\t\t\t{\n\t\t\t\ttrace(error);\n\t\t\t}\n\t\t\t\n\t\t\tif (onCreated != null)\n\t\t\t{\n\t\t\t\tonCreated();\n\t\t\t}\n\t\t}\n\t\t);\n\t}\n}","package core;\nimport cm.CodeMirrorEditor;\nimport js.Browser;\nimport js.html.DivElement;\nimport js.html.SpanElement;\n\n/**\n * ...\n * @author AS3\n */\nclass FunctionParametersHelper\n{\n\tpublic static var widgets:Array<Dynamic> = [];\n\t\n\tpublic static function addWidget(text:String, lineNumber:Int):Void\n\t{\n\t\tvar msg:DivElement = Browser.document.createDivElement();\n\t\t//var icon:SpanElement = Browser.document.createSpanElement();\n\t\t//msg.appendChild(icon);\n\t\t//icon.className = \"lint-error-icon\";\n\t\tmsg.appendChild(Browser.document.createTextNode(text));\n\t\tmsg.className = \"lint-error\";\n\t\twidgets.push(CodeMirrorEditor.editor.addLineWidget(lineNumber, msg, {coverGutter: false, noHScroll: true}));\n\t}\n\t\n\tpublic static function updateScroll():Void\n\t{\n\t\tvar info = CodeMirrorEditor.editor.getScrollInfo();\n\t\tvar after = CodeMirrorEditor.editor.charCoords( { line: CodeMirrorEditor.editor.getCursor().line + 1, ch: 0 }, \"local\").top;\n\t\t\n\t\tif (info.top + info.clientHeight < after)\n\t\t{\n\t\t\tCodeMirrorEditor.editor.scrollTo(null, after - info.clientHeight + 3);\n\t\t}\n\t}\n\t\n\tpublic static function clear():Void\n\t{\n\t\tfor (widget in widgets) \n\t\t{\n\t\t\tCodeMirrorEditor.editor.removeLineWidget(widget);\n\t\t}\n\t}\n}","package core;\r\nimport core.HaxeLint.Info;\r\nimport haxe.ds.StringMap.StringMap;\r\nimport js.Browser;\r\nimport js.html.TextAreaElement;\r\nimport js.Node;\r\nimport projectaccess.ProjectAccess;\r\nimport tabmanager.TabManager;\r\n\r\n/**\r\n * ...\r\n * @author AS3Boyan\r\n */\r\n@:keepSub @:expose class HaxeClient\r\n{\t\r\n\tpublic static function buildProject(command:String, ?onComplete:Dynamic):Void\r\n\t{\t\t\r\n\t\tvar textarea = cast(Browser.document.getElementById(\"output\"), TextAreaElement);\r\n\t\ttextarea.value = \"Build started\\n\";\r\n\t\ttextarea.value += command + \"\\n\";\r\n\t\t\r\n\t\tvar haxeCompilerClient:js.Node.NodeChildProcess = js.Node.child_process.exec(command, { }, function (error, stdout:String, stderr:String):Void\r\n\t\t{\r\n\t\t\tif (StringTools.trim(stdout) != \"\")\r\n\t\t\t{\r\n\t\t\t\ttextarea.value += \"stdout:\\n\" + stdout;\r\n\t\t\t\ttrace(\"stdout:\\n\" + stdout);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tHaxeLint.fileData = new StringMap();\r\n\t\t\t\r\n\t\t\tif (stderr != \"\")\r\n\t\t\t{\r\n\t\t\t\tvar lines = stderr.split(\"\\n\");\r\n\t\t\t\t\r\n\t\t\t\tfor (line in lines) \r\n\t\t\t\t{\r\n\t\t\t\t\tif (line.indexOf(\":\") != 0) \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar args:Array<String> = line.split(\":\");\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (args.length > 3) \r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar relativePath:String = args[0];\r\n\t\t\t\t\t\t\tvar fullPath:String = Node.path.join(ProjectAccess.currentProject.path, relativePath);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tvar data:Array<Info> = [];\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tHaxeLint.fileData.set(fullPath, data);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tvar pos = untyped __js__(\"CodeMirror.Pos\");\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tvar lineNumber:Int = Std.parseInt(args[1]) - 1;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tvar charsData:Array<String> = StringTools.trim(args[2]).split(\" \")[1].split(\"-\");\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tvar start:Int = Std.parseInt(charsData[0]);\r\n\t\t\t\t\t\t\tvar end:Int = Std.parseInt(charsData[1]);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tvar message:String = \"\";\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tfor (i in 3...args.length) \r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tmessage += args[i];\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif (i != args.length - 1) \r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tmessage += \":\";\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tvar info:Info = { from: pos(lineNumber, start), to: pos(lineNumber, end), message: message, severity: \"error\" };\r\n\t\t\t\t\t\t\ttrace(info);\r\n\t\t\t\t\t\t\tdata.push(info);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t//Check if it's open\r\n\t\t\t\t\t\t\t//Show hints when swithing document\r\n\t\t\t\t\t\t\tTabManager.openFileInNewTab(fullPath, false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\ttextarea.value += \"stderr:\\n\" + stderr;\r\n\t\t\t\ttrace(\"stderr:\\n\" + stderr);\r\n\t\t\t}\r\n\t\t}\r\n\t\t);\r\n\t\t\r\n\t\thaxeCompilerClient.on(\"close\", function (code:Int):Void\r\n\t\t{\r\n\t\t\tif (code == 0)\r\n\t\t\t{\r\n\t\t\t\ttextarea.value += \"Build complete\\n\";\r\n\t\t\t\t\r\n\t\t\t\tif (onComplete != null)\r\n\t\t\t\t{\r\n\t\t\t\t\tonComplete();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse \r\n\t\t\t{\r\n\t\t\t\ttrace(command);\r\n\t\t\t\ttextarea.value += \"Build failed (exit code: \" + Std.string(code) +  \")\\n\" ;\r\n\t\t\t}\r\n\t\t}\r\n\t\t);\r\n\t}\r\n}","package core;\r\nimport js.Browser;\r\nimport js.html.TextAreaElement;\r\n\r\n/**\r\n * ...\r\n * @author AS3Boyan\r\n */\r\n@:keepSub @:expose class HaxeCompletionClient\r\n{\t\r\n\tprivate static var processStdout:String;\r\n\tprivate static var processStderr:String;\r\n\t\r\n\tpublic static function runProcess(process:String, params:Array<String>, onComplete:String->Void, onFailed:Int->String->Void):Void\r\n\t{\t\t\r\n\t\tvar command:String = process + \" \" + params.join(\" \");\r\n\t\t\r\n\t\ttrace(command);\r\n\t\t\r\n\t\tvar haxeCompilerClient:js.Node.NodeChildProcess = js.Node.child_process.exec(command, { }, function (error, stdout:String, stderr:String):Void\r\n\t\t{\t\r\n\t\t\tprocessStdout = stdout;\r\n\t\t\tprocessStderr = stderr;\r\n\t\t\t\r\n\t\t\t//if (stdout != \"\")\r\n\t\t\t//{\r\n\t\t\t\t//trace(\"stdout:\\n\" + stdout);\r\n\t\t\t//}\r\n\t\t\t//\r\n\t\t\t//if (stderr != \"\")\r\n\t\t\t//{\r\n\t\t\t\t//trace(\"stderr:\\n\" + stderr);\r\n\t\t\t//}\r\n\t\t\t\r\n\t\t\tif (error == null)\r\n\t\t\t{\t\t\t\t\r\n\t\t\t\tonComplete(processStderr);\r\n\t\t\t}\r\n\t\t\telse \r\n\t\t\t{\r\n\t\t\t\tonFailed(error.code, processStderr);\r\n\t\t\t}\r\n\t\t}\r\n\t\t);\r\n\t}\r\n}","package core;\r\nimport haxe.ds.StringMap.StringMap;\r\nimport tabmanager.TabManager;\r\n\r\ntypedef Info = {\r\n\tvar from:CodeMirror.Pos;\r\n\tvar to:CodeMirror.Pos;\r\n\tvar message:String;\r\n\tvar severity:String;\r\n}\r\n\r\n/**\r\n * ...\r\n * @author \r\n */\r\nclass HaxeLint\r\n{\r\n\tpublic static var fileData:StringMap<Array<Info>> = new StringMap();\r\n\tpublic static var parserData:StringMap<Array<Info>> = new StringMap();\r\n\r\n\tpublic static function prepare():Void\r\n\t{\r\n\t\tCodeMirror.registerHelper(\"lint\", \"haxe\", function (text:String) \r\n\t\t{\r\n\t\t\tvar found = [];\r\n\t\t\t\r\n\t\t\tvar path:String = TabManager.getCurrentDocumentPath();\r\n\t\t\t\r\n\t\t\tif (fileData.exists(path)) \r\n\t\t\t{\r\n\t\t\t\tvar data:Array<Info> = fileData.get(path);\r\n\t\t\t\t\r\n\t\t\t\tfound = found.concat(data);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (parserData.exists(path)) \r\n\t\t\t{\r\n\t\t\t\tvar data:Array<Info> = parserData.get(path);\r\n\t\t\t\t\r\n\t\t\t\tfound = found.concat(data);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn found;\r\n\t\t}\r\n\t\t);\r\n\t}\r\n\t\r\n}","package core;\nimport byte.ByteData;\nimport cm.CMDoc;\nimport cm.CodeMirrorEditor;\nimport core.HaxeLint.Info;\nimport haxe.macro.Expr;\nimport haxe.macro.Expr.Field;\nimport haxe.macro.Expr.Position;\nimport haxeparser.Data.ClassFlag;\nimport haxeparser.Data.Definition;\nimport haxeparser.Data.ImportMode;\nimport haxeparser.Data.TypeDef;\nimport haxeparser.HaxeParser;\nimport haxeparser.HaxeParser.ParserErrorMsg;\nimport hxparse.NoMatch;\nimport hxparse.Unexpected;\nimport js.Node;\nimport tabmanager.TabManager;\n\n/**\n * ...\n * @author \n */\n\nenum FunctionScopeType \n{\n\tSClass;\n\tSStatic;\n\tSRegular;\n}\n\nclass HaxeParserProvider\n{\n\tprivate static var currentClass:String;\n\tprivate static var currentFunctionScopeType:FunctionScopeType;\n\t\n\tpublic static function test():Void\n\t{\n\t\t//var path = \"../src/Main.hx\";\n\t\t//\n\t\t//var options:NodeFsFileOptions = { };\n\t\t//options.encoding = NodeC.UTF8;\n\t\t//\n\t\t//var data:String = Node.fs.readFileSync(path, options);\n\t\t//\n\t\t//getClassName(data, path);\n\t}\n\t\n\tprivate static function processClass(type:Definition<ClassFlag, Array<Field>>, pos:Int):Bool\n\t{\n\t\tvar found:Bool = false;\n\t\t\n\t\tcurrentClass = type.name;\n\t\tcurrentFunctionScopeType = SClass;\n\t\t\n\t\tfor (i in 0...type.data.length) \n\t\t{\t\t\t\n\t\t\tif (pos > type.data[i].pos.min && pos < type.data[i].pos.max) \n\t\t\t{\n\t\t\t\tswitch (type.data[i].kind) \n\t\t\t\t{\n\t\t\t\t\tcase FFun(f):\n\t\t\t\t\t\tcurrentFunctionScopeType = getFunctionScope(type.data[i], f);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (pos > f.expr.pos.min && pos < f.expr.pos.max) \n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (processExpression(f.expr.expr, pos)) \n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\tcase FVar(t, e):\n\t\t\t\t\t\ttrace(e);\n\t\t\t\t\t\tcurrentFunctionScopeType = SClass;\n\t\t\t\t\tcase FProp(get, set, t, e):\n\t\t\t\t\t\tcurrentFunctionScopeType = SClass;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\ttrace(type.data[i].name);\n\t\t\t\ttrace(currentFunctionScopeType);\n\t\t\t\tfound = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn found;\n\t}\n\t\n\tstatic function processExpression(expr:haxe.macro.ExprDef, pos:Int):Bool \n\t{\n\t\ttrace(expr);\n\t\t\n\t\tvar found:Bool = false;\n\t\t\n\t\tswitch (expr)\n\t\t{\n\t\t\tcase EWhile(econd, e, b):\n\t\t\tcase EVars(vars):\n\t\t\tcase EUntyped(e):\n\t\t\tcase EUnop(op, postFix, e):\n\t\t\tcase ETry(e, catches):\n\t\t\tcase EThrow(e):\n\t\t\tcase ETernary(econd, eif, eelse):\n\t\t\tcase ESwitch(e, cases, edef):\n\t\t\tcase EReturn(e):\n\t\t\tcase EParenthesis(e):\n\t\t\tcase EObjectDecl(fields):\n\t\t\tcase ENew(t, params):\n\t\t\tcase EMeta(s, e):\n\t\t\tcase EIn(e1, e2):\n\t\t\tcase EIf(econd, eif, eelse):\n\t\t\tcase EFunction(name, f):\n\t\t\tcase EFor(it, expr):\n\t\t\tcase EField(e, field):\n\t\t\t\tprocessExpression(e.expr, pos);\n\t\t\t\ttrace(field);\n\t\t\tcase EDisplayNew(t):\n\t\t\tcase EDisplay(e, isCall):\n\t\t\tcase EContinue:\n\t\t\tcase EConst(c):\n\t\t\t\tswitch (c) \n\t\t\t\t{\n\t\t\t\t\tcase CIdent(s):\n\t\t\t\t\t\ttrace(s);\n\t\t\t\t\tdefault:\n\t\t\t\t\t\t\n\t\t\t\t}\n\t\t\tcase ECheckType(e, t):\n\t\t\tcase ECast(e, t):\n\t\t\tcase ECall(e, params):\n\t\t\t\t//trace(e);\n\t\t\t\tprocessExpression(e.expr, pos);\n\t\t\t\t\n\t\t\t\tfor (param in params) \n\t\t\t\t{\n\t\t\t\t\tprocessExpression(param.expr, pos);\n\t\t\t\t}\n\t\t\tcase EBreak:\n\t\t\tcase EBlock(exprs):\n\t\t\t\tfor (e in exprs) \n\t\t\t\t{\n\t\t\t\t\tif (pos > e.pos.max) \n\t\t\t\t\t{\n\t\t\t\t\t\ttrace(e.expr);\n\t\t\t\t\t}\n\t\t\t\t\tif (pos > e.pos.min && pos <= e.pos.max) \n\t\t\t\t\t{\n\t\t\t\t\t\tif (processExpression(e.expr, pos))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\tcase EBinop(op, e1, e2):\n\t\t\t\t//trace(op);\n\t\t\t\t//trace(e1);\n\t\t\t\t//trace(e2);\n\t\t\tcase EArrayDecl(values):\n\t\t\tcase EArray(e1, e2):\n\t\t}\n\t\t\n\t\treturn found;\n\t}\n\t\n\tprivate static function getFunctionScope(field:Field, f:Function) \n\t{\n\t\tvar\tfunctionScopeType:FunctionScopeType = SRegular;\n\t\t\n\t\tvar access:Array<Access> = field.access;\n\t\t\n\t\tfor (accessType in access)\n\t\t{\n\t\t\tswitch (accessType) \n\t\t\t{\n\t\t\t\tcase APublic:\n\t\t\t\tcase AStatic:\n\t\t\t\t\tfunctionScopeType = SStatic;\n\t\t\t\tcase AMacro:\n\t\t\t\tcase AInline:\n\t\t\t\tcase ADynamic:\n\t\t\t\tcase AOverride:\n\t\t\t\tcase APrivate:\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn functionScopeType;\n\t}\n\t\n\tpublic static function getClassName():Void \n\t{\n\t\tvar cm = CodeMirrorEditor.editor;\n\t\tvar pos = cm.indexFromPos(cm.getCursor());\n\t\ttrace(pos);\n\t\t\n\t\tvar doc:CMDoc = TabManager.getCurrentDocument();\n\t\t\n\t\tvar data:String = doc.doc.getValue();\n\t\tvar path:String = doc.path;\n\t\t\n\t\tvar ast = parse(data, path);\n\t\t\n\t\tif (ast != null) \n\t\t{\n\t\t\tvar classPackage:Array<String> = ast.pack;\n\t\n\t\t\tfor (decl in ast.decls) switch (decl) \n\t\t\t{\n\t\t\t\tcase EImport(sl, mode): \n\t\t\t\t\tcurrentClass = null;\n\t\t\t\t\tif (processImport(sl, mode, pos)) \n\t\t\t\t\t{\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\tcase EUsing(path): \n\t\t\t\t\tcurrentClass = null;\n\t\t\t\tcase EAbstract(data): \n\t\t\t\t\tcurrentClass = null;\n\t\t\t\tcase EClass(data): \n\t\t\t\t\tif (processClass(data, pos)) \n\t\t\t\t\t{\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\tcase EEnum(data): \n\t\t\t\t\tcurrentClass = null;\n\t\t\t\tcase ETypedef(data): \n\t\t\t\t\tcurrentClass = null;\n\t\t\t}\n\t\t\t\n\t\t\ttrace(classPackage);\n\t\t\ttrace(currentClass);\n\t\t}\n\t\telse \n\t\t{\n\t\t\ttrace(\"ast is null\");\n\t\t}\n\t}\n\t\n\tprivate static function parse(data:String, path:String) \n\t{\n\t\tvar input = ByteData.ofString(data);\n\t\t\n\t\tvar parser = new haxeparser.HaxeParser(input, path);\n\n\t\tvar data:Array<Info> = [];\n\t\tHaxeLint.parserData.set(path, data);\n\t\t\n\t\tvar ast = null;\n\t\t\n\t\ttry \n\t\t{\n\t\t\tast = parser.parse();\n\t\t}\n\t\tcatch (e:NoMatch<Dynamic>) \n\t\t{\n\t\t\tvar pos =  e.pos.getLinePosition(input);\n\t\t\t\n\t\t\tvar cmPos = untyped __js__(\"CodeMirror.Pos\");\n\t\t\t\n\t\t\tvar info:Info = { from: cmPos(pos.lineMin - 1, pos.posMin), to: cmPos(pos.lineMax - 1, pos.posMax), message: \"Unexpected \" + e.token.tok, severity: \"error\"};\n\t\t\tdata.push(info);\n\t\t\t\n\t\t\t//throw e.pos.format(input) + \": Unexpected \" +e.token.tok;\n\t\t}\n\t\tcatch (e:Unexpected<Dynamic>) \n\t\t{\n\t\t\ttrace(e);\n\t\t\tvar pos =  e.pos.getLinePosition(input);\n\t\t\t\n\t\t\tvar cmPos = untyped __js__(\"CodeMirror.Pos\");\n\t\t\t\n\t\t\tvar info:Info = { from: cmPos(pos.lineMin - 1, pos.posMin), to: cmPos(pos.lineMax - 1, pos.posMax), message: \"Unexpected \" + e.token.tok, severity: \"error\"};\n\t\t\tdata.push(info);\n\t\t\t//trace(e.pos.format(input) + \": Unexpected \" + e.token.tok);\n\t\t\t//throw e.pos.format(input) + \": Unexpected \" + e.token.tok;\n\t\t} \n\t\tcatch (e:Dynamic)\n\t\t{\t\t\t\n\t\t\tif (Reflect.hasField(e, \"pos\")) \n\t\t\t{\t\t\n\t\t\t\tvar cm = CodeMirrorEditor.editor;\n\t\t\t\t\n\t\t\t\tvar message:String = \"\";\n\t\t\t\t\n\t\t\t\tswitch (e.msg) \n\t\t\t\t{\n\t\t\t\t\tcase MissingSemicolon:\n\t\t\t\t\t\tmessage = \"Missing Semicolon\";\n\t\t\t\t\tcase MissingType:\n\t\t\t\t\t\tmessage = \"Missing Type\";\n\t\t\t\t\tcase DuplicateDefault:\n\t\t\t\t\t\tmessage = \"Duplicate Default\";\n\t\t\t\t\tcase Custom(s):\n\t\t\t\t\t\tmessage = s;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar info:Info = { from: cm.posFromIndex(e.pos.min), to: cm.posFromIndex(e.pos.max), message: message, severity: \"error\"};\n\t\t\t\tdata.push(info);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn ast;\n\t}\n\t\n\tprivate static function processImport(path:Array<{pack:String, pos:Position}>, mode:ImportMode, currentPosition:Int):Bool \n\t{\n\t\tvar found:Bool = false;\n\t\t\n\t\tfor (i in 0...path.length) \n\t\t{\t\t\t\n\t\t\tif (currentPosition > path[i].pos.min && currentPosition < path[i].pos.max) \n\t\t\t{\n\t\t\t\ttrace(path[i].pack);\n\t\t\t\t\n\t\t\t\tfound = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn found;\n\t}\n\t\n\tprivate static function printImport(path:Array<{pack:String, pos:Position}>, mode:ImportMode):Void\n\t{\n\t\tvar fullPackage:String = \"\";\n\t\t\n\t\tfor (i in 0...path.length) \n\t\t{\n\t\t\tfullPackage += path[i].pack;\n\t\t\t\n\t\t\tif (i != path.length - 1) \n\t\t\t{\n\t\t\t\tfullPackage += \".\";\n\t\t\t}\n\t\t\t\n\t\t\t//trace(path[i].pos);\n\t\t}\n\t\t\n\t\ttrace(fullPackage);\n\t}\n\t\n\tprivate static function printClass(type:Definition<ClassFlag, Array<Field>>):Void \n\t{\n\t\ttrace(type.name);\n\t\t\n\t\tvar publicFunctions:Array<Field> = [];\n\t\tvar publicStaticFunctions:Array<Field> = [];\n\t\t\n\t\t\t//if (isPublic) \n\t\t\t//{\n\t\t\t\t//if (isStatic) \n\t\t\t\t//{\n\t\t\t\t\t//publicStaticFunctions.push(type.data[i]);\n\t\t\t\t//}\n\t\t\t\t//else \n\t\t\t\t//{\n\t\t\t\t\t//publicFunctions.push(type.data[i]);\n\t\t\t\t//}\n\t\t\t//}\n\t\t\n\t\t//for (publicFunction in publicFunctions) \n\t\t//{\n\t\t\t//trace(\"public \" + publicFunction.name);\n\t\t//}\n\t\t//\n\t\tfor (publicStaticFunction in publicStaticFunctions) \n\t\t{\n\t\t\t//trace(\"public static \" + publicStaticFunction.name);\n\t\t\t\n\t\t\tvar info:String = publicStaticFunction.name;\n\t\t\t\n\t\t\tswitch (publicStaticFunction.kind) \n\t\t\t{\n\t\t\t\tcase FFun(f):\n\t\t\t\t\t//trace(f);\n\t\t\t\t\ttrace(f.expr);\n\t\t\t\t\ttrace(f.params);\n\t\t\t\t\tinfo += \"(\";\n\t\t\t\t\t\n\t\t\t\t\tfor (i in 0...f.args.length) \n\t\t\t\t\t{\n\t\t\t\t\t\tinfo += f.args[i].name;\n\t\t\t\t\t\t\n\t\t\t\t\t\tswitch (f.args[i].type) \n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcase TPath(p):\n\t\t\t\t\t\t\t\t//p.pack.join(\".\") + \".\"\n\t\t\t\t\t\t\t\tinfo += \":\" + p.name;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif (i != f.args.length - 1) \n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tinfo += \", \";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcase TParent(t):\n\t\t\t\t\t\t\t\ttrace(t);\n\t\t\t\t\t\t\tcase TOptional(t):\n\t\t\t\t\t\t\t\ttrace(t);\n\t\t\t\t\t\t\tcase TFunction(args, ret):\n\t\t\t\t\t\t\t\ttrace(args);\n\t\t\t\t\t\t\t\ttrace(ret);\n\t\t\t\t\t\t\tcase TExtend(p, fields):\n\t\t\t\t\t\t\t\ttrace(p, fields);\n\t\t\t\t\t\t\tcase TAnonymous(fields):\n\t\t\t\t\t\t\t\ttrace(fields);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tinfo += \")\";\n\t\t\t\tcase FVar(t, e):\n\t\t\t\t\t\n\t\t\t\tcase FProp(get, set, t, e):\n\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\ttrace(info);\n\t\t}\n\t}\n}","package core;\nimport js.Node;\nimport nodejs.webkit.Window;\n\n/**\n * ...\n * @author AS3Boyan\n */\n@:keepSub @:expose class HaxeServer\n{\n\tprivate static var haxeCompletionServer:js.Node.NodeChildProcess;\n\tprivate static var processStarted:Bool = true;\n\n\tpublic static function check():Void\n\t{\n\t\tvar socket = Node.net.connect(5000, \"localhost\");\n\t\t//socket.on(\"data\", function (e)\n\t\t//{\n\t\t\t//trace(e.toString(NodeC.UTF8));\n\t\t\t//socket.destroy();\n\t\t//}\n\t\t//);\n\t\tsocket.on(\"error\", function (e)\n\t\t{\n\t\t\ttrace(e);\n\t\t}\n\t\t);\n\t\tsocket.on(\"close\", function (e)\n\t\t{\n\t\t\tif (e) \n\t\t\t{\n\t\t\t\tstart();\n\t\t\t}\n\t\t}\n\t\t);\n\t}\n\t\n\tpublic static function start():Void\n\t{\n\t\thaxeCompletionServer = js.Node.child_process.exec([\"haxe\", \"--wait\", \"5000\"].join(\" \"), { }, function (error, stdout, stderr)\n\t\t{\n\t\t\ttrace(stdout);\n\t\t\ttrace(stderr);\n\t\t\t\n\t\t\tif (error.code != 0)\n\t\t\t{\n\t\t\t\tprocessStarted = false;\n\t\t\t}\n\t\t\t\n\t\t\ttrace('haxeCompletionServer process exit code ' + error.code);\n\t\t}\n\t\t);\t\t\n\n\t\tvar window:Window = Window.get();\n\t\t\n\t\twindow.on(\"close\", function (e)\n\t\t{\n\t\t\tif (processStarted) \n\t\t\t{\n\t\t\t\thaxeCompletionServer.kill('SIGKILL');\n\t\t\t}\n\t\t}\n\t\t);\n\t}\n}","package core;\nimport haxe.ds.StringMap.StringMap;\nimport js.Browser;\nimport js.html.KeyboardEvent;\nimport js.html.SpanElement;\nimport js.Node;\nimport tjson.TJSON;\n\n/**\n * ...\n * @author AS3Boyan\n */\ntypedef Hotkey = \n{\n\tvar keyCode:Int;\n\tvar ctrl:Bool;\n\tvar shift:Bool;\n\tvar alt:Bool;\n\tvar onKeyDown:Dynamic;\n}\n \n@:keepSub @:expose(\"Hotkeys\") class Hotkeys\n{\n\tprivate static var hotkeys:Array<Hotkey> = new Array();\n\tprivate static var commandMap:StringMap<String> = new StringMap();\n\tprivate static var spanMap:StringMap<SpanElement> = new StringMap();\n\tpublic static var data:Dynamic;\n\tprivate static var pathToData:String;\n\t\n\tpublic static function prepare():Void\n\t{\n\t\tpathToData = \"hotkeys.json\";\n\t\tparseData();\n\t\t\n\t\tvar options:NodeWatchOpt = { };\n\t\toptions.interval = 1500;\n\t\t\n\t\tNode.fs.watchFile(pathToData, options, function (curr:NodeStat, prev:NodeStat)\n\t\t{\n\t\t\tif (curr.mtime != prev.mtime) \n\t\t\t{\n\t\t\t\tparseData();\n\t\t\t\thotkeys = new Array();\n\t\t\t\t\n\t\t\t\tfor (key in commandMap.keys()) \n\t\t\t\t{\n\t\t\t\t\taddHotkey(key);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t);\n\t\t\n\t\tBrowser.window.addEventListener(\"keyup\", function (e:KeyboardEvent)\n\t\t{\n\t\t\tfor (hotkey in hotkeys)\n\t\t\t{\n\t\t\t\tif (hotkey.keyCode == e.keyCode && hotkey.ctrl == e.ctrlKey && hotkey.shift == e.shiftKey && hotkey.alt == e.altKey)\n\t\t\t\t{\n\t\t\t\t\thotkey.onKeyDown();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t);\n\t}\n\t\n\tpublic static function add(menuItem:String, hotkeyText:String, span:SpanElement, onKeyDown:Dynamic):Void\n\t{\n\t\tcommandMap.set(menuItem, onKeyDown);\n\t\t\n\t\tif (span != null)\n\t\t{\n\t\t\tspanMap.set(menuItem, span);\n\t\t}\n\t\t\n\t\taddHotkey(menuItem, hotkeyText);\n\t}\n\t\n\tprivate static function addHotkey(menuItem:String, ?hotkeyText:String = \"\")\n\t{\n\t\tif (Reflect.hasField(data, menuItem))\n\t\t{\n\t\t\thotkeyText = Reflect.field(data, menuItem);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tReflect.setField(data, menuItem, hotkeyText);\n\t\t\tvar data:String = TJSON.encode(data, 'fancy');\n\t\t\tjs.Node.fs.writeFileSync(pathToData, data, js.Node.NodeC.UTF8);\n\t\t}\n\t\t\n\t\tvar keyCode:Int = null;\n\t\tvar ctrl:Bool = null;\n\t\tvar shift:Bool = null;\n\t\tvar alt:Bool = null;\n\t\t\n\t\tif (hotkeyText != \"\")\n\t\t{\n\t\t\tvar hotkey:Dynamic = parseHotkey(hotkeyText);\n\t\t\t\n\t\t\tif (hotkey.keyCode != 0) \n\t\t\t{\n\t\t\t\tkeyCode = hotkey.keyCode;\n\t\t\t\tctrl = hotkey.ctrl;\n\t\t\t\tshift = hotkey.shift;\n\t\t\t\talt = hotkey.alt;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBrowser.window.console.warn(\"can't assign hotkey \" + hotkeyText + \" for \" + menuItem);\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (spanMap.exists(menuItem)) \n\t\t{\n\t\t\tspanMap.get(menuItem).innerText = hotkeyText;\n\t\t}\n\t\t\n\t\tif (keyCode != null) \n\t\t{\n\t\t\thotkeys.push( { keyCode:keyCode, ctrl:ctrl, shift:shift, alt:alt, onKeyDown:commandMap.get(menuItem) } );\n\t\t}\n\t}\n\t\n\tprivate static function parseData():Void\n\t{\n\t\tvar options:NodeFsFileOptions = { };\n\t\toptions.encoding = js.Node.NodeC.UTF8;\n\t\t\n\t\tdata = TJSON.parse(Node.fs.readFileSync(pathToData, options));\n\t}\n\t\n\tprivate static function parseHotkey(hotkey:String):Dynamic\n\t{\n\t\tvar keys:Array<String> = hotkey.split(\"-\");\n\t\t\n\t\tvar ctrl:Bool = false;\n\t\tvar shift:Bool = false;\n\t\tvar alt:Bool = false;\n\t\tvar keyCode:Int = 0;\n\t\t\n\t\tfor (key in keys) \n\t\t{\n\t\t\tswitch (key.toLowerCase()) \n\t\t\t{\t\t\t\t\n\t\t\t\tcase \"ctrl\":\n\t\t\t\t\tctrl = true;\n\t\t\t\tcase \"shift\":\n\t\t\t\t\tshift = true;\n\t\t\t\tcase \"alt\":\n\t\t\t\t\talt = true;\n\t\t\t\tcase \"f1\":\n\t\t\t\t\tkeyCode = 112;\n\t\t\t\tcase \"f2\":\n\t\t\t\t\tkeyCode = 113;\n\t\t\t\tcase \"f3\":\n\t\t\t\t\tkeyCode = 114;\n\t\t\t\tcase \"f4\":\n\t\t\t\t\tkeyCode = 115;\n\t\t\t\tcase \"f5\":\n\t\t\t\t\tkeyCode = 116;\n\t\t\t\tcase \"f6\":\n\t\t\t\t\tkeyCode = 117;\n\t\t\t\tcase \"f7\":\n\t\t\t\t\tkeyCode = 118;\n\t\t\t\tcase \"f8\":\n\t\t\t\t\tkeyCode = 119;\n\t\t\t\tcase \"f9\":\n\t\t\t\t\tkeyCode = 120;\n\t\t\t\tcase \"f10\":\n\t\t\t\t\tkeyCode = 121;\n\t\t\t\tcase \"f11\":\n\t\t\t\t\tkeyCode = 122;\n\t\t\t\tcase \"f12\":\n\t\t\t\t\tkeyCode = 123;\n\t\t\t\tcase \"tab\":\n\t\t\t\t\tkeyCode = 9;\n\t\t\t\tcase \"enter\":\n\t\t\t\t\tkeyCode = 13;\n\t\t\t\tcase \"esc\":\n\t\t\t\t\tkeyCode = 27;\n\t\t\t\tcase \"space\":\n\t\t\t\t\tkeyCode = 32;\n\t\t\t\tcase \"+\":\n\t\t\t\t\tkeyCode = 187;\n\t\t\t\tcase \"\": \n\t\t\t\t\tkeyCode = 189;\n\t\t\t\tdefault:\n\t\t\t\t\tif (key.length == 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tkeyCode = key.charCodeAt(0);\n\t\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn { keyCode:keyCode, ctrl: ctrl, shift: shift, alt:alt };\n\t}\n}","package core;\r\nimport haxe.Timer;\r\nimport js.Browser;\r\nimport js.html.Node;\r\nimport nodejs.webkit.Window;\r\n\r\n//Ported to Haxe from https://github.com/rogerwang/node-webkit/wiki/Preserve-window-state-between-sessions\r\n\r\n// Cross-platform window state preservation.\r\n// Yes this code is quite complicated, but this is the best I came up with for \r\n// current state of node-webkit Window API (v0.7.3).\r\n// Known issues:\r\n// - unmaximization not always sets the window (x, y) in the lastly used coordinates\r\n// - unmaximization animation sometimes looks wierd\r\n\r\nclass PreserveWindowState\r\n{\r\n\tprivate static var winState:Dynamic;\r\n\tprivate static var currWinMode:String;\r\n\tprivate static var resizeTimeout:Timer;\r\n\tprivate static var isMaximizationEvent:Bool = false;\r\n\tprivate static var window:Window = Window.get();\r\n\t\r\n\tpublic static function init():Void\r\n\t{                \r\n\t\tinitWindowState();\r\n\r\n\t\twindow.on('maximize', function ():Void\r\n\t\t{\r\n\t\t\t\tisMaximizationEvent = true;\r\n\t\t\t\tcurrWinMode = 'maximized';\r\n\t\t});\r\n\r\n\t\twindow.on('unmaximize', function ():Void\r\n\t\t{\r\n\t\t\t\tcurrWinMode = 'normal';\r\n\t\t\t\trestoreWindowState();\r\n\t\t});\r\n\r\n\t\twindow.on('minimize', function ():Void\r\n\t\t{\r\n\t\t\t\tcurrWinMode = 'minimized';\r\n\t\t});\r\n\r\n\t\twindow.on('restore', function ():Void\r\n\t\t{\r\n\t\t\t\tcurrWinMode = 'normal';\r\n\t\t});\r\n\t\t\r\n\t\twindow.window.addEventListener('resize', function (e) \r\n\t\t{\r\n\t\t\t// resize event is fired many times on one resize action,\r\n\t\t\t// this hack with setTiemout forces it to fire only once\r\n\t\t\t\r\n\t\t\tif (resizeTimeout != null)\r\n\t\t\t{\r\n\t\t\t\tresizeTimeout.stop();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tresizeTimeout = new Timer(500);\r\n\t\t\tresizeTimeout.run = \r\n\t\t\tfunction () \r\n\t\t\t{\r\n\t\t\t\t// on MacOS you can resize maximized window, so it's no longer maximized\r\n\t\t\t\tif (isMaximizationEvent) \r\n\t\t\t\t{\r\n\t\t\t\t\t\t// first resize after maximization event should be ignored\r\n\t\t\t\t\t\tisMaximizationEvent = false;\r\n\t\t\t\t} \r\n\t\t\t\telse \r\n\t\t\t\t{\r\n\t\t\t\t\t\tif (currWinMode == 'maximized') \r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tcurrWinMode = 'normal';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tresizeTimeout.stop();\r\n\t\t\t\t\r\n\t\t\t\tdumpWindowState();        \r\n\t\t\t};\r\n\t\t\t\t\r\n\t\t}, false);\r\n\t\t\r\n\t\twindow.on(\"close\", function (e)\r\n\t\t{\r\n\t\t\tsaveWindowState();\r\n\t\t}\r\n\t\t);\r\n\t}\r\n\t\r\n\tprivate static function initWindowState():Void\r\n\t{\r\n\t\tvar windowState = Browser.getLocalStorage().getItem(\"windowState\");\r\n\t\t\t\t\r\n\t\tif (windowState != null)\r\n\t\t{\r\n\t\t\twinState = js.Node.parse(windowState);\r\n\t\t}\r\n\t\t\t\t\r\n\t\tif (winState != null) \r\n\t\t{\r\n\t\t\tcurrWinMode = winState.mode;\r\n\t\t\tif (currWinMode == 'maximized') \r\n\t\t\t{\r\n\t\t\t\twindow.maximize();\r\n\t\t\t} \r\n\t\t\telse \r\n\t\t\t{\r\n\t\t\t\trestoreWindowState();\r\n\t\t\t}\r\n\t\t} \r\n\t\telse \r\n\t\t{\r\n\t\t\tcurrWinMode = 'normal';\r\n\t\t\tdumpWindowState();\r\n\t\t}\r\n\t\t\r\n\t\twindow.show();\r\n\t}\r\n\r\n\tprivate static function dumpWindowState():Void\r\n\t{\r\n\t\tif (winState == null) \r\n\t\t{\r\n\t\t\twinState = {};\r\n\t\t}\r\n\t\t\r\n\t\t// we don't want to save minimized state, only maximized or normal\r\n\t\tif (currWinMode == 'maximized') \r\n\t\t{\r\n\t\t\twinState.mode = 'maximized';\r\n\t\t}\r\n\t\telse \r\n\t\t{\r\n\t\t\twinState.mode = 'normal';\r\n\t\t}\r\n\t\t\r\n\t\t// when window is maximized you want to preserve normal\r\n\t\t// window dimensions to restore them later (even between sessions)\r\n\t\tif (currWinMode == 'normal') \r\n\t\t{\r\n\t\t\twinState.x = window.x;\r\n\t\t\twinState.y = window.y;\r\n\t\t\twinState.width = window.width;\r\n\t\t\twinState.height = window.height;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate static function restoreWindowState():Void\r\n\t{\r\n\t\twindow.resizeTo(winState.width, winState.height);\r\n\t\twindow.moveTo(winState.x, winState.y);\r\n\t}\r\n\r\n\tprivate static function saveWindowState():Void\r\n\t{\r\n\t\tdumpWindowState();\r\n\t\tBrowser.getLocalStorage().setItem(\"windowState\", js.Node.stringify(winState));\r\n\t}\r\n        \r\n}\r\n\r\n","package core;\nimport cm.CodeMirrorEditor;\nimport js.Browser;\nimport js.html.TextAreaElement;\nimport js.Node;\nimport menu.BootstrapMenu;\nimport nodejs.webkit.Shell;\nimport projectaccess.Project;\nimport projectaccess.ProjectAccess;\nimport tabmanager.TabManager;\n\n/**\n * ...\n * @author AS3Boyan\n */\nclass RunProject\n{\t\n\tpublic static function load():Void\n\t{\n\t\tBootstrapMenu.getMenu(\"Project\", 80).addMenuItem(\"Run\", 1, runProject, \"F5\");\n\t\tBootstrapMenu.getMenu(\"Project\").addMenuItem(\"Build\", 2, buildProject, \"F8\");\n\t\tBootstrapMenu.getMenu(\"Project\").addMenuItem(\"Set this hxml as project build file\", 3, setHxmlAsProjectBuildFile);\n\t}\n\t\n\tprivate static function setHxmlAsProjectBuildFile():Void\n\t{\n\t\tvar path:String = TabManager.getCurrentDocumentPath();\n\t\tvar extname:String = js.Node.path.extname(path);\n\t\tvar buildHxml:Bool = (extname == \".hxml\");\n\t\t\n\t\tif (buildHxml) \n\t\t{\n\t\t\tvar project:Project = ProjectAccess.currentProject;\n\t\t\tproject.type = Project.HXML;\n\t\t\tproject.main = Node.path.basename(path);\n\t\t\tproject.path = Node.path.dirname(path);\n\t\t\tProjectAccess.save();\n\t\t\tAlerts.showAlert(\"Done\");\n\t\t}\n\t\telse \n\t\t{\n\t\t\tAlerts.showAlert(\"Currently active document is not a hxml file\");\n\t\t}\n\t}\n\t\n\tprivate static function runProject():Void\n\t{\t\t\n\t\tbuildProject(function ()\n\t\t{\t\t\t\n\t\t\tswitch (ProjectAccess.currentProject.runActionType) \n\t\t\t{\n\t\t\t\tcase Project.URL:\n\t\t\t\t\tvar url:String = ProjectAccess.currentProject.runActionText;\n\t\t\t\t\t\n\t\t\t\t\tif (isValidCommand(url)) \n\t\t\t\t\t{\n\t\t\t\t\t\tShell.openExternal(url);\n\t\t\t\t\t}\n\t\t\t\tcase Project.FILE:\n\t\t\t\t\tvar path:String = ProjectAccess.currentProject.runActionText;\n\t\t\t\t\t\n\t\t\t\t\tif (isValidCommand(path)) \n\t\t\t\t\t{\n\t\t\t\t\t\tjs.Node.fs.exists(path, function (exists:Bool)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (!exists)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tpath = js.Node.path.join(ProjectAccess.currentProject.path, path);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tShell.openItem(path);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\tcase Project.COMMAND:\n\t\t\t\t\tvar command:String = ProjectAccess.currentProject.runActionText;\n\t\t\t\t\t\n\t\t\t\t\tif (isValidCommand(command)) \n\t\t\t\t\t{\n\t\t\t\t\t\tHaxeClient.buildProject(preprocessCommand(command));\n\t\t\t\t\t}\n\t\t\t\tdefault:\n\t\t\t\t\t\n\t\t\t}\n\t\t}\n\t\t);\n\t}\n\t\n\tprivate static function isValidCommand(command:String):Bool\n\t{\n\t\tvar valid = false;\n\t\t\n\t\tif (command != null && StringTools.trim(command) != \"\")  \n\t\t{\n\t\t\tvalid = true;\n\t\t}\n\t\t\n\t\treturn valid;\n\t}\n\t\n\tprivate static function buildProject(?onComplete:Dynamic):Void\n\t{\t\t\n\t\tif (ProjectAccess.currentProject.path == null)\n\t\t{\n\t\t\tAlerts.showAlert(\"Please open or create project first!\");\n\t\t}\n\t\telse \n\t\t{\n\t\t\tTabManager.saveAll(function ()\n\t\t\t{\n\t\t\t\tvar path:String = TabManager.getCurrentDocumentPath();\n\t\t\t\tvar extname:String = Node.path.extname(path);\n\t\t\t\tvar buildHxml:Bool = (extname == \".hxml\");\n\t\t\t\t\n\t\t\t\tvar dirname:String = Node.path.dirname(path);\n\t\t\t\tvar filename:String = Node.path.basename(path);\n\t\t\t\t\n\t\t\t\tif (buildHxml || ProjectAccess.currentProject.type == Project.HXML) \n\t\t\t\t{\n\t\t\t\t\tvar hxmlData:String;\n\t\t\t\t\t\n\t\t\t\t\tif (!buildHxml) \n\t\t\t\t\t{\n\t\t\t\t\t\tdirname = ProjectAccess.currentProject.path;\n\t\t\t\t\t\tfilename = ProjectAccess.currentProject.main;\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar options:js.Node.NodeFsFileOptions = { };\n\t\t\t\t\t\toptions.encoding = js.Node.NodeC.UTF8;\n\t\t\t\t\t\t\n\t\t\t\t\t\tNode.fs.readFile(Node.path.join(dirname, filename), options, function (err:js.NodeErr, data:String):Void\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (err == null) \n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\thxmlData = data;\n\t\t\t\t\t\t\t\tcheckHxml(dirname, filename, hxmlData, onComplete);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse \n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttrace(err);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\telse \n\t\t\t\t\t{\n\t\t\t\t\t\thxmlData = CodeMirrorEditor.editor.getValue();\t\n\t\t\t\t\t\tcheckHxml(dirname, filename, hxmlData, onComplete);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse \n\t\t\t\t{\n\t\t\t\t\tvar command:String = ProjectAccess.currentProject.buildActionCommand;\n\t\t\t\t\tcommand = preprocessCommand(command);\n\t\t\t\t\t\n\t\t\t\t\tif (ProjectAccess.currentProject.type == Project.HAXE)\n\t\t\t\t\t{\n\t\t\t\t\t\tcommand = [command].concat(ProjectAccess.currentProject.args).join(\" \");\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tHaxeClient.buildProject(command, onComplete);\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\t\n\tprivate static function checkHxml(dirname:String, filename:String, hxmlData:String, ?onComplete:Dynamic)\n\t{\n\t\tvar useCompilationServer:Bool = true;\n\t\tvar startCommandLine:Bool = false;\n\t\t\n\t\tif (hxmlData != null) \n\t\t{\n\t\t\tif (hxmlData.indexOf(\"-cmd\") != -1) \n\t\t\t{\n\t\t\t\tstartCommandLine = true;\n\t\t\t}\n\t\t\t\n\t\t\tif (hxmlData.indexOf(\"-cpp\") != -1) \n\t\t\t{\n\t\t\t\tuseCompilationServer = false;\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\tbuildHxml(dirname, filename, useCompilationServer, startCommandLine, onComplete);\n\t}\n\t\n\tprivate static function buildHxml(dirname:String, filename:String, ?useCompilationServer:Bool = true, ?startCommandLine:Bool = false, ?onComplete:Dynamic)\n\t{\n\t\tvar command:String = \"\";\n\t\t\n\t\tif (startCommandLine) \n\t\t{\n\t\t\tswitch (Utils.os) \n\t\t\t{\n\t\t\t\tcase Utils.WINDOWS:\n\t\t\t\t\tcommand = \"start\";\n\t\t\t\tdefault:\n\t\t\t\t\tcommand = \"bash\";\n\t\t\t}\n\t\t\t\n\t\t\tcommand += \" \";\n\t\t}\n\t\t\n\t\tvar compilationServer:String = \"\";\n\t\t\n\t\tif (useCompilationServer)\n\t\t{\n\t\t\tcompilationServer = \"--connect 5000\";\n\t\t}\n\t\t\n\t\tHaxeClient.buildProject(command + \"haxe \" + \"--cwd \" + dirname + \" \" + compilationServer +  \" \" + filename, onComplete);\n\t}\n\t\n\tprivate static function preprocessCommand(command:String):String\n\t{\n\t\tvar processedCommand:String = command;\n\t\t\n\t\tprocessedCommand = StringTools.replace(processedCommand, \"%path%\", ProjectAccess.currentProject.path);\n\t\t\n\t\tvar ereg:EReg = ~/%join%[(](.+)[)]/;\n\t\t\n\t\tif (ereg.match(processedCommand))\n\t\t{\n\t\t\tvar matchedString:String = ereg.matched(1);\n\t\t\tvar arguments = matchedString.split(\",\");\n\t\t\t\n\t\t\tprocessedCommand = StringTools.replace(processedCommand, ereg.matched(0), js.Node.path.join(arguments[0], arguments[1]));\n\t\t}\n\t\t\n\t\treturn processedCommand;\n\t}\n}\n","package core;\r\nimport haxe.Timer;\r\nimport js.Browser;\r\nimport js.html.DivElement;\r\nimport jQuery.JQuery;\r\nimport js.html.Element;\r\nimport nodejs.webkit.Window;\r\n\r\n/**\r\n * ...\r\n * @author AS3Boyan\r\n */\r\n@:keepSub @:expose(\"Splitpane\") class Splitpane\r\n{\r\n\tpublic static var components:Array<DivElement> = new Array();\r\n\tpublic static var layout:Dynamic;\r\n\tprivate static var panel:DivElement;\r\n\t\r\n\tpublic static function createSplitPane():Void\r\n\t{\t\t\r\n\t\tpanel = Browser.document.createDivElement();\r\n\t\tpanel.id = \"panel\";\r\n\t\tpanel.className = \"ui-layout-container\";\r\n\t\t\r\n\t\tvar outerCenterPanel:DivElement = createComponent(\"outer\", \"center\");\r\n\t\tpanel.appendChild(outerCenterPanel);\r\n\t\t\r\n\t\tvar middleCenterPanel:DivElement = createComponent(\"middle\", \"center\");\r\n\t\touterCenterPanel.appendChild(middleCenterPanel);\r\n\t\t\r\n\t\tvar middleCenterPanelContent:DivElement = createContent();\r\n\t\tmiddleCenterPanel.appendChild(middleCenterPanelContent);\r\n\t\t\r\n\t\tvar middleSouthPanel:DivElement = createComponent(\"middle\", \"south\");\r\n\t\touterCenterPanel.appendChild(middleSouthPanel);\r\n\t\t\r\n\t\tvar middleSouthPanelContent:DivElement = createContent();\r\n\t\tmiddleSouthPanel.appendChild(middleSouthPanelContent);\r\n\t\t\r\n\t\tvar outerWestPanel:DivElement = createComponent(\"outer\", \"west\");\r\n\t\tpanel.appendChild(outerWestPanel);\r\n\t\t\r\n\t\tvar outerEastPanel:DivElement = createComponent(\"outer\", \"east\");\r\n\t\tpanel.appendChild(outerEastPanel);\r\n\t\t\r\n\t\tcomponents.push(outerWestPanel);\r\n\t\tcomponents.push(middleCenterPanelContent);\r\n\t\tcomponents.push(middleSouthPanelContent);\r\n\t\tcomponents.push(outerEastPanel);\r\n\t\t\r\n\t\tBrowser.document.body.appendChild(panel);\r\n\t}\r\n\t\r\n\tpublic static function activateSplitpane():Void\r\n\t{\t\t\r\n\t\tvar layoutSettings = {\r\n\t\tcenter__paneSelector:        \".outer-center\",\r\n\t\twest__paneSelector:                \".outer-west\",\r\n\t\twest__size:                                120,\r\n\t\teast__paneSelector:                \".outer-east\",\r\n\t\teast__size:                                120,\r\n\t\tspacing_open:                        8,  // ALL panes\r\n\t\tspacing_closed:                        12, // ALL panes\r\n\t\t\r\n\t\tcenter__childOptions: {\r\n\t\t\t\tcenter__paneSelector:        \".middle-center\",\r\n\t\t\t\tsouth__paneSelector:        \".middle-south\",\r\n\t\t\t\tsouth__size:                        100,\r\n\t\t\t\tspacing_open:                        8,  // ALL panes\r\n\t\t\t\tspacing_closed:                        12 // ALL panes\r\n\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tlayout = untyped JQuery(\"#panel\").layout(layoutSettings);\r\n\t\t\r\n\t\tvar timer:Timer = new Timer(250);\r\n\t\t\r\n\t\ttimer.run = function ():Void\r\n\t\t{\r\n\t\t\tvar treeWell:Element = Browser.document.getElementById(\"tree-well\");\r\n\t\t\t\r\n\t\t\tif (treeWell != null)\r\n\t\t\t{\t\t\t\t\r\n\t\t\t\tif (treeWell.clientHeight < 250 || treeWell.clientWidth < 80)\r\n\t\t\t\t{\r\n\t\t\t\t\tlayout.resizeAll();\r\n\t\t\t\t\tnew JQuery(Browser.window).trigger(\"resize\");\r\n\t\t\t\t\t\r\n\t\t\t\t\ttrace(\"layout.resizeAll()\");\r\n\t\t\t\t}\r\n\t\t\t\telse \r\n\t\t\t\t{\r\n\t\t\t\t\ttimer.stop();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\t\r\n\tpublic static function activateStatePreserving():Void\r\n\t{\r\n\t\tvar localStorage = Browser.getLocalStorage();\r\n        \r\n        var window = Window.get();\r\n\t\t\r\n\t\twindow.on(\"close\", function (e)\r\n\t\t{\r\n\t\t\tvar stateString = js.Node.stringify(layout.readState());\r\n\t\t\tlocalStorage.setItem(\"state\", stateString);\r\n\t\t\twindow.close();\r\n\t\t});\r\n\t\t\r\n\t\tvar state = localStorage.getItem(\"state\");\r\n\t\t\r\n\t\tif (state != null)\r\n\t\t{\r\n\t\t\tlayout.loadState(js.Node.parse(state));\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic static function createComponent(layout:String, side:String):DivElement\r\n\t{\r\n\t\tvar component:DivElement = Browser.document.createDivElement();\r\n\t\tcomponent.className = layout + \"-\" + side + \" \" + \"ui-layout-\" + side;\r\n\t\treturn component;\r\n\t}\r\n\t\r\n\tpublic static function createContent():DivElement\r\n\t{\r\n\t\tvar content:DivElement = Browser.document.createDivElement();\r\n\t\tcontent.className = \"ui-layout-content\";\r\n\t\treturn content;\r\n\t}\r\n}","package core;\r\nimport menu.BootstrapMenu;\r\n\r\n/**\r\n * ...\r\n * @author AS3Boyan\r\n */\r\nclass ToggleFullscreen\r\n{\r\n\tpublic static function addToMenu():Void\r\n\t{\t\r\n\t\tBootstrapMenu.getMenu(\"View\", 2).addMenuItem(\"Toggle Fullscreen\", 1, function ():Void\r\n\t\t{\r\n\t\t\tnodejs.webkit.Window.get().toggleFullscreen();\r\n\t\t}\r\n\t\t, \"F11\");\r\n\t}\t\r\n}","package core;\n\n/**\n * ...\n * @author AS3Boyan\n */\n@:keepSub @:expose class Utils\n{\n\tinline public static var WINDOWS:Int = 0;\n\tinline public static var LINUX:Int = 1;\n\tinline public static var OTHER:Int = 2;\n\t\n\tpublic static var os:Int;\n\t\n\tpublic static function prepare():Void\n\t{\t\t\n\t\tswitch(js.Node.os.type())\n        {\n\t\t\tcase \"Windows_NT\":\n\t\t\t\tos = WINDOWS;\n\t\t\tcase \"Linux\":\n\t\t\t\tos = LINUX;\n\t\t\tcase _:\n\t\t\t\tos = OTHER;\n        }\n\t}\n}","package core;\r\nimport menu.BootstrapMenu;\r\nimport nodejs.webkit.Window;\r\n\r\n/**\r\n * ...\r\n * @author AS3Boyan\r\n */\r\nclass Zoom\r\n{\r\n\tpublic static function addToMenu():Void\r\n\t{\r\n\t\tvar window = Window.get();\r\n\r\n\t\tBootstrapMenu.getMenu(\"View\").addMenuItem(\"Zoom In\", 2, function ():Void\r\n\t\t{\r\n\t\t\twindow.zoomLevel += 1;\r\n\t\t}\r\n\t\t, \"Ctrl-Shift-+\");\r\n\r\n\t\tBootstrapMenu.getMenu(\"View\").addMenuItem(\"Zoom Out\", 3, function ():Void\r\n\t\t{\r\n\t\t\twindow.zoomLevel -= 1;\r\n\t\t}\r\n\t\t, \"Ctrl-Shift--\");\r\n\r\n\t\tBootstrapMenu.getMenu(\"View\").addMenuItem(\"Reset\", 4, function ():Void\r\n\t\t{\r\n\t\t\twindow.zoomLevel = 0;\r\n\t\t}\r\n\t\t, \"Ctrl-Shift-0\");\r\n\t}\r\n\t\r\n}\r\n","package filetree;\nimport core.Bootbox;\nimport haxe.ds.StringMap.StringMap;\nimport js.Browser;\nimport js.html.AnchorElement;\nimport js.html.DivElement;\nimport js.html.Element;\nimport js.html.LIElement;\nimport js.html.MouseEvent;\nimport js.html.UListElement;\nimport js.Lib;\nimport nodejs.webkit.Shell;\n\n/**\n * ...\n * @author AS3Boyan\n */\nclass ContextMenu\n{\n\t\n\tprivate static var itemType:String;\n\tprivate static var path:String;\n\tprivate static var menuItems:StringMap<LIElement>;\n\t\n\tpublic function new() \n\t{\n\t\t\n\t}\n\t\n\tpublic static function createContextMenu():Void\n\t{\n\t\tvar contextMenu:DivElement = Browser.document.createDivElement();\n\t\tcontextMenu.className = \"dropdown\";\n\t\tcontextMenu.style.position = \"absolute\";\n\t\tcontextMenu.style.display = \"none\";\n\t\t\n\t\tBrowser.document.addEventListener(\"click\", function (e:MouseEvent)\n\t\t{\n\t\t\tcontextMenu.style.display = \"none\";\n\t\t}\n\t\t);\n\t\t\n\t\tvar ul:UListElement = Browser.document.createUListElement();\n\t\tul.className = \"dropdown-menu\";\n\t\tul.style.display = \"block\";\n\t\t\n\t\tmenuItems = new StringMap();\n\t\t\n\t\taddContextMenuItemToStringMap(\"New File...\", function ()\n\t\t{\n\t\t\tBootbox.prompt(\"Filename:\", \"New.hx\", function (result:String)\n\t\t\t{\n\t\t\t\tvar filename:String = result;\n\t\t\t\n\t\t\t\tvar template:String = \"\";\n\t\t\t\n\t\t\t\tif (filename != null) \n\t\t\t\t{\n\t\t\t\t\tvar extname = js.Node.path.extname(filename);\n\t\t\t\t\tvar pathToFile:String;\n\t\t\t\t\t\n\t\t\t\t\tif (extname == \".hx\")\n\t\t\t\t\t{\n\t\t\t\t\t\tvar name:String = js.Node.path.basename(filename, extname);\n\t\t\t\t\t\tname = name.substr(0, 1).toUpperCase() + name.substr(1).toLowerCase();\n\t\t\t\t\t\tname = StringTools.replace(name, \" \", \"\");\n\t\t\t\t\t\t\n\t\t\t\t\t\ttemplate = \"package ;\\n\\nclass \" + name + \"\\n{\\n    public function new()\\n    {\\n\\n    }\\n}\";\n\t\t\t\t\t\t\n\t\t\t\t\t\tpathToFile = js.Node.path.join(path, name + \".hx\");\n\t\t\t\t\t}\n\t\t\t\t\telse \n\t\t\t\t\t{\n\t\t\t\t\t\tpathToFile = js.Node.path.join(path, filename);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tjs.Node.fs.writeFile(pathToFile, template, js.Node.NodeC.UTF8, function (error:js.Node.NodeErr):Void\n\t\t\t\t\t{\n\t\t\t\t\t\tFileTree.onFileClick(pathToFile);\n\t\t\t\t\t\tFileTree.load();\n\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\t\n\t\t});\n\t\t\n\t\taddContextMenuItemToStringMap(\"New Folder...\", function ()\n\t\t{\n\t\t\tBootbox.prompt(\"Folder name:\", \"New Folder\", function (result:String)\n\t\t\t{\n\t\t\t\tvar dirname:String = result;\n\t\t\t\n\t\t\t\tif (dirname != null)\n\t\t\t\t{\n\t\t\t\t\tjs.Node.fs.mkdir(js.Node.path.join(path, dirname), function (error):Void\n\t\t\t\t\t{\n\t\t\t\t\t\tFileTree.load();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\t);\n\t\t\t\n\t\t});\n\t\t\n\t\taddContextMenuItemToStringMap(\"Open File\", function ()\n\t\t{\n\t\t\tFileTree.onFileClick(path);\n\t\t});\n\t\t\n\t\taddContextMenuItemToStringMap(\"Open using OS\", function ()\n\t\t{\n\t\t\tShell.openItem(path);\n\t\t});\n\t\t\n\t\taddContextMenuItemToStringMap(\"Show Item In Folder\", function ()\n\t\t{\n\t\t\tShell.showItemInFolder(path);\n\t\t});\n\t\t\n\t\taddContextMenuItemToStringMap(\"Refresh\", FileTree.load);\n\t\t\n\t\tul.appendChild(menuItems.get(\"New File...\"));\n\t\tul.appendChild(menuItems.get(\"New Folder...\"));\n\t\tul.appendChild(menuItems.get(\"Open File\"));\n\t\tul.appendChild(menuItems.get(\"Open using OS\"));\n\t\tul.appendChild(menuItems.get(\"Show Item In Folder\"));\n\t\tul.appendChild(menuItems.get(\"Refresh\"));\n\t\t\n\t\tcontextMenu.appendChild(ul);\n\t\t\n\t\tBrowser.document.body.appendChild(contextMenu);\n\t\t\n\t\tFileTree.treeWell.addEventListener('contextmenu', function(ev:MouseEvent) \n\t\t{ \n\t\t\titemType = cast(ev.target, Element).getAttribute(\"itemType\");\n\t\t\tpath = cast(ev.target, Element).getAttribute(\"path\");\n\t\t\t\n\t\t\tmenuItems.get(\"New File...\").style.display = \"none\";\n\t\t\tmenuItems.get(\"New Folder...\").style.display = \"none\";\n\t\t\tmenuItems.get(\"Open File\").style.display = \"none\";\n\t\t\tmenuItems.get(\"Open using OS\").style.display = \"none\";\n\t\t\tmenuItems.get(\"Show Item In Folder\").style.display = \"none\";\n\t\t\t\n\t\t\tif (itemType != null) \n\t\t\t{\n\t\t\t\tswitch (itemType) \n\t\t\t\t{\n\t\t\t\t\tcase \"file\":\n\t\t\t\t\t\tmenuItems.get(\"Open File\").style.display = \"\";\n\t\t\t\t\t\tmenuItems.get(\"Open using OS\").style.display = \"\";\n\t\t\t\t\t\tmenuItems.get(\"Show Item In Folder\").style.display = \"\";\n\t\t\t\t\tcase \"folder\":\n\t\t\t\t\t\tmenuItems.get(\"New File...\").style.display = \"\";\n\t\t\t\t\t\tmenuItems.get(\"New Folder...\").style.display = \"\";\n\t\t\t\t\t\tmenuItems.get(\"Show Item In Folder\").style.display = \"\";\n\t\t\t\t\tdefault:\n\t\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tev.preventDefault();\n\t\t\t\t\n\t\t\tcontextMenu.style.display = \"block\";\n\t\t\tcontextMenu.style.left = Std.string(ev.pageX) + \"px\";\n\t\t\tcontextMenu.style.top = Std.string(ev.pageY) + \"px\";\n\t\t\t\n\t\t\treturn false;\n\t\t}\n\t\t);\n\t}\n\t\n\tpublic static function createContextMenuItem(text:String, onClick:Dynamic):LIElement\n\t{\n\t\tvar li:LIElement = Browser.document.createLIElement();\n\t\tli.onclick = function (e:MouseEvent):Void\n\t\t{\n\t\t\tonClick();\n\t\t};\n\t\t\n\t\tvar a:AnchorElement = Browser.document.createAnchorElement();\n\t\ta.href = \"#\";\n\t\ta.textContent = text;\n\t\tli.appendChild(a);\n\t\t\n\t\treturn li;\n\t}\n\t\n\tprivate static function addContextMenuItemToStringMap(text:String, ?onClick:Dynamic):Void\n\t{\n\t\tmenuItems.set(text, createContextMenuItem(text, onClick));\n\t}\n}","package filetree;\r\nimport core.Splitpane;\r\nimport jQuery.JQuery;\r\nimport js.Browser;\r\nimport js.html.AnchorElement;\r\nimport js.html.DivElement;\r\nimport js.html.LIElement;\r\nimport js.html.MouseEvent;\r\nimport js.html.UListElement;\r\n\r\n/**\r\n * ...\r\n * @author AS3Boyan\r\n */\r\n@:keepSub @:expose class FileTree\r\n{\t\r\n\tpublic static var onFileClick:Dynamic;\r\n\tprivate static var lastProjectName:String;\r\n\tprivate static var lastProjectPath:String;\r\n\tpublic static var treeWell:DivElement;\r\n\t\r\n\tpublic static function init():Void\r\n\t{\r\n\t\t//<div id=\"tree_well\" class=\"well\" style=\"overflow: auto; padding: 0; margin: 0; width: 100%; height: 100%; font-size: 10pt; line-height: 1;\">\r\n\t\t\t//<ul id=\"tree\" class=\"nav nav-list\" style=\"padding: 5px 0px;\">\r\n\t\t\t//</ul>\r\n\t\t//</div>\r\n\t\t\r\n\t\tvar splitPaneComponent:DivElement = cast(Splitpane.components[0], DivElement);\r\n\t\t\r\n\t\ttreeWell = Browser.document.createDivElement();\r\n\t\ttreeWell.id = \"tree-well\";\r\n\t\ttreeWell.className = \"well\";\r\n\t\t\r\n\t\tvar tree:UListElement = Browser.document.createUListElement();\r\n\t\ttree.className = \"nav nav-list\";\r\n\t\ttree.id = \"tree\";\r\n\t\ttreeWell.appendChild(tree);\r\n\t\t\r\n\t\tsplitPaneComponent.appendChild(treeWell);\r\n\t\t\r\n\t\tload(\"HIDE\", \"../\");\r\n\t\t\r\n\t\tContextMenu.createContextMenu();\r\n\t}\r\n\t\r\n\tpublic static function load(?projectName:String, ?path:String):Void\r\n\t{\t\t\r\n\t\tif (projectName == null)\r\n\t\t{\r\n\t\t\tprojectName = lastProjectName;\r\n\t\t}\r\n\t\t\r\n\t\tif (path == null)\r\n\t\t{\r\n\t\t\tpath = lastProjectPath;\r\n\t\t}\r\n\t\t\r\n\t\tvar tree:UListElement = cast(Browser.document.getElementById(\"tree\"), UListElement);\r\n\t\t\r\n\t\tnew JQuery(tree).children().remove();\r\n\t\t\r\n\t\tvar rootTreeElement:LIElement = createDirectoryElement(projectName, path);\t\t\r\n\t\t\r\n\t\ttree.appendChild(rootTreeElement);\r\n\t\t\r\n\t\treadDir(path, rootTreeElement);\r\n\t\t\r\n\t\tlastProjectName = projectName;\r\n\t\tlastProjectPath = path;\r\n\t}\r\n\t\r\n\tprivate static function createDirectoryElement(text:String, path:String):LIElement\r\n\t{\r\n\t\tvar directoryElement:LIElement = Browser.document.createLIElement();\r\n\t\t\r\n\t\tvar a:AnchorElement = Browser.document.createAnchorElement();\r\n\t\ta.className = \"tree-toggler nav-header\";\r\n\t\ta.href = \"#\";\r\n\t\ta.setAttribute(\"path\", path);\r\n\t\ta.setAttribute(\"itemType\", \"folder\");\r\n\t\t\r\n\t\tvar span = Browser.document.createSpanElement();\r\n\t\tspan.className = \"glyphicon glyphicon-folder-open\";\r\n\t\tspan.setAttribute(\"path\", path);\r\n\t\tspan.setAttribute(\"itemType\", \"folder\");\r\n\t\ta.appendChild(span);\r\n\t\t\r\n\t\tspan = Browser.document.createSpanElement();\r\n\t\tspan.textContent = text;\r\n\t\tspan.style.marginLeft = \"5px\";\r\n\t\tspan.setAttribute(\"path\", path);\r\n\t\tspan.setAttribute(\"itemType\", \"folder\");\r\n\t\ta.appendChild(span);\r\n\t\t\r\n\t\t//var textNode = Browser.document.createTextNode(text);\r\n\t\t//a.appendChild(textNode);\r\n\t\t\r\n\t\ta.onclick = function (e:MouseEvent):Void\r\n\t\t{\r\n\t\t\tnew JQuery(directoryElement).children('ul.tree').toggle(300);\r\n\t\t\t//Main.resize();\r\n\t\t};\r\n\t\t\r\n\t\t//var label:LabelElement = Browser.document.createLabelElement();\r\n\t\t//label.className = \"tree-toggler nav-header\";\r\n\t\t//label.textContent = text;\r\n\t\t\r\n\t\tdirectoryElement.appendChild(a);\r\n\t\t\r\n\t\tvar ul:UListElement = Browser.document.createUListElement();\r\n\t\tul.className = \"nav nav-list tree\";\r\n\t\t\r\n\t\tdirectoryElement.appendChild(ul);\r\n\t\t\r\n\t\treturn directoryElement;\r\n\t}\r\n\t\r\n\tprivate static function readDir(path:String, topElement:LIElement):Void\r\n\t{\r\n\t\tjs.Node.fs.readdir(path, function (error:js.Node.NodeErr, files:Array<String>):Void\r\n\t\t{\t\t\t\r\n\t\t\tif (files != null)\r\n\t\t\t{\r\n\t\t\t\tvar foldersCount:Int = 0;\r\n\t\t\t\r\n\t\t\t\tfor (file in files)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar filePath:String = js.Node.path.join(path, file);\r\n\t\t\t\t\t\r\n\t\t\t\t\tjs.Node.fs.stat(filePath, function (error:js.Node.NodeErr, stat:js.Node.NodeStat)\r\n\t\t\t\t\t{\t\t\t\t\t\r\n\t\t\t\t\t\tif (stat.isFile())\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar li:LIElement = Browser.document.createLIElement();\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tvar a:AnchorElement = Browser.document.createAnchorElement();\r\n\t\t\t\t\t\t\ta.href = \"#\";\r\n\t\t\t\t\t\t\ta.textContent = file;\r\n\t\t\t\t\t\t\ta.title = filePath;\r\n\t\t\t\t\t\t\ta.setAttribute(\"path\", filePath);\r\n\t\t\t\t\t\t\ta.setAttribute(\"itemType\", \"file\");\r\n\t\t\t\t\t\t\ta.onclick = function (e):Void\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tif (onFileClick != null)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tonFileClick(filePath);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (StringTools.endsWith(file, \".hx\"))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\ta.style.fontWeight = \"bold\";\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (StringTools.endsWith(file, \".hxml\"))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\ta.style.fontWeight = \"bold\";\r\n\t\t\t\t\t\t\t\ta.style.color = \"gray\";\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\ta.style.color = \"gray\";\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tli.appendChild(a);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tvar ul:UListElement = cast(topElement.getElementsByTagName(\"ul\")[0], UListElement);\r\n\t\t\t\t\t\t\tul.appendChild(li);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (!StringTools.startsWith(file, \".\"))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tvar ul:UListElement = cast(topElement.getElementsByTagName(\"ul\")[0], UListElement);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar directoryElement:LIElement = createDirectoryElement(file, filePath);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t//Lazy loading\r\n\t\t\t\t\t\t\t\tdirectoryElement.onclick = function (e):Void\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tif (directoryElement.getElementsByTagName(\"ul\")[0].childNodes.length == 0)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\treadDir(filePath, directoryElement);\r\n\t\t\t\t\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\tdirectoryElement.onclick = null;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tul.appendChild(directoryElement);\r\n\t\t\t\t\t\t\t\tul.insertBefore(directoryElement, ul.childNodes[foldersCount]);\r\n\t\t\t\t\t\t\t\tfoldersCount++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tnew JQuery(topElement).children('ul.tree').show(300);\r\n\t\t\t}\r\n\t\t}\r\n\t\t);\r\n\t}\r\n\t\r\n}","package haxe;\r\n\r\n#if (nodejs && !macro)\r\nimport js.Node;\r\n\r\nclass Json\r\n{\r\n\tinline public static function stringify (obj :Dynamic, ?replacer : Dynamic -> Dynamic -> Dynamic, ?insertion :Dynamic) :String\r\n\t{\r\n\t\treturn Node.json.stringify(obj, replacer, insertion);\r\n\t}\r\n\r\n\tinline public static function parse (jsonString :String) :Dynamic\r\n\t{\r\n\t\treturn Node.json.parse(jsonString);\r\n\t}\r\n}\r\n#else\r\n\r\n/*\r\n * Copyright (C)2005-2012 Haxe Foundation\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a\r\n * copy of this software and associated documentation files (the \"Software\"),\r\n * to deal in the Software without restriction, including without limitation\r\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\r\n * and/or sell copies of the Software, and to permit persons to whom the\r\n * Software is furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\r\n * DEALINGS IN THE SOFTWARE.\r\n */\r\n/**\r\n\tCrossplatform JSON API : it will automatically use the optimized native API if available.\r\n\tUse -D haxeJSON to force usage of the Haxe implementation even if a native API is found : this will provide\r\n\textra encoding features such as enums (replaced by their index), Hashs and Iterable.\r\n**/\r\n#if (flash11 && !haxeJSON)\r\n@:native('JSON') extern\r\n#end\r\nclass Json {\r\n\r\n#if (haxeJSON || !flash11)\r\n\tvar buf : #if flash9 flash.utils.ByteArray #else StringBuf #end;\r\n\tvar str : String;\r\n\tvar pos : Int;\r\n\r\n\tfunction new() {\r\n\t}\r\n\r\n\t@:extern inline function addChar(c:Int) {\r\n\t\t#if flash9\r\n\t\tbuf.writeByte(c);\r\n\t\t#else\r\n\t\tbuf.addChar(c);\r\n\t\t#end\r\n\t}\r\n\r\n\t@:extern inline function add(v:String) {\r\n\t\t#if flash9\r\n\t\t// argument is not always a string but will be automatically casted\r\n\t\tbuf.writeUTFBytes(v);\r\n\t\t#else\r\n\t\tbuf.add(v);\r\n\t\t#end\r\n\t}\r\n\r\n\tvar replacer:Dynamic -> Dynamic -> Dynamic;\r\n\r\n\tfunction toString(v:Dynamic, ?replacer:Dynamic -> Dynamic -> Dynamic) {\r\n\t\t#if flash9\r\n\t\tbuf = new flash.utils.ByteArray();\r\n\t\tbuf.endian = flash.utils.Endian.BIG_ENDIAN;\r\n\t\tbuf.position = 0;\r\n\t\t#else\r\n\t\tbuf = new StringBuf();\r\n\t\t#end\r\n\t\tthis.replacer = replacer;\r\n\t\ttoStringRec(\"\", v);\r\n\t\treturn buf.toString();\r\n\t}\r\n\r\n\tfunction fieldsString( v : Dynamic, fields : Array<String> )\r\n\t{\r\n\t\tvar first = true;\r\n\t\taddChar('{'.code);\r\n\t\tfor( f in fields ) {\r\n\t\t\tvar value = Reflect.field(v,f);\r\n\t\t\tif( Reflect.isFunction(value) ) continue;\r\n\t\t\tif( first ) first = false else addChar(','.code);\r\n\t\t\tquote(f);\r\n\t\t\taddChar(':'.code);\r\n\t\t\ttoStringRec(f, value);\r\n\t\t}\r\n\t\taddChar('}'.code);\r\n\t}\r\n\r\n\t#if flash9\r\n\tfunction classString ( v : Dynamic ) {\r\n\t\tfieldsString(v,Type.getInstanceFields(Type.getClass(v)));\r\n\t}\r\n\t#end\r\n\r\n\tfunction objString( v : Dynamic ) {\r\n\t\tfieldsString(v,Reflect.fields(v));\r\n\t}\r\n\r\n\tfunction toStringRec(k:Dynamic, v:Dynamic) {\r\n\t\tif (replacer != null) v = replacer(k, v);\r\n\t\tswitch( Type.typeof(v) ) {\r\n\t\tcase TUnknown:\r\n\t\t\tadd('\"???\"');\r\n\t\tcase TObject:\r\n\t\t\tobjString(v);\r\n\t\tcase TInt:\r\n\t\t\tadd(v);\r\n\t\tcase TFloat:\r\n\t\t\tadd(Math.isFinite(v) ? v : 'null');\r\n\t\tcase TFunction:\r\n\t\t\tadd('\"<fun>\"');\r\n\t\tcase TClass(c):\r\n\t\t\tif( c == String )\r\n\t\t\t\tquote(v);\r\n\t\t\telse if( c == Array ) {\r\n\t\t\t\tvar v : Array<Dynamic> = v;\r\n\t\t\t\taddChar('['.code);\r\n\t\t\t\tvar len = v.length;\r\n\t\t\t\tif( len > 0 ) {\r\n\t\t\t\t\ttoStringRec(0, v[0]);\r\n\t\t\t\t\tvar i = 1;\r\n\t\t\t\t\twhile( i < len ) {\r\n\t\t\t\t\t\taddChar(','.code);\r\n\t\t\t\t\t\ttoStringRec(i, v[i++]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\taddChar(']'.code);\r\n\t\t\t} else if( c == haxe.ds.StringMap ) {\r\n\t\t\t\tvar v : haxe.ds.StringMap<Dynamic> = v;\r\n\t\t\t\tvar o = {};\r\n\t\t\t\tfor( k in v.keys() )\r\n\t\t\t\t\tReflect.setField(o,k,v.get(k));\r\n\t\t\t\tobjString(o);\r\n\t\t\t} else\r\n\t\t\t\t#if flash9\r\n\t\t\t\tclassString(v);\r\n\t\t\t\t#else\r\n\t\t\t\tobjString(v);\r\n\t\t\t\t#end\r\n\t\tcase TEnum(_):\r\n\t\t\tvar i : Dynamic = Type.enumIndex(v);\r\n\t\t\tadd(i);\r\n\t\tcase TBool:\r\n\t\t\tadd(#if php (v ? 'true' : 'false') #else v #end);\r\n\t\tcase TNull:\r\n\t\t\tadd('null');\r\n\t\t}\r\n\t}\r\n\r\n\tfunction quote( s : String ) {\r\n\t\t#if (neko || php || cpp)\r\n\t\tif( s.length != haxe.Utf8.length(s) ) {\r\n\t\t\tquoteUtf8(s);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t#end\r\n\t\taddChar('\"'.code);\r\n\t\tvar i = 0;\r\n\t\twhile( true ) {\r\n\t\t\tvar c = StringTools.fastCodeAt(s,i++);\r\n\t\t\tif( StringTools.isEof(c) ) break;\r\n\t\t\tswitch( c ) {\r\n\t\t\tcase '\"'.code: add('\\\\\"');\r\n\t\t\tcase '\\\\'.code: add('\\\\\\\\');\r\n\t\t\tcase '\\n'.code: add('\\\\n');\r\n\t\t\tcase '\\r'.code: add('\\\\r');\r\n\t\t\tcase '\\t'.code: add('\\\\t');\r\n\t\t\tcase 8: add('\\\\b');\r\n\t\t\tcase 12: add('\\\\f');\r\n\t\t\tdefault: addChar(c);\r\n\t\t\t}\r\n\t\t}\r\n\t\taddChar('\"'.code);\r\n\t}\r\n\r\n\t#if (neko || php || cpp)\r\n\tfunction quoteUtf8( s : String ) {\r\n\t\tvar u = new haxe.Utf8();\r\n\t\thaxe.Utf8.iter(s,function(c) {\r\n\t\t\tswitch( c ) {\r\n\t\t\tcase '\\\\'.code, '\"'.code: u.addChar('\\\\'.code); u.addChar(c);\r\n\t\t\tcase '\\n'.code: u.addChar('\\\\'.code); u.addChar('n'.code);\r\n\t\t\tcase '\\r'.code: u.addChar('\\\\'.code); u.addChar('r'.code);\r\n\t\t\tcase '\\t'.code: u.addChar('\\\\'.code); u.addChar('t'.code);\r\n\t\t\tcase 8: u.addChar('\\\\'.code); u.addChar('b'.code);\r\n\t\t\tcase 12: u.addChar('\\\\'.code); u.addChar('f'.code);\r\n\t\t\tdefault: u.addChar(c);\r\n\t\t\t}\r\n\t\t});\r\n\t\tbuf.add('\"');\r\n\t\tbuf.add(u.toString());\r\n\t\tbuf.add('\"');\r\n\t}\r\n\t#end\r\n\r\n\tfunction doParse( str : String ) {\r\n\t\tthis.str = str;\r\n\t\tthis.pos = 0;\r\n\t\treturn parseRec();\r\n\t}\r\n\r\n\tfunction invalidChar() {\r\n\t\tpos--; // rewind\r\n\t\tthrow \"Invalid char \"+StringTools.fastCodeAt(str,pos)+\" at position \"+pos;\r\n\t}\r\n\r\n\tinline function nextChar() {\r\n\t\treturn StringTools.fastCodeAt(str,pos++);\r\n\t}\r\n\r\n\tfunction parseRec() : Dynamic {\r\n\t\twhile( true ) {\r\n\t\t\tvar c = nextChar();\r\n\t\t\tswitch( c ) {\r\n\t\t\tcase ' '.code, '\\r'.code, '\\n'.code, '\\t'.code:\r\n\t\t\t\t// loop\r\n\t\t\tcase '{'.code:\r\n\t\t\t\tvar obj = {}, field = null, comma : Null<Bool> = null;\r\n\t\t\t\twhile( true ) {\r\n\t\t\t\t\tvar c = nextChar();\r\n\t\t\t\t\tswitch( c ) {\r\n\t\t\t\t\tcase ' '.code, '\\r'.code, '\\n'.code, '\\t'.code:\r\n\t\t\t\t\t\t// loop\r\n\t\t\t\t\tcase '}'.code:\r\n\t\t\t\t\t\tif( field != null || comma == false )\r\n\t\t\t\t\t\t\tinvalidChar();\r\n\t\t\t\t\t\treturn obj;\r\n\t\t\t\t\tcase ':'.code:\r\n\t\t\t\t\t\tif( field == null )\r\n\t\t\t\t\t\t\tinvalidChar();\r\n\t\t\t\t\t\tReflect.setField(obj,field,parseRec());\r\n\t\t\t\t\t\tfield = null;\r\n\t\t\t\t\t\tcomma = true;\r\n\t\t\t\t\tcase ','.code:\r\n\t\t\t\t\t\tif( comma ) comma = false else invalidChar();\r\n\t\t\t\t\tcase '\"'.code:\r\n\t\t\t\t\t\tif( comma ) invalidChar();\r\n\t\t\t\t\t\tfield = parseString();\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tinvalidChar();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\tcase '['.code:\r\n\t\t\t\tvar arr = [], comma : Null<Bool> = null;\r\n\t\t\t\twhile( true ) {\r\n\t\t\t\t\tvar c = nextChar();\r\n\t\t\t\t\tswitch( c ) {\r\n\t\t\t\t\tcase ' '.code, '\\r'.code, '\\n'.code, '\\t'.code:\r\n\t\t\t\t\t\t// loop\r\n\t\t\t\t\tcase ']'.code:\r\n\t\t\t\t\t\tif( comma == false ) invalidChar();\r\n\t\t\t\t\t\treturn arr;\r\n\t\t\t\t\tcase ','.code:\r\n\t\t\t\t\t\tif( comma ) comma = false else invalidChar();\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tif( comma ) invalidChar();\r\n\t\t\t\t\t\tpos--;\r\n\t\t\t\t\t\tarr.push(parseRec());\r\n\t\t\t\t\t\tcomma = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\tcase 't'.code:\r\n\t\t\t\tvar save = pos;\r\n\t\t\t\tif( nextChar() != 'r'.code || nextChar() != 'u'.code || nextChar() != 'e'.code ) {\r\n\t\t\t\t\tpos = save;\r\n\t\t\t\t\tinvalidChar();\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\tcase 'f'.code:\r\n\t\t\t\tvar save = pos;\r\n\t\t\t\tif( nextChar() != 'a'.code || nextChar() != 'l'.code || nextChar() != 's'.code || nextChar() != 'e'.code ) {\r\n\t\t\t\t\tpos = save;\r\n\t\t\t\t\tinvalidChar();\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\tcase 'n'.code:\r\n\t\t\t\tvar save = pos;\r\n\t\t\t\tif( nextChar() != 'u'.code || nextChar() != 'l'.code || nextChar() != 'l'.code ) {\r\n\t\t\t\t\tpos = save;\r\n\t\t\t\t\tinvalidChar();\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\tcase '\"'.code:\r\n\t\t\t\treturn parseString();\r\n\t\t\tcase '0'.code, '1'.code,'2'.code,'3'.code,'4'.code,'5'.code,'6'.code,'7'.code,'8'.code,'9'.code,'-'.code:\r\n\t\t\t\treturn parseNumber(c);\r\n\t\t\tdefault:\r\n\t\t\t\tinvalidChar();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseString() {\r\n\t\tvar start = pos;\r\n\t\tvar buf = new StringBuf();\r\n\t\twhile( true ) {\r\n\t\t\tvar c = nextChar();\r\n\t\t\tif( c == '\"'.code )\r\n\t\t\t\tbreak;\r\n\t\t\tif( c == '\\\\'.code ) {\r\n\t\t\t\tbuf.addSub(str,start, pos - start - 1);\r\n\t\t\t\tc = nextChar();\r\n\t\t\t\tswitch( c ) {\r\n\t\t\t\tcase \"r\".code: buf.addChar(\"\\r\".code);\r\n\t\t\t\tcase \"n\".code: buf.addChar(\"\\n\".code);\r\n\t\t\t\tcase \"t\".code: buf.addChar(\"\\t\".code);\r\n\t\t\t\tcase \"b\".code: buf.addChar(8);\r\n\t\t\t\tcase \"f\".code: buf.addChar(12);\r\n\t\t\t\tcase \"/\".code, '\\\\'.code, '\"'.code: buf.addChar(c);\r\n\t\t\t\tcase 'u'.code:\r\n\t\t\t\t\tvar uc = Std.parseInt(\"0x\" + str.substr(pos, 4));\r\n\t\t\t\t\tpos += 4;\r\n\t\t\t\t\t#if (neko || php || cpp)\r\n\t\t\t\t\tif( uc <= 0x7F )\r\n\t\t\t\t\t\tbuf.addChar(uc);\r\n\t\t\t\t\telse if( uc <= 0x7FF ) {\r\n\t\t\t\t\t\tbuf.addChar(0xC0 | (uc >> 6));\r\n\t\t\t\t\t\tbuf.addChar(0x80 | (uc & 63));\r\n\t\t\t\t\t} else if( uc <= 0xFFFF ) {\r\n\t\t\t\t\t\tbuf.addChar(0xE0 | (uc >> 12));\r\n\t\t\t\t\t\tbuf.addChar(0x80 | ((uc >> 6) & 63));\r\n\t\t\t\t\t\tbuf.addChar(0x80 | (uc & 63));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbuf.addChar(0xF0 | (uc >> 18));\r\n\t\t\t\t\t\tbuf.addChar(0x80 | ((uc >> 12) & 63));\r\n\t\t\t\t\t\tbuf.addChar(0x80 | ((uc >> 6) & 63));\r\n\t\t\t\t\t\tbuf.addChar(0x80 | (uc & 63));\r\n\t\t\t\t\t}\r\n\t\t\t\t\t#else\r\n\t\t\t\t\tbuf.addChar(uc);\r\n\t\t\t\t\t#end\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthrow \"Invalid escape sequence \\\\\" + String.fromCharCode(c) + \" at position \" + (pos - 1);\r\n\t\t\t\t}\r\n\t\t\t\tstart = pos;\r\n\t\t\t}\r\n\t\t\t#if (neko || php || cpp)\r\n\t\t\t// ensure utf8 chars are not cut\r\n\t\t\telse if( c >= 0x80 ) {\r\n\t\t\t\tpos++;\r\n\t\t\t\tif( c >= 0xFC ) pos += 4;\r\n\t\t\t\telse if( c >= 0xF8 ) pos += 3;\r\n\t\t\t\telse if( c >= 0xF0 ) pos += 2;\r\n\t\t\t\telse if( c >= 0xE0 ) pos++;\r\n\t\t\t}\r\n\t\t\t#end\r\n\t\t\telse if( StringTools.isEof(c) )\r\n\t\t\t\tthrow \"Unclosed string\";\r\n\t\t}\r\n\t\tbuf.addSub(str,start, pos - start - 1);\r\n\t\treturn buf.toString();\r\n\t}\r\n\r\n\tfunction invalidNumber( start : Int ) {\r\n\t\tthrow \"Invalid number at position \"+start+\": \" + str.substr(start, pos - start);\r\n\t}\r\n\r\n\tinline function parseNumber( c : Int ) {\r\n\t\tvar start = pos - 1;\r\n\t\tvar minus = c == '-'.code, digit = !minus, zero = c == '0'.code;\r\n\t\tvar point = false, e = false, pm = false, end = false;\r\n\t\twhile( true ) {\r\n\t\t\tc = nextChar();\r\n\t\t\tswitch( c ) {\r\n\t\t\t\tcase '0'.code :\r\n\t\t\t\t\tif (zero && !point) invalidNumber(start);\r\n\t\t\t\t\tif (minus) {\r\n\t\t\t\t\t\tminus = false; zero = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdigit = true;\r\n\t\t\t\tcase '1'.code,'2'.code,'3'.code,'4'.code,'5'.code,'6'.code,'7'.code,'8'.code,'9'.code :\r\n\t\t\t\t\tif (zero && !point) invalidNumber(start);\r\n\t\t\t\t\tif (minus) minus = false;\r\n\t\t\t\t\tdigit = true; zero = false;\r\n\t\t\t\tcase '.'.code :\r\n\t\t\t\t\tif (minus || point) invalidNumber(start);\r\n\t\t\t\t\tdigit = false; point = true;\r\n\t\t\t\tcase 'e'.code, 'E'.code :\r\n\t\t\t\t\tif (minus || zero || e) invalidNumber(start);\r\n\t\t\t\t\tdigit = false; e = true;\r\n\t\t\t\tcase '+'.code, '-'.code :\r\n\t\t\t\t\tif (!e || pm) invalidNumber(start);\r\n\t\t\t\t\tdigit = false; pm = true;\r\n\t\t\t\tdefault :\r\n\t\t\t\t\tif (!digit) invalidNumber(start);\r\n\t\t\t\t\tpos--;\r\n\t\t\t\t\tend = true;\r\n\t\t\t}\r\n\t\t\tif (end) break;\r\n\t\t}\r\n\t\tvar f = Std.parseFloat(str.substr(start, pos - start));\r\n\t\tvar i = Std.int(f);\r\n\t\treturn if( i == f ) i else f;\r\n\t}\r\n\r\n#end\r\n\r\n\tpublic static function parse( text : String ) : Dynamic {\r\n\t\t#if (php && !haxeJSON)\r\n\t\treturn phpJsonDecode(text);\r\n\t\t#elseif (flash11 && !haxeJSON)\r\n\t\treturn null;\r\n\t\t#else\r\n\t\treturn new Json().doParse(text);\r\n\t\t#end\r\n\t}\r\n\r\n\tpublic static function stringify( value : Dynamic, ?replacer:Dynamic -> Dynamic -> Dynamic ) : String {\r\n\t\t#if (php && !haxeJSON)\r\n\t\treturn phpJsonEncode(value);\r\n\t\t#elseif (flash11 && !haxeJSON)\r\n\t\treturn null;\r\n\t\t#else\r\n\t\treturn new Json().toString(value, replacer);\r\n\t\t#end\r\n\t}\r\n\r\n\t#if !haxeJSON\r\n\t\t#if js\r\n\t\tstatic function __init__() untyped {\r\n\t\t\tif( __js__('typeof(JSON)') != 'undefined' )\r\n\t\t\t\tJson = __js__('JSON');\r\n\t\t}\r\n\t\t#end\r\n\t#end\r\n\r\n\t#if php\r\n\tstatic function phpJsonDecode(json:String):Dynamic {\r\n\t\tvar val = untyped __call__(\"json_decode\", json);\r\n\t\treturn convertAfterDecode(val);\r\n\t}\r\n\r\n\tstatic function convertAfterDecode(val:Dynamic):Dynamic {\r\n\t\tvar arr:php.NativeArray;\r\n\t\tif (untyped __call__(\"is_object\", val)) {\r\n\t\t\tarr = phpMapArray(php.Lib.associativeArrayOfObject(val), convertAfterDecode);\r\n\t\t\treturn untyped __call__(\"_hx_anonymous\", arr);\r\n\t\t}\r\n\t\telse if (untyped __call__(\"is_array\", val)) {\r\n\t\t\tarr = phpMapArray(val, convertAfterDecode);\r\n\t\t\treturn php.Lib.toHaxeArray(arr);\r\n\t\t}\r\n\t\telse\r\n\t\t\treturn val;\r\n\t}\r\n\r\n\tstatic function phpJsonEncode(val:Dynamic):String {\r\n\t\tvar json = untyped __call__(\"json_encode\", convertBeforeEncode(val));\r\n\t\tif (untyped __physeq__(json, false))\r\n\t\t\treturn throw \"invalid json\";\r\n\t\telse\r\n\t\t\treturn json;\r\n\t}\r\n\r\n\tstatic function convertBeforeEncode(val:Dynamic):Dynamic {\r\n\t\tvar arr:php.NativeArray;\r\n\t\tif (untyped __call__(\"is_object\", val)) {\r\n\t\t\tswitch (untyped __call__(\"get_class\", val)) {\r\n\t\t\t\tcase \"_hx_anonymous\", \"stdClass\" : arr = php.Lib.associativeArrayOfObject(val);\r\n\t\t\t\tcase \"_hx_array\" : arr = php.Lib.toPhpArray(val);\r\n\t\t\t\tcase \"Date\" : return Std.string(val); //.split(\" \").join(\"T\"); //better with \"T\"?\r\n\t\t\t\tcase \"HList\" : arr = php.Lib.toPhpArray(Lambda.array(val)); //convert List to array?\r\n\t\t\t\tcase \"_hx_enum\" : return Type.enumIndex(val);\r\n\t\t\t\tcase \"StringMap\", \"IntMap\" : arr = php.Lib.associativeArrayOfHash(val);\r\n\t\t\t\tdefault : arr = php.Lib.associativeArrayOfObject(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (untyped __call__(\"is_array\", val)) arr = val;\r\n\t\telse {\r\n\t\t\tif (untyped __call__(\"is_float\",val) && !__call__(\"is_finite\",val)) val = null;\r\n\t\t\treturn val;\r\n\t\t}\r\n\t\treturn phpMapArray(arr, convertBeforeEncode);\r\n\t}\r\n\r\n\tinline static function phpMapArray(arr:php.NativeArray\r\n\t, func:Dynamic->Dynamic):php.NativeArray {\r\n\t\treturn untyped __call__(\"array_map\", func, arr);\r\n\t}\r\n\r\n\t#end\r\n\r\n}\r\n\r\n#end\r\n\r\n","/*\n * Copyright (C)2005-2013 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe;\n\n/**\n\tResource can be used to access resources that were added through the\n\t-resource file@name command line parameter.\n\n\tDepending on their type they can be obtained as String through\n\tgetString(name), or as binary data through getBytes(name).\n\n\tA list of all available resource names can be obtained from listNames().\n**/\nclass Resource {\n\n\t#if (java || cs)\n\t@:keep static var content : Array<String>;\n\t#else\n\tstatic var content : Array<{ name : String, data : String, str : String }>;\n\t#end\n\n\t#if cs\n\tstatic var paths : haxe.ds.StringMap<String>;\n\n\t#if cs @:keep #end private static function getPaths():haxe.ds.StringMap<String>\n\t{\n\t\tif (paths != null)\n\t\t\treturn paths;\n\t\tvar p = new haxe.ds.StringMap();\n\t\tvar all = cs.Lib.toNativeType(haxe.Resource).Assembly.GetManifestResourceNames();\n\t\tfor (i in 0...all.Length)\n\t\t{\n\t\t\tvar path = all[i];\n\t\t\tvar name = path.substr(path.indexOf(\"Resources.\") + 10);\n\t\t\tp.set(name, path);\n\t\t}\n\n\t\treturn paths = p;\n\t}\n\t#end\n\n\t/**\n\t\tLists all available resource names. The resource name is the name part\n\t\tof the -resource file@name command line parameter.\n\t**/\n\tpublic static function listNames() : Array<String> {\n\t\tvar names = new Array();\n\t\t#if (java || cs)\n\t\tfor ( x in content )\n\t\t\tnames.push(x);\n\t\t#else\n\t\tfor ( x in content )\n\t\t\tnames.push(x.name);\n\t\t#end\n\t\treturn names;\n\t}\n\n\t/**\n\t\tRetrieves the resource identified by `name` as a String.\n\n\t\tIf `name` does not match any resource name, null is returned.\n\t**/\n\tpublic static function getString( name : String ) : String {\n\t\t#if java\n\t\tvar stream = cast(Resource, java.lang.Class<Dynamic>).getResourceAsStream(\"/\" + name);\n\t\tif (stream == null)\n\t\t\treturn null;\n\t\tvar stream = new java.io.NativeInput(stream);\n\t\treturn stream.readAll().toString();\n\t\t#elseif cs\n\t\tvar path = getPaths().get(name);\n\t\tvar str = cs.Lib.toNativeType(haxe.Resource).Assembly.GetManifestResourceStream(path);\n\t\tif (str != null)\n\t\t\treturn new cs.io.NativeInput(str).readAll().toString();\n\t\treturn null;\n\t\t#else\n\t\tfor( x in content )\n\t\t\tif( x.name == name ) {\n\t\t\t\t#if neko\n\t\t\t\treturn new String(x.data);\n\t\t\t\t#else\n\t\t\t\tif( x.str != null ) return x.str;\n\t\t\t\tvar b : haxe.io.Bytes = haxe.crypto.Base64.decode(x.data);\n\t\t\t\treturn b.toString();\n\t\t\t\t#end\n\t\t\t}\n\t\treturn null;\n\t\t#end\n\t}\n\n\t/**\n\t\tRetrieves the resource identified by `name` as an instance of\n\t\thaxe.io.Bytes.\n\n\t\tIf `name` does not match any resource name, null is returned.\n\t**/\n\tpublic static function getBytes( name : String ) : haxe.io.Bytes {\n\t\t#if java\n\t\tvar stream = cast(Resource, java.lang.Class<Dynamic>).getResourceAsStream(\"/\" + name);\n\t\tif (stream == null)\n\t\t\treturn null;\n\t\tvar stream = new java.io.NativeInput(stream);\n\t\treturn stream.readAll();\n\t\t#elseif cs\n\t\tvar path = getPaths().get(name);\n\t\tvar str = cs.Lib.toNativeType(haxe.Resource).Assembly.GetManifestResourceStream(path);\n\t\tif (str != null)\n\t\t\treturn new cs.io.NativeInput(str).readAll();\n\t\treturn null;\n\t\t#else\n\t\tfor( x in content )\n\t\t\tif( x.name == name ) {\n\t\t\t\t#if neko\n\t\t\t\treturn haxe.io.Bytes.ofData(cast x.data);\n\t\t\t\t#else\n\t\t\t\tif( x.str != null ) return haxe.io.Bytes.ofString(x.str);\n\t\t\t\treturn haxe.crypto.Base64.decode(x.data);\n\t\t\t\t#end\n\t\t\t}\n\t\treturn null;\n\t\t#end\n\t}\n\n\tstatic function __init__() {\n\t\t#if neko\n\t\tvar tmp = untyped __resources__();\n\t\tcontent = untyped Array.new1(tmp,__dollar__asize(tmp));\n\t\t#elseif php\n\t\tcontent = null;\n\t\t#elseif as3\n\t\tnull;\n\t\t#elseif (java || cs)\n\t\t//do nothing\n\t\t#else\n\t\tcontent = untyped __resources__();\n\t\t#end\n\t}\n\n}\n","/*\n * Copyright (C)2005-2013 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe;\n\n/**\n\tThe Serializer class can be used to encode values and objects into a String,\n\tfrom which the Unserializer class can recreate the original representation.\n\n\tThis class can be used in two ways:\n\t\n\t- create a new Serializer() instance, call its serialize() method with\n\t\tany argument and finally retrieve the String representation from\n\t\ttoString()\n\t- call Serializer.run() to obtain the serialized representation of a\n\t\tsingle argument\n\n\tSerialization is guaranteed to work for all haxe-defined classes, but may\n\tor may not work for instances of external/native classes.\n\n\tThe specification of the serialization format can be found here:\n\t`http://haxe.org/manual/serialization/format`\n**/\nclass Serializer {\n\n\t/**\n\t\tIf the values you are serializing can contain circular references or\n\t\tobjects repetitions, you should set USE_CACHE to true to prevent\n\t\tinfinite loops.\n\n\t\tThis may also reduce the size of serialization Strings at the expense of\n\t\tperformance.\n\n\t\tThis value can be changed for individual instances of Serializer by\n\t\tsetting their useCache field.\n\t**/\n\tpublic static var USE_CACHE = false;\n\n\t/**\n\t\tUse constructor indexes for enums instead of names.\n\n\t\tThis may reduce the size of serialization Strings, but makes them less\n\t\tsuited for long-term storage: If constructors are removed or added from\n\t\tthe enum, the indices may no longer match.\n\n\t\tThis value can be changed for individual instances of Serializer by\n\t\tsetting their useEnumIndex field.\n\t**/\n\tpublic static var USE_ENUM_INDEX = false;\n\n\tstatic var BASE64 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:\";\n\n\tvar buf : StringBuf;\n\tvar cache : Array<Dynamic>;\n\tvar shash : haxe.ds.StringMap<Int>;\n\tvar scount : Int;\n\n\t/**\n\t\tThe individual cache setting for `this` Serializer instance.\n\n\t\tSee USE_CACHE for a complete description.\n\t**/\n\tpublic var useCache : Bool;\n\n\t/**\n\t\tThe individual enum index setting for `this` Serializer instance.\n\n\t\tSee USE_ENUM_INDEX for a complete description.\n\t**/\n\tpublic var useEnumIndex : Bool;\n\n\t/**\n\t\tCreates a new Serializer instance.\n\n\t\tSubsequent calls to `this.serialize` will append values to the\n\t\tinternal buffer of this String. Once complete, the contents can be\n\t\tretrieved through a call to `this.toString`.\n\n\t\tEach Serializer instance maintains its own cache if this.useCache` is\n\t\ttrue.\n\t**/\n\tpublic function new() {\n\t\tbuf = new StringBuf();\n\t\tcache = new Array();\n\t\tuseCache = USE_CACHE;\n\t\tuseEnumIndex = USE_ENUM_INDEX;\n\t\tshash = new haxe.ds.StringMap();\n\t\tscount = 0;\n\t}\n\n\t/**\n\t\tReturn the String representation of `this` Serializer.\n\n\t\tThe exact format specification can be found here:\n\t\thttp://haxe.org/manual/serialization/format\n\t**/\n\tpublic function toString() {\n\t\treturn buf.toString();\n\t}\n\n\t/* prefixes :\n\t\ta : array\n\t\tb : hash\n\t\tc : class\n\t\td : Float\n\t\te : reserved (float exp)\n\t\tf : false\n\t\tg : object end\n\t\th : array/list/hash end\n\t\ti : Int\n\t\tj : enum (by index)\n\t\tk : NaN\n\t\tl : list\n\t\tm : -Inf\n\t\tn : null\n\t\to : object\n\t\tp : +Inf\n\t\tq : haxe.ds.IntMap\n\t\tr : reference\n\t\ts : bytes (base64)\n\t\tt : true\n\t\tu : array nulls\n\t\tv : date\n\t\tw : enum\n\t\tx : exception\n\t\ty : urlencoded string\n\t\tz : zero\n\t\tM : haxe.ds.ObjectMap\n\t\tC : custom\n\t*/\n\n\tfunction serializeString( s : String ) {\n\t\tvar x = shash.get(s);\n\t\tif( x != null ) {\n\t\t\tbuf.add(\"R\");\n\t\t\tbuf.add(x);\n\t\t\treturn;\n\t\t}\n\t\tshash.set(s,scount++);\n\t\t#if old_serialize\n\t\t\t// no more support for -D old_serialize due to 'j' reuse\n\t\t\t#if error #end\n\t\t#end\n\t\tbuf.add(\"y\");\n\t\ts = StringTools.urlEncode(s);\n\t\tbuf.add(s.length);\n\t\tbuf.add(\":\");\n\t\tbuf.add(s);\n\t}\n\n\tfunction serializeRef(v) {\n\t\t#if js\n\t\tvar vt = untyped __js__(\"typeof\")(v);\n\t\t#end\n\t\tfor( i in 0...cache.length ) {\n\t\t\t#if js\n\t\t\tvar ci = cache[i];\n\t\t\tif( untyped __js__(\"typeof\")(ci) == vt && ci == v ) {\n\t\t\t#else\n\t\t\tif( cache[i] == v ) {\n\t\t\t#end\n\t\t\t\tbuf.add(\"r\");\n\t\t\t\tbuf.add(i);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\tcache.push(v);\n\t\treturn false;\n\t}\n\n\t#if flash9\n\t// only the instance variables\n\n\tfunction serializeClassFields(v,c) {\n\t\tvar xml : flash.xml.XML = untyped __global__[\"flash.utils.describeType\"](c);\n\t\tvar vars = xml.factory[0].child(\"variable\");\n\t\tfor( i in 0...vars.length() ) {\n\t\t\tvar f = vars[i].attribute(\"name\").toString();\n\t\t\tif( !v.hasOwnProperty(f) )\n\t\t\t\tcontinue;\n\t\t\tserializeString(f);\n\t\t\tserialize(Reflect.field(v,f));\n\t\t}\n\t\tbuf.add(\"g\");\n\t}\n\t#end\n\n\tfunction serializeFields(v) {\n\t\tfor( f in Reflect.fields(v) ) {\n\t\t\tserializeString(f);\n\t\t\tserialize(Reflect.field(v,f));\n\t\t}\n\t\tbuf.add(\"g\");\n\t}\n\n\t/**\n\t\tSerializes `v`.\n\n\t\tAll haxe-defined values and objects with the exception of functions can\n\t\tbe serialized. Serialization of external/native objects is not\n\t\tguaranteed to work.\n\n\t\tThe values of `this.useCache` and `this.useEnumIndex` may affect\n\t\tserialization output.\n\t**/\n\tpublic function serialize( v : Dynamic ) {\n\t\tswitch( Type.typeof(v) ) {\n\t\tcase TNull:\n\t\t\tbuf.add(\"n\");\n\t\tcase TInt:\n\t\t\tvar v : Int = v;\n\t\t\tif( v == 0 ) {\n\t\t\t\tbuf.add(\"z\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tbuf.add(\"i\");\n\t\t\tbuf.add(v);\n\t\tcase TFloat:\n\t\t\tvar v : Float = v;\n\t\t\tif( Math.isNaN(v) )\n\t\t\t\tbuf.add(\"k\");\n\t\t\telse if( !Math.isFinite(v) )\n\t\t\t\tbuf.add(if( v < 0 ) \"m\" else \"p\");\n\t\t\telse {\n\t\t\t\tbuf.add(\"d\");\n\t\t\t\tbuf.add(v);\n\t\t\t}\n\t\tcase TBool:\n\t\t\tbuf.add(if( v ) \"t\" else \"f\");\n\t\tcase TClass(c):\n\t\t\tif( #if neko untyped c.__is_String #else c == String #end ) {\n\t\t\t\tserializeString(v);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif( useCache && serializeRef(v) )\n\t\t\t\treturn;\n\t\t\tswitch( #if (neko || cs) Type.getClassName(c) #else c #end ) {\n\t\t\tcase #if (neko || cs) \"Array\" #else cast Array #end:\n\t\t\t\tvar ucount = 0;\n\t\t\t\tbuf.add(\"a\");\n\t\t\t\t#if flash9\n\t\t\t\tvar v : Array<Dynamic> = v;\n\t\t\t\t#end\n\t\t\t\tvar l = #if (neko || flash9 || php || cs || java) v.length #elseif cpp v.__length() #else v[untyped \"length\"] #end;\n\t\t\t\tfor( i in 0...l ) {\n\t\t\t\t\tif( v[i] == null )\n\t\t\t\t\t\tucount++;\n\t\t\t\t\telse {\n\t\t\t\t\t\tif( ucount > 0 ) {\n\t\t\t\t\t\t\tif( ucount == 1 )\n\t\t\t\t\t\t\t\tbuf.add(\"n\");\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tbuf.add(\"u\");\n\t\t\t\t\t\t\t\tbuf.add(ucount);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tucount = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tserialize(v[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif( ucount > 0 ) {\n\t\t\t\t\tif( ucount == 1 )\n\t\t\t\t\t\tbuf.add(\"n\");\n\t\t\t\t\telse {\n\t\t\t\t\t\tbuf.add(\"u\");\n\t\t\t\t\t\tbuf.add(ucount);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbuf.add(\"h\");\n\t\t\tcase #if (neko || cs) \"List\" #else cast List #end:\n\t\t\t\tbuf.add(\"l\");\n\t\t\t\tvar v : List<Dynamic> = v;\n\t\t\t\tfor( i in v )\n\t\t\t\t\tserialize(i);\n\t\t\t\tbuf.add(\"h\");\n\t\t\tcase #if (neko || cs) \"Date\" #else cast Date #end:\n\t\t\t\tvar d : Date = v;\n\t\t\t\tbuf.add(\"v\");\n\t\t\t\tbuf.add(d.toString());\n\t\t\tcase #if (neko || cs) \"haxe.ds.StringMap\" #else cast haxe.ds.StringMap #end:\n\t\t\t\tbuf.add(\"b\");\n\t\t\t\tvar v : haxe.ds.StringMap<Dynamic> = v;\n\t\t\t\tfor( k in v.keys() ) {\n\t\t\t\t\tserializeString(k);\n\t\t\t\t\tserialize(v.get(k));\n\t\t\t\t}\n\t\t\t\tbuf.add(\"h\");\n\t\t\tcase #if (neko || cs) \"haxe.ds.IntMap\" #else cast haxe.ds.IntMap #end:\n\t\t\t\tbuf.add(\"q\");\n\t\t\t\tvar v : haxe.ds.IntMap<Dynamic> = v;\n\t\t\t\tfor( k in v.keys() ) {\n\t\t\t\t\tbuf.add(\":\");\n\t\t\t\t\tbuf.add(k);\n\t\t\t\t\tserialize(v.get(k));\n\t\t\t\t}\n\t\t\t\tbuf.add(\"h\");\n\t\t\tcase #if (neko || cs) \"haxe.ds.ObjectMap\" #else cast haxe.ds.ObjectMap #end:\n\t\t\t\tbuf.add(\"M\");\n\t\t\t\tvar v : haxe.ds.ObjectMap<Dynamic,Dynamic> = v;\n\t\t\t\tfor ( k in v.keys() ) {\n\t\t\t\t\t#if (js || flash8 || neko)\n\t\t\t\t\tvar id = Reflect.field(k, \"__id__\");\n\t\t\t\t\tReflect.deleteField(k, \"__id__\");\n\t\t\t\t\tserialize(k);\n\t\t\t\t\tReflect.setField(k, \"__id__\", id);\n\t\t\t\t\t#else\n\t\t\t\t\tserialize(k);\n\t\t\t\t\t#end\n\t\t\t\t\tserialize(v.get(k));\n\t\t\t\t}\n\t\t\t\tbuf.add(\"h\");\n\t\t\tcase #if (neko || cs) \"haxe.io.Bytes\" #else cast haxe.io.Bytes #end:\n\t\t\t\tvar v : haxe.io.Bytes = v;\n\t\t\t\t#if neko\n\t\t\t\tvar chars = new String(base_encode(v.getData(),untyped BASE64.__s));\n\t\t\t\t#else\n\t\t\t\tvar i = 0;\n\t\t\t\tvar max = v.length - 2;\n\t\t\t\tvar charsBuf = new StringBuf();\n\t\t\t\tvar b64 = BASE64;\n\t\t\t\twhile( i < max ) {\n\t\t\t\t\tvar b1 = v.get(i++);\n\t\t\t\t\tvar b2 = v.get(i++);\n\t\t\t\t\tvar b3 = v.get(i++);\n\n\t\t\t\t\tcharsBuf.add(b64.charAt(b1 >> 2));\n\t\t\t\t\tcharsBuf.add(b64.charAt(((b1 << 4) | (b2 >> 4)) & 63));\n\t\t\t\t\tcharsBuf.add(b64.charAt(((b2 << 2) | (b3 >> 6)) & 63));\n\t\t\t\t\tcharsBuf.add(b64.charAt(b3 & 63));\n\t\t\t\t}\n\t\t\t\tif( i == max ) {\n\t\t\t\t\tvar b1 = v.get(i++);\n\t\t\t\t\tvar b2 = v.get(i++);\n\t\t\t\t\tcharsBuf.add(b64.charAt(b1 >> 2));\n\t\t\t\t\tcharsBuf.add(b64.charAt(((b1 << 4) | (b2 >> 4)) & 63));\n\t\t\t\t\tcharsBuf.add(b64.charAt((b2 << 2) & 63));\n\t\t\t\t} else if( i == max + 1 ) {\n\t\t\t\t\tvar b1 = v.get(i++);\n\t\t\t\t\tcharsBuf.add(b64.charAt(b1 >> 2));\n\t\t\t\t\tcharsBuf.add(b64.charAt((b1 << 4) & 63));\n\t\t\t\t}\n\t\t\t\tvar chars = charsBuf.toString();\n\t\t\t\t#end\n\t\t\t\tbuf.add(\"s\");\n\t\t\t\tbuf.add(chars.length);\n\t\t\t\tbuf.add(\":\");\n\t\t\t\tbuf.add(chars);\n\t\t\tdefault:\n\t\t\t\tif( useCache ) cache.pop();\n\t\t\t\tif( #if flash9 try v.hxSerialize != null catch( e : Dynamic ) false #elseif (cs || java) Reflect.hasField(v, \"hxSerialize\") #else v.hxSerialize != null #end  ) {\n\t\t\t\t\tbuf.add(\"C\");\n\t\t\t\t\tserializeString(Type.getClassName(c));\n\t\t\t\t\tif( useCache ) cache.push(v);\n\t\t\t\t\tv.hxSerialize(this);\n\t\t\t\t\tbuf.add(\"g\");\n\t\t\t\t} else {\n\t\t\t\t\tbuf.add(\"c\");\n\t\t\t\t\tserializeString(Type.getClassName(c));\n\t\t\t\t\tif( useCache ) cache.push(v);\n\t\t\t\t\t#if flash9\n\t\t\t\t\tserializeClassFields(v,c);\n\t\t\t\t\t#else\n\t\t\t\t\tserializeFields(v);\n\t\t\t\t\t#end\n\t\t\t\t}\n\t\t\t}\n\t\tcase TObject:\n\t\t\tif( useCache && serializeRef(v) )\n\t\t\t\treturn;\n\t\t\tbuf.add(\"o\");\n\t\t\tserializeFields(v);\n\t\tcase TEnum(e):\n\t\t\tif( useCache ) {\n\t\t\t\tif( serializeRef(v) )\n\t\t\t\t\treturn;\n\t\t\t\tcache.pop();\n\t\t\t}\n\t\t\tbuf.add(useEnumIndex?\"j\":\"w\");\n\t\t\tserializeString(Type.getEnumName(e));\n\t\t\t#if neko\n\t\t\tif( useEnumIndex ) {\n\t\t\t\tbuf.add(\":\");\n\t\t\t\tbuf.add(v.index);\n\t\t\t} else\n\t\t\t\tserializeString(new String(v.tag));\n\t\t\tbuf.add(\":\");\n\t\t\tif( v.args == null )\n\t\t\t\tbuf.add(0);\n\t\t\telse {\n\t\t\t\tvar l : Int = untyped __dollar__asize(v.args);\n\t\t\t\tbuf.add(l);\n\t\t\t\tfor( i in 0...l )\n\t\t\t\t\tserialize(v.args[i]);\n\t\t\t}\n\t\t\t#elseif flash9\n\t\t\tif( useEnumIndex ) {\n\t\t\t\tbuf.add(\":\");\n\t\t\t\tbuf.add(v.index);\n\t\t\t} else\n\t\t\t\tserializeString(v.tag);\n\t\t\tbuf.add(\":\");\n\t\t\tvar pl : Array<Dynamic> = v.params;\n\t\t\tif( pl == null )\n\t\t\t\tbuf.add(0);\n\t\t\telse {\n\t\t\t\tbuf.add(pl.length);\n\t\t\t\tfor( p in pl )\n\t\t\t\t\tserialize(p);\n\t\t\t}\n\t\t\t#elseif cpp\n\t\t\tif( useEnumIndex ) {\n\t\t\t\tbuf.add(\":\");\n\t\t\t\tbuf.add(v.__Index());\n\t\t\t} else\n\t\t\t\tserializeString(v.__Tag());\n\t\t\tbuf.add(\":\");\n\t\t\tvar pl : Array<Dynamic> = v.__EnumParams();\n\t\t\tif( pl == null )\n\t\t\t\tbuf.add(0);\n\t\t\telse {\n\t\t\t\tbuf.add(pl.length);\n\t\t\t\tfor( p in pl )\n\t\t\t\t\tserialize(p);\n\t\t\t}\n\t\t\t#elseif php\n\t\t\tif( useEnumIndex ) {\n\t\t\t\tbuf.add(\":\");\n\t\t\t\tbuf.add(v.index);\n\t\t\t} else\n\t\t\t\tserializeString(v.tag);\n\t\t\tbuf.add(\":\");\n\t\t\tvar l : Int = untyped __call__(\"count\", v.params);\n\t\t\tif( l == 0 || v.params == null)\n\t\t\t\tbuf.add(0);\n\t\t\telse {\n\t\t\t\tbuf.add(l);\n\t\t\t\tfor( i in 0...l )\n\t\t\t\t\tserialize(untyped __field__(v, __php__(\"params\"), i));\n\t\t\t}\n\t\t\t#elseif (java || cs)\n\t\t\tif( useEnumIndex ) {\n\t\t\t\tbuf.add(\":\");\n\t\t\t\tbuf.add(Type.enumIndex(v));\n\t\t\t} else\n\t\t\t\tserializeString(Type.enumConstructor(v));\n\t\t\tbuf.add(\":\");\n\t\t\tvar arr:Array<Dynamic> = Type.enumParameters(v);\n\t\t\tif (arr != null)\n\t\t\t{\n\t\t\t\tbuf.add(arr.length);\n\t\t\t\tfor (v in arr)\n\t\t\t\t\tserialize(v);\n\t\t\t} else {\n\t\t\t\tbuf.add(\"0\");\n\t\t\t}\n\n\t\t\t#else\n\t\t\tif( useEnumIndex ) {\n\t\t\t\tbuf.add(\":\");\n\t\t\t\tbuf.add(v[1]);\n\t\t\t} else\n\t\t\t\tserializeString(v[0]);\n\t\t\tbuf.add(\":\");\n\t\t\tvar l = v[untyped \"length\"];\n\t\t\tbuf.add(l - 2);\n\t\t\tfor( i in 2...l )\n\t\t\t\tserialize(v[i]);\n\t\t\t#end\n\t\t\tif( useCache ) cache.push(v);\n\t\tcase TFunction:\n\t\t\tthrow \"Cannot serialize function\";\n\t\tdefault:\n\t\t\t#if neko\n\t\t\tif( untyped (__i32__kind != null && __dollar__iskind(v,__i32__kind)) ) {\n\t\t\t\tbuf.add(\"i\");\n\t\t\t\tbuf.add(v);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t#end\n\t\t\tthrow \"Cannot serialize \"+Std.string(v);\n\t\t}\n\t}\n\n\tpublic function serializeException( e : Dynamic ) {\n\t\tbuf.add(\"x\");\n\t\t#if flash9\n\t\tif( untyped __is__(e,__global__[\"Error\"]) ) {\n\t\t\tvar e : flash.errors.Error = e;\n\t\t\tvar s = e.getStackTrace();\n\t\t\tif( s == null )\n\t\t\t\tserialize(e.message);\n\t\t\telse\n\t\t\t\tserialize(s);\n\t\t\treturn;\n\t\t}\n\t\t#end\n\t\tserialize(e);\n\t}\n\n\t/**\n\t\tSerializes `v` and returns the String representation.\n\n\t\tThis is a convenience function for creating a new instance of\n\t\tSerializer, serialize `v` into it and obtain the result through a call\n\t\tto toString().\n\t**/\n\tpublic static function run( v : Dynamic ) {\n\t\tvar s = new Serializer();\n\t\ts.serialize(v);\n\t\treturn s.toString();\n\t}\n\n\t#if neko\n\tstatic var base_encode = neko.Lib.load(\"std\",\"base_encode\",2);\n\t#end\n\n}\n\n","/*\n * Copyright (C)2005-2013 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe;\n\n/**\n\tThe Timer class allows you to create asynchronous timers on platforms that\n\tsupport events.\n\t\n\tThe intended usage is to create an instance of the Timer class with a given\n\tinterval, set its run() method to a custom function to be invoked and\n\teventually call stop() to stop the Timer.\n\n\tNote that a running Timer may or may not prevent the program to exit \n\tautomatically when main() returns.\n\t\n\tIt is also possible to extend this class and override its run() method in\n\tthe child class.\n**/\nclass Timer {\n\t#if (flash || js || java)\n\n\t#if (flash || js)\n\t\tprivate var id : Null<Int>;\n\t#elseif java\n\t\tprivate var timer : java.util.Timer;\n\t\tprivate var task : java.util.TimerTask;\n\t#end\n\n\t/**\n\t\tCreates a new timer that will run every `time_ms` milliseconds.\n\t\t\n\t\tAfter creating the Timer instance, it calls `this].run` repeatedly,\n\t\twith delays of `time_ms` milliseconds, until `this.stop` is called.\n\t\t\n\t\tThe first invocation occurs after `time_ms` milliseconds, not\n\t\timmediately.\n\t\t\n\t\tThe accuracy of this may be platform-dependent.\n\t**/\n\tpublic function new( time_ms : Int ){\n\t\t#if flash9\n\t\t\tvar me = this;\n\t\t\tid = untyped __global__[\"flash.utils.setInterval\"](function() { me.run(); },time_ms);\n\t\t#elseif flash\n\t\t\tvar me = this;\n\t\t\tid = untyped _global[\"setInterval\"](function() { me.run(); },time_ms);\n\t\t#elseif js\n\t\t\tvar me = this;\n\t\t\tid = untyped setInterval(function() me.run(),time_ms);\n\t\t#elseif java\n\t\t\ttimer = new java.util.Timer();\n\t\t\ttimer.scheduleAtFixedRate(task = new TimerTask(this), haxe.Int64.ofInt(time_ms), haxe.Int64.ofInt(time_ms));\n\t\t#end\n\t}\n\n\t/**\n\t\tStops `this` Timer.\n\t\t\n\t\tAfter calling this method, no additional invocations of `this.run`\n\t\twill occur.\n\t\t\n\t\tIt is not possible to restart `this` Timer once stopped.\n\t**/\n\tpublic function stop() {\n\t\t#if (flash || js)\n\t\t\tif( id == null )\n\t\t\t\treturn;\n\t\t\t#if flash9\n\t\t\t\tuntyped __global__[\"flash.utils.clearInterval\"](id);\n\t\t\t#elseif flash\n\t\t\t\tuntyped _global[\"clearInterval\"](id);\n\t\t\t#elseif js\n\t\t\t\tuntyped clearInterval(id);\n\t\t\t#end\n\t\t\tid = null;\n\t\t#elseif java\n\t\t\ttimer.cancel();\n\t\t\ttimer = null;\n\t\t\ttask = null;\n\t\t#end\n\t}\n\n\t/**\n\t\tThis method is invoked repeatedly on `this` Timer.\n\t\t\n\t\tIt can be overridden in a subclass, or rebound directly to a custom\n\t\tfunction:\n\t\t\tvar timer = new haxe.Timer(1000); // 1000ms delay\n\t\t\ttimer.run = function() { ... }\n\t\t\t\n\t\tOnce bound, it can still be rebound to different functions until `this`\n\t\tTimer is stopped through a call to `this.stop`.\n\t**/\n\tpublic dynamic function run() {\n\n\t}\n\n\t/**\n\t\tInvokes `f` after `time_ms` milliseconds.\n\t\t\n\t\tThis is a convenience function for creating a new Timer instance with\n\t\t`time_ms` as argument, binding its run() method to `f` and then stopping\n\t\t`this` Timer upon the first invocation.\n\t\t\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function delay( f : Void -> Void, time_ms : Int ) {\n\t\tvar t = new haxe.Timer(time_ms);\n\t\tt.run = function() {\n\t\t\tt.stop();\n\t\t\tf();\n\t\t};\n\t\treturn t;\n\t}\n\n\t#end\n\n\t/**\n\t\tMeasures the time it takes to execute `f`, in seconds with fractions.\n\t\t\n\t\tThis is a convenience function for calculating the difference between\n\t\tTimer.stamp() before and after the invocation of `f`.\n\t\t\n\t\tThe difference is passed as argument to Log.trace(), with \"s\" appended\n\t\tto denote the unit. The optional `pos` argument is passed through.\n\t\t\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function measure<T>( f : Void -> T, ?pos : PosInfos ) : T {\n\t\tvar t0 = stamp();\n\t\tvar r = f();\n\t\tLog.trace((stamp() - t0) + \"s\", pos);\n\t\treturn r;\n\t}\n\n\t/**\n\t\tReturns a timestamp, in seconds with fractions.\n\t\t\n\t\tThe value itself might differ depending on platforms, only differences\n\t\tbetween two values make sense.\n\t**/\n\tpublic static function stamp() : Float {\n\t\t#if flash\n\t\t\treturn flash.Lib.getTimer() / 1000;\n\t\t#elseif (neko || php)\n\t\t\treturn Sys.time();\n\t\t#elseif js\n\t\t\treturn Date.now().getTime() / 1000;\n\t\t#elseif cpp\n\t\t\treturn untyped __global__.__time_stamp();\n\t\t#elseif sys\n\t\t\treturn Sys.time();\n\t\t#else\n\t\t\treturn 0;\n\t\t#end\n\t}\n\n}\n\n#if java\n@:nativeGen\nprivate class TimerTask extends java.util.TimerTask {\n\tvar timer:Timer;\n\tpublic function new(timer:Timer):Void {\n\t\tsuper();\n\t\tthis.timer = timer;\n\t}\n\n\t@:overload public function run():Void {\n\t\ttimer.run();\n\t}\n}\n#end","/*\n * Copyright (C)2005-2013 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe;\n\n@:noDoc\ntypedef TypeResolver = {\n\tfunction resolveClass( name : String ) : Class<Dynamic>;\n\tfunction resolveEnum( name : String ) : Enum<Dynamic>;\n}\n\n/**\n\tThe Unserializer class is the complement to the Serializer class. It parses\n\ta serialization String and creates objects from the contained data.\n\n\tThis class can be used in two ways:\n\t\n\t- create a new Unserializer() instance with a given serialization\n\t\tString, then call its unserialize() method until all values are\n\t\textracted\n\t- call Unserializer.run() to unserialize a single value from a given\n\t\tString\n**/\nclass Unserializer {\n\n\t/**\n\t\tThis value can be set to use custom type resolvers.\n\n\t\tA type resolver finds a Class or Enum instance from a given String. By\n\t\tdefault, the haxe Type Api is used.\n\n\t\tA type resolver must provide two methods:\n\t\t\n\t\t1. resolveClass(name:String):Class<Dynamic> is called to determine a\n\t\t\t\tClass from a class name\n\t\t2. resolveEnum(name:String):Enum<Dynamic> is called to determine an\n\t\t\t\tEnum from an enum name\n\n\t\tThis value is applied when a new Unserializer instance is created.\n\t\tChanging it afterwards has no effect on previously created instances.\n\t**/\n\tpublic static var DEFAULT_RESOLVER : TypeResolver = Type;\n\n\tstatic var BASE64 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:\";\n\n\t#if !neko\n\tstatic var CODES = null;\n\n\tstatic function initCodes() {\n\t\tvar codes =\n\t\t\t#if flash9\n\t\t\t\tnew flash.utils.ByteArray();\n\t\t\t#else\n\t\t\t\tnew Array();\n\t\t\t#end\n\t\tfor( i in 0...BASE64.length )\n\t\t\tcodes[StringTools.fastCodeAt(BASE64,i)] = i;\n\t\treturn codes;\n\t}\n\t#end\n\n \tvar buf : String;\n \tvar pos : Int;\n \tvar length : Int;\n \tvar cache : Array<Dynamic>;\n \tvar scache : Array<String>;\n \tvar resolver : TypeResolver;\n \t#if neko\n \tvar upos : Int;\n \t#end\n\n\t/**\n\t\tCreates a new Unserializer instance, with its internal buffer\n\t\tinitialized to `buf`.\n\n\t\tThis does not parse `buf` immediately. It is parsed only when calls to\n\t\t`this.unserialize` are made.\n\n\t\tEach Unserializer instance maintains its own cache.\n\t**/\n \tpublic function new( buf : String ) {\n \t\tthis.buf = buf;\n \t\tlength = buf.length;\n \t\tpos = 0;\n \t\t#if neko\n \t\tupos = 0;\n \t\t#end\n \t\tscache = new Array();\n \t\tcache = new Array();\n\t\tvar r = DEFAULT_RESOLVER;\n\t\tif( r == null ) {\n\t\t\tr = Type;\n\t\t\tDEFAULT_RESOLVER = r;\n\t\t}\n \t\tsetResolver(r);\n \t}\n\n\t/**\n\t\tSets the type resolver of `this` Unserializer instance to `r`.\n\n\t\tIf `r` is null, a special resolver is used which returns null for all\n\t\tinput values.\n\n\t\tSee DEFAULT_RESOLVER for more information on type resolvers.\n\t**/\n \tpublic function setResolver( r ) {\n\t\tif( r == null )\n\t\t\tresolver = {\n\t\t\t\tresolveClass : function(_) { return null; },\n\t\t\t\tresolveEnum : function(_) { return null; }\n\t\t\t};\n\t\telse\n\t\t\tresolver = r;\n\t}\n\n\t/**\n\t\tGets the type resolver of `this` Unserializer instance.\n\n\t\tSee DEFAULT_RESOLVER for more information on type resolvers.\n\t**/\n \tpublic function getResolver() {\n\t\treturn resolver;\n\t}\n\n\tinline function get(p) : Int {\n\t\treturn StringTools.fastCodeAt(buf, p);\n\t}\n\n \tfunction readDigits() {\n \t\tvar k = 0;\n \t\tvar s = false;\n \t\tvar fpos = pos;\n \t\twhile( true ) {\n \t\t\tvar c = get(pos);\n\t\t\tif( StringTools.isEof(c) )\n\t\t\t\tbreak;\n \t\t\tif( c == \"-\".code ) {\n \t\t\t\tif( pos != fpos )\n \t\t\t\t\tbreak;\n \t\t\t\ts = true;\n \t\t\t\tpos++;\n \t\t\t\tcontinue;\n \t\t\t}\n \t\t\tif( c < \"0\".code || c > \"9\".code )\n \t\t\t\tbreak;\n \t\t\tk = k * 10 + (c - \"0\".code);\n \t\t\tpos++;\n \t\t}\n \t\tif( s )\n \t\t\tk *= -1;\n \t\treturn k;\n \t}\n\n\tfunction unserializeObject(o) {\n \t\twhile( true ) {\n \t\t\tif( pos >= length )\n \t\t\t\tthrow \"Invalid object\";\n \t\t\tif( get(pos) == \"g\".code )\n \t\t\t\tbreak;\n \t\t\tvar k = unserialize();\n \t\t\tif( !Std.is(k,String) )\n \t\t\t\tthrow \"Invalid object key\";\n \t\t\tvar v = unserialize();\n \t\t\tReflect.setField(o,k,v);\n \t\t}\n \t\tpos++;\n\t}\n\n\tfunction unserializeEnum( edecl, tag ) {\n\t\tif( get(pos++) != \":\".code )\n\t\t\tthrow \"Invalid enum format\";\n\t\tvar nargs = readDigits();\n\t\tif( nargs == 0 )\n\t\t\treturn Type.createEnum(edecl,tag);\n\t\tvar args = new Array();\n\t\twhile( nargs-- > 0 )\n\t\t\targs.push(unserialize());\n\t\treturn Type.createEnum(edecl,tag,args);\n\t}\n\n\t/**\n\t\tUnserializes the next part of `this` Unserializer instance and returns\n\t\tthe according value.\n\n\t\tThis function may call `this.resolver.resolveClass` to determine a\n\t\tClass from a String, and `this.resolver.resolveEnum` to determine an\n\t\tEnum from a String.\n\n\t\tIf `this` Unserializer instance contains no more or invalid data, an\n\t\texception is thrown.\n\n\t\tThis operation may fail on structurally valid data if a type cannot be\n\t\tresolved or if a field cannot be set. This can happen when unserializing\n\t\tStrings that were serialized on a different haxe target, in which the\n\t\tserialization side has to make sure not to include platform-specific\n\t\tdata.\n\n\t\tClasses are created from Type.createEmptyInstance, which means their\n\t\tconstructors are not called.\n\t**/\n \tpublic function unserialize() : Dynamic {\n \t\tswitch( get(pos++) ) {\n \t\tcase \"n\".code:\n \t\t\treturn null;\n \t\tcase \"t\".code:\n \t\t\treturn true;\n \t\tcase \"f\".code:\n \t\t\treturn false;\n \t\tcase \"z\".code:\n \t\t\treturn 0;\n \t\tcase \"i\".code:\n \t\t\treturn readDigits();\n \t\tcase \"d\".code:\n \t\t\tvar p1 = pos;\n \t\t\twhile( true ) {\n \t\t\t\tvar c = get(pos);\n \t\t\t\t// + - . , 0-9\n \t\t\t\tif( (c >= 43 && c < 58) || c == \"e\".code || c == \"E\".code )\n \t\t\t\t\tpos++;\n \t\t\t\telse\n \t\t\t\t\tbreak;\n \t\t\t}\n \t\t\treturn Std.parseFloat(buf.substr(p1,pos-p1));\n\t\tcase \"y\".code:\n \t\t\tvar len = readDigits();\n \t\t\tif( get(pos++) != \":\".code || length - pos < len )\n \t\t\t\tthrow \"Invalid string length\";\n\t\t\tvar s = buf.substr(pos,len);\n\t\t\tpos += len;\n\t\t\ts = StringTools.urlDecode(s);\n\t\t\tscache.push(s);\n\t\t\treturn s;\n \t\tcase \"k\".code:\n \t\t\treturn Math.NaN;\n \t\tcase \"m\".code:\n \t\t\treturn Math.NEGATIVE_INFINITY;\n \t\tcase \"p\".code:\n \t\t\treturn Math.POSITIVE_INFINITY;\n \t\tcase \"a\".code:\n\t\t\tvar buf = buf;\n \t\t\tvar a = new Array<Dynamic>();\n \t\t\tcache.push(a);\n \t\t\twhile( true ) {\n \t\t\t\tvar c = get(pos);\n \t\t\t\tif( c == \"h\".code ) {\n\t\t\t\t\tpos++;\n \t\t\t\t\tbreak;\n\t\t\t\t}\n \t\t\t\tif( c == \"u\".code ) {\n\t\t\t\t\tpos++;\n \t\t\t\t\tvar n = readDigits();\n \t\t\t\t\ta[a.length+n-1] = null;\n \t\t\t\t} else\n \t\t\t\t\ta.push(unserialize());\n \t\t\t}\n \t\t\treturn a;\n \t\tcase \"o\".code:\n\t \t\tvar o = {};\n\t \t\tcache.push(o);\n\t\t\tunserializeObject(o);\n\t\t\treturn o;\n \t\tcase \"r\".code:\n \t\t\tvar n = readDigits();\n \t\t\tif( n < 0 || n >= cache.length )\n \t\t\t\tthrow \"Invalid reference\";\n \t\t\treturn cache[n];\n \t\tcase \"R\".code:\n\t\t\tvar n = readDigits();\n\t\t\tif( n < 0 || n >= scache.length )\n\t\t\t\tthrow \"Invalid string reference\";\n\t\t\treturn scache[n];\n \t\tcase \"x\".code:\n\t\t\tthrow unserialize();\n\t\tcase \"c\".code:\n\t \t\tvar name = unserialize();\n\t\t\tvar cl = resolver.resolveClass(name);\n\t\t\tif( cl == null )\n\t\t\t\tthrow \"Class not found \" + name;\n\t\t\tvar o = Type.createEmptyInstance(cl);\n\t\t\tcache.push(o);\n\t\t\tunserializeObject(o);\n\t\t\treturn o;\n\t\tcase \"w\".code:\n\t\t\tvar name = unserialize();\n\t\t\tvar edecl = resolver.resolveEnum(name);\n\t\t\tif( edecl == null )\n\t\t\t\tthrow \"Enum not found \" + name;\n\t\t\tvar e = unserializeEnum(edecl, unserialize());\n\t\t\tcache.push(e);\n\t\t\treturn e;\n \t\tcase \"j\".code:\n\t\t\tvar name = unserialize();\n\t\t\tvar edecl = resolver.resolveEnum(name);\n\t\t\tif( edecl == null )\n\t\t\t\tthrow \"Enum not found \" + name;\n\t\t\tpos++; /* skip ':' */\n\t\t\tvar index = readDigits();\n\t\t\tvar tag = Type.getEnumConstructs(edecl)[index];\n\t\t\tif( tag == null )\n\t\t\t\tthrow \"Unknown enum index \"+name+\"@\"+index;\n\t\t\tvar e = unserializeEnum(edecl, tag);\n\t\t\tcache.push(e);\n\t\t\treturn e;\n\t\tcase \"l\".code:\n\t\t\tvar l = new List();\n\t\t\tcache.push(l);\n\t\t\tvar buf = buf;\n\t\t\twhile( get(pos) != \"h\".code )\n\t\t\t\tl.add(unserialize());\n\t\t\tpos++;\n\t\t\treturn l;\n\t\tcase \"b\".code:\n\t\t\tvar h = new haxe.ds.StringMap();\n\t\t\tcache.push(h);\n\t\t\tvar buf = buf;\n\t\t\twhile( get(pos) != \"h\".code ) {\n\t\t\t\tvar s = unserialize();\n\t\t\t\th.set(s,unserialize());\n\t\t\t}\n\t\t\tpos++;\n\t\t\treturn h;\n\t\tcase \"q\".code:\n\t\t\tvar h = new haxe.ds.IntMap();\n\t\t\tcache.push(h);\n\t\t\tvar buf = buf;\n\t\t\tvar c = get(pos++);\n\t\t\twhile( c == \":\".code ) {\n\t\t\t\tvar i = readDigits();\n\t\t\t\th.set(i,unserialize());\n\t\t\t\tc = get(pos++);\n\t\t\t}\n\t\t\tif( c != \"h\".code )\n\t\t\t\tthrow \"Invalid IntMap format\";\n\t\t\treturn h;\n\t\tcase \"M\".code:\n\t\t\tvar h = new haxe.ds.ObjectMap();\n\t\t\tcache.push(h);\n\t\t\tvar buf = buf;\n\t\t\twhile( get(pos) != \"h\".code ) {\n\t\t\t\tvar s = unserialize();\n\t\t\t\th.set(s,unserialize());\n\t\t\t}\n\t\t\tpos++;\n\t\t\treturn h;\n\t\tcase \"v\".code:\n\t\t\tvar d = Date.fromString(buf.substr(pos,19));\n\t\t\tcache.push(d);\n\t\t\tpos += 19;\n\t\t\treturn d;\n \t\tcase \"s\".code:\n \t\t\tvar len = readDigits();\n\t\t\tvar buf = buf;\n \t\t\tif( get(pos++) != \":\".code || length - pos < len )\n\t\t\t\tthrow \"Invalid bytes length\";\n\t\t\t#if neko\n\t\t\tvar bytes = haxe.io.Bytes.ofData( base_decode(untyped buf.substr(pos,len).__s,untyped BASE64.__s) );\n\t\t\t#else\n\t\t\tvar codes = CODES;\n\t\t\tif( codes == null ) {\n\t\t\t\tcodes = initCodes();\n\t\t\t\tCODES = codes;\n\t\t\t}\n\t\t\tvar i = pos;\n\t\t\tvar rest = len & 3;\n\t\t\tvar size = (len >> 2) * 3 + ((rest >= 2) ? rest - 1 : 0);\n\t\t\tvar max = i + (len - rest);\n\t\t\tvar bytes = haxe.io.Bytes.alloc(size);\n\t\t\tvar bpos = 0;\n\t\t\twhile( i < max ) {\n\t\t\t\tvar c1 = codes[StringTools.fastCodeAt(buf,i++)];\n\t\t\t\tvar c2 = codes[StringTools.fastCodeAt(buf,i++)];\n\t\t\t\tbytes.set(bpos++,(c1 << 2) | (c2 >> 4));\n\t\t\t\tvar c3 = codes[StringTools.fastCodeAt(buf,i++)];\n\t\t\t\tbytes.set(bpos++,(c2 << 4) | (c3 >> 2));\n\t\t\t\tvar c4 = codes[StringTools.fastCodeAt(buf,i++)];\n\t\t\t\tbytes.set(bpos++,(c3 << 6) | c4);\n\t\t\t}\n\t\t\tif( rest >= 2 ) {\n\t\t\t\tvar c1 = codes[StringTools.fastCodeAt(buf,i++)];\n\t\t\t\tvar c2 = codes[StringTools.fastCodeAt(buf,i++)];\n\t\t\t\tbytes.set(bpos++,(c1 << 2) | (c2 >> 4));\n\t\t\t\tif( rest == 3 ) {\n\t\t\t\t\tvar c3 = codes[StringTools.fastCodeAt(buf,i++)];\n\t\t\t\t\tbytes.set(bpos++,(c2 << 4) | (c3 >> 2));\n\t\t\t\t}\n\t\t\t}\n \t\t\t#end\n\t\t\tpos += len;\n\t\t\tcache.push(bytes);\n\t\t\treturn bytes;\n\t\tcase \"C\".code:\n\t \t\tvar name = unserialize();\n\t\t\tvar cl = resolver.resolveClass(name);\n\t\t\tif( cl == null )\n\t\t\t\tthrow \"Class not found \" + name;\n\t\t\tvar o : Dynamic = Type.createEmptyInstance(cl);\n\t\t\tcache.push(o);\n\t\t\to.hxUnserialize(this);\n\t\t\tif( get(pos++) != \"g\".code )\n\t\t\t\tthrow \"Invalid custom data\";\n\t\t\treturn o;\n \t\tdefault:\n \t\t}\n \t\tpos--;\n \t\tthrow (\"Invalid char \"+buf.charAt(pos)+\" at position \"+pos);\n \t}\n\n\t/**\n\t\tUnserializes `v` and returns the according value.\n\n\t\tThis is a convenience function for creating a new instance of\n\t\tUnserializer with `v` as buffer and calling its unserialize() method\n\t\tonce.\n\t**/\n\tpublic static function run( v : String ) : Dynamic {\n\t\treturn new Unserializer(v).unserialize();\n\t}\n\n\t#if neko\n\tstatic var base_decode = neko.Lib.load(\"std\",\"base_decode\",2);\n\t#end\n\n}\n","/*\r\n * Copyright (c) 2005-2008, The haXe Project Contributors\r\n * All rights reserved.\r\n * Redistribution and use in source and binary forms, with or without\r\n * modification, are permitted provided that the following conditions are met:\r\n *\r\n *   - Redistributions of source code must retain the above copyright\r\n *     notice, this list of conditions and the following disclaimer.\r\n *   - Redistributions in binary form must reproduce the above copyright\r\n *     notice, this list of conditions and the following disclaimer in the\r\n *     documentation and/or other materials provided with the distribution.\r\n *\r\n * THIS SOFTWARE IS PROVIDED BY THE HAXE PROJECT CONTRIBUTORS \"AS IS\" AND ANY\r\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\r\n * DISCLAIMED. IN NO EVENT SHALL THE HAXE PROJECT CONTRIBUTORS BE LIABLE FOR\r\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\r\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\r\n * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\r\n * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY\r\n * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH\r\n * DAMAGE.\r\n */\r\npackage haxe.io;\r\n\r\nclass Bytes {\r\n\r\n\tpublic var length(default,null) : Int;\r\n\tvar b : BytesData;\r\n\r\n\tfunction new(length,b) {\r\n\t\tthis.length = length;\r\n\t\tthis.b = b;\r\n\t}\r\n\r\n\tpublic inline function get( pos : Int ) : Int {\r\n\t\t#if neko\r\n\t\treturn untyped __dollar__sget(b,pos);\r\n\t\t#elseif flash9\r\n\t\treturn b[pos];\r\n\t\t#elseif php\r\n\t\treturn untyped __call__(\"ord\", b[pos]);\r\n\t\t#elseif cpp\r\n\t\treturn untyped b[pos];\r\n\t\t#else\r\n\t\treturn b[pos];\r\n\t\t#end\r\n\t}\r\n\r\n\tpublic inline function set( pos : Int, v : Int ) : Void {\r\n\t\t#if neko\r\n\t\tuntyped __dollar__sset(b,pos,v);\r\n\t\t#elseif flash9\r\n\t\tb[pos] = v;\r\n\t\t#elseif php\r\n\t\tb[pos] = untyped __call__(\"chr\", v);\r\n\t\t#elseif cpp\r\n\t\tuntyped b[pos] = v;\r\n    #elseif (nodejs || nodejs_std)\r\n    b[pos] = v;\r\n\t\t#else\r\n\t\tb[pos] = v & 0xFF;\r\n\t\t#end\r\n\t}\r\n\r\n\tpublic function blit( pos : Int, src : Bytes, srcpos : Int, len : Int ) : Void {\r\n\t\t#if !neko\r\n\t\tif( pos < 0 || srcpos < 0 || len < 0 || pos + len > length || srcpos + len > src.length ) throw Error.OutsideBounds;\r\n\t\t#end\r\n\t\t#if neko\r\n\t\ttry untyped __dollar__sblit(b,pos,src.b,srcpos,len) catch( e : Dynamic ) throw Error.OutsideBounds;\r\n\t\t#elseif php\r\n\t\t// TODO: test me\r\n\t\tb = untyped __php__(\"substr($this->b, 0, $pos) . substr($src->b, $srcpos, $len) . substr($this->b, $pos+$len)\"); //__call__(\"substr\", b, 0, pos)+__call__(\"substr\", src.b, srcpos, len)+__call__(\"substr\", b, pos+len);\r\n\t\t#elseif flash9\r\n\t\tb.position = pos;\r\n\t\tb.writeBytes(src.b,srcpos,len);\r\n\t\t#elseif (nodejs || nodejs_std)\r\n    src.getData().copy(b,pos,srcpos,srcpos+len);\r\n    #else\r\n\t\tvar b1 = b;\r\n\t\tvar b2 = src.b;\r\n\t\tif( b1 == b2 && pos > srcpos ) {\r\n\t\t\tvar i = len;\r\n\t\t\twhile( i > 0 ) {\r\n\t\t\t\ti--;\r\n\t\t\t\tb1[i + pos] = b2[i + srcpos];\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfor( i in 0...len )\r\n\t\t\tb1[i+pos] = b2[i+srcpos];\r\n\t\t#end\r\n\t}\r\n\r\n\tpublic function sub( pos : Int, len : Int ) : Bytes {\r\n\t\t#if !neko\r\n\t\tif( pos < 0 || len < 0 || pos + len > length ) throw Error.OutsideBounds;\r\n\t\t#end\r\n\t\t#if neko\r\n\t\treturn try new Bytes(len,untyped __dollar__ssub(b,pos,len)) catch( e : Dynamic ) throw Error.OutsideBounds;\r\n\t\t#elseif flash9\r\n\t\tb.position = pos;\r\n\t\tvar b2 = new flash.utils.ByteArray();\r\n\t\tb.readBytes(b2,0,len);\r\n\t\treturn new Bytes(len,b2);\r\n\t\t#elseif php\r\n\t\t// TODO: test me\r\n\t\treturn new Bytes(len, untyped __call__(\"substr\", b, pos, len));\r\n\t\t#elseif (nodejs || nodejs_std)\r\n\r\n    /* node slice does not return a copy, so need a blit(copy) */\r\n    var\r\n      nb = new js.Node.NodeBuffer(len),\r\n      slice:js.Node.NodeBuffer = b.slice(pos,pos+len);\r\n\r\n    slice.copy(nb,0,0,len);\r\n\t\treturn new Bytes(len,nb);\r\n\t\t#else\r\n\t\treturn new Bytes(len,b.slice(pos,pos+len));\r\n    #end\r\n\t}\r\n\r\n\tpublic function compare( other : Bytes ) : Int {\r\n\t\t#if neko\r\n\t\treturn untyped __dollar__compare(b,other.b);\r\n\t\t#elseif flash9\r\n\t\tvar len = (length < other.length) ? length : other.length;\r\n\t\tvar b1 = b;\r\n\t\tvar b2 = other.b;\r\n\t\tb1.position = 0;\r\n\t\tb2.position = 0;\r\n\t\tfor( i in 0...len>>2 )\r\n\t\t\tif( b1.readUnsignedInt() != b2.readUnsignedInt() ) {\r\n\t\t\t\tb1.position -= 4;\r\n\t\t\t\tb2.position -= 4;\r\n\t\t\t\treturn b1.readUnsignedInt() - b2.readUnsignedInt();\r\n\t\t\t}\r\n\t\tfor( i in 0...len & 3 )\r\n\t\t\tif( b1.readUnsignedByte() != b2.readUnsignedByte() )\r\n\t\t\t\treturn b1[b1.position-1] - b2[b2.position-1];\r\n\t\treturn length - other.length;\r\n\t\t#elseif php\r\n\t\treturn untyped __php__(\"$this->b < $other->b ? -1 : ($this->b == $other->b ? 0 : 1)\");\r\n\t\t#else\r\n\t\tvar b1 = b;\r\n\t\tvar b2 = other.b;\r\n\t\tvar len = (length < other.length) ? length : other.length;\r\n\t\tfor( i in 0...len )\r\n\t\t\tif( b1[i] != b2[i] )\r\n\t\t\t\t#if cpp\r\n\t\t\t\treturn untyped b1[i] - untyped b2[i];\r\n\t\t\t\t#else\r\n\t\t\t\treturn b1[i] - b2[i];\r\n\t\t\t\t#end\r\n\t\treturn length - other.length;\r\n\t\t#end\r\n\t}\r\n\r\n\tpublic function readString( pos : Int, len : Int ) : String {\r\n\t\t#if !neko\r\n\t\tif( pos < 0 || len < 0 || pos + len > length ) throw Error.OutsideBounds;\r\n\t\t#end\r\n\t\t#if neko\r\n\t\treturn try new String(untyped __dollar__ssub(b,pos,len)) catch( e : Dynamic ) throw Error.OutsideBounds;\r\n\t\t#elseif flash9\r\n\t\tb.position = pos;\r\n\t\treturn b.readUTFBytes(len);\r\n\t\t#elseif php\r\n\t\t// TODO: test me\r\n\t\treturn untyped __call__(\"substr\", b, pos, len);\r\n//\t\treturn untyped __call__(\"call_user_func_array\", \"pack\", __call__(\"array_merge\", __call__(\"array\", \"C*\"), __call__(\"array_slice\", b.a, pos, len)));\r\n\t\t#elseif cpp\r\n\t\tvar result:String=\"\";\r\n\t\tuntyped __global__.__hxcpp_string_of_bytes(b,result,pos,len);\r\n\t\treturn result;\r\n\t\t#else\r\n\t\tvar s = \"\";\r\n\t\tvar b = b;\r\n\t\tvar fcc = String.fromCharCode;\r\n\t\tvar i = pos;\r\n\t\tvar max = pos+len;\r\n\t\t// utf8-encode\r\n\t\twhile( i < max ) {\r\n\t\t\tvar c = b[i++];\r\n\t\t\tif( c < 0x80 ) {\r\n\t\t\t\tif( c == 0 ) break;\r\n\t\t\t\ts += fcc(c);\r\n\t\t\t} else if( c < 0xE0 )\r\n\t\t\t\ts += fcc( ((c & 0x3F) << 6) | (b[i++] & 0x7F) );\r\n\t\t\telse if( c < 0xF0 ) {\r\n\t\t\t\tvar c2 = b[i++];\r\n\t\t\t\ts += fcc( ((c & 0x1F) << 12) | ((c2 & 0x7F) << 6) | (b[i++] & 0x7F) );\r\n\t\t\t} else {\r\n\t\t\t\tvar c2 = b[i++];\r\n\t\t\t\tvar c3 = b[i++];\r\n\t\t\t\ts += fcc( ((c & 0x0F) << 18) | ((c2 & 0x7F) << 12) | ((c3 << 6) & 0x7F) | (b[i++] & 0x7F) );\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn s;\r\n    #else (nodejs || nodejs_std)\r\n       return b.toString(js.Node.UTF8,pos,pos+len);\r\n\t\t#end\r\n\t}\r\n\r\n\tpublic function toString() : String {\r\n\t\t#if neko\r\n\t\treturn new String(untyped __dollar__ssub(b,0,length));\r\n\t\t#elseif flash9\r\n\t\tb.position = 0;\r\n\t\treturn b.readUTFBytes(length);\r\n\t\t#elseif php\r\n\t\t// TODO: test me\r\n\t\treturn cast b;\r\n//\t\treturn untyped __call__(\"call_user_func_array\", \"pack\", __call__(\"array_merge\", __call__(\"array\", \"C*\"), b.a));\r\n\t\t#else\r\n\t\treturn readString(0,length);\r\n\t\t#end\r\n\t}\r\n\t\r\n\tpublic function toHex() : String {\r\n\t\tvar s = new StringBuf();\r\n\t\tvar chars = [];\r\n\t\tvar str = \"0123456789abcdef\";\r\n\t\tfor( i in 0...str.length )\r\n\t\t\tchars.push(str.charCodeAt(i));\r\n\t\tfor( i in 0...length ) {\r\n\t\t\tvar c = get(i);\r\n\t\t\ts.addChar(chars[c >> 4]);\r\n\t\t\ts.addChar(chars[c & 15]);\r\n\t\t}\r\n\t\treturn s.toString();\r\n\t}\r\n\r\n\tpublic inline function getData() : BytesData {\r\n\t\treturn b;\r\n\t}\r\n\r\n\tpublic static function alloc( length : Int ) : Bytes {\r\n\t\t#if neko\r\n\t\treturn new Bytes(length,untyped __dollar__smake(length));\r\n\t\t#elseif flash9\r\n\t\tvar b = new flash.utils.ByteArray();\r\n\t\tb.length = length;\r\n\t\treturn new Bytes(length,b);\r\n\t\t#elseif php\r\n\t\t// TODO: test me\r\n\t\treturn new Bytes(length, untyped __call__(\"str_repeat\", __call__(\"chr\", 0), length));\r\n\t\t/*\r\n\t\tif(length > 0)\r\n\t\t\treturn new Bytes(length, untyped __call__(\"new _hx_array\", __call__(\"array_fill\", 0, length, 0)));\r\n\t\telse\r\n\t\t\treturn new Bytes(0, untyped __call__(\"new _hx_array\", __call__(\"array\")));\r\n\t\t*/\r\n\t\t#elseif cpp\r\n\t\tvar a = new BytesData();\r\n\t\tif (length>0) a[length-1] = untyped 0;\r\n\t\treturn new Bytes(length,a);\r\n\t\t#elseif (nodejs || nodejs_std)\r\n    return new Bytes(length,new js.Node.NodeBuffer(length));\r\n\r\n    #else\r\n\t\tvar a = new Array();\r\n\t\tfor( i in 0...length )\r\n\t\t\ta.push(0);\r\n\t\treturn new Bytes(length,a);\r\n\t\t#end\r\n\t}\r\n\r\n\tpublic static function ofString( s : String ) : Bytes {\r\n\t\t#if neko\r\n\t\treturn new Bytes(s.length,untyped __dollar__ssub(s.__s,0,s.length));\r\n\t\t#elseif flash9\r\n\t\tvar b = new flash.utils.ByteArray();\r\n\t\tb.writeUTFBytes(s);\r\n\t\treturn new Bytes(b.length,b);\r\n\t\t#elseif php\r\n\t\treturn new Bytes(untyped __call__(\"strlen\", s), cast s);\r\n//\t\treturn ofData(untyped __call__(\"new _hx_array\", __call__(\"array_values\", __call__(\"unpack\", \"C*\",  s))));\r\n\t\t#elseif cpp\r\n\t\tvar a = new BytesData();\r\n\t\tuntyped __global__.__hxcpp_bytes_of_string(a,s);\r\n\t\treturn new Bytes(a.length,a);\r\n\t\t#elseif (nodejs || nodejs_std)\r\n    var nb = new js.Node.NodeBuffer(s, js.Node.NodeC.UTF8);\r\n    return new Bytes(nb.length,nb);\r\n    #else\r\n\t\tvar a = new Array();\r\n\t\t// utf8-decode\r\n\t\tfor( i in 0...s.length ) {\r\n\t\t\tvar c : Int = untyped s[\"cca\"](i);\r\n\t\t\tif( c <= 0x7F )\r\n\t\t\t\ta.push(c);\r\n\t\t\telse if( c <= 0x7FF ) {\r\n\t\t\t\ta.push( 0xC0 | (c >> 6) );\r\n\t\t\t\ta.push( 0x80 | (c & 63) );\r\n\t\t\t} else if( c <= 0xFFFF ) {\r\n\t\t\t\ta.push( 0xE0 | (c >> 12) );\r\n\t\t\t\ta.push( 0x80 | ((c >> 6) & 63) );\r\n\t\t\t\ta.push( 0x80 | (c & 63) );\r\n\t\t\t} else {\r\n\t\t\t\ta.push( 0xF0 | (c >> 18) );\r\n\t\t\t\ta.push( 0x80 | ((c >> 12) & 63) );\r\n\t\t\t\ta.push( 0x80 | ((c >> 6) & 63) );\r\n\t\t\t\ta.push( 0x80 | (c & 63) );\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn new Bytes(a.length,a);\r\n\t\t#end\r\n\t}\r\n\r\n\tpublic static function ofData( b : BytesData ) {\r\n\t\t#if flash9\r\n\t\treturn new Bytes(b.length,b);\r\n\t\t#elseif neko\r\n\t\treturn new Bytes(untyped __dollar__ssize(b),b);\r\n\t\t#elseif php\r\n\t\treturn new Bytes(untyped __call__(\"strlen\", b), b);\r\n\t\t#else\r\n\t\treturn new Bytes(b.length,b);\r\n\t\t#end\r\n\t}\r\n\r\n}\r\n","/*\n * Copyright (C)2005-2013 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.crypto;\n\n/**\n\tAllows to encode/decode String and bytes using Base64 encoding.\n**/\nclass Base64 {\n\n\tpublic static var CHARS(default,null) = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\tpublic static var BYTES(default,null) = haxe.io.Bytes.ofString(CHARS);\n\t\n\tpublic static function encode( bytes : haxe.io.Bytes, complement = true ) : String {\n\t\tvar str = new BaseCode(BYTES).encodeBytes(bytes).toString();\n\t\tif( complement )\n\t\t\tfor( i in 0...(3-(bytes.length*4)%3)%3 )\n\t\t\t\tstr += \"=\";\n\t\treturn str;\n\t}\n\t\n\tpublic static function decode( str : String, complement = true ) : haxe.io.Bytes {\n\t\tif( complement )\n\t\t\twhile( str.charCodeAt(str.length-1) == \"=\".code )\n\t\t\t\tstr = str.substr(0,-1);\n\t\treturn new BaseCode(BYTES).decodeBytes(haxe.io.Bytes.ofString(str));\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.crypto;\n\n/**\n\tAllows to encode/decode String and bytes using a power of two base dictionnary.\n**/\nclass BaseCode {\n\n\tvar base : haxe.io.Bytes;\n\tvar nbits : Int;\n\tvar tbl : Array<Int>;\n\n\tpublic function new( base : haxe.io.Bytes ) {\n\t\tvar len = base.length;\n\t\tvar nbits = 1;\n\t\twhile( len > 1 << nbits )\n\t\t\tnbits++;\n\t\tif( nbits > 8 || len != 1 << nbits )\n\t\t\tthrow \"BaseCode : base length must be a power of two.\";\n\t\tthis.base = base;\n\t\tthis.nbits = nbits;\n\t}\n\n\tpublic function encodeBytes( b : haxe.io.Bytes ) : haxe.io.Bytes {\n\t\t#if neko\n\t\treturn haxe.io.Bytes.ofData( base_encode(b.getData(),base.getData()) );\n\t\t#else\n\t\tvar nbits = this.nbits;\n\t\tvar base = this.base;\n\t\tvar size = Std.int(b.length * 8 / nbits);\n\t\tvar out = haxe.io.Bytes.alloc(size + (((b.length * 8) % nbits == 0) ? 0 : 1) );\n\t\tvar buf = 0;\n\t\tvar curbits = 0;\n\t\tvar mask = (1 << nbits) - 1;\n\t\tvar pin = 0;\n\t\tvar pout = 0;\n\t\twhile( pout < size ) {\n\t\t\twhile( curbits < nbits ) {\n\t\t\t\tcurbits += 8;\n\t\t\t\tbuf <<= 8;\n\t\t\t\tbuf |= b.get(pin++);\n\t\t\t}\n\t\t\tcurbits -= nbits;\n\t\t\tout.set(pout++,base.get((buf >> curbits) & mask));\n\t\t}\n\t\tif( curbits > 0 )\n\t\t\tout.set(pout++,base.get((buf << (nbits - curbits)) & mask));\n\t\treturn out;\n\t\t#end\n\t}\n\n\tfunction initTable() {\n\t\tvar tbl = new Array();\n\t\tfor( i in 0...256 )\n\t\t\ttbl[i] = -1;\n\t\tfor( i in 0...base.length )\n\t\t\ttbl[base.get(i)] = i;\n\t\tthis.tbl = tbl;\n\t}\n\n\tpublic function decodeBytes( b : haxe.io.Bytes ) : haxe.io.Bytes {\n\t\t#if neko\n\t\treturn haxe.io.Bytes.ofData( base_decode(b.getData(),base.getData()) );\n\t\t#else\n\t\tvar nbits = this.nbits;\n\t\tvar base = this.base;\n\t\tif( this.tbl == null ) initTable();\n\t\tvar tbl = this.tbl;\n\t\tvar size = (b.length * nbits) >> 3;\n\t\tvar out = haxe.io.Bytes.alloc(size);\n\t\tvar buf = 0;\n\t\tvar curbits = 0;\n\t\tvar pin = 0;\n\t\tvar pout = 0;\n\t\twhile( pout < size ) {\n\t\t\twhile( curbits < 8 ) {\n\t\t\t\tcurbits += nbits;\n\t\t\t\tbuf <<= nbits;\n\t\t\t\tvar i = tbl[b.get(pin++)];\n\t\t\t\tif( i == -1 )\n\t\t\t\t\tthrow \"BaseCode : invalid encoded char\";\n\t\t\t\tbuf |= i;\n\t\t\t}\n\t\t\tcurbits -= 8;\n\t\t\tout.set(pout++,(buf >> curbits) & 0xFF);\n\t\t}\n\t\treturn out;\n\t\t#end\n\t}\n\n\tpublic function encodeString( s : String ) {\n\t\t#if neko\n\t\treturn neko.NativeString.toString( base_encode(neko.NativeString.ofString(s),base.getData()) );\n\t\t#else\n\t\treturn encodeBytes(haxe.io.Bytes.ofString(s)).toString();\n\t\t#end\n\t}\n\n\tpublic function decodeString( s : String ) {\n\t\t#if neko\n\t\treturn neko.NativeString.toString( base_decode(neko.NativeString.ofString(s),base.getData()) );\n\t\t#else\n\t\treturn decodeBytes(haxe.io.Bytes.ofString(s)).toString();\n\t\t#end\n\t}\n\n\tpublic static function encode( s : String, base : String ) {\n\t\tvar b = new BaseCode(haxe.io.Bytes.ofString(base));\n\t\treturn b.encodeString(s);\n\t}\n\n\tpublic static function decode( s : String, base : String ) {\n\t\tvar b = new BaseCode(haxe.io.Bytes.ofString(base));\n\t\treturn b.decodeString(s);\n\t}\n\n\t#if neko\n\tprivate static var base_encode = neko.Lib.load(\"std\",\"base_encode\",2);\n\tprivate static var base_decode = neko.Lib.load(\"std\",\"base_decode\",2);\n\t#end\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.ds;\n\n#if (flash9 || cpp)\n@:generic\n#end\nclass GenericCell<T> {\n\tpublic var elt : T;\n\tpublic var next : GenericCell<T>;\n\tpublic function new(elt,next) { this.elt = elt; this.next = next; }\n}\n\n#if cpp\n@:generic\nprivate class GenericStackIterator<T> extends cpp.FastIterator<T> {\n\tpublic var current : GenericCell<T>;\n\toverride public function hasNext():Bool { return current!=null; }\n\toverride public function next():T { var result = current.elt; current = current.next; return result; }\n\n\tpublic function new(head) { current = head; }\n}\n\n#end\n\n/**\n\tA stack of elements.\n\t\n\tThis class is generic, which means one type is generated for each type\n\tparameter T on static targets. For example:\n\t\t\n\t- `new GenericStack<Int>()` generates `GenericStack_Int`\n\t- `new GenericStack<String>()` generates `GenericStack_String`\n\t\n\tThe generated name is an implementation detail and should not be relied\n\tupon.\n**/\n#if (flash9 || cpp)\n@:generic\n#end\nclass GenericStack<T> {\n\n\tpublic var head : GenericCell<T>;\n\n\t/**\n\t\tCreates a new empty GenericStack.\n\t**/\n\tpublic function new() {\n\t}\n\n\t/**\n\t\tPushes element `item` onto the stack.\n\t**/\n\tpublic inline function add( item : T ) {\n\t\thead = new GenericCell<T>(item,head);\n\t}\n\n\t/**\n\t\tReturns the topmost stack element without removing it.\n\t\t\n\t\tIf the stack is empty, null is returned.\n\t**/\n\tpublic inline function first() : Null<T> {\n\t\treturn if( head == null ) null else head.elt;\n\t}\n\n\t/**\n\t\tReturns the topmost stack element and removes it.\n\t\t\n\t\tIf the stack is empty, null is returned.\n\t**/\n\tpublic inline function pop() : Null<T> {\n\t\tvar k = head;\n\t\tif( k== null )\n\t\t\treturn null;\n\t\telse {\n\t\t\thead = k.next;\n\t\t\treturn k.elt;\n\t\t}\n\t}\n\n\t/**\n\t\tTells if the stack is empty.\n\t**/\n\tpublic inline function isEmpty() : Bool {\n\t\treturn (head == null);\n\t}\n\n\t/**\n\t\tRemoves the first element which is equal to `v` according to the `==`\n\t\toperator.\n\t\t\n\t\tThis method traverses the stack until it finds a matching element and\n\t\tunlinks it, returning true.\n\t\t\n\t\tIf no matching element is found, false is returned.\n\t**/\n\tpublic function remove( v : T ) : Bool {\n\t\tvar prev = null;\n\t\tvar l = head;\n\t\twhile( l != null ) {\n\t\t\tif( l.elt == v ) {\n\t\t\t\tif( prev == null )\n\t\t\t\t\thead = l.next;\n\t\t\t\telse\n\t\t\t\t\tprev.next = l.next;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprev = l;\n\t\t\tl = l.next;\n\t\t}\n\t\treturn (l != null);\n\t}\n\n\t#if cpp\n\n\t/**\n\t\tReturns an iterator over the elements of `this` GenericStack.\n\t**/\n\tpublic function iterator() : Iterator<T> {\n\t\treturn new GenericStackIterator<T>(head);\n\t}\n\n\t#else\n\n\t/**\n\t\tReturns an iterator over the elements of `this` GenericStack.\n\t**/\n\tpublic function iterator() : Iterator<T> {\n\t\tvar l = head;\n\t\treturn {\n\t\t\thasNext : function() {\n\t\t\t\treturn l != null;\n\t\t\t},\n\t\t\tnext : function() {\n\t\t\t\tvar k = l;\n\t\t\t\tl = k.next;\n\t\t\t\treturn k.elt;\n\t\t\t}\n\t\t};\n\t}\n   #end\n\n\t/**\n\t\tReturns a String representation of `this` GenericStack.\n\t**/\n\tpublic function toString() {\n\t\tvar a = new Array();\n\t\tvar l = head;\n\t\twhile( l != null ) {\n\t\t\ta.push(l.elt);\n\t\t\tl = l.next;\n\t\t}\n\t\treturn \"{\"+a.join(\",\")+\"}\";\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.ds;\n\n@:coreApi class IntMap<T> implements Map.IMap<Int,T> {\n\n\tprivate var h : Dynamic;\n\n\tpublic function new() : Void {\n\t\th = {};\n\t}\n\n\tpublic function set( key : Int, value : T ) : Void {\n\t\tuntyped h[key] = value;\n\t}\n\n\tpublic function get( key : Int ) : Null<T> {\n\t\treturn untyped h[key];\n\t}\n\n\tpublic function exists( key : Int ) : Bool {\n\t\treturn untyped h.hasOwnProperty(key);\n\t}\n\n\tpublic function remove( key : Int ) : Bool {\n\t\tif( untyped !h.hasOwnProperty(key) ) return false;\n\t\tuntyped  __js__(\"delete\")(h[key]);\n\t\treturn true;\n\t}\n\n\tpublic function keys() : Iterator<Int> {\n\t\tvar a = [];\n\t\tuntyped {\n\t\t\t__js__(\"for( var key in this.h ) {\");\n\t\t\t\tif( h.hasOwnProperty(key) )\n\t\t\t\t\ta.push(key|0);\n\t\t\t__js__(\"}\");\n\t\t}\n\t\treturn a.iterator();\n\t}\n\n\tpublic function iterator() : Iterator<T> {\n\t\treturn untyped {\n\t\t\tref : h,\n\t\t\tit : keys(),\n\t\t\thasNext : function() { return __this__.it.hasNext(); },\n\t\t\tnext : function() { var i = __this__.it.next(); return __this__.ref[i]; }\n\t\t};\n\t}\n\n\tpublic function toString() : String {\n\t\tvar s = new StringBuf();\n\t\ts.add(\"{\");\n\t\tvar it = keys();\n\t\tfor( i in it ) {\n\t\t\ts.add(i);\n\t\t\ts.add(\" => \");\n\t\t\ts.add(Std.string(get(i)));\n\t\t\tif( it.hasNext() )\n\t\t\t\ts.add(\", \");\n\t\t}\n\t\ts.add(\"}\");\n\t\treturn s.toString();\n\t}\n\n}\n","/*\n * Copyright (C)2005-2013 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of h software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and h permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n\npackage haxe.ds;\n\n@:coreApi\nclass ObjectMap<K:{ }, V> implements Map.IMap<K,V> {\n\t\n\tstatic var count = 0;\n\t\n\tstatic inline function assignId(obj: { } ):Int {\n\t\treturn untyped obj.__id__ = ++count;\n\t}\n\t\n\tstatic inline function getId(obj: { } ):Int {\n\t\treturn untyped obj.__id__;\n\t}\n\t\n\tvar h : { };\n\t\n\tpublic function new() : Void {\n\t\th = { };\n\t\tuntyped h.__keys__ = { };\n\t}\n\t\n\tpublic function set(key:K, value:V):Void untyped {\n\t\tvar id : Int = untyped key.__id__ || assignId(key);\n\t\th[id] = value;\n\t\th.__keys__[id] = key;\n\t}\n\t\n\tpublic inline function get(key:K):Null<V> {\n\t\treturn untyped h[getId(key)];\n\t}\n\t\n\tpublic inline function exists(key:K):Bool {\n\t\treturn untyped h.__keys__[getId(key)] != null;\n\t}\n\t\n\tpublic function remove( key : K ) : Bool {\n\t\tvar id = getId(key);\n\t\tif ( untyped h.__keys__[id] == null ) return false;\n\t\tuntyped  __js__(\"delete\")(h[id]);\n\t\tuntyped  __js__(\"delete\")(h.__keys__[id]);\n\t\treturn true;\n\t}\n\t\n\tpublic function keys() : Iterator<K> {\n\t\tvar a = [];\n\t\tuntyped {\n\t\t\t__js__(\"for( var key in this.h.__keys__ ) {\");\n\t\t\t\tif( h.hasOwnProperty(key) )\n\t\t\t\t\ta.push(h.__keys__[key]);\n\t\t\t__js__(\"}\");\n\t\t}\n\t\treturn a.iterator();\n\t}\n\t\n\tpublic function iterator() : Iterator<V> {\n\t\treturn untyped {\n\t\t\tref : h,\n\t\t\tit : keys(),\n\t\t\thasNext : function() { return __this__.it.hasNext(); },\n\t\t\tnext : function() { var i = __this__.it.next(); return __this__.ref[getId(i)]; }\n\t\t};\n\t}\n\t\n\tpublic function toString() : String {\n\t\tvar s = new StringBuf();\n\t\ts.add(\"{\");\n\t\tvar it = keys();\n\t\tfor( i in it ) {\n\t\t\ts.add(Std.string(i));\n\t\t\ts.add(\" => \");\n\t\t\ts.add(Std.string(get(i)));\n\t\t\tif( it.hasNext() )\n\t\t\t\ts.add(\", \");\n\t\t}\n\t\ts.add(\"}\");\n\t\treturn s.toString();\n\t}\n}","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.io;\n\n/**\n\tThis exception is raised when reading while data is no longer available in the [Input].\n**/\nclass Eof {\n\tpublic function new() {\n\t}\n\t@:keep function toString() {\n\t\treturn \"Eof\";\n\t}\n}\n","/*\n * Copyright (C)2005-2013 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n\npackage haxe.macro;\n\nimport haxe.macro.Expr;\nusing Lambda;\n\n/**\n\tThis class provides some utility methods to work with expressions. It is\n\tbest used through 'using haxe.macro.ExprTools' syntax and then provides\n\tadditional methods on haxe.macro.Expr instances.\n\n\tWhile mainly intended to be used in macros, it works in non-macro code as\n\twell.\n**/\nclass ExprTools {\n\n\t/**\n\t\tConverts expression [e] to a human-readable String representation.\n\n\t\tThe result is guaranteed to be valid haxe code, but there may be\n\t\tdifferences from the original lexical syntax.\n\t**/\n\tstatic public function toString( e : Expr ) : String\n\t\treturn new Printer().printExpr(e);\n\n\t/**\n\t\tCalls function [f] on each sub-expression of [e].\n\n\t\tIf [e] has no sub-expressions, this operation has no effect.\n\n\t\tOtherwise [f] is called once per sub-expression of [e], with the\n\t\tsub-expression as argument. These calls are done in order of the\n\t\tsub-expression declarations.\n\n\t\tThis method does not call itself recursively. It should instead be used\n\t\tin a recursive function which handles the expression nodes of interest.\n\n\t\tUsage example:\n\n\t\tfunction findStrings(e:Expr) {\n\t\t\tswitch(e.expr) {\n\t\t\t\tcase EConst(CString(s)):\n\t\t\t\t\t// handle s\n\t\t\t\tcase _:\n\t\t\t\t\tExprTools.iter(e, findStrings);\n\t\t\t}\n\t\t}\n\t**/\n\tstatic public function iter( e : Expr, f : Expr -> Void ) : Void {\n\t\tswitch(e.expr) {\n\t\t\tcase EConst(_),\n\t\t\t\tEContinue,\n\t\t\t\tEBreak,\n\t\t\t\tEDisplayNew(_):\n\t\t\tcase EField(e, _),\n\t\t\t\tEParenthesis(e),\n\t\t\t\tEUntyped(e),\n\t\t\t\tEThrow(e),\n\t\t\t\tEDisplay(e, _),\n\t\t\t\tECheckType(e, _),\n\t\t\t\tEUnop(_, _, e),\n\t\t\t\tECast(e, _),\n\t\t\t\tEMeta(_, e):\n\t\t\t\t\tf(e);\n\t\t\tcase EArray(e1, e2),\n\t\t\t\tEWhile(e1, e2, _),\n\t\t\t\tEBinop(_, e1, e2),\n\t\t\t\tEFor(e1, e2),\n\t\t\t\tEIn(e1, e2):\n\t\t\t\t\tf(e1);\n\t\t\t\t\tf(e2);\n\t\t\tcase EVars(vl):\n\t\t\t\tfor (v in vl)\n\t\t\t\t\topt2(v.expr, f);\n\t\t\tcase ETry(e, cl):\n\t\t\t\tf(e);\n\t\t\t\tfor (c in cl)\n\t\t\t\t\tf(c.expr);\n\t\t\tcase ETernary(e1, e2, e3)\n\t\t\t| EIf(e1, e2, e3):\n\t\t\t\tf(e1);\n\t\t\t\tf(e2);\n\t\t\t\topt2(e3, f);\n\t\t\tcase EArrayDecl(el),\n\t\t\t\tENew(_, el),\n\t\t\t\tEBlock(el):\n\t\t\t\t\tExprArrayTools.iter(el, f);\n\t\t\tcase EObjectDecl(fl):\n\t\t\t\tfor (fd in fl)\n\t\t\t\t\tf(fd.expr);\n\t\t\tcase ECall(e, el):\n\t\t\t\tf(e);\n\t\t\t\tExprArrayTools.iter(el, f);\n\t\t\tcase EReturn(e):\n\t\t\t\topt2(e, f);\n\t\t\tcase EFunction(_, func):\n\t\t\t\tfor (arg in func.args)\n\t\t\t\t\topt2(arg.value, f);\n\t\t\t\topt2(func.expr, f);\n\t\t\tcase ESwitch(e, cl, edef):\n\t\t\t\tf(e);\n\t\t\t\tfor (c in cl) {\n\t\t\t\t\tExprArrayTools.iter(c.values, f);\n\t\t\t\t\topt2(c.guard, f);\n\t\t\t\t\topt2(c.expr, f);\n\t\t\t\t}\n\t\t\t\tif (edef != null && edef.expr != null)\n\t\t\t\t\tf(edef);\n\t\t}\n\t}\n\n\t/**\n\t\tTransforms the sub-expressions of [e] by calling [f] on each of them.\n\n\t\tIf [e] has no sub-expressions, this operation returns [e] unchanged.\n\n\t\tOtherwise [f] is called once per sub-expression of [e], with the\n\t\tsub-expression as argument. These calls are done in order of the\n\t\tsub-expression declarations.\n\n\t\tThis method does not call itself recursively. It should instead be used\n\t\tin a recursive function which handles the expression nodes of interest.\n\n\t\tUsage example:\n\n\t\tfunction capitalizeStrings(e:Expr) {\n\t\t\treturn switch(e.expr) {\n\t\t\t\tcase EConst(CString(s)):\n\t\t\t\t\t{ expr: EConst(CString(s.toUpperCase())), pos: e.pos };\n\t\t\t\tcase _:\n\t\t\t\t\tExprTools.map(e, capitalizeStrings);\n\t\t\t}\n\t\t}\n\t**/\n\tstatic public function map( e : Expr, f : Expr -> Expr ) : Expr {\n\t\treturn {pos: e.pos, expr: switch(e.expr) {\n\t\t\tcase EConst(_): e.expr;\n\t\t\tcase EArray(e1, e2): EArray(f(e1), f(e2));\n\t\t\tcase EBinop(op, e1, e2): EBinop(op, f(e1), f(e2));\n\t\t\tcase EField(e, field): EField(f(e), field);\n\t\t\tcase EParenthesis(e): EParenthesis(f(e));\n\t\t\tcase EObjectDecl(fields):\n\t\t\t\tvar ret = [];\n\t\t\t\tfor (field in fields)\n\t\t\t\t\tret.push( { field: field.field, expr: f(field.expr) } );\n\t\t\t\tEObjectDecl(ret);\n\t\t\tcase EArrayDecl(el): EArrayDecl(ExprArrayTools.map(el, f));\n\t\t\tcase ECall(e, params): ECall(f(e), ExprArrayTools.map(params, f));\n\t\t\tcase ENew(tp, params): ENew(tp, ExprArrayTools.map(params, f));\n\t\t\tcase EUnop(op, postFix, e): EUnop(op, postFix, f(e));\n\t\t\tcase EVars(vars):\n\t\t\t\tvar ret = [];\n\t\t\t\tfor (v in vars)\n\t\t\t\t\tret.push( { name: v.name, type:v.type, expr: opt(v.expr, f) } );\n\t\t\t\tEVars(ret);\n\t\t\tcase EBlock(el): EBlock(ExprArrayTools.map(el, f));\n\t\t\tcase EFor(it, expr): EFor(f(it), f(expr));\n\t\t\tcase EIn(e1, e2): EIn(f(e1), f(e2));\n\t\t\tcase EIf(econd, eif, eelse): EIf(f(econd), f(eif), opt(eelse, f));\n\t\t\tcase EWhile(econd, e, normalWhile): EWhile(f(econd), f(e), normalWhile);\n\t\t\tcase EReturn(e): EReturn(opt(e,f));\n\t\t\tcase EUntyped(e): EUntyped(f(e));\n\t\t\tcase EThrow(e): EThrow(f(e));\n\t\t\tcase ECast(e, t): ECast(f(e), t);\n\t\t\tcase EDisplay(e, isCall): EDisplay(f(e), isCall);\n\t\t\tcase ETernary(econd, eif, eelse): ETernary(f(econd), f(eif), f(eelse));\n\t\t\tcase ECheckType(e, t): ECheckType(f(e), t);\n\t\t\tcase EDisplayNew(_),\n\t\t\t\tEContinue,\n\t\t\t\tEBreak:\n\t\t\t\t\te.expr;\n\t\t\tcase ETry(e, catches):\n\t\t\t\tvar ret = [];\n\t\t\t\tfor (c in catches)\n\t\t\t\t\tret.push( { name:c.name, type:c.type, expr:f(c.expr) } );\n\t\t\t\tETry(f(e), ret);\n\t\t\tcase ESwitch(e, cases, edef):\n\t\t\t\tvar ret = [];\n\t\t\t\tfor (c in cases)\n\t\t\t\t\tret.push( { expr: opt (c.expr, f), guard: opt(c.guard, f), values: ExprArrayTools.map(c.values, f) } );\n\t\t\t\tESwitch(f(e), ret, edef == null || edef.expr == null ? edef : f(edef));\n\t\t\tcase EFunction(name, func):\n\t\t\t\tvar ret = [];\n\t\t\t\tfor (arg in func.args)\n\t\t\t\t\tret.push( { name: arg.name, opt: arg.opt, type: arg.type, value: opt(arg.value, f) } );\n\t\t\t\tEFunction(name, { args: ret, ret: func.ret, params: func.params, expr: f(func.expr) } );\n\t\t\tcase EMeta(m, e): EMeta(m, f(e));\n\t\t}};\n\t}\n\n\t/**\n\t\tReturns the value `e` represents.\n\t\t\n\t\tSupported expressions are:\n\t\t\t- `Int`, `Float` and `String` literals\n\t\t\t- identifiers `true`, `false` and `null`\n\t\t\t- structure declarations if all their fields are values\n\t\t\t- array declarations if all their elements are values\n\t\t\t- unary operators `-`, `!` and `~` if the operand is a value\n\t\t\t- binary operators except `=>`, `...` and assignments\n\t\t\t\n\t\tParentheses, metadata and the `untyped` keyword are ignored.\n\t\t\n\t\tIf any non-value is encountered, an exception of type `String` is\n\t\tthrown.\n\t\t\n\t\tIf `e` is null, the result is unspecified.\n\t**/\n\tstatic public function getValue(e:Expr):Dynamic {\n\t\treturn switch (e.expr) {\n\t\t\tcase EConst(CInt(v)): Std.parseInt(v);\n\t\t\tcase EConst(CFloat(v)): Std.parseFloat(v);\n\t\t\tcase EConst(CString(s)): s;\n\t\t\tcase EConst(CIdent(\"true\")): true;\n\t\t\tcase EConst(CIdent(\"false\")): false;\n\t\t\tcase EConst(CIdent(\"null\")): null;\n\t\t\tcase EParenthesis(e1) | EUntyped(e1) | EMeta(_, e1): getValue(e1);\n\t\t\tcase EObjectDecl(fields):\n\t\t\t\tvar obj = {};\n\t\t\t\tfor (field in fields) {\n\t\t\t\t\tReflect.setField(obj, field.field, getValue(field.expr));\n\t\t\t\t}\n\t\t\t\tobj;\n\t\t\tcase EArrayDecl(el): el.map(getValue);\n\t\t\tcase EUnop(op, false, e1):\n\t\t\t\tvar e1:Dynamic = getValue(e1);\n\t\t\t\tswitch (op) {\n\t\t\t\t\tcase OpNot: !e1;\n\t\t\t\t\tcase OpNeg: -e1;\n\t\t\t\t\tcase OpNegBits: ~e1;\n\t\t\t\t\tcase _: throw 'Unsupported expression: $e';\n\t\t\t\t}\n\t\t\tcase EBinop(op, e1, e2):\n\t\t\t\tvar e1:Dynamic = getValue(e1);\n\t\t\t\tvar e2:Dynamic = getValue(e2);\n\t\t\t\tswitch (op) {\n\t\t\t\t\tcase OpAdd: e1 + e2;\n\t\t\t\t\tcase OpSub: e1 - e2;\n\t\t\t\t\tcase OpMult: e1 * e2;\n\t\t\t\t\tcase OpDiv: e1 / e2;\n\t\t\t\t\tcase OpMod: e1 % e2;\n\t\t\t\t\tcase OpEq: e1 == e2;\n\t\t\t\t\tcase OpNotEq: e1 != e2;\n\t\t\t\t\tcase OpLt: e1 < e2;\n\t\t\t\t\tcase OpLte: e1 <= e2;\n\t\t\t\t\tcase OpGt: e1 > e2;\n\t\t\t\t\tcase OpGte: e1 >= e2;\n\t\t\t\t\tcase OpOr: e1 | e2;\n\t\t\t\t\tcase OpAnd: e1 & e2;\n\t\t\t\t\tcase OpXor: e1 ^ e2;\n\t\t\t\t\tcase OpBoolAnd: e1 && e2;\n\t\t\t\t\tcase OpBoolOr: e1 || e2;\n\t\t\t\t\tcase OpShl: e1 << e2;\n\t\t\t\t\tcase OpShr: e1 >> e2;\n\t\t\t\t\tcase OpUShr: e1 >>> e2;\n\t\t\t\t\tcase _: throw 'Unsupported expression: $e';\n\t\t\t\t}\n\t\t\tcase _: throw 'Unsupported expression: $e';\n\t\t}\n\t}\n\t\n\tstatic inline function opt(e:Null<Expr>, f : Expr -> Expr):Expr\n\t\treturn e == null ? null : f(e);\n\n\tstatic inline function opt2(e:Null<Expr>, f : Expr -> Void):Void\n\t\tif (e != null) f(e);\n}\n\n/**\n\tThis class provides functions on expression arrays for convenience. For a\n\tdetailed reference on each method, see the documentation of ExprTools.\n */\nclass ExprArrayTools {\n\tstatic public function map( el : Array<Expr>, f : Expr -> Expr):Array<Expr> {\n\t\tvar ret = [];\n\t\tfor (e in el)\n\t\t\tret.push(f(e));\n\t\treturn ret;\n\t}\n\n\tstatic public function iter( el : Array<Expr>, f : Expr -> Void):Void {\n\t\tfor (e in el)\n\t\t\tf(e);\n\t}\n}","/*\n * Copyright (C)2005-2013 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n\npackage haxe.macro;\n\nimport haxe.macro.Expr;\nusing Lambda;\n\nclass Printer {\n\tvar tabs:String;\n\tvar tabString:String;\n\n\tpublic function new(?tabString = \"\\t\") {\n\t\ttabs = \"\";\n\t\tthis.tabString = tabString;\n\t}\n\n\tpublic function printUnop(op:Unop) return switch(op) {\n\t\tcase OpIncrement: \"++\";\n\t\tcase OpDecrement: \"--\";\n\t\tcase OpNot: \"!\";\n\t\tcase OpNeg: \"-\";\n\t\tcase OpNegBits: \"~\";\n\t}\n\n\tpublic function printBinop(op:Binop) return switch(op) {\n\t\tcase OpAdd: \"+\";\n\t\tcase OpMult: \"*\";\n\t\tcase OpDiv: \"/\";\n\t\tcase OpSub: \"-\";\n\t\tcase OpAssign: \"=\";\n\t\tcase OpEq: \"==\";\n\t\tcase OpNotEq: \"!=\";\n\t\tcase OpGt: \">\";\n\t\tcase OpGte: \">=\";\n\t\tcase OpLt: \"<\";\n\t\tcase OpLte: \"<=\";\n\t\tcase OpAnd: \"&\";\n\t\tcase OpOr: \"|\";\n\t\tcase OpXor: \"^\";\n\t\tcase OpBoolAnd: \"&&\";\n\t\tcase OpBoolOr: \"||\";\n\t\tcase OpShl: \"<<\";\n\t\tcase OpShr: \">>\";\n\t\tcase OpUShr: \">>>\";\n\t\tcase OpMod: \"%\";\n\t\tcase OpInterval: \"...\";\n\t\tcase OpArrow: \"=>\";\n\t\tcase OpAssignOp(op):\n\t\t\tprintBinop(op)\n\t\t\t+ \"=\";\n\t}\n\tpublic function printString(s:String) {\n\t\treturn '\"' + s.split(\"\\n\").join(\"\\\\n\").split(\"\\t\").join(\"\\\\t\").split(\"'\").join(\"\\\\'\").split('\"').join(\"\\\\\\\"\") #if sys .split(\"\\x00\").join(\"\\\\x00\") #end + '\"';\n\t}\n\tpublic function printConstant(c:Constant) return switch(c) {\n\t\tcase CString(s): printString(s);\n\t\tcase CIdent(s),\n\t\t\tCInt(s),\n\t\t\tCFloat(s):\n\t\t\t\ts;\n\t\tcase CRegexp(s,opt): '~/$s/$opt';\n\t}\n\n\tpublic function printTypeParam(param:TypeParam) return switch(param) {\n\t\tcase TPType(ct): printComplexType(ct);\n\t\tcase TPExpr(e): printExpr(e);\n\t}\n\n\tpublic function printTypePath(tp:TypePath) return\n\t\t(tp.pack.length > 0 ? tp.pack.join(\".\") + \".\" : \"\")\n\t\t+ tp.name\n\t\t+ (tp.sub != null ? '.${tp.sub}' : \"\")\n\t\t+ (tp.params.length > 0 ? \"<\" + tp.params.map(printTypeParam).join(\", \") + \">\" : \"\");\n\n\t// TODO: check if this can cause loops\n\tpublic function printComplexType(ct:ComplexType) return switch(ct) {\n\t\tcase TPath(tp): printTypePath(tp);\n\t\tcase TFunction(args, ret): (args.length>0 ? args.map(printComplexType).join(\" -> \") : \"Void\") + \" -> \" + printComplexType(ret);\n\t\tcase TAnonymous(fields): \"{ \" + [for (f in fields) printField(f) + \"; \"].join(\"\") + \"}\";\n\t\tcase TParent(ct): \"(\" + printComplexType(ct) + \")\";\n\t\tcase TOptional(ct): \"?\" + printComplexType(ct);\n\t\tcase TExtend(tpl, fields): '{> ${tpl.map(printTypePath).join(\" >, \")}, ${fields.map(printField).join(\", \")} }';\n\t}\n\n\tpublic function printMetadata(meta:MetadataEntry) return\n\t\t'@${meta.name}'\n\t\t+ (meta.params.length > 0 ? '(${printExprs(meta.params,\", \")})' : \"\");\n\n\tpublic function printAccess(access:Access) return switch(access) {\n\t\tcase AStatic: \"static\";\n\t\tcase APublic: \"public\";\n\t\tcase APrivate: \"private\";\n\t\tcase AOverride: \"override\";\n\t\tcase AInline: \"inline\";\n\t\tcase ADynamic: \"dynamic\";\n\t\tcase AMacro: \"macro\";\n\t}\n\t\n\tpublic function printField(field:Field) return\n\t\t(field.doc != null && field.doc != \"\" ? \"/**\\n\" + tabs + tabString + StringTools.replace(field.doc, \"\\n\", \"\\n\" + tabs + tabString) + \"\\n\" + tabs + \"**/\\n\" + tabs : \"\")\n\t\t+ (field.meta != null && field.meta.length > 0 ? field.meta.map(printMetadata).join('\\n$tabs') + '\\n$tabs' : \"\")\n\t\t+ (field.access != null && field.access.length > 0 ? field.access.map(printAccess).join(\" \") + \" \" : \"\")\n\t\t+ switch(field.kind) {\n\t\t  case FVar(t, eo): 'var ${field.name}' + opt(t, printComplexType, \" : \") + opt(eo, printExpr, \" = \");\n\t\t  case FProp(get, set, t, eo): 'var ${field.name}($get, $set)' + opt(t, printComplexType, \" : \") + opt(eo, printExpr, \" = \");\n\t\t  case FFun(func): 'function ${field.name}' + printFunction(func);\n\t\t}\n\n\tpublic function printTypeParamDecl(tpd:TypeParamDecl) return\n\t\ttpd.name\n\t\t+ (tpd.params != null && tpd.params.length > 0 ? \"<\" + tpd.params.map(printTypeParamDecl).join(\", \") + \">\" : \"\")\n\t\t+ (tpd.constraints != null && tpd.constraints.length > 0 ? \":(\" + tpd.constraints.map(printComplexType).join(\", \") + \")\" : \"\");\n\n\tpublic function printFunctionArg(arg:FunctionArg) return\n\t\t(arg.opt ? \"?\" : \"\")\n\t\t+ arg.name\n\t\t+ opt(arg.type, printComplexType, \":\")\n\t\t+ opt(arg.value, printExpr, \" = \");\n\n\tpublic function printFunction(func:Function) return\n\t\t(func.params.length > 0 ? \"<\" + func.params.map(printTypeParamDecl).join(\", \") + \">\" : \"\")\n\t\t+ \"(\" + func.args.map(printFunctionArg).join(\", \") + \")\"\n\t\t+ opt(func.ret, printComplexType, \":\")\n\t\t+ opt(func.expr, printExpr, \" \");\n\n\tpublic function printVar(v:Var) return\n\t\tv.name\n\t\t+ opt(v.type, printComplexType, \":\")\n\t\t+ opt(v.expr, printExpr, \" = \");\n\n\n\tpublic function printExpr(e:Expr) return e == null ? \"#NULL\" : switch(e.expr) {\n\t\tcase EConst(c): printConstant(c);\n\t\tcase EArray(e1, e2): '${printExpr(e1)}[${printExpr(e2)}]';\n\t\tcase EBinop(op, e1, e2): '${printExpr(e1)} ${printBinop(op)} ${printExpr(e2)}';\n\t\tcase EField(e1, n): '${printExpr(e1)}.$n';\n\t\tcase EParenthesis(e1): '(${printExpr(e1)})';\n\t\tcase EObjectDecl(fl):\n\t\t\t\"{ \" + fl.map(function(fld) return '${fld.field} : ${printExpr(fld.expr)}').join(\", \") + \" }\";\n\t\tcase EArrayDecl(el): '[${printExprs(el, \", \")}]';\n\t\tcase ECall(e1, el): '${printExpr(e1)}(${printExprs(el,\", \")})';\n\t\tcase ENew(tp, el): 'new ${printTypePath(tp)}(${printExprs(el,\", \")})';\n\t\tcase EUnop(op, true, e1): printExpr(e1) + printUnop(op);\n\t\tcase EUnop(op, false, e1): printUnop(op) + printExpr(e1);\n\t\tcase EFunction(no, func) if (no != null): 'function $no' + printFunction(func);\n\t\tcase EFunction(_, func): \"function\" +printFunction(func);\n\t\tcase EVars(vl): \"var \" +vl.map(printVar).join(\", \");\n\t\tcase EBlock([]): '{ }';\n\t\tcase EBlock(el):\n\t\t\tvar old = tabs;\n\t\t\ttabs += tabString;\n\t\t\tvar s = '{\\n$tabs' + printExprs(el, ';\\n$tabs');\n\t\t\ttabs = old;\n\t\t\ts + ';\\n$tabs}';\n\t\tcase EFor(e1, e2): 'for (${printExpr(e1)}) ${printExpr(e2)}';\n\t\tcase EIn(e1, e2): '${printExpr(e1)} in ${printExpr(e2)}';\n\t\tcase EIf(econd, eif, null): 'if (${printExpr(econd)}) ${printExpr(eif)}';\n\t\tcase EIf(econd, eif, eelse): 'if (${printExpr(econd)}) ${printExpr(eif)} else ${printExpr(eelse)}';\n\t\tcase EWhile(econd, e1, true): 'while (${printExpr(econd)}) ${printExpr(e1)}';\n\t\tcase EWhile(econd, e1, false): 'do ${printExpr(e1)} while (${printExpr(econd)})';\n\t\tcase ESwitch(e1, cl, edef):\n\t\t\tvar old = tabs;\n\t\t\ttabs += tabString;\n\t\t\tvar s = 'switch ${printExpr(e1)} {\\n$tabs' +\n\t\t\t\tcl.map(function(c)\n\t\t\t\t\treturn 'case ${printExprs(c.values, \", \")}'\n\t\t\t\t\t\t+ (c.guard != null ? ' if (${printExpr(c.guard)}):' : \":\")\n\t\t\t\t\t\t+ (c.expr != null ? (opt(c.expr, printExpr)) + \";\" : \"\"))\n\t\t\t\t.join('\\n$tabs');\n\t\t\tif (edef != null)\n\t\t\t\ts += '\\n${tabs}default:' + (edef.expr == null ? \"\" : printExpr(edef) + \";\");\n\t\t\ttabs = old;\n\t\t\ts + '\\n$tabs}';\n\t\tcase ETry(e1, cl):\n\t\t\t'try ${printExpr(e1)}'\n\t\t\t+ cl.map(function(c) return ' catch(${c.name}:${printComplexType(c.type)}) ${printExpr(c.expr)}').join(\"\");\n\t\tcase EReturn(eo): \"return\" + opt(eo, printExpr, \" \");\n\t\tcase EBreak: \"break\";\n\t\tcase EContinue: \"continue\";\n\t\tcase EUntyped(e1): \"untyped \" +printExpr(e1);\n\t\tcase EThrow(e1): \"throw \" +printExpr(e1);\n\t\tcase ECast(e1, cto) if (cto != null): 'cast(${printExpr(e1)}, ${printComplexType(cto)})';\n\t\tcase ECast(e1, _): \"cast \" +printExpr(e1);\n\t\tcase EDisplay(e1, _): '#DISPLAY(${printExpr(e1)})';\n\t\tcase EDisplayNew(tp): '#DISPLAY(${printTypePath(tp)})';\n\t\tcase ETernary(econd, eif, eelse): '${printExpr(econd)} ? ${printExpr(eif)} : ${printExpr(eelse)}';\n\t\tcase ECheckType(e1, ct): '(${printExpr(e1)} : ${printComplexType(ct)})';\n\t\tcase EMeta(meta, e1): printMetadata(meta) + \" \" +printExpr(e1);\n\t}\n\n\tpublic function printExprs(el:Array<Expr>, sep:String) {\n\t\treturn el.map(printExpr).join(sep);\n\t}\n\t\n\tfunction printExtension(tpl:Array<TypePath>, fields: Array<Field>) {\n\t\treturn '{\\n$tabs>' + tpl.map(printTypePath).join(',\\n$tabs>') + \",\"\n\t\t    + (fields.length > 0 ? ('\\n$tabs' + fields.map(printField).join(';\\n$tabs') + \";\\n}\") : (\"\\n}\"));\n\t}\n\t\n\tfunction printStructure(fields:Array<Field>) {\n\t\treturn fields.length == 0 ? \"{ }\" :\n\t\t\t'{\\n$tabs' + fields.map(printField).join(';\\n$tabs') + \";\\n}\";\n\t}\n\t\n\tpublic function printTypeDefinition(t:TypeDefinition, printPackage = true):String {\n\t\tvar old = tabs;\n\t\ttabs = tabString;\n\t\t\n\t\tvar str = t == null ? \"#NULL\" :\n\t\t\t(printPackage && t.pack.length > 0 && t.pack[0] != \"\" ? \"package \" + t.pack.join(\".\") + \";\\n\" : \"\") +\n\t\t\t(t.meta != null && t.meta.length > 0 ? t.meta.map(printMetadata).join(\" \") + \" \" : \"\") + (t.isExtern ? \"extern \" : \"\") + switch (t.kind) {\n\t\t\t\tcase TDEnum:\n\t\t\t\t\t\"enum \" + t.name + (t.params.length > 0 ? \"<\" + t.params.map(printTypeParamDecl).join(\", \") + \">\" : \"\") + \" {\\n\"\n\t\t\t\t\t+ [for (field in t.fields)\n\t\t\t\t\t\ttabs + (field.doc != null && field.doc != \"\" ? \"/**\\n\" + tabs + tabString + StringTools.replace(field.doc, \"\\n\", \"\\n\" + tabs + tabString) + \"\\n\" + tabs + \"**/\\n\" + tabs : \"\")\n\t\t\t\t\t\t+ (field.meta != null && field.meta.length > 0 ? field.meta.map(printMetadata).join(\" \") + \" \" : \"\")\n\t\t\t\t\t\t+ (switch(field.kind) {\n\t\t\t\t\t\t\tcase FVar(t, _): field.name + opt(t, printComplexType, \":\");\n\t\t\t\t\t\t\tcase FProp(_, _, _, _): throw \"FProp is invalid for TDEnum.\";\n\t\t\t\t\t\t\tcase FFun(func): field.name + printFunction(func);\n\t\t\t\t\t\t}) + \";\"\n\t\t\t\t\t].join(\"\\n\")\n\t\t\t\t\t+ \"\\n}\";\n\t\t\t\tcase TDStructure:\n\t\t\t\t\t\"typedef \" + t.name + (t.params.length > 0 ? \"<\" + t.params.map(printTypeParamDecl).join(\", \") + \">\" : \"\") + \" = {\\n\"\n\t\t\t\t\t+ [for (f in t.fields) {\n\t\t\t\t\t\ttabs + printField(f) + \";\";\n\t\t\t\t\t}].join(\"\\n\")\n\t\t\t\t\t+ \"\\n}\";\n\t\t\t\tcase TDClass(superClass, interfaces, isInterface):\n\t\t\t\t\t(isInterface ? \"interface \" : \"class \") + t.name + (t.params.length > 0 ? \"<\" + t.params.map(printTypeParamDecl).join(\", \") + \">\" : \"\")\n\t\t\t\t\t+ (superClass != null ? \" extends \" + printTypePath(superClass) : \"\")\n\t\t\t\t\t+ (interfaces != null ? (isInterface ? [for (tp in interfaces) \" extends \" + printTypePath(tp)] : [for (tp in interfaces) \" implements \" + printTypePath(tp)]).join(\"\") : \"\")\n\t\t\t\t\t+ \" {\\n\"\n\t\t\t\t\t+ [for (f in t.fields) {\n\t\t\t\t\t\tvar fstr = printField(f);\n\t\t\t\t\t\ttabs + fstr + switch(f.kind) {\n\t\t\t\t\t\t\tcase FVar(_, _), FProp(_, _, _, _): \";\";\n\t\t\t\t\t\t\tcase FFun(func) if (func.expr == null): \";\";\n\t\t\t\t\t\t\tcase _: \"\";\n\t\t\t\t\t\t};\n\t\t\t\t\t}].join(\"\\n\")\n\t\t\t\t\t+ \"\\n}\";\n\t\t\t\tcase TDAlias(ct):\n\t\t\t\t\t\"typedef \" + t.name + (t.params.length > 0 ? \"<\" + t.params.map(printTypeParamDecl).join(\", \") + \">\" : \"\") + \" = \"\n\t\t\t\t\t+ (switch(ct) {\n\t\t\t\t\t\tcase TExtend(tpl, fields): printExtension(tpl, fields);\n\t\t\t\t\t\tcase TAnonymous(fields): printStructure(fields);\n\t\t\t\t\t\tcase _: printComplexType(ct);\n\t\t\t\t\t})\n\t\t\t\t\t+ \";\";\n\t\t\t\tcase TDAbstract(tthis, from, to):\n\t\t\t\t\t\"abstract \" + t.name\n\t\t\t\t\t+ (t.params.length > 0 ? \"<\" + t.params.map(printTypeParamDecl).join(\", \") + \">\" : \"\")\n\t\t\t\t\t+ (tthis == null ? \"\" : \"(\" + printComplexType(tthis) + \")\")\n\t\t\t\t\t+ (from == null ? \"\" : [for (f in from) \" from \" + printComplexType(f)].join(\"\"))\n\t\t\t\t\t+ (to == null ? \"\" : [for (t in to) \" to \" + printComplexType(t)].join(\"\"))\n\t\t\t\t\t+ \" {\\n\"\n\t\t\t\t\t+ [for (f in t.fields) {\n\t\t\t\t\t\tvar fstr = printField(f);\n\t\t\t\t\t\ttabs + fstr + switch(f.kind) {\n\t\t\t\t\t\t\tcase FVar(_, _), FProp(_, _, _, _): \";\";\n\t\t\t\t\t\t\tcase FFun(func) if (func.expr == null): \";\";\n\t\t\t\t\t\t\tcase _: \"\";\n\t\t\t\t\t\t};\n\t\t\t\t\t}].join(\"\\n\")\n\t\t\t\t\t+ \"\\n}\";\n\t\t\t}\n\t\t\n\t\ttabs = old;\n\t\treturn str;\n\t}\n\n\tfunction opt<T>(v:T, f:T->String, prefix = \"\") return v == null ? \"\" : (prefix + f(v));\n}","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.xml;\n\nprivate class NodeAccess implements Dynamic<Fast> {\n\n\tvar __x : Xml;\n\n\tpublic function new( x : Xml ) {\n\t\t__x = x;\n\t}\n\n\tpublic function resolve( name : String ) : Fast {\n\t\tvar x = __x.elementsNamed(name).next();\n\t\tif( x == null ) {\n\t\t\tvar xname = if( __x.nodeType == Xml.Document ) \"Document\" else __x.nodeName;\n\t\t\tthrow xname+\" is missing element \"+name;\n\t\t}\n\t\treturn new Fast(x);\n\t}\n\n}\n\nprivate class AttribAccess implements Dynamic<String> {\n\n\tvar __x : Xml;\n\n\tpublic function new( x : Xml ) {\n\t\t__x = x;\n\t}\n\n\tpublic function resolve( name : String ) : String {\n\t\tif( __x.nodeType == Xml.Document )\n\t\t\tthrow \"Cannot access document attribute \"+name;\n\t\tvar v = __x.get(name);\n\t\tif( v == null )\n\t\t\tthrow __x.nodeName+\" is missing attribute \"+name;\n\t\treturn v;\n\t}\n\n}\n\nprivate class HasAttribAccess implements Dynamic<Bool> {\n\n\tvar __x : Xml;\n\n\tpublic function new( x : Xml ) {\n\t\t__x = x;\n\t}\n\n\tpublic function resolve( name : String ) : Bool {\n\t\tif( __x.nodeType == Xml.Document )\n\t\t\tthrow \"Cannot access document attribute \"+name;\n\t\treturn __x.exists(name);\n\t}\n\n}\n\nprivate class HasNodeAccess implements Dynamic<Bool> {\n\n\tvar __x : Xml;\n\n\tpublic function new( x : Xml ) {\n\t\t__x = x;\n\t}\n\n\tpublic function resolve( name : String ) : Bool {\n\t\treturn __x.elementsNamed(name).hasNext();\n\t}\n\n}\n\nprivate class NodeListAccess implements Dynamic<List<Fast>> {\n\n\tvar __x : Xml;\n\n\tpublic function new( x : Xml ) {\n\t\t__x = x;\n\t}\n\n\tpublic function resolve( name : String ) : List<Fast> {\n\t\tvar l = new List();\n\t\tfor( x in __x.elementsNamed(name) )\n\t\t\tl.add(new Fast(x));\n\t\treturn l;\n\t}\n\n}\n\nclass Fast {\n\n\tpublic var x(default,null) : Xml;\n\tpublic var name(get,null) : String;\n\tpublic var innerData(get,null) : String;\n\tpublic var innerHTML(get,null) : String;\n\tpublic var node(default,null) : NodeAccess;\n\tpublic var nodes(default,null) : NodeListAccess;\n\tpublic var att(default,null) : AttribAccess;\n\tpublic var has(default,null) : HasAttribAccess;\n\tpublic var hasNode(default,null) : HasNodeAccess;\n\tpublic var elements(get,null) : Iterator<Fast>;\n\n\tpublic function new( x : Xml ) {\n\t\tif( x.nodeType != Xml.Document && x.nodeType != Xml.Element )\n\t\t\tthrow \"Invalid nodeType \"+x.nodeType;\n\t\tthis.x = x;\n\t\tnode = new NodeAccess(x);\n\t\tnodes = new NodeListAccess(x);\n\t\tatt = new AttribAccess(x);\n\t\thas = new HasAttribAccess(x);\n\t\thasNode = new HasNodeAccess(x);\n\t}\n\n\tfunction get_name() {\n\t\treturn if( x.nodeType == Xml.Document ) \"Document\" else x.nodeName;\n\t}\n\n\tfunction get_innerData() {\n\t\tvar it = x.iterator();\n\t\tif( !it.hasNext() )\n\t\t\tthrow name+\" does not have data\";\n\t\tvar v = it.next();\n\t\tvar n = it.next();\n\t\tif( n != null ) {\n\t\t\t// handle <spaces>CDATA<spaces>\n\t\t\tif( v.nodeType == Xml.PCData && n.nodeType == Xml.CData && StringTools.trim(v.nodeValue) == \"\" ) {\n\t\t\t\tvar n2 = it.next();\n\t\t\t\tif( n2 == null || (n2.nodeType == Xml.PCData && StringTools.trim(n2.nodeValue) == \"\" && it.next() == null) )\n\t\t\t\t\treturn n.nodeValue;\n\t\t\t}\n\t\t\tthrow name+\" does not only have data\";\n\t\t}\n\t\tif( v.nodeType != Xml.PCData && v.nodeType != Xml.CData )\n\t\t\tthrow name+\" does not have data\";\n\t\treturn v.nodeValue;\n\t}\n\n\tfunction get_innerHTML() {\n\t\tvar s = new StringBuf();\n\t\tfor( x in x )\n\t\t\ts.add(x.toString());\n\t\treturn s.toString();\n\t}\n\n\tfunction get_elements() {\n\t\tvar it = x.elements();\n\t\treturn {\n\t\t\thasNext : it.hasNext,\n\t\t\tnext : function() {\n\t\t\t\tvar x = it.next();\n\t\t\t\tif( x == null )\n\t\t\t\t\treturn null;\n\t\t\t\treturn new Fast(x);\n\t\t\t}\n\t\t};\n\t}\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.xml;\n\nusing StringTools;\n\n/* poor'man enum : reduce code size + a bit faster since inlined */\nextern private class S {\n\tpublic static inline var IGNORE_SPACES \t= 0;\n\tpublic static inline var BEGIN\t\t\t= 1;\n\tpublic static inline var BEGIN_NODE\t\t= 2;\n\tpublic static inline var TAG_NAME\t\t= 3;\n\tpublic static inline var BODY\t\t\t= 4;\n\tpublic static inline var ATTRIB_NAME\t= 5;\n\tpublic static inline var EQUALS\t\t\t= 6;\n\tpublic static inline var ATTVAL_BEGIN\t= 7;\n\tpublic static inline var ATTRIB_VAL\t\t= 8;\n\tpublic static inline var CHILDS\t\t\t= 9;\n\tpublic static inline var CLOSE\t\t\t= 10;\n\tpublic static inline var WAIT_END\t\t= 11;\n\tpublic static inline var WAIT_END_RET\t= 12;\n\tpublic static inline var PCDATA\t\t\t= 13;\n\tpublic static inline var HEADER\t\t\t= 14;\n\tpublic static inline var COMMENT\t\t= 15;\n\tpublic static inline var DOCTYPE\t\t= 16;\n\tpublic static inline var CDATA\t\t\t= 17;\n\tpublic static inline var ESCAPE\t\t\t= 18;\n}\n\nclass Parser\n{\n\tstatic var escapes = {\n\t\tvar h = new haxe.ds.StringMap();\n\t\th.set(\"lt\", \"<\");\n\t\th.set(\"gt\", \">\");\n\t\th.set(\"amp\", \"&\");\n\t\th.set(\"quot\", '\"');\n\t\th.set(\"apos\", \"'\");\n\t\th.set(\"nbsp\", String.fromCharCode(160));\n\t\th;\n\t}\n\t\n\tstatic public function parse(str:String)\n\t{\n\t\tvar doc = Xml.createDocument();\n\t\tdoParse(str, 0, doc);\n\t\treturn doc;\n\t}\n\t\n\tstatic function doParse(str:String, p:Int = 0, ?parent:Xml):Int\n\t{\n\t\tvar xml:Xml = null;\n\t\tvar state = S.BEGIN;\n\t\tvar next = S.BEGIN;\n\t\tvar aname = null;\n\t\tvar start = 0;\n\t\tvar nsubs = 0;\n\t\tvar nbrackets = 0;\n\t\tvar c = str.fastCodeAt(p);\n\t\tvar buf = new StringBuf();\n\t\twhile (!StringTools.isEof(c))\n\t\t{\n\t\t\tswitch(state)\n\t\t\t{\n\t\t\t\tcase S.IGNORE_SPACES:\n\t\t\t\t\tswitch(c)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase\n\t\t\t\t\t\t\t'\\n'.code,\n\t\t\t\t\t\t\t'\\r'.code,\n\t\t\t\t\t\t\t'\\t'.code,\n\t\t\t\t\t\t\t' '.code:\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tstate = next;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\tcase S.BEGIN:\n\t\t\t\t\tswitch(c)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase '<'.code:\n\t\t\t\t\t\t\tstate = S.IGNORE_SPACES;\n\t\t\t\t\t\t\tnext = S.BEGIN_NODE;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tstart = p;\n\t\t\t\t\t\t\tstate = S.PCDATA;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\tcase S.PCDATA:\n\t\t\t\t\tif (c == '<'.code)\n\t\t\t\t\t{\n\t\t\t\t\t\t#if php\n\t\t\t\t\t\tvar child = Xml.createPCDataFromCustomParser(buf.toString() + str.substr(start, p - start));\n\t\t\t\t\t\t#else\n\t\t\t\t\t\tvar child = Xml.createPCData(buf.toString() + str.substr(start, p - start));\n\t\t\t\t\t\t#end\n\t\t\t\t\t\tbuf = new StringBuf();\n\t\t\t\t\t\tparent.addChild(child);\n\t\t\t\t\t\tnsubs++;\n\t\t\t\t\t\tstate = S.IGNORE_SPACES;\n\t\t\t\t\t\tnext = S.BEGIN_NODE;\n\t\t\t\t\t}\n\t\t\t\t\t#if !flash9\n\t\t\t\t\telse if (c == '&'.code) {\n\t\t\t\t\t\tbuf.addSub(str, start, p - start);\n\t\t\t\t\t\tstate = S.ESCAPE;\n\t\t\t\t\t\tnext = S.PCDATA;\n\t\t\t\t\t\tstart = p + 1;\n\t\t\t\t\t}\n\t\t\t\t\t#end\n\t\t\t\tcase S.CDATA:\n\t\t\t\t\tif (c == ']'.code && str.fastCodeAt(p + 1) == ']'.code && str.fastCodeAt(p + 2) == '>'.code)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar child = Xml.createCData(str.substr(start, p - start));\n\t\t\t\t\t\tparent.addChild(child);\n\t\t\t\t\t\tnsubs++;\n\t\t\t\t\t\tp += 2;\n\t\t\t\t\t\tstate = S.BEGIN;\n\t\t\t\t\t}\n\t\t\t\tcase S.BEGIN_NODE:\n\t\t\t\t\tswitch(c)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase '!'.code:\n\t\t\t\t\t\t\tif (str.fastCodeAt(p + 1) == '['.code)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tp += 2;\n\t\t\t\t\t\t\t\tif (str.substr(p, 6).toUpperCase() != \"CDATA[\")\n\t\t\t\t\t\t\t\t\tthrow(\"Expected <![CDATA[\");\n\t\t\t\t\t\t\t\tp += 5;\n\t\t\t\t\t\t\t\tstate = S.CDATA;\n\t\t\t\t\t\t\t\tstart = p + 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (str.fastCodeAt(p + 1) == 'D'.code || str.fastCodeAt(p + 1) == 'd'.code)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(str.substr(p + 2, 6).toUpperCase() != \"OCTYPE\")\n\t\t\t\t\t\t\t\t\tthrow(\"Expected <!DOCTYPE\");\n\t\t\t\t\t\t\t\tp += 8;\n\t\t\t\t\t\t\t\tstate = S.DOCTYPE;\n\t\t\t\t\t\t\t\tstart = p + 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if( str.fastCodeAt(p + 1) != '-'.code || str.fastCodeAt(p + 2) != '-'.code )\n\t\t\t\t\t\t\t\tthrow(\"Expected <!--\");\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tp += 2;\n\t\t\t\t\t\t\t\tstate = S.COMMENT;\n\t\t\t\t\t\t\t\tstart = p + 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\tcase '?'.code:\n\t\t\t\t\t\t\tstate = S.HEADER;\n\t\t\t\t\t\t\tstart = p;\n\t\t\t\t\t\tcase '/'.code:\n\t\t\t\t\t\t\tif( parent == null )\n\t\t\t\t\t\t\t\tthrow(\"Expected node name\");\n\t\t\t\t\t\t\tstart = p + 1;\n\t\t\t\t\t\t\tstate = S.IGNORE_SPACES;\n\t\t\t\t\t\t\tnext = S.CLOSE;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tstate = S.TAG_NAME;\n\t\t\t\t\t\t\tstart = p;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\tcase S.TAG_NAME:\n\t\t\t\t\tif (!isValidChar(c))\n\t\t\t\t\t{\n\t\t\t\t\t\tif( p == start )\n\t\t\t\t\t\t\tthrow(\"Expected node name\");\n\t\t\t\t\t\txml = Xml.createElement(str.substr(start, p - start));\n\t\t\t\t\t\tparent.addChild(xml);\n\t\t\t\t\t\tstate = S.IGNORE_SPACES;\n\t\t\t\t\t\tnext = S.BODY;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\tcase S.BODY:\n\t\t\t\t\tswitch(c)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase '/'.code:\n\t\t\t\t\t\t\tstate = S.WAIT_END;\n\t\t\t\t\t\t\tnsubs++;\n\t\t\t\t\t\tcase '>'.code:\n\t\t\t\t\t\t\tstate = S.CHILDS;\n\t\t\t\t\t\t\tnsubs++;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tstate = S.ATTRIB_NAME;\n\t\t\t\t\t\t\tstart = p;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\tcase S.ATTRIB_NAME:\n\t\t\t\t\tif (!isValidChar(c))\n\t\t\t\t\t{\n\t\t\t\t\t\tvar tmp;\n\t\t\t\t\t\tif( start == p )\n\t\t\t\t\t\t\tthrow(\"Expected attribute name\");\n\t\t\t\t\t\ttmp = str.substr(start,p-start);\n\t\t\t\t\t\taname = tmp;\n\t\t\t\t\t\tif( xml.exists(aname) )\n\t\t\t\t\t\t\tthrow(\"Duplicate attribute\");\n\t\t\t\t\t\tstate = S.IGNORE_SPACES;\n\t\t\t\t\t\tnext = S.EQUALS;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\tcase S.EQUALS:\n\t\t\t\t\tswitch(c)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase '='.code:\n\t\t\t\t\t\t\tstate = S.IGNORE_SPACES;\n\t\t\t\t\t\t\tnext = S.ATTVAL_BEGIN;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tthrow(\"Expected =\");\n\t\t\t\t\t}\n\t\t\t\tcase S.ATTVAL_BEGIN:\n\t\t\t\t\tswitch(c)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase '\"'.code, '\\''.code:\n\t\t\t\t\t\t\tstate = S.ATTRIB_VAL;\n\t\t\t\t\t\t\tstart = p;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tthrow(\"Expected \\\"\");\n\t\t\t\t\t}\n\t\t\t\tcase S.ATTRIB_VAL:\n\t\t\t\t\tif (c == str.fastCodeAt(start))\n\t\t\t\t\t{\n\t\t\t\t\t\tvar val = str.substr(start+1,p-start-1);\n\t\t\t\t\t\txml.set(aname, val);\n\t\t\t\t\t\tstate = S.IGNORE_SPACES;\n\t\t\t\t\t\tnext = S.BODY;\n\t\t\t\t\t}\n\t\t\t\tcase S.CHILDS:\n\t\t\t\t\tp = doParse(str, p, xml);\n\t\t\t\t\tstart = p;\n\t\t\t\t\tstate = S.BEGIN;\n\t\t\t\tcase S.WAIT_END:\n\t\t\t\t\tswitch(c)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase '>'.code:\n\t\t\t\t\t\t\tstate = S.BEGIN;\n\t\t\t\t\t\tdefault :\n\t\t\t\t\t\t\tthrow(\"Expected >\");\n\t\t\t\t\t}\n\t\t\t\tcase S.WAIT_END_RET:\n\t\t\t\t\tswitch(c)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase '>'.code:\n\t\t\t\t\t\t\tif( nsubs == 0 )\n\t\t\t\t\t\t\t\tparent.addChild(Xml.createPCData(\"\"));\n\t\t\t\t\t\t\treturn p;\n\t\t\t\t\t\tdefault :\n\t\t\t\t\t\t\tthrow(\"Expected >\");\n\t\t\t\t\t}\n\t\t\t\tcase S.CLOSE:\n\t\t\t\t\tif (!isValidChar(c))\n\t\t\t\t\t{\n\t\t\t\t\t\tif( start == p )\n\t\t\t\t\t\t\tthrow(\"Expected node name\");\n\n\t\t\t\t\t\tvar v = str.substr(start,p - start);\n\t\t\t\t\t\tif (v != parent.nodeName)\n\t\t\t\t\t\t\tthrow \"Expected </\" +parent.nodeName + \">\";\n\n\t\t\t\t\t\tstate = S.IGNORE_SPACES;\n\t\t\t\t\t\tnext = S.WAIT_END_RET;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\tcase S.COMMENT:\n\t\t\t\t\tif (c == '-'.code && str.fastCodeAt(p +1) == '-'.code && str.fastCodeAt(p + 2) == '>'.code)\n\t\t\t\t\t{\n\t\t\t\t\t\tparent.addChild(Xml.createComment(str.substr(start, p - start)));\n\t\t\t\t\t\tp += 2;\n\t\t\t\t\t\tstate = S.BEGIN;\n\t\t\t\t\t}\n\t\t\t\tcase S.DOCTYPE:\n\t\t\t\t\tif(c == '['.code)\n\t\t\t\t\t\tnbrackets++;\n\t\t\t\t\telse if(c == ']'.code)\n\t\t\t\t\t\tnbrackets--;\n\t\t\t\t\telse if (c == '>'.code && nbrackets == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tparent.addChild(Xml.createDocType(str.substr(start, p - start)));\n\t\t\t\t\t\tstate = S.BEGIN;\n\t\t\t\t\t}\n\t\t\t\tcase S.HEADER:\n\t\t\t\t\tif (c == '?'.code && str.fastCodeAt(p + 1) == '>'.code)\n\t\t\t\t\t{\n\t\t\t\t\t\tp++;\n\t\t\t\t\t\tvar str = str.substr(start + 1, p - start - 2);\n\t\t\t\t\t\tparent.addChild(Xml.createProcessingInstruction(str));\n\t\t\t\t\t\tstate = S.BEGIN;\n\t\t\t\t\t}\n\t\t\t\tcase S.ESCAPE:\n\t\t\t\t\tif (c == ';'.code)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar s = str.substr(start, p - start);\n\t\t\t\t\t\tif (s.fastCodeAt(0) == '#'.code) {\n\t\t\t\t\t\t\tvar i = s.fastCodeAt(1) == 'x'.code\n\t\t\t\t\t\t\t\t? Std.parseInt(\"0\" +s.substr(1, s.length - 1))\n\t\t\t\t\t\t\t\t: Std.parseInt(s.substr(1, s.length - 1));\n\t\t\t\t\t\t\tbuf.add(String.fromCharCode(i));\n\t\t\t\t\t\t} else if (!escapes.exists(s))\n\t\t\t\t\t\t\tbuf.add('&$s;');\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tbuf.add(escapes.get(s));\n\t\t\t\t\t\tstart = p + 1;\n\t\t\t\t\t\tstate = next;\n\t\t\t\t\t}\n\t\t\t}\n\t\t\tc = str.fastCodeAt(++p);\n\t\t}\n\t\t\n\t\tif (state == S.BEGIN)\n\t\t{\n\t\t\tstart = p;\n\t\t\tstate = S.PCDATA;\n\t\t}\n\t\t\n\t\tif (state == S.PCDATA)\n\t\t{\n\t\t\tif (p != start || nsubs == 0)\n\t\t\t\tparent.addChild(Xml.createPCData(buf.toString() + str.substr(start, p - start)));\n\t\t\treturn p;\n\t\t}\n\t\t\n\t\tthrow \"Unexpected end\";\n\t}\n\t\n\tstatic inline function isValidChar(c) {\n\t\treturn (c >= 'a'.code && c <= 'z'.code) || (c >= 'A'.code && c <= 'Z'.code) || (c >= '0'.code && c <= '9'.code) || c == ':'.code || c == '.'.code || c == '_'.code || c == '-'.code;\n\t}\n}","package haxeparser;\r\n\r\nimport haxe.macro.Expr;\r\n\r\nenum Keyword {\r\n\tKwdFunction;\r\n\tKwdClass;\r\n\tKwdVar;\r\n\tKwdIf;\r\n\tKwdElse;\r\n\tKwdWhile;\r\n\tKwdDo;\r\n\tKwdFor;\r\n\tKwdBreak;\r\n\tKwdContinue;\r\n\tKwdReturn;\r\n\tKwdExtends;\r\n\tKwdImplements;\r\n\tKwdImport;\r\n\tKwdSwitch;\r\n\tKwdCase;\r\n\tKwdDefault;\r\n\tKwdStatic;\r\n\tKwdPublic;\r\n\tKwdPrivate;\r\n\tKwdTry;\r\n\tKwdCatch;\r\n\tKwdNew;\r\n\tKwdThis;\r\n\tKwdThrow;\r\n\tKwdExtern;\r\n\tKwdEnum;\r\n\tKwdIn;\r\n\tKwdInterface;\r\n\tKwdUntyped;\r\n\tKwdCast;\r\n\tKwdOverride;\r\n\tKwdTypedef;\r\n\tKwdDynamic;\r\n\tKwdPackage;\r\n\tKwdInline;\r\n\tKwdUsing;\r\n\tKwdNull;\r\n\tKwdTrue;\r\n\tKwdFalse;\r\n\tKwdAbstract;\r\n\tKwdMacro;\r\n}\r\n\r\nenum TokenDef {\r\n\tKwd(k:Keyword);\r\n\tConst(c:haxe.macro.Expr.Constant);\r\n\tSharp(s:String);\r\n\tDollar(s:String);\r\n\tUnop(op:haxe.macro.Expr.Unop);\r\n\tBinop(op:haxe.macro.Expr.Binop);\r\n\tComment(s:String);\r\n\tCommentLine(s:String);\r\n\tIntInterval(s:String);\r\n\tSemicolon;\r\n\tDot;\r\n\tDblDot;\r\n\tArrow;\r\n\tComma;\r\n\tBkOpen;\r\n\tBkClose;\r\n\tBrOpen;\r\n\tBrClose;\r\n\tPOpen;\r\n\tPClose;\r\n\tQuestion;\r\n\tAt;\r\n\tEof;\r\n}\r\n\r\nclass TokenDefPrinter {\r\n\tstatic public function print(def:TokenDef) {\r\n\t\treturn switch(def) {\r\n\t\t\tcase Kwd(k): k.getName().substr(3).toLowerCase();\r\n\t\t\tcase Const(CInt(s) | CFloat(s) | CIdent(s)): s;\r\n\t\t\tcase Const(CString(s)): '\"$s\"';\r\n\t\t\tcase Const(CRegexp(r, opt)): '~/$r/$opt';\r\n\t\t\tcase Sharp(s): '#$s';\r\n\t\t\tcase Dollar(s): '$$$s';\r\n\t\t\tcase Unop(op): new haxe.macro.Printer(\"\").printUnop(op);\r\n\t\t\tcase Binop(op): new haxe.macro.Printer(\"\").printBinop(op);\r\n\t\t\tcase Comment(s): '/*$s/*';\r\n\t\t\tcase CommentLine(s): '//$s';\r\n\t\t\tcase IntInterval(s): '$s...';\r\n\t\t\tcase Semicolon: \";\";\r\n\t\t\tcase Dot: \".\";\r\n\t\t\tcase DblDot: \":\";\r\n\t\t\tcase Arrow: \"->\";\r\n\t\t\tcase Comma: \",\";\r\n\t\t\tcase BkOpen: \"[\";\r\n\t\t\tcase BkClose: \"]\";\r\n\t\t\tcase BrOpen: \"{\";\r\n\t\t\tcase BrClose: \"}\";\r\n\t\t\tcase POpen: \"(\";\r\n\t\t\tcase PClose: \")\";\r\n\t\t\tcase Question: \"?\";\r\n\t\t\tcase At: \"@\";\r\n\t\t\tcase Eof: \"<eof>\";\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass Token {\r\n\tpublic var tok: TokenDef;\r\n\tpublic var pos: Position;\r\n\t\r\n\tpublic function new(tok, pos) {\r\n\t\tthis.tok = tok;\r\n\t\tthis.pos = pos;\r\n\t}\r\n\t\r\n\tpublic function toString() {\r\n\t\treturn TokenDefPrinter.print(tok);\r\n\t}\r\n}\r\n\r\ntypedef EnumConstructor = {\r\n\tname : String,\r\n\tdoc: String,\r\n\tmeta: Metadata,\r\n\targs: Array<{ name: String, opt: Bool, type: ComplexType}>,\r\n\tpos: Position,\r\n\tparams: Array<TypeParamDecl>,\r\n\ttype: Null<ComplexType>\r\n}\r\n\r\ntypedef Definition<A,B> = {\r\n\tname : String,\r\n\tdoc: String,\r\n\tparams: Array<TypeParamDecl>,\r\n\tmeta: Metadata,\r\n\tflags: Array<A>,\r\n\tdata: B\r\n}\r\n\r\nenum TypeDef {\r\n\tEClass(d:Definition<ClassFlag, Array<Field>>);\r\n\tEEnum(d:Definition<EnumFlag, Array<EnumConstructor>>);\r\n\tEAbstract(a:Definition<AbstractFlag, Array<Field>>);\r\n\tEImport(sl:Array<{pack:String, pos:Position}>, mode:ImportMode);\r\n\tETypedef(d:Definition<EnumFlag, ComplexType>);\r\n\tEUsing(path:TypePath);\r\n}\r\n\r\nenum ClassFlag {\r\n\tHInterface;\r\n\tHExtern;\r\n\tHPrivate;\r\n\tHExtends(t:TypePath);\r\n\tHImplements(t:TypePath);\r\n}\r\n\r\nenum AbstractFlag {\r\n\tAPrivAbstract;\r\n\tAFromType(ct:ComplexType);\r\n\tAToType(ct:ComplexType);\r\n\tAIsType(ct:ComplexType);\r\n}\r\n\r\nenum EnumFlag {\r\n\tEPrivate;\r\n\tEExtern;\r\n}\r\n\r\nenum ImportMode {\r\n\tINormal;\r\n\tIAsName(s:String);\r\n\tIAll;\r\n}","package haxeparser;\r\n\r\nimport haxeparser.Data;\r\nimport haxe.macro.Expr;\r\nimport hxparse.Lexer;\r\n\r\nenum LexerErrorMsg {\r\n\tUnterminatedString;\r\n\tUnterminatedRegExp;\r\n\tUnclosedComment;\r\n}\r\n\r\nclass LexerError {\r\n\tpublic var msg:LexerErrorMsg;\r\n\tpublic var pos:Position;\r\n\tpublic function new(msg, pos) {\r\n\t\tthis.msg = msg;\r\n\t\tthis.pos = pos;\r\n\t}\r\n}\r\n\r\nclass HaxeLexer extends Lexer implements hxparse.RuleBuilder {\r\n\r\n\tstatic function mkPos(p:hxparse.Position) {\r\n\t\treturn {\r\n\t\t\tfile: p.psource,\r\n\t\t\tmin: p.pmin,\r\n\t\t\tmax: p.pmax\r\n\t\t};\r\n\t}\r\n\t\r\n\tstatic function mk(lexer:Lexer, td) {\r\n\t\treturn new Token(td, mkPos(lexer.curPos()));\r\n\t}\r\n\t\r\n\t// @:mapping generates a map with lowercase enum constructor names as keys\r\n\t// and the constructor itself as value\r\n\tstatic var keywords = @:mapping(3) Data.Keyword;\r\n\t\r\n\tstatic var buf = new StringBuf();\r\n\t\r\n\tstatic var ident = \"_*[a-z][a-zA-Z0-9_]*|_+|_+[0-9][_a-zA-Z0-9]*\";\r\n\tstatic var idtype = \"_*[A-Z][a-zA-Z0-9_]*\";\r\n\t\r\n\t// @:rule wraps the expression to the right of => with function(lexer) return\r\n\tpublic static var tok = @:rule [\r\n\t\t\"\" => mk(lexer, Eof),\r\n\t\t\"[\\r\\n\\t ]\" => lexer.token(tok),\r\n\t\t\"0x[0-9a-fA-F]+\" => mk(lexer, Const(CInt(lexer.current))),\r\n\t\t\"[0-9]+\" => mk(lexer, Const(CInt(lexer.current))),\r\n\t\t\"[0-9]+\\\\.[0-9]+\" => mk(lexer, Const(CFloat(lexer.current))),\r\n\t\t\"\\\\.[0-9]+\" => mk(lexer, Const(CFloat(lexer.current))),\r\n\t\t\"[0-9]+[eE][\\\\+\\\\-]?[0-9]+\" => mk(lexer,Const(CFloat(lexer.current))),\r\n\t\t\"[0-9]+\\\\.[0-9]*[eE][\\\\+\\\\-]?[0-9]+\" => mk(lexer,Const(CFloat(lexer.current))),\r\n\t\t\"[0-9]+\\\\.\\\\.\\\\.\" => mk(lexer,IntInterval(lexer.current.substr(0,-3))),\r\n\t\t\"//[^\\n\\r]*\" => mk(lexer, CommentLine(lexer.current.substr(2))),\r\n\t\t\"+\\\\+\" => mk(lexer,Unop(OpIncrement)),\r\n\t\t\"--\" => mk(lexer,Unop(OpDecrement)),\r\n\t\t\"~\" => mk(lexer,Unop(OpNegBits)),\r\n\t\t\"%=\" => mk(lexer,Binop(OpAssignOp(OpMod))),\r\n\t\t\"&=\" => mk(lexer,Binop(OpAssignOp(OpAnd))),\r\n\t\t\"|=\" => mk(lexer,Binop(OpAssignOp(OpOr))),\r\n\t\t\"^=\" => mk(lexer,Binop(OpAssignOp(OpXor))),\r\n\t\t\"+=\" => mk(lexer,Binop(OpAssignOp(OpAdd))),\r\n\t\t\"-=\" => mk(lexer,Binop(OpAssignOp(OpSub))),\r\n\t\t\"*=\" => mk(lexer,Binop(OpAssignOp(OpMult))),\r\n\t\t\"/=\" => mk(lexer,Binop(OpAssignOp(OpDiv))),\r\n\t\t\"<<=\" => mk(lexer,Binop(OpAssignOp(OpShl))),\r\n\t\t\"==\" => mk(lexer,Binop(OpEq)),\r\n\t\t\"!=\" => mk(lexer,Binop(OpNotEq)),\r\n\t\t\"<=\" => mk(lexer,Binop(OpLte)),\r\n\t\t\"&&\" => mk(lexer,Binop(OpBoolAnd)),\r\n\t\t\"|\\\\|\" => mk(lexer,Binop(OpBoolOr)),\r\n\t\t\"<<\" => mk(lexer,Binop(OpShl)),\r\n\t\t\"->\" => mk(lexer,Arrow),\r\n\t\t\"\\\\.\\\\.\\\\.\" => mk(lexer,Binop(OpInterval)),\r\n\t\t\"=>\" => mk(lexer,Binop(OpArrow)),\r\n\t\t\"!\" => mk(lexer,Unop(OpNot)),\r\n\t\t\"<\" => mk(lexer,Binop(OpLt)),\r\n\t\t\">\" => mk(lexer,Binop(OpGt)),\r\n\t\t\";\" => mk(lexer, Semicolon),\r\n\t\t\":\" => mk(lexer, DblDot),\r\n\t\t\",\" => mk(lexer, Comma),\r\n\t\t\"\\\\.\" => mk(lexer, Dot),\r\n\t\t\"%\" => mk(lexer,Binop(OpMod)),\r\n\t\t\"&\" => mk(lexer,Binop(OpAnd)),\r\n\t\t\"|\" => mk(lexer,Binop(OpOr)),\r\n\t\t\"^\" => mk(lexer,Binop(OpXor)),\r\n\t\t\"+\" => mk(lexer,Binop(OpAdd)),\r\n\t\t\"*\" => mk(lexer,Binop(OpMult)),\r\n\t\t\"/\" => mk(lexer,Binop(OpDiv)),\r\n\t\t\"-\" => mk(lexer,Binop(OpSub)),\r\n\t\t\"=\" => mk(lexer,Binop(OpAssign)),\r\n\t\t\"[\" => mk(lexer, BkOpen),\r\n\t\t\"]\" => mk(lexer, BkClose),\r\n\t\t\"{\" => mk(lexer, BrOpen),\r\n\t\t\"}\" => mk(lexer, BrClose),\r\n\t\t\"\\\\(\" => mk(lexer, POpen),\r\n\t\t\"\\\\)\" => mk(lexer, PClose),\r\n\t\t\"?\" => mk(lexer, Question),\r\n\t\t\"@\" => mk(lexer, At),\r\n\t\t'\"' => {\r\n\t\t\tbuf = new StringBuf();\r\n\t\t\tvar pmin = lexer.curPos();\r\n\t\t\tvar pmax = try lexer.token(string) catch (e:haxe.io.Eof) throw new LexerError(UnterminatedString, mkPos(pmin));\r\n\t\t\tvar token = mk(lexer, Const(CString(buf.toString())));\r\n\t\t\ttoken.pos.min = pmin.pmin; token;\r\n\t\t},\r\n\t\t\"'\" => {\r\n\t\t\tbuf = new StringBuf();\r\n\t\t\tvar pmin = lexer.curPos();\r\n\t\t\tvar pmax = try lexer.token(string2) catch (e:haxe.io.Eof) throw new LexerError(UnterminatedString, mkPos(pmin));\r\n\t\t\tvar token = mk(lexer, Const(CString(buf.toString())));\r\n\t\t\ttoken.pos.min = pmin.pmin; token;\r\n\t\t},\r\n\t\t'~/' => {\r\n\t\t\tbuf = new StringBuf();\r\n\t\t\tvar pmin = lexer.curPos();\r\n\t\t\tvar info = try lexer.token(regexp) catch (e:haxe.io.Eof) throw new LexerError(UnterminatedRegExp, mkPos(pmin));\r\n\t\t\tvar token = mk(lexer, Const(CRegexp(buf.toString(), info.opt)));\r\n\t\t\ttoken.pos.min = pmin.pmin; token;\r\n\t\t},\r\n\t\t'/\\\\*' => {\r\n\t\t\tbuf = new StringBuf();\r\n\t\t\tvar pmin = lexer.curPos();\r\n\t\t\tvar pmax = try lexer.token(comment) catch (e:haxe.io.Eof) throw new LexerError(UnclosedComment, mkPos(pmin));\r\n\t\t\tvar token = mk(lexer, Comment(buf.toString()));\r\n\t\t\ttoken.pos.min = pmin.pmin; token;\r\n\t\t},\r\n\t\t\"#\" + ident => mk(lexer, Sharp(lexer.current.substr(1))),\r\n\t\t\"$[_a-zA-Z0-9]*\" => mk(lexer, Dollar(lexer.current.substr(1))),\r\n\t\tident => {\r\n\t\t\tvar kwd = keywords.get(lexer.current);\r\n\t\t\tif (kwd != null)\r\n\t\t\t\tmk(lexer, Kwd(kwd));\r\n\t\t\telse\r\n\t\t\t\tmk(lexer, Const(CIdent(lexer.current)));\r\n\t\t},\r\n\t\tidtype => mk(lexer, Const(CIdent(lexer.current))),\r\n\t];\r\n\t\r\n\tpublic static var string = @:rule [\r\n\t\t\"\\\\\\\\\\\\\\\\\" => {\r\n\t\t\tbuf.add(\"\\\\\");\r\n\t\t\tlexer.token(string);\r\n\t\t},\r\n\t\t\"\\\\\\\\n\" => {\r\n\t\t\tbuf.add(\"\\n\");\r\n\t\t\tlexer.token(string);\r\n\t\t},\r\n\t\t\"\\\\\\\\r\" => {\r\n\t\t\tbuf.add(\"\\r\");\r\n\t\t\tlexer.token(string);\r\n\t\t},\r\n\t\t\"\\\\\\\\t\" => {\r\n\t\t\tbuf.add(\"\\t\");\r\n\t\t\tlexer.token(string);\r\n\t\t},\r\n\t\t\"\\\\\\\\\\\"\" => {\r\n\t\t\tbuf.add('\"');\r\n\t\t\tlexer.token(string);\r\n\t\t},\r\n\t\t'\"' => lexer.curPos().pmax,\r\n\t\t\"[^\\\\\\\\\\\"]+\" => {\r\n\t\t\tbuf.add(lexer.current);\r\n\t\t\tlexer.token(string);\r\n\t\t}\r\n\t];\r\n\t\r\n\tpublic static var string2 = @:rule [\r\n\t\t\"\\\\\\\\\\\\\\\\\" => {\r\n\t\t\tbuf.add(\"\\\\\");\r\n\t\t\tlexer.token(string2);\r\n\t\t},\r\n\t\t\"\\\\\\\\n\" =>  {\r\n\t\t\tbuf.add(\"\\n\");\r\n\t\t\tlexer.token(string2);\r\n\t\t},\r\n\t\t\"\\\\\\\\r\" => {\r\n\t\t\tbuf.add(\"\\r\");\r\n\t\t\tlexer.token(string2);\r\n\t\t},\r\n\t\t\"\\\\\\\\t\" => {\r\n\t\t\tbuf.add(\"\\t\");\r\n\t\t\tlexer.token(string2);\r\n\t\t},\r\n\t\t'\\\\\\\\\\'' => {\r\n\t\t\tbuf.add('\"');\r\n\t\t\tlexer.token(string2);\r\n\t\t},\r\n\t\t\"'\" => lexer.curPos().pmax,\r\n\t\t'[^\\\\\\\\\\']+' => {\r\n\t\t\tbuf.add(lexer.current);\r\n\t\t\tlexer.token(string2);\r\n\t\t}\r\n\t];\r\n\t\r\n\tpublic static var comment = @:rule [\r\n\t\t\"*/\" => lexer.curPos().pmax,\r\n\t\t\"*\" => {\r\n\t\t\tbuf.add(\"*\");\r\n\t\t\tlexer.token(comment);\r\n\t\t},\r\n\t\t\"[^\\\\*]\" => {\r\n\t\t\tbuf.add(lexer.current);\r\n\t\t\tlexer.token(comment);\r\n\t\t}\r\n\t];\r\n\r\n\tpublic static var regexp = @:rule [\r\n\t\t\"\\\\\\\\/\" => {\r\n\t\t\tbuf.add(\"/\");\r\n\t\t\tlexer.token(regexp);\r\n\t\t},\r\n\t\t\"\\\\\\\\r\" => {\r\n\t\t\tbuf.add(\"\\r\");\r\n\t\t\tlexer.token(regexp);\r\n\t\t},\r\n\t\t\"\\\\\\\\n\" => {\r\n\t\t\tbuf.add(\"\\n\");\r\n\t\t\tlexer.token(regexp);\r\n\t\t},\r\n\t\t\"\\\\\\\\t\" => {\r\n\t\t\tbuf.add(\"\\t\");\r\n\t\t\tlexer.token(regexp);\r\n\t\t},\r\n\t\t\"\\\\\\\\[\\\\$\\\\.*+\\\\^|{}\\\\[\\\\]()?\\\\-0-9]\" => {\r\n\t\t\tbuf.add(lexer.current);\r\n\t\t\tlexer.token(regexp);\r\n\t\t},\r\n\t\t\"\\\\\\\\[wWbBsSdDx]\" => {\r\n\t\t\tbuf.add(lexer.current);\r\n\t\t\tlexer.token(regexp);\r\n\t\t},\r\n\t\t\"/\" => {\r\n\t\t\tlexer.token(regexp_options);\r\n\t\t},\r\n\t\t\"[^\\\\\\\\/\\r\\n]+\" => {\r\n\t\t\tbuf.add(lexer.current);\r\n\t\t\tlexer.token(regexp);\r\n\t\t}\r\n\t];\r\n\r\n\tpublic static var regexp_options = @:rule [\r\n\t\t\"[gimsu]*\" => {\r\n\t\t\t{ pmax:lexer.curPos().pmax, opt:lexer.current };\r\n\t\t}\r\n\t];\r\n}","package hxparse;\r\n\r\n/**\r\n\tLexer matches a sequence of characters against a set of rule patterns.\r\n\t\r\n\tAn instance of Lexer is created once for each input and maintains state\r\n\tfor that input. Tokens can then be obtained by calling the `token` method,\r\n\tpassing an instance of `Ruleset`.\r\n\t\r\n\tRule sets can be created manually, or by calling the static `buildRuleset`\r\n\tmethod.\r\n**/\r\nclass Lexer {\r\n\t\r\n\t/**\r\n\t\tThe `String` that was matched by the most recent invocation of the\r\n\t\t`token` method.\r\n\t**/\r\n\tpublic var current(default, null):String;\r\n\t\r\n\tvar input:byte.ByteData;\r\n\tvar source:String;\r\n\tvar pos:Int;\r\n\tvar eof(default, null):Bool;\r\n\t\r\n\t/**\r\n\t\tCreates a new Lexer for `input`.\r\n\t\t\r\n\t\tIf `sourceName` is provided, it is used in error messages to denote\r\n\t\tthe position of an error.\r\n\t\t\r\n\t\tIf `input` is null, the result is unspecified.\r\n\t**/\r\n\tpublic function new(input:byte.ByteData, sourceName:String = \"<null>\") {\r\n\t\tcurrent = \"\";\r\n\t\tthis.input = input;\r\n\t\tsource = sourceName;\r\n\t\tpos = 0;\r\n\t\teof = false;\r\n\t}\r\n\t\r\n\t/**\r\n\t\tReturns the current position of `this` Lexer.\r\n\t**/\r\n\tpublic inline function curPos():Position {\r\n\t\treturn new Position(source, pos - current.length, pos);\r\n\t}\r\n\t\t\r\n\t/**\r\n\t\tReturns the next token according to `ruleset`.\r\n\t\t\r\n\t\tThis method starts with `ruleset.state` and reads characters from `this`\r\n\t\tinput until no further state transitions are possible. It always returns\r\n\t\tthe longest match.\r\n\t\t\r\n\t\tIf a character is read which has no transition defined, an\r\n\t\t`UnexpectedChar` exception is thrown.\r\n\t\t\r\n\t\tIf the input is in the end of file state upon method invocation,\r\n\t\t`ruleset.eofFunction` is called with `this` Lexer as argument. If\r\n\t\t`ruleset` defines no `eofFunction` field, a `haxe.io.Eof` exception\r\n\t\tis thrown.\r\n\t\t\r\n\t\tIf `ruleset` is null, the result is unspecified.\r\n\t**/\r\n\tpublic function token<T>(ruleset:Ruleset<T>):T {\r\n\t\tif (eof) {\r\n\t\t\tif (ruleset.eofFunction != null) return ruleset.eofFunction(this);\r\n\t\t\telse throw new haxe.io.Eof();\r\n\t\t}\r\n\t\tvar state = ruleset.state;\r\n\t\tvar lastMatch = null;\r\n\t\tvar lastMatchPos = pos;\r\n\t\tvar start = pos;\r\n\t\twhile(true) {\r\n\t\t\tif (state.final > -1) {\r\n\t\t\t\tlastMatch = state;\r\n\t\t\t\tlastMatchPos = pos;\r\n\t\t\t}\r\n\t\t\tif (pos == input.length) {\r\n\t\t\t\teof = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tvar i = input.readByte(pos);\r\n\t\t\tpos++;\r\n\t\t\tstate = state.trans.get(i);\r\n\t\t\tif (state == null)\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tpos = lastMatchPos;\r\n\t\tcurrent = input.readString(start, pos - start);\r\n\t\tif (lastMatch == null || lastMatch.final == -1)\r\n\t\t\tthrow new UnexpectedChar(String.fromCharCode(input.readByte(pos)), curPos());\r\n\t\treturn ruleset.functions[lastMatch.final](this);\r\n\t}\r\n\t\r\n\t/**\r\n\t\tBuilds a `Ruleset` from the given `rules` `Array`.\r\n\t\t\r\n\t\tFor each element of `rules`, its `rule` `String` is parsed into a\r\n\t\t`Pattern` using `LexEngine.parse`.\r\n\t\t\r\n\t\tIf `rules` is null, the result is unspecified.\r\n\t**/\r\n\tstatic public function buildRuleset<Token>(rules:Array<{rule:String,func:Lexer->Token}>) {\r\n\t\tvar cases = [];\r\n\t\tvar functions = [];\r\n\t\tvar eofFunction = null;\r\n\t\tfor (rule in rules) {\r\n\t\t\tif (rule.rule == \"\") {\r\n\t\t\t\teofFunction = rule.func;\r\n\t\t\t} else {\r\n\t\t\t\tcases.push(LexEngine.parse(rule.rule));\r\n\t\t\t\tfunctions.push(rule.func);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn new Ruleset(new LexEngine(cases).firstState(), functions, eofFunction);\r\n\t}\r\n}","package hxparse;\r\n\r\n/**\r\n\tLexEngine handles pattern parsing and state transformation.\r\n\t\r\n\tThis class is used by the `Lexer` and rarely has to be interacted with\r\n\tdirectly.\r\n\t\r\n\tThe static `parse` method transforms a single `String` to a `Pattern`.\r\n\tMultiple patterns can then be passed to the constructor to generate the\r\n\tstate machine, which is obtainable from the `firstState` method.\r\n**/\r\nclass LexEngine {\r\n\t\r\n\tvar uid : Int;\r\n\tvar nodes : Array<Node>;\r\n\tvar finals : Array<Node>;\r\n\tvar states : Array<State>;\r\n\tvar hstates : Map<String,State>;\r\n\r\n\t/**\r\n\t\tCreates a new LexEngine from `patterns`.\r\n\t\t\r\n\t\tEach LexEngine maintains a state machine, whose initial state can be\r\n\t\tobtained from the `firstState` method. After this, `this` LexEngine can\r\n\t\tbe discarded.\r\n\t\t\r\n\t\tIf `patterns` is null, the result is unspecified.\r\n\t**/\r\n\tpublic function new( patterns : Array<Pattern> ) {\r\n\t\tnodes = [];\r\n\t\tfinals = [];\r\n\t\tstates = [];\r\n\t\thstates = new Map();\r\n\t\tuid = 0;\r\n\t\tvar pid = 0;\r\n\t\tfor ( p in patterns ) {\r\n\t\t\tvar id = pid++;\r\n\t\t\tvar f = node(id);\r\n\t\t\tvar n = initNode(p, f,id);\r\n\t\t\tnodes.push(n);\r\n\t\t\tfinals.push(f);\r\n\t\t}\r\n\t\tmakeState(addNodes([], nodes));\r\n\t}\r\n\t\r\n\t/**\r\n\t\tReturns the entry state of the state machine generated by `this`\r\n\t\tLexEngine.\r\n\t**/\r\n\tpublic function firstState() {\r\n\t\treturn states[0];\r\n\t}\r\n\t\r\n\tfunction makeState( nodes : Array<Node> ) {\r\n\t\tvar buf = new StringBuf();\r\n\t\tfor( n in nodes ) {\r\n\t\t\tbuf.add(n.id);\r\n\t\t\tbuf.addChar(\"-\".code);\r\n\t\t}\r\n\t\tvar key = buf.toString();\r\n\t\tvar s = hstates.get(key);\r\n\t\tif( s != null )\r\n\t\t\treturn s;\r\n\t\t\t\r\n\t\ts = new State();\r\n\t\tstates.push(s);\r\n\t\thstates.set(key, s);\r\n\t\t\r\n\t\tvar trans = getTransitions(nodes);\r\n\t\t\r\n\t\tfor ( t in trans ) {\r\n\t\t\tvar target = makeState(t.n);\r\n\t\t\tfor (chr in t.chars) {\r\n\t\t\t\tfor (i in chr.min...(chr.max + 1)) {\r\n\t\t\t\t\ts.trans.set(i, target);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction setFinal() {\r\n\t\t\tfor( f in finals )\r\n\t\t\t\tfor( n in nodes )\r\n\t\t\t\t\tif( n == f ) {\r\n\t\t\t\t\t\ts.final = n.pid;\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t}\r\n\t\tif (s.final == -1)\r\n\t\t\tsetFinal();\r\n\t\treturn s;\r\n\t}\r\n\t\r\n\tfunction getTransitions( nodes : Array<Node> ) {\r\n\t\tvar tl = [];\r\n\t\tfor( n in nodes )\r\n\t\t\tfor( t in n.trans )\r\n\t\t\t\ttl.push(t);\r\n\t\t\t\t\r\n\t\t// Merge transition with the same target\r\n\t\ttl.sort(function(t1, t2) return t1.n.id - t2.n.id);\r\n\t\tvar t0 = tl[0];\r\n\t\tfor( i in 1...tl.length ) {\r\n\t\t\tvar t1 = tl[i];\r\n\t\t\tif( t0.n == t1.n ) {\r\n\t\t\t\ttl[i - 1] = null;\r\n\t\t\t\tt1 = { chars : cunion(t0.chars, t1.chars), n : t1.n };\r\n\t\t\t\ttl[i] = t1;\r\n\t\t\t}\r\n\t\t\tt0 = t1;\r\n\t\t}\r\n\t\twhile( tl.remove(null) ) {\r\n\t\t}\r\n\t\t\r\n\t\t// Split char sets to make them disjoint\r\n\t\tvar allChars = EMPTY;\r\n\t\tvar allStates = new List<{ chars : Charset, n : Array<Node> }>();\r\n\t\tfor( t in tl ) {\r\n\t\t\tvar states = new List();\r\n\t\t\tstates.push( { chars : cdiff(t.chars, allChars), n : [t.n] } );\r\n\t\t\tfor( s in allStates ) {\r\n\t\t\t\tvar nodes = s.n.copy();\r\n\t\t\t\tnodes.push(t.n);\r\n\t\t\t\tstates.push( { chars : cinter(s.chars,t.chars), n : nodes } );\r\n\t\t\t\tstates.push( { chars : cdiff(s.chars, t.chars), n : s.n } );\r\n\t\t\t}\r\n\t\t\tfor( s in states )\r\n\t\t\t\tif( s.chars.length == 0 )\r\n\t\t\t\t\tstates.remove(s);\r\n\t\t\tallChars = cunion(allChars, t.chars);\r\n\t\t\tallStates = states;\r\n\t\t}\r\n\t\t\t\t\r\n\t\t// Epsilon closure of targets\r\n\t\tvar states = [];\r\n\t\tfor( s in allStates )\r\n\t\t\tstates.push({ chars : s.chars, n : addNodes([], s.n) });\r\n\t\t\r\n\t\t// Canonical ordering\r\n\t\tstates.sort(function(s1, s2) {\r\n\t\t\tvar a = s1.chars.length;\r\n\t\t\tvar b = s2.chars.length;\r\n\t\t\tfor( i in 0...(a < b?a:b) ) {\r\n\t\t\t\tvar a = s1.chars[i];\r\n\t\t\t\tvar b = s2.chars[i];\r\n\t\t\t\tif( a.min != b.min )\r\n\t\t\t\t\treturn b.min - a.min;\r\n\t\t\t\tif( a.max != b.max )\r\n\t\t\t\t\treturn b.max - a.max;\r\n\t\t\t}\r\n\t\t\tif( a < b )\r\n\t\t\t\treturn b - a;\r\n\t\t\treturn 0;\r\n\t\t});\r\n\t\treturn states;\r\n\t}\r\n\t\r\n\tfunction addNode( nodes : Array<Node>, n : Node ) {\r\n\t\tfor( n2 in nodes )\r\n\t\t\tif( n == n2 )\r\n\t\t\t\treturn;\r\n\t\tnodes.push(n);\r\n\t\taddNodes(nodes, n.epsilon);\r\n\t}\r\n\t\r\n\tfunction addNodes( nodes : Array<Node>, add : Array<Node> ) {\r\n\t\tfor( n in add  )\r\n\t\t\taddNode(nodes, n);\r\n\t\treturn nodes;\r\n\t}\r\n\t\r\n\tinline function node(pid) {\r\n\t\treturn new Node(uid++, pid);\r\n\t}\r\n\r\n\tfunction initNode( p : Pattern, final : Node, pid : Int ) {\r\n\t\treturn switch( p ) {\r\n\t\tcase Empty:\r\n\t\t\tfinal;\r\n\t\tcase Match(c):\r\n\t\t\tvar n = node(pid);\r\n\t\t\tn.trans.push({ chars : c, n : final });\r\n\t\t\tn;\r\n\t\tcase Star(p):\r\n\t\t\tvar n = node(pid);\r\n\t\t\tvar an = initNode(p,n,pid);\r\n\t\t\tn.epsilon.push(an);\r\n\t\t\tn.epsilon.push(final);\r\n\t\t\tn;\r\n\t\tcase Plus(p):\r\n\t\t\tvar n = node(pid);\r\n\t\t\tvar an = initNode(p,n,pid);\r\n\t\t\tn.epsilon.push(an);\r\n\t\t\tn.epsilon.push(final);\r\n\t\t\tan;\r\n\t\tcase Next(a,b):\r\n\t\t\tinitNode(a, initNode(b, final,pid),pid);\r\n\t\tcase Choice(a,b):\r\n\t\t\tvar n = node(pid);\r\n\t\t\tn.epsilon.push(initNode(a,final,pid));\r\n\t\t\tn.epsilon.push(initNode(b,final,pid));\r\n\t\t\tn;\r\n\t\tcase Group(p):\r\n\t\t\tinitNode(p, final, pid);\r\n\t\t}\r\n\t}\r\n\t\r\n\t// ----------------------- PATTERN PARSING ---------------------------\r\n\t\r\n\tstatic inline var MAX_CODE = 255;\r\n\tstatic var EMPTY = [];\r\n\tstatic var ALL_CHARS = [ { min : 0, max : MAX_CODE } ];\r\n\r\n\tstatic inline function single( c : Int ) : Charset {\r\n\t\treturn [ { min : c, max : c } ];\r\n\t}\r\n\t\r\n\t/**\r\n\t\tParses the `pattern` `String` and returns an instance of `Pattern`.\r\n\t\t\r\n\t\tIf `pattern` is not a valid pattern string, an exception of `String` is\r\n\t\tthrown.\r\n\t\t\r\n\t\tThe following meta characters are supported:\r\n\t\t\t\r\n\t\t\t- `*`: zero or more\r\n\t\t\t- `+`: one or more\r\n\t\t\t- `?`: zero or one\r\n\t\t\t- `|`: or\r\n\t\t\t- `[`: begin char range\r\n\t\t\t- `]`: end char range\r\n\t\t\t- `(`: begin group\r\n\t\t\t- `)`: end group\r\n\t\t\t- `\\`: escape next char\r\n\t\t\t\r\n\t\tThese characters must be escaped if they are part of the pattern, by\r\n\t\tusing `\\\\*`, `\\\\]` etc.\r\n\t**/\r\n\tpublic static function parse( pattern : String ) : Pattern {\r\n\t\tvar p = parseInner(pattern);\r\n\t\tif( p == null ) throw \"Invalid pattern '\" + pattern + \"'\";\r\n\t\treturn p.pattern;\r\n\t}\r\n\t\r\n\tstatic function next( a, b ) {\r\n\t\treturn a == Empty ? b : Next(a, b);\r\n\t}\r\n\t\r\n\tstatic function plus(r) {\r\n\t\treturn switch( r ) {\r\n\t\tcase Next(r1, r2): Next(r1, plus(r2));\r\n\t\tdefault: Plus(r);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic function star(r) {\r\n\t\treturn switch( r ) {\r\n\t\tcase Next(r1, r2): Next(r1, star(r2));\r\n\t\tdefault: Star(r);\r\n\t\t}\r\n\t}\r\n\t\r\n\tstatic function opt(r) {\r\n\t\treturn switch( r ) {\r\n\t\tcase Next(r1, r2): Next(r1, opt(r2));\r\n\t\tdefault: Choice(r, Empty);\r\n\t\t}\r\n\t}\r\n\t\r\n\tstatic function cinter(c1,c2) {\r\n\t\treturn ccomplement(cunion(ccomplement(c1), ccomplement(c2)));\r\n\t}\r\n\t\r\n\tstatic function cdiff(c1,c2) {\r\n\t\treturn ccomplement(cunion(ccomplement(c1), c2));\r\n\t}\r\n\r\n\tstatic function ccomplement( c : Charset ) {\r\n\t\tvar first = c[0];\r\n\t\tvar start = first != null && first.min == -1 ? c.shift().max + 1 : -1;\r\n\t\tvar out = [];\r\n\t\tfor( k in c ) {\r\n\t\t\tout.push( { min : start, max : k.min - 1 } );\r\n\t\t\tstart = k.max + 1;\r\n\t\t}\r\n\t\tif( start <= MAX_CODE )\r\n\t\t\tout.push( { min : start, max : MAX_CODE } );\r\n\t\treturn out;\r\n\t}\r\n\t\r\n\tstatic function cunion( ca : Charset, cb : Charset ) {\r\n\t\tvar i = 0, j = 0;\r\n\t\tvar out = [];\r\n\t\tvar a = ca[i++], b = cb[j++];\r\n\t\twhile( true ) {\r\n\t\t\tif( a == null ) {\r\n\t\t\t\tout.push(b);\r\n\t\t\t\twhile( j < cb.length )\r\n\t\t\t\t\tout.push(cb[j++]);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif( b == null ) {\r\n\t\t\t\tout.push(a);\r\n\t\t\t\twhile( i < ca.length )\r\n\t\t\t\t\tout.push(ca[i++]);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif( a.min <= b.min ) {\r\n\t\t\t\tif( a.max + 1 < b.min ) {\r\n\t\t\t\t\tout.push(a);\r\n\t\t\t\t\ta = ca[i++];\r\n\t\t\t\t} else if( a.max < b.max ) {\r\n\t\t\t\t\tb = { min : a.min, max : b.max };\r\n\t\t\t\t\ta = ca[i++];\r\n\t\t\t\t} else\r\n\t\t\t\t\tb = cb[j++];\r\n\t\t\t} else {\r\n\t\t\t\t// swap\r\n\t\t\t\tvar tmp = ca;\r\n\t\t\t\tca = cb;\r\n\t\t\t\tcb = tmp;\r\n\t\t\t\tvar tmp = j;\r\n\t\t\t\tj = i;\r\n\t\t\t\ti = tmp;\r\n\t\t\t\tvar tmp = a;\r\n\t\t\t\ta = b;\r\n\t\t\t\tb = tmp;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn out;\r\n\t}\r\n\r\n\tstatic function parseInner( pattern : String, i : Int = 0, pDepth : Int = 0 ) : { pattern: Pattern, pos: Int } {\r\n\t\tvar r = Empty;\r\n\t\tvar l = pattern.length;\r\n\t\twhile( i < l ) {\r\n\t\t\tvar c = StringTools.fastCodeAt(pattern,i++);\r\n\t\t\tswitch( c ) {\r\n\t\t\tcase '+'.code if (r != Empty):\r\n\t\t\t\tr = plus(r);\r\n\t\t\tcase '*'.code if (r != Empty):\r\n\t\t\t\tr = star(r);\r\n\t\t\tcase '?'.code if (r != Empty):\r\n\t\t\t\tr = opt(r);\r\n\t\t\tcase '|'.code if (r != Empty):\r\n\t\t\t\tvar r2 = parseInner(pattern, i);\r\n\t\t\t\treturn {pattern: Choice(r, r2.pattern), pos: r2.pos};\r\n\t\t\tcase '.'.code:\r\n\t\t\t\tr = next(r, Match(ALL_CHARS));\r\n\t\t\tcase '('.code:\r\n\t\t\t\tvar r2 = parseInner(pattern, i, pDepth + 1);\r\n\t\t\t\ti = r2.pos;\r\n\t\t\t\tr = next(r, r2.pattern);\r\n\t\t\tcase ')'.code:\r\n\t\t\t\treturn { pattern: Group(r), pos: i};\r\n\t\t\tcase '['.code if (pattern.length > 1):\r\n\t\t\t\tvar range = 0;\r\n\t\t\t\tvar acc = [];\r\n\t\t\t\tvar not = StringTools.fastCodeAt(pattern, i) == '^'.code;\r\n\t\t\t\tif( not ) i++;\r\n\t\t\t\twhile( true ) {\r\n\t\t\t\t\tvar c = StringTools.fastCodeAt(pattern, i++);\r\n\t\t\t\t\tif( c == ']'.code ) {\r\n\t\t\t\t\t\tif( range != 0 ) return null;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t} else if( c == '-'.code ) {\r\n\t\t\t\t\t\tif( range != 0 ) return null;\r\n\t\t\t\t\t\tvar last = acc.pop();\r\n\t\t\t\t\t\tif( last == null )\r\n\t\t\t\t\t\t\tacc.push( { min : c, max : c } );\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tif( last.min != last.max ) return null;\r\n\t\t\t\t\t\t\trange = last.min;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif( c == '\\\\'.code )\r\n\t\t\t\t\t\t\tc = StringTools.fastCodeAt(pattern, i++);\r\n\t\t\t\t\t\tif( range == 0 )\r\n\t\t\t\t\t\t\tacc.push( { min : c, max : c } );\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tacc.push( { min : range, max : c } );\r\n\t\t\t\t\t\t\trange = 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tvar g = [];\r\n\t\t\t\tfor( k in acc )\r\n\t\t\t\t\tg = cunion(g, [k]);\r\n\t\t\t\tif( not )\r\n\t\t\t\t\tg = cdiff(ALL_CHARS, g);\r\n\t\t\t\tr = next(r, Match(g));\r\n\t\t\tcase '\\\\'.code:\r\n\t\t\t\tc = StringTools.fastCodeAt(pattern, i++);\r\n\t\t\t\tif ( StringTools.isEof(c) ) c = '\\\\'.code;\r\n\t\t\t\telse if (c >= \"0\".code && c <= \"9\".code) {\r\n\t\t\t\t\tvar v = c - 48;\r\n\t\t\t\t\twhile(true) {\r\n\t\t\t\t\t\tvar cNext = StringTools.fastCodeAt(pattern, i);\r\n\t\t\t\t\t\tif (cNext >= \"0\".code && cNext <= \"9\".code) {\r\n\t\t\t\t\t\t\tv = v * 10 + (cNext - 48);\r\n\t\t\t\t\t\t\t++i;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tc = v;\r\n\t\t\t\t}\r\n\t\t\t\tr = next(r, Match(single(c)));\r\n\t\t\tdefault:\r\n\t\t\t\tr = next(r, Match(single(c)));\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (pDepth != 0) throw 'Found unclosed parenthesis while parsing \"$pattern\"';\r\n\t\treturn {pattern:r, pos: i};\r\n\t}\r\n}\r\n\r\nprivate enum Pattern {\r\n\tEmpty;\r\n\tMatch( c : Charset );\r\n\tStar( p : Pattern );\r\n\tPlus( p : Pattern );\r\n\tNext( p1 : Pattern, p2 : Pattern );\r\n\tChoice( p1 : Pattern, p2 : Pattern );\r\n\tGroup ( p : Pattern );\r\n}\r\n\r\nprivate typedef Charset = Array<{ min : Int, max : Int }>;\r\n\r\nprivate class Node {\r\n\tpublic var id : Int;\r\n\tpublic var pid : Int;\r\n\tpublic var trans : Array<{ chars : Charset, n : Node }>;\r\n\tpublic var epsilon : Array<Node>;\r\n\tpublic function new(id, pid) {\r\n\t\tthis.id = id;\r\n\t\tthis.pid = pid;\r\n\t\ttrans = [];\r\n\t\tepsilon = [];\r\n\t}\r\n}\r\n\r\nprivate class Transition {\r\n\tpublic var chars : Charset;\r\n\tpublic function new(chars) {\r\n\t\tthis.chars = chars;\r\n\t}\r\n\tpublic function toString() {\r\n\t\treturn Std.string(chars);\r\n\t}\r\n}","package hxparse;\r\n\r\n/**\r\n\tA Ruleset wraps an input state and the semantic callback functions for the\r\n\t`Lexer`.\r\n**/\r\nclass Ruleset<Token> {\r\n\t\r\n\t/**\r\n\t\tThe initial state.\r\n\t**/\r\n\tpublic var state:State;\r\n\t\r\n\t/**\r\n\t\tThe semantic functions.\r\n\t**/\r\n\tpublic var functions:Array<Lexer->Token>;\r\n\t\r\n\t/**\r\n\t\tThe callback function for when end of file state is reached.\r\n\t**/\r\n\tpublic var eofFunction:Lexer->Token;\r\n\t\r\n\t/**\r\n\t\tCreates a new Ruleset.\r\n\t**/\r\n\tpublic function new(state, functions, eofFunction) {\r\n\t\tthis.state = state;\r\n\t\tthis.functions = functions;\r\n\t\tthis.eofFunction = eofFunction;\r\n\t}\r\n}","package hxparse;\r\n\r\n/**\r\n\tThe position information maintained by `Lexer`.\r\n**/\r\nclass Position {\r\n\t/**\r\n\t\tName of the source.\r\n\t**/\r\n\tpublic var psource : String;\r\n\t\r\n\t/**\r\n\t\tThe first character position, counting from the beginning of the input.\r\n\t**/\r\n\tpublic var pmin : Int;\r\n\t\r\n\t/**\r\n\t\tThe last character position, counting from the beginning of the input.\r\n\t**/\r\n\tpublic var pmax : Int;\r\n\t\r\n\t/**\r\n\t\tCreates a new `Position` from the given information.\r\n\t**/\r\n\tpublic function new(source, min, max) {\r\n\t\tpsource = source;\r\n\t\tpmin = min;\r\n\t\tpmax = max;\r\n\t}\r\n\t\r\n\t/**\r\n\t\tReturns a readable representation of `this` position;\r\n\t**/\r\n\tpublic function toString() {\r\n\t\treturn '$psource:characters $pmin-$pmax';\r\n\t}\r\n\t\r\n\tpublic function getLinePosition(input:byte.ByteData) {\r\n\t\tvar lineMin = 1;\r\n\t\tvar lineMax = 1;\r\n\t\tvar posMin = 0;\r\n\t\tvar posMax = 0;\r\n\t\tvar cur = 0;\r\n\t\twhile (cur < pmin) {\r\n\t\t\tif (input.readByte(cur) == \"\\n\".code) {\r\n\t\t\t\tlineMin++;\r\n\t\t\t\tposMin = cur;\r\n\t\t\t}\r\n\t\t\tcur++;\r\n\t\t}\r\n\t\tlineMax = lineMin;\r\n\t\tposMax = posMin;\r\n\t\tposMin = cur - posMin;\r\n\t\twhile (cur < pmax) {\r\n\t\t\tif (input.readByte(cur) == \"\\n\".code) {\r\n\t\t\t\tlineMax++;\r\n\t\t\t\tposMax = cur;\r\n\t\t\t}\r\n\t\t\tcur++;\r\n\t\t}\r\n\t\tposMax = cur - posMax;\r\n\t\treturn {\r\n\t\t\tlineMin: lineMin,\r\n\t\t\tlineMax: lineMax,\r\n\t\t\tposMin: posMin,\r\n\t\t\tposMax: posMax\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t\tFormats `this` position by resolving line numbers within `input`.\r\n\t\t\r\n\t\tIf `input` is null, the result is unspecified.\r\n\t**/\r\n\tpublic function format(input:byte.ByteData) {\r\n\t\tvar linePos = getLinePosition(input);\r\n\t\tif (linePos.lineMin != linePos.lineMax) {\r\n\t\t\treturn '${psource}:lines ${linePos.lineMin}-${linePos.lineMax}';\r\n\t\t} else {\r\n\t\t\treturn '${psource}:line ${linePos.lineMin}:characters ${linePos.posMin}-${linePos.posMax}';\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t\tUnifies two positions `p1` and `p2`, using the minimum `pmin` and\r\n\t\tmaximum `pmax` of both.\r\n\t\t\r\n\t\tThe resulting `psource` and `pline` are taken from `p1`.\r\n\t\t\r\n\t\tIf `p1` or `p2` are null, the result is unspecified.\r\n\t**/\r\n\tstatic public function union(p1:Position, p2:Position) {\r\n\t\treturn new Position(p1.psource, p1.pmin < p2.pmin ? p1.pmin : p2.pmin, p1.pmax > p2.pmax ? p1.pmax : p2.pmax);\r\n\t}\r\n}\r\n\r\nprivate typedef Position2 = {\r\n\tlineMin: Int,\r\n\tlineMax: Int,\r\n\tposMin: Int,\r\n\tposMax: Int\r\n}","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage js;\n\nclass Boot {\n\n\tprivate static function __unhtml(s : String) {\n\t\treturn s.split(\"&\").join(\"&amp;\").split(\"<\").join(\"&lt;\").split(\">\").join(\"&gt;\");\n\t}\n\n\tprivate static function __trace(v,i : haxe.PosInfos) {\n\t\tuntyped {\n\t\t\tvar msg = if( i != null ) i.fileName+\":\"+i.lineNumber+\": \" else \"\";\n\t\t\t#if jsfl\n\t\t\tmsg += __string_rec(v,\"\");\n\t\t\tfl.trace(msg);\n\t\t\t#else\n\t\t\tmsg += __string_rec(v, \"\");\n\t\t\tif( i != null && i.customParams != null )\n\t\t\t\tfor( v in i.customParams )\n\t\t\t\t\tmsg += \",\" + __string_rec(v, \"\");\n\t\t\tvar d;\n\t\t\tif( __js__(\"typeof\")(document) != \"undefined\" && (d = document.getElementById(\"haxe:trace\")) != null )\n\t\t\t\td.innerHTML += __unhtml(msg)+\"<br/>\";\n\t\t\telse if( __js__(\"typeof console\") != \"undefined\" && __js__(\"console\").log != null )\n\t\t\t\t__js__(\"console\").log(msg);\n\t\t\t#end\n\t\t}\n\t}\n\n\tprivate static function __clear_trace() {\n\t\tuntyped {\n\t\t\t#if jsfl\n\t\t\tfl.outputPanel.clear();\n\t\t\t#else\n\t\t\tvar d = document.getElementById(\"haxe:trace\");\n\t\t\tif( d != null )\n\t\t\t\td.innerHTML = \"\";\n\t\t\t#end\n\t\t}\n\t}\n\n\tstatic inline function isClass(o:Dynamic) : Bool {\n\t\treturn untyped __define_feature__(\"js.Boot.isClass\", o.__name__);\n\t}\n\n\tstatic inline function isEnum(e:Dynamic) : Bool {\n\t\treturn untyped __define_feature__(\"js.Boot.isEnum\", e.__ename__);\n\t}\n\n\tstatic inline function getClass(o:Dynamic) : Dynamic {\n\t\tif (Std.is(o, Array))\n\t\t\treturn Array;\n\t\telse\n\t\t\treturn untyped __define_feature__(\"js.Boot.getClass\", o.__class__);\n\t}\n\n\t@:ifFeature(\"has_enum\")\n\tprivate static function __string_rec(o,s:String) {\n\t\tuntyped {\n\t\t\tif( o == null )\n\t\t\t    return \"null\";\n\t\t\tif( s.length >= 5 )\n\t\t\t\treturn \"<...>\"; // too much deep recursion\n\t\t\tvar t = __js__(\"typeof(o)\");\n\t\t\tif( t == \"function\" && (isClass(o) || isEnum(o)) )\n\t\t\t\tt = \"object\";\n\t\t\tswitch( t ) {\n\t\t\tcase \"object\":\n\t\t\t\tif( __js__(\"o instanceof Array\") ) {\n\t\t\t\t\tif( o.__enum__ ) {\n\t\t\t\t\t\tif( o.length == 2 )\n\t\t\t\t\t\t\treturn o[0];\n\t\t\t\t\t\tvar str = o[0]+\"(\";\n\t\t\t\t\t\ts += \"\\t\";\n\t\t\t\t\t\tfor( i in 2...o.length ) {\n\t\t\t\t\t\t\tif( i != 2 )\n\t\t\t\t\t\t\t\tstr += \",\" + __string_rec(o[i],s);\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tstr += __string_rec(o[i],s);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn str + \")\";\n\t\t\t\t\t}\n\t\t\t\t\tvar l = o.length;\n\t\t\t\t\tvar i;\n\t\t\t\t\tvar str = \"[\";\n\t\t\t\t\ts += \"\\t\";\n\t\t\t\t\tfor( i in 0...l )\n\t\t\t\t\t\tstr += (if (i > 0) \",\" else \"\")+__string_rec(o[i],s);\n\t\t\t\t\tstr += \"]\";\n\t\t\t\t\treturn str;\n\t\t\t\t}\n\t\t\t\tvar tostr;\n\t\t\t\ttry {\n\t\t\t\t\ttostr = untyped o.toString;\n\t\t\t\t} catch( e : Dynamic ) {\n\t\t\t\t\t// strange error on IE\n\t\t\t\t\treturn \"???\";\n\t\t\t\t}\n\t\t\t\tif( tostr != null && tostr != __js__(\"Object.toString\") ) {\n\t\t\t\t\tvar s2 = o.toString();\n\t\t\t\t\tif( s2 != \"[object Object]\")\n\t\t\t\t\t\treturn s2;\n\t\t\t\t}\n\t\t\t\tvar k : String = null;\n\t\t\t\tvar str = \"{\\n\";\n\t\t\t\ts += \"\\t\";\n\t\t\t\tvar hasp = (o.hasOwnProperty != null);\n\t\t\t\t__js__(\"for( var k in o ) {\");\n\t\t\t\t\tif( hasp && !o.hasOwnProperty(k) )\n\t\t\t\t\t\t__js__(\"continue\");\n\t\t\t\t\tif( k == \"prototype\" || k == \"__class__\" || k == \"__super__\" || k == \"__interfaces__\" || k == \"__properties__\" )\n\t\t\t\t\t\t__js__(\"continue\");\n\t\t\t\t\tif( str.length != 2 )\n\t\t\t\t\t\tstr += \", \\n\";\n\t\t\t\t\tstr += s + k + \" : \"+__string_rec(o[k],s);\n\t\t\t\t__js__(\"}\");\n\t\t\t\ts = s.substring(1);\n\t\t\t\tstr += \"\\n\" + s + \"}\";\n\t\t\t\treturn str;\n\t\t\tcase \"function\":\n\t\t\t\treturn \"<function>\";\n\t\t\tcase \"string\":\n\t\t\t\treturn o;\n\t\t\tdefault:\n\t\t\t\treturn String(o);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate static function __interfLoop(cc : Dynamic,cl : Dynamic) {\n\t\tif( cc == null )\n\t\t\treturn false;\n\t\tif( cc == cl )\n\t\t\treturn true;\n\t\tvar intf : Dynamic = cc.__interfaces__;\n\t\tif( intf != null )\n\t\t\tfor( i in 0...intf.length ) {\n\t\t\t\tvar i : Dynamic = intf[i];\n\t\t\t\tif( i == cl || __interfLoop(i,cl) )\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\treturn __interfLoop(cc.__super__,cl);\n\t}\n\n\t@:ifFeature(\"typed_catch\") private static function __instanceof(o : Dynamic,cl : Dynamic) {\n\t\tif( cl == null )\n\t\t\treturn false;\n\t\tswitch( cl ) {\n\t\tcase Int:\n\t\t\treturn (untyped __js__(\"(o|0) === o\"));\n\t\tcase Float:\n\t\t\treturn (untyped __js__(\"typeof\"))(o) == \"number\";\n\t\tcase Bool:\n\t\t\treturn (untyped __js__(\"typeof\"))(o) == \"boolean\";\n\t\tcase String:\n\t\t\treturn (untyped __js__(\"typeof\"))(o) == \"string\";\n\t\tcase Array:\n\t\t\treturn (untyped __js__(\"(o instanceof Array)\")) && o.__enum__ == null;\n\t\tcase Dynamic:\n\t\t\treturn true;\n\t\tdefault:\n\t\t\tif( o != null ) {\n\t\t\t\t// Check if o is an instance of a Haxe class\n\t\t\t\tif( (untyped __js__(\"typeof\"))(cl) == \"function\" ) {\n\t\t\t\t\tif( untyped __js__(\"o instanceof cl\") ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\tif( __interfLoop(getClass(o),cl) )\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// do not use isClass/isEnum here\n\t\t\tuntyped __feature__(\"Class.*\",if( cl == Class && o.__name__ != null ) return true);\n\t\t\tuntyped __feature__(\"Enum.*\",if( cl == Enum && o.__ename__ != null ) return true);\n\t\t\treturn o.__enum__ == cl;\n\t\t}\n\t}\n\n\t@:ifFeature(\"typed_cast\") private static function __cast(o : Dynamic, t : Dynamic) {\n\t\tif (__instanceof(o, t)) return o;\n\t\telse throw \"Cannot cast \" +Std.string(o) + \" to \" +Std.string(t);\n\t}\n\n}\n","package hxparse;\r\n\r\n/**\r\n\tParser is the base class for all custom parsers.\r\n\t\r\n\tThe intended usage is to extend it and utilize its method as an API where\r\n\trequired.\r\n */\r\n@:generic\r\nclass Parser<S:TokenSource<Token>, Token> {\r\n\r\n\t/**\r\n\t\tThe current `Ruleset`.\r\n\t\t\r\n\t\tThis value is passed to the lexer when the `peek` method is invoked.\r\n\t\tChanging it during parsing can thus modify the tokenizing behavior\r\n\t\tof the lexer.\r\n\t**/\r\n\tpublic var ruleset(default, null):Ruleset<Token>;\r\n\t\r\n\t/**\r\n\t\tReturns the last matched token.\r\n\t\t\r\n\t\tThis is a convenience property for accessing `cache[offset - 1]`.\r\n\t**/\r\n\tpublic var last(default, null):Token;\r\n\t\r\n\tvar stream:S;\r\n\tvar token:haxe.ds.GenericStack.GenericCell<Token>;\r\n\t\r\n\t/**\r\n\t\tCreates a new Parser instance over `TokenSource` `stream` with the\r\n\t\tinitial `Ruleset` being `ruleset`.\r\n\t**/\r\n\tpublic function new(stream:S, ruleset:Ruleset<Token>) {\r\n\t\tthis.stream = stream;\r\n\t\tthis.ruleset = ruleset;\r\n\t}\r\n\t\r\n\t/**\r\n\t\tReturns the `n`th token without consuming it.\r\n\t**/\r\n\t@:doc\r\n\tfunction peek(n:Int):Token {\r\n\t\tif (token == null) {\r\n\t\t\ttoken = new haxe.ds.GenericStack.GenericCell<Token>(stream.token(ruleset), null);\r\n\t\t\tn--;\r\n\t\t}\r\n\t\tvar tok = token;\r\n\t\twhile (n > 0) {\r\n\t\t\tif (tok.next == null) tok.next = new haxe.ds.GenericStack.GenericCell<Token>(stream.token(ruleset), null);\r\n\t\t\ttok = tok.next;\r\n\t\t\tn--;\r\n\t\t}\r\n\t\treturn tok.elt;\r\n\t}\r\n\t\r\n\t/**\r\n\t\tConsumes the current token.\r\n\t\t\r\n\t\tThis method is automatically called after a successful match.\r\n\t**/\r\n\t@:doc\r\n\tinline function junk() {\r\n\t\tlast = token.elt;\r\n\t\ttoken = token.next;\r\n\t}\r\n\t\t\r\n\t/**\r\n\t\tReturns the current lexer position.\r\n\t**/\r\n\t@:doc\r\n\tpublic inline function curPos() {\r\n\t\treturn stream.curPos();\r\n\t}\r\n\t\r\n\t/**\r\n\t\tInvokes `f` and then `separatorFunc` with the current token until the\r\n\t\tresult of that call is `false`.\r\n\t\t\r\n\t\tThe result is an Array containing the results of all calls to `f`.\r\n\t\t\r\n\t\tA typical use case is parsing function arguments which are separated by\r\n\t\ta comma.\r\n\t */\r\n\t@:doc\r\n\tfunction parseSeparated<T>(separatorFunc:Token->Bool, f:Void->T):Array<T> {\r\n\t\tvar acc = [];\r\n\t\twhile(true) {\r\n\t\t\tacc.push(f());\r\n\t\t\tif (separatorFunc(peek(0))) {\r\n\t\t\t\tjunk();\r\n\t\t\t} else {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn acc;\r\n\t}\r\n\t\r\n\t/**\r\n\t\tReturns the result of calling `f()` if a match is made, or `null`\r\n\t\totherwise`.\r\n\t**/\r\n\t@:doc\r\n\tfunction parseOptional<T>(f:Void->T) {\r\n\t\ttry {\r\n\t\t\treturn f();\r\n\t\t} catch(e:hxparse.NoMatch<Dynamic>) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t\tCalls `f` until no match can be made.\r\n\t\t\r\n\t\tThe result is an Array containing the results of all calls to `f`.\r\n\t**/\r\n\t@:doc\r\n\tfunction parseRepeat<T>(f:Void->T) {\r\n\t\tvar acc = [];\r\n\t\twhile(true) {\r\n\t\t\ttry {\r\n\t\t\t\tacc.push(f());\r\n\t\t\t} catch(e:hxparse.NoMatch<Dynamic>) {\r\n\t\t\t\treturn acc;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tinline function noMatch() {\r\n\t\treturn new NoMatch(stream.curPos(), peek(0));\r\n\t}\r\n\t\r\n\tinline function unexpected():Dynamic {\r\n\t\treturn throw new Unexpected(peek(0), stream.curPos());\r\n\t}\r\n}","package haxeparser;\r\n\r\nimport haxeparser.Data;\r\nimport haxe.macro.Expr;\r\nimport haxe.ds.Option;\r\nusing Lambda;\r\n\r\nenum ParserErrorMsg {\r\n\tMissingSemicolon;\r\n\tMissingType;\r\n\tDuplicateDefault;\r\n\tCustom(s:String);\r\n}\r\n\r\ntypedef ParserError = {\r\n\tmsg: ParserErrorMsg,\r\n\tpos: hxparse.Position\r\n}\r\n\r\nenum SmallType {\r\n\tSNull;\r\n\tSBool(b:Bool);\r\n\tSFloat(f:Float);\r\n\tSString(s:String);\r\n}\r\n\r\nclass HaxeParser extends hxparse.Parser<HaxeLexer, Token> implements hxparse.ParserBuilder {\r\n\r\n\tvar defines:Map<String, Dynamic>;\r\n\r\n\tvar mstack:Array<Position>;\r\n\tvar doResume = true;\r\n\tvar doc:String;\r\n\tvar inMacro:Bool;\r\n\t\r\n\tpublic function new(input:byte.ByteData, sourceName:String) {\r\n\t\tsuper(new HaxeLexer(input, sourceName), HaxeLexer.tok);\r\n\t\tmstack = [];\r\n\t\tdefines = new Map();\r\n\t\tdefines.set(\"true\", true);\r\n\t\tinMacro = false;\r\n\t\tdoc = \"\";\r\n\t}\r\n\r\n\tpublic function define(flag:String, ?value:Dynamic)\r\n\t{\r\n\t\tdefines.set(flag, value);\r\n\t}\r\n\r\n\tpublic function parse() {\r\n\t\treturn parseFile();\r\n\t}\r\n\t\r\n\toverride function peek(n):Token {\r\n\t\treturn if (n == 0)\r\n\t\t{\r\n\t\t\tvar tk = super.peek(0);\r\n\t\t\tswitch tk {\r\n\t\t\t\tcase {tok:CommentLine(_) | Comment(_) | Sharp(\"error\" | \"line\")}:\r\n\t\t\t\t\tjunk();\r\n\t\t\t\t\tpeek(0);\r\n\t\t\t\tcase {tok:Sharp(\"end\")}:\r\n\t\t\t\t\tjunk();\r\n\t\t\t\t\tif (mstack.length == 0) tk;\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tmstack.shift();\r\n\t\t\t\t\t\tpeek(0);\r\n\t\t\t\t\t}\r\n\t\t\t\tcase {tok:Sharp(\"else\" | \"elseif\")}:\r\n\t\t\t\t\tjunk();\r\n\t\t\t\t\tif (mstack.length == 0) tk;\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tmstack.shift();\r\n\t\t\t\t\t\tskipTokens(tk.pos, false);\r\n\t\t\t\t\t}\r\n\t\t\t\tcase {tok:Sharp(\"if\")}:\r\n\t\t\t\t\tjunk();\r\n\t\t\t\t\tenterMacro(tk.pos);\r\n\t\t\t\tcase t: t;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse super.peek(n);\r\n\t}\r\n\r\n\tfunction keywordString(k:Keyword)\r\n\t{\r\n\t\treturn Std.string(k).substr(3).toLowerCase();\r\n\t}\r\n\r\n\tfunction parseMacroCond(allowOp:Bool):{tk:Option<Token>, expr:Expr}\r\n\t{\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Const(CIdent(t)), pos:p}]:\r\n\t\t\t\tparseMacroIdent(allowOp, t, p);\r\n\t\t\tcase [{tok:Const(CString(s)), pos:p}]:\r\n\t\t\t\t{tk:None, expr:{expr:EConst(CString(s)), pos:p}};\r\n\t\t\tcase [{tok:Const(CInt(s)), pos:p}]:\r\n\t\t\t\t{tk:None, expr:{expr:EConst(CInt(s)), pos:p}};\r\n\t\t\tcase [{tok:Const(CFloat(s)), pos:p}]:\r\n\t\t\t\t{tk:None, expr:{expr:EConst(CFloat(s)), pos:p}};\r\n\t\t\tcase [{tok:Kwd(k), pos:p}]:\r\n\t\t\t\tparseMacroIdent(allowOp, keywordString(k), p);\r\n\t\t\tcase [{tok:POpen, pos:p1}, o = parseMacroCond(true), {tok:PClose, pos:p2}]:\r\n\t\t\t\tvar e = {expr:EParenthesis(o.expr), pos:punion(p1, p2)};\r\n\t\t\t\tif (allowOp) parseMacroOp(e) else { tk:None, expr:e };\r\n\t\t\tcase [{tok:Unop(op), pos:p}, o = parseMacroCond(allowOp)]:\r\n\t\t\t\t{tk:o.tk, expr:makeUnop(op, o.expr, p)};\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseMacroIdent(allowOp:Bool, t:String, p:Position):{tk:Option<Token>, expr:Expr}\r\n\t{\r\n\t\tvar e = {expr:EConst(CIdent(t)), pos:p};\r\n\t\treturn if (!allowOp) { tk:None, expr:e } else parseMacroOp(e);\r\n\t}\r\n\r\n\tfunction parseMacroOp(e:Expr):{tk:Option<Token>, expr:Expr}\r\n\t{\r\n\t\treturn switch peek(0) {\r\n\t\t\tcase {tok:Binop(op)}:\r\n\t\t\t\tjunk();\r\n\t\t\t\top = switch peek(0) {\r\n\t\t\t\t\tcase {tok:Binop(OpAssign)} if (op == OpGt):\r\n\t\t\t\t\t\tjunk();\r\n\t\t\t\t\t\tOpGte;\r\n\t\t\t\t\tcase _: op;\r\n\t\t\t\t}\r\n\t\t\t\tvar o = parseMacroCond(true);\r\n\t\t\t\t{tk:o.tk, expr:makeBinop(op, e, o.expr)};\r\n\t\t\tcase tk:\r\n\t\t\t\t{tk:Some(tk), expr:e};\r\n\t\t}\r\n\t}\r\n\r\n\tfunction enterMacro(p)\r\n\t{\r\n\t\tvar o = parseMacroCond(false);\r\n\t\tvar tk = switch o.tk {\r\n\t\t\tcase None: peek(0);\r\n\t\t\tcase Some(tk): tk;\r\n\t\t}\r\n\t\treturn if (isTrue(eval(o.expr)))\r\n\t\t{\r\n\t\t\tmstack.unshift(p);\r\n\t\t\ttk;\r\n\t\t}\r\n\t\telse skipTokensLoop(p, true, tk);\r\n\t}\r\n\r\n\tfunction next()\r\n\t{\r\n\t\tvar tk = super.peek(0);\r\n\t\tjunk();\r\n\t\treturn tk;\r\n\t}\r\n\r\n\tfunction skipTokens(p:Position, test:Bool)\r\n\t{\r\n\t\treturn skipTokensLoop(p, test, next());\r\n\t}\r\n\r\n\tfunction skipTokensLoop(p:Position, test:Bool, tk:Token)\r\n\t{\r\n\t\treturn switch tk {\r\n\t\t\tcase {tok:Sharp(\"end\")}:\r\n\t\t\t\tpeek(0);\r\n\t\t\tcase {tok:Sharp(\"elseif\" | \"else\")} if (!test):\r\n\t\t\t\tskipTokens(p, test);\r\n\t\t\tcase {tok:Sharp(\"else\")}:\r\n\t\t\t\tmstack.unshift(tk.pos);\r\n\t\t\t\tpeek(0);\r\n\t\t\tcase {tok:Sharp(\"elseif\")}:\r\n\t\t\t\tenterMacro(tk.pos);\r\n\t\t\tcase {tok:Sharp(\"if\")}:\r\n\t\t\t\tskipTokensLoop(p, test, skipTokens(p, false));\r\n\t\t\tcase {tok:Eof}:\r\n\t\t\t\tthrow \"unclosed macro\";\r\n\t\t\tcase _:\r\n\t\t\t\tskipTokens(p, test);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction isTrue(a:SmallType)\r\n\t{\r\n\t\treturn switch a {\r\n\t\t\tcase SBool(false), SNull, SFloat(0.0), SString(\"\"): false;\r\n\t\t\tcase _: true;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction compare(a:SmallType, b:SmallType)\r\n\t{\r\n\t\treturn switch [a, b] {\r\n\t\t\tcase [SNull, SNull]: 0;\r\n\t\t\tcase [SFloat(a), SFloat(b)]: Reflect.compare(a, b);\r\n\t\t\tcase [SString(a), SString(b)]: Reflect.compare(a, b);\r\n\t\t\tcase [SBool(a), SBool(b)]: Reflect.compare(a, b);\r\n\t\t\tcase [SString(a), SFloat(b)]: Reflect.compare(Std.parseFloat(a), b);\r\n\t\t\tcase [SFloat(a), SString(b)]: Reflect.compare(a, Std.parseFloat(b));\r\n\t\t\tcase _: 0;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction eval(e:Expr)\r\n\t{\r\n\t\treturn switch (e.expr)\r\n\t\t{\r\n\t\t\tcase EConst(CIdent(s)): defines.exists(s) ? SString(s) : SNull;\r\n\t\t\tcase EConst(CString(s)): SString(s);\r\n\t\t\tcase EConst(CInt(f)), EConst(CFloat(f)): SFloat(Std.parseFloat(f));\r\n\t\t\tcase EBinop(OpBoolAnd, e1, e2): SBool(isTrue(eval(e1)) && isTrue(eval(e2)));\r\n\t\t\tcase EBinop(OpBoolOr, e1, e2): SBool(isTrue(eval(e1)) || isTrue(eval(e2)));\r\n\t\t\tcase EUnop(OpNot, _, e): SBool(!isTrue(eval(e)));\r\n\t\t\tcase EParenthesis(e): eval(e);\r\n\t\t\tcase EBinop(op, e1, e2):\r\n\t\t\t\tvar v1 = eval(e1);\r\n\t\t\t\tvar v2 = eval(e2);\r\n\t\t\t\tvar cmp = compare(v1, v2);\r\n\t\t\t\tvar val = switch (op)\r\n\t\t\t\t{\r\n\t\t\t\t\tcase OpEq: cmp == 0;\r\n\t\t\t\t\tcase OpNotEq: cmp != 0;\r\n\t\t\t\t\tcase OpGt: cmp > 0;\r\n\t\t\t\t\tcase OpGte: cmp >= 0;\r\n\t\t\t\t\tcase OpLt: cmp < 0;\r\n\t\t\t\t\tcase OpLte: cmp <= 0;\r\n\t\t\t\t\tcase _: throw \"Unsupported operation\";\r\n\t\t\t\t}\r\n\t\t\t\tSBool(val);\r\n\t\t\tcase _: throw \"Invalid condition expression\";\r\n\t\t}\r\n\t}\r\n\r\n\tstatic function punion(p1:Position, p2:Position) {\r\n\t\treturn {\r\n\t\t\tfile: p1.file,\r\n\t\t\tmin: p1.min < p2.min ? p1.min : p2.min,\r\n\t\t\tmax: p1.max > p2.max ? p1.max : p2.max,\r\n\t\t};\r\n\t}\r\n\r\n\tstatic function quoteIdent(s:String) {\r\n\t\t// TODO\r\n\t\treturn s;\r\n\t}\r\n\r\n\tstatic function isLowerIdent(s:String) {\r\n\t\tfunction loop(p) {\r\n\t\t\tvar c = s.charCodeAt(p);\r\n\t\t\treturn if (c >= 'a'.code && c <= 'z'.code)\r\n\t\t\t\ttrue\r\n\t\t\telse if (c == '_'.code) {\r\n\t\t\t\tif (p + 1 < s.length)\r\n\t\t\t\t\tloop(p + 1);\r\n\t\t\t\telse\r\n\t\t\t\t\ttrue;\r\n\t\t\t} else\r\n\t\t\t\tfalse;\r\n\t\t}\r\n\t\treturn loop(0);\r\n\t}\r\n\r\n\tstatic function isPostfix(e:Expr, u:Unop) {\r\n\t\treturn switch (u) {\r\n\t\t\tcase OpIncrement | OpDecrement:\r\n\t\t\t\tswitch(e.expr) {\r\n\t\t\t\t\tcase EConst(_) | EField(_) | EArray(_):\r\n\t\t\t\t\t\ttrue;\r\n\t\t\t\t\tcase _:\r\n\t\t\t\t\t\tfalse;\r\n\t\t\t\t}\r\n\t\t\tcase OpNot | OpNeg | OpNegBits: false;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic function isPrefix(u:Unop) {\r\n\t\treturn switch(u) {\r\n\t\t\tcase OpIncrement | OpDecrement: true;\r\n\t\t\tcase OpNot | OpNeg | OpNegBits: true;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic function precedence(op:Binop) {\r\n\t\tvar left = true;\r\n\t\tvar right = false;\r\n\t\treturn switch(op) {\r\n\t\t\tcase OpMod : {p: 0, left: left};\r\n\t\t\tcase OpMult | OpDiv : {p: 0, left: left};\r\n\t\t\tcase OpAdd | OpSub : {p: 0, left: left};\r\n\t\t\tcase OpShl | OpShr | OpUShr : {p: 0, left: left};\r\n\t\t\tcase OpOr | OpAnd | OpXor : {p: 0, left: left};\r\n\t\t\tcase OpEq | OpNotEq | OpGt | OpLt | OpGte | OpLte : {p: 0, left: left};\r\n\t\t\tcase OpInterval : {p: 0, left: left};\r\n\t\t\tcase OpBoolAnd : {p: 0, left: left};\r\n\t\t\tcase OpBoolOr : {p: 0, left: left};\r\n\t\t\tcase OpArrow : {p: 0, left: left};\r\n\t\t\tcase OpAssign | OpAssignOp(_) : {p:10, left:right};\r\n\t\t}\r\n\t}\r\n\r\n\tstatic function isNotAssign(op:Binop) {\r\n\t\treturn switch(op) {\r\n\t\t\tcase OpAssign | OpAssignOp(_): false;\r\n\t\t\tcase _: true;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic function isDollarIdent(e:Expr) {\r\n\t\treturn switch (e.expr) {\r\n\t\t\tcase EConst(CIdent(n)) if (n.charCodeAt(0) == \"$\".code): true;\r\n\t\t\tcase _: false;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic function swap(op1:Binop, op2:Binop) {\r\n\t\tvar i1 = precedence(op1);\r\n\t\tvar i2 = precedence(op2);\r\n\t\treturn i1.left && i1.p < i2.p;\r\n\t}\r\n\r\n\tstatic function makeBinop(op:Binop, e:Expr, e2:Expr) {\r\n\t\treturn switch (e2.expr) {\r\n\t\t\tcase EBinop(_op,_e,_e2) if (swap(op,_op)):\r\n\t\t\t\tvar _e = makeBinop(op,e,_e);\r\n\t\t\t\t{expr: EBinop(_op,_e,_e2), pos:punion(_e.pos,_e2.pos)};\r\n\t\t\tcase ETernary(e1,e2,e3) if (isNotAssign(op)):\r\n\t\t\t\tvar e = makeBinop(op,e,e1);\r\n\t\t\t\t{expr:ETernary(e,e2,e3), pos:punion(e.pos, e3.pos)};\r\n\t\t\tcase _:\r\n\t\t\t\t{ expr: EBinop(op,e,e2), pos:punion(e.pos, e2.pos)};\r\n\t\t}\r\n\t}\r\n\r\n\tstatic function makeUnop(op:Unop, e:Expr, p1:Position) {\r\n\t\treturn switch(e.expr) {\r\n\t\t\tcase EBinop(bop,e,e2):\r\n\t\t\t\t{ expr: EBinop(bop, makeUnop(op,e,p1), e2), pos: punion(p1,e.pos)};\r\n\t\t\tcase ETernary(e1,e2,e3):\r\n\t\t\t\t{ expr: ETernary(makeUnop(op,e1,p1), e2, e3), pos:punion(p1,e.pos)};\r\n\t\t\tcase _:\r\n\t\t\t\t{ expr: EUnop(op,false,e), pos:punion(p1,e.pos)};\r\n\t\t}\r\n\t}\r\n\r\n\tstatic function makeMeta(name:String, params:Array<Expr>, e:Expr, p1:Position) {\r\n\t\treturn switch(e.expr) {\r\n\t\t\tcase EBinop(bop,e,e2):\r\n\t\t\t\t{ expr: EBinop(bop, makeMeta(name,params,e,p1), e2), pos: punion(p1,e.pos)};\r\n\t\t\tcase ETernary(e1,e2,e3):\r\n\t\t\t\t{ expr: ETernary(makeMeta(name,params,e1,p1), e2, e3), pos:punion(p1,e.pos)};\r\n\t\t\tcase _:\r\n\t\t\t\t{ expr: EMeta({name:name, params:params, pos:p1}, e), pos: punion(p1, e.pos) };\r\n\t\t}\r\n\t}\r\n\r\n\tstatic function aadd<T>(a:Array<T>, t:T) {\r\n\t\ta.push(t);\r\n\t\treturn a;\r\n\t}\r\n\r\n\tfunction psep<T>(sep:TokenDef, f:Void->T):Array<T> {\r\n\t\tvar acc = [];\r\n\t\twhile(true) {\r\n\t\t\ttry {\r\n\t\t\t\tacc.push(f());\r\n\t\t\t\tswitch stream {\r\n\t\t\t\t\tcase [{tok: sep2} && sep2 == sep]:\r\n\t\t\t\t}\r\n\t\t\t} catch(e:hxparse.NoMatch<Dynamic>) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn acc;\r\n\t}\r\n\r\n\tfunction ident() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Const(CIdent(i)),pos:p}]: { name: i, pos: p};\r\n\t\t}\r\n\t}\r\n\r\n\tfunction dollarIdent() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Const(CIdent(i)),pos:p}]: { name: i, pos: p};\r\n\t\t\tcase [{tok:Dollar(i), pos:p}]: { name: \"$\" + i, pos: p};\r\n\t\t}\r\n\t}\r\n\r\n\tfunction dollarIdentMacro(pack:Array<String>) {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Const(CIdent(i)),pos:p}]: { name: i, pos: p};\r\n\t\t\tcase [{tok:Dollar(i), pos:p}]: { name: \"$\" + i, pos: p};\r\n\t\t\tcase [{tok:Kwd(KwdMacro), pos: p} && pack.length > 0]: { name: \"macro\", pos: p };\r\n\t\t}\r\n\t}\r\n\r\n\tfunction lowerIdentOrMacro() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Const(CIdent(i))} && isLowerIdent(i)]: i;\r\n\t\t\tcase [{tok:Kwd(KwdMacro)}]: \"macro\";\r\n\t\t}\r\n\t}\r\n\r\n\tfunction anyEnumIdent() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [i = ident()]: i;\r\n\t\t\tcase [{tok:Kwd(k), pos:p}]: {name:k.getName().toLowerCase(), pos:p};\r\n\t\t}\r\n\t}\r\n\r\n\tfunction propertyIdent() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [i = ident()]: i.name;\r\n\t\t\tcase [{tok:Kwd(KwdDynamic)}]: \"dynamic\";\r\n\t\t\tcase [{tok:Kwd(KwdDefault)}]: \"default\";\r\n\t\t\tcase [{tok:Kwd(KwdNull)}]: \"null\";\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getDoc() {\r\n\t\treturn \"\";\r\n\t}\r\n\r\n\tfunction comma() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Comma}]:\r\n\t\t}\r\n\t}\r\n\r\n\tfunction semicolon() {\r\n\t\treturn if (last.tok == BrClose) {\r\n\t\t\tswitch stream {\r\n\t\t\t\tcase [{tok: Semicolon, pos:p}]: p;\r\n\t\t\t\tcase _: last.pos;\r\n\t\t\t}\r\n\t\t} else switch stream {\r\n\t\t\tcase [{tok: Semicolon, pos:p}]: p;\r\n\t\t\tcase _:\r\n\t\t\t\tvar pos = last.pos;\r\n\t\t\t\tif (doResume)\r\n\t\t\t\t\tpos\r\n\t\t\t\telse\r\n\t\t\t\t\tthrow {\r\n\t\t\t\t\t\tmsg: MissingSemicolon,\r\n\t\t\t\t\t\tpos: pos\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\t}\r\n\r\n\tfunction parseFile() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Kwd(KwdPackage)}, p = parsePackage(), _ = semicolon(), l = parseTypeDecls(p,[]), {tok:Eof}]:\r\n\t\t\t\t{ pack: p, decls: l };\r\n\t\t\tcase [l = parseTypeDecls([],[]), {tok:Eof}]:\r\n\t\t\t\t{ pack: [], decls: l };\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseTypeDecls(pack:Array<String>, acc:Array<TypeDef>) {\r\n\t\treturn switch stream {\r\n\t\t\tcase [ v = parseTypeDecl(), l = parseTypeDecls(pack,aadd(acc,v.decl)) ]:\r\n\t\t\t\tl;\r\n\t\t\tcase _: acc;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseTypeDecl() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Kwd(KwdImport), pos:p1}]:\r\n\t\t\t\tparseImport(p1);\r\n\t\t\tcase [{tok:Kwd(KwdUsing), pos: p1}, t = parseTypePath(), p2 = semicolon()]:\r\n\t\t\t\t{decl: EUsing(t), pos: punion(p1, p2)};\r\n\t\t\tcase [meta = parseMeta(), c = parseCommonFlags()]:\r\n\t\t\t\tswitch stream {\r\n\t\t\t\t\tcase [flags = parseEnumFlags(), doc = getDoc(), name = typeName(), tl = parseConstraintParams(), {tok:BrOpen}, l = parseRepeat(parseEnum), {tok:BrClose, pos: p2}]:\r\n\t\t\t\t\t\t{decl: EEnum({\r\n\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\tdoc: doc,\r\n\t\t\t\t\t\t\tmeta: meta,\r\n\t\t\t\t\t\t\tparams: tl,\r\n\t\t\t\t\t\t\tflags: c.map(function(i) return i.e).concat(flags.flags),\r\n\t\t\t\t\t\t\tdata: l\r\n\t\t\t\t\t\t}), pos: punion(flags.pos,p2)};\r\n\t\t\t\t\tcase [flags = parseClassFlags(), doc = getDoc(), name = typeName(), tl = parseConstraintParams(), hl = parseRepeat(parseClassHerit), {tok:BrOpen}, fl = parseClassFields(false,flags.pos)]:\r\n\t\t\t\t\t\t{decl: EClass({\r\n\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\tdoc: doc,\r\n\t\t\t\t\t\t\tmeta: meta,\r\n\t\t\t\t\t\t\tparams: tl,\r\n\t\t\t\t\t\t\tflags: c.map(function(i) return i.c).concat(flags.flags).concat(hl),\r\n\t\t\t\t\t\t\tdata: fl.fields\r\n\t\t\t\t\t\t}), pos: punion(flags.pos,fl.pos)};\r\n\t\t\t\t\tcase [{tok: Kwd(KwdTypedef), pos: p1}, doc = getDoc(), name = typeName(), tl = parseConstraintParams(), {tok:Binop(OpAssign), pos: p2}, t = parseComplexType()]:\r\n\t\t\t\t\t\tswitch stream {\r\n\t\t\t\t\t\t\tcase [{tok:Semicolon}]:\r\n\t\t\t\t\t\t\tcase _:\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t{ decl: ETypedef({\r\n\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\tdoc: doc,\r\n\t\t\t\t\t\t\tmeta: meta,\r\n\t\t\t\t\t\t\tparams: tl,\r\n\t\t\t\t\t\t\tflags: c.map(function(i) return i.e),\r\n\t\t\t\t\t\t\tdata: t\r\n\t\t\t\t\t\t}), pos: punion(p1,p2)};\r\n\t\t\t\t\tcase [{tok:Kwd(KwdAbstract), pos:p1}, name = typeName(), tl = parseConstraintParams(), st = parseAbstractSubtype(), sl = parseRepeat(parseAbstractRelations), {tok:BrOpen}, fl = parseClassFields(false, p1)]:\r\n\t\t\t\t\t\tvar flags = c.map(function(flag) return switch(flag.e) { case EPrivate: APrivAbstract; case EExtern: throw 'extern abstract is not allowed'; });\r\n\t\t\t\t\t\tif (st != null) {\r\n\t\t\t\t\t\t\tflags.push(AIsType(st));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t{ decl: EAbstract({\r\n\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\tdoc: doc,\r\n\t\t\t\t\t\t\tmeta: meta,\r\n\t\t\t\t\t\t\tparams: tl,\r\n\t\t\t\t\t\t\tflags: flags.concat(sl),\r\n\t\t\t\t\t\t\tdata: fl.fields\r\n\t\t\t\t\t\t}), pos: punion(p1, fl.pos)};\r\n\t\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseClass(meta:Metadata, cflags:Array<{fst: ClassFlag, snd:String}>, needName:Bool) {\r\n\t\tvar optName = if (needName) typeName else function() {\r\n\t\t\tvar t = parseOptional(typeName);\r\n\t\t\treturn t == null ? \"\" : t;\r\n\t\t}\r\n\t\treturn switch stream {\r\n\t\t\tcase [flags = parseClassFlags(), doc = getDoc(), name = optName(), tl = parseConstraintParams(), hl = psep(Comma,parseClassHerit), {tok: BrOpen}, fl = parseClassFields(false,flags.pos)]:\r\n\t\t\t\t{ decl: EClass({\r\n\t\t\t\t\tname: name,\r\n\t\t\t\t\tdoc: doc,\r\n\t\t\t\t\tmeta: meta,\r\n\t\t\t\t\tparams: tl,\r\n\t\t\t\t\tflags: cflags.map(function(i) return i.fst).concat(flags.flags).concat(hl),\r\n\t\t\t\t\tdata: fl.fields\r\n\t\t\t\t}), pos: punion(flags.pos,fl.pos)};\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseImport(p1:Position) {\r\n\t\tvar acc = switch stream {\r\n\t\t\tcase [{tok:Const(CIdent(name)), pos:p}]: [{pack:name, pos:p}];\r\n\t\t\tcase _: unexpected();\r\n\t\t}\r\n\t\twhile(true) {\r\n\t\t\tswitch stream {\r\n\t\t\t\tcase [{tok: Dot}]:\r\n\t\t\t\t\tswitch stream {\r\n\t\t\t\t\t\tcase [{tok:Const(CIdent(k)), pos: p}]:\r\n\t\t\t\t\t\t\tacc.push({pack:k,pos:p});\r\n\t\t\t\t\t\tcase [{tok:Kwd(KwdMacro), pos:p}]:\r\n\t\t\t\t\t\t\tacc.push({pack:\"macro\",pos:p});\r\n\t\t\t\t\t\tcase [{tok:Binop(OpMult)}, {tok:Semicolon, pos:p2}]:\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\tdecl: EImport(acc, IAll),\r\n\t\t\t\t\t\t\t\tpos: p2\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase _: unexpected();\r\n\t\t\t\t\t}\r\n\t\t\t\tcase [{tok:Semicolon, pos:p2}]:\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tdecl: EImport(acc, INormal),\r\n\t\t\t\t\t\tpos: p2\r\n\t\t\t\t\t}\r\n\t\t\t\tcase [{tok:Kwd(KwdIn)}, {tok:Const(CIdent(name))}, {tok:Semicolon, pos:p2}]:\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tdecl: EImport(acc, IAsName(name)),\r\n\t\t\t\t\t\tpos: p2\r\n\t\t\t\t\t}\r\n\t\t\t\tcase _: unexpected();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction parseAbstractRelations() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Const(CIdent(\"to\"))}, t = parseComplexType()]: AToType(t);\r\n\t\t\tcase [{tok:Const(CIdent(\"from\"))}, t = parseComplexType()]: AFromType(t);\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction parseAbstractSubtype() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:POpen}, t = parseComplexType(), {tok:PClose}]: t;\r\n\t\t\tcase _: null;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parsePackage() {\r\n\t\treturn psep(Dot, lowerIdentOrMacro);\r\n\t}\r\n\r\n\tfunction parseClassFields(tdecl:Bool, p1:Position):{fields:Array<Field>, pos:Position} {\r\n\t\tvar l = parseClassFieldResume(tdecl);\r\n\t\tvar p2 = switch stream {\r\n\t\t\tcase [{tok: BrClose, pos: p2}]:\r\n\t\t\t\tp2;\r\n\t\t\tcase _: unexpected();\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tfields: l,\r\n\t\t\tpos: p2\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseClassFieldResume(tdecl:Bool):Array<Field> {\r\n\t\treturn parseRepeat(parseClassField);\r\n\t}\r\n\r\n\tfunction parseCommonFlags():Array<{c:ClassFlag, e:EnumFlag}> {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Kwd(KwdPrivate)}, l = parseCommonFlags()]: aadd(l, {c:HPrivate, e:EPrivate});\r\n\t\t\tcase [{tok:Kwd(KwdExtern)}, l = parseCommonFlags()]: aadd(l, {c:HExtern, e:EExtern});\r\n\t\t\tcase _: [];\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseMetaParams(pname:Position) {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok: POpen, pos:p} && p.min == pname.max, params = psep(Comma, expr), {tok: PClose}]: params;\r\n\t\t\tcase _: [];\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseMetaEntry() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:At}, name = metaName(), params = parseMetaParams(name.pos)]: {name: name.name, params: params, pos: name.pos};\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseMeta() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [entry = parseMetaEntry()]: aadd(parseMeta(), entry);\r\n\t\t\tcase _: [];\r\n\t\t}\r\n\t}\r\n\r\n\tfunction metaName() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Const(CIdent(i)), pos:p}]: {name: i, pos: p};\r\n\t\t\tcase [{tok:Kwd(k), pos:p}]: {name: k.getName().toLowerCase(), pos:p};\r\n\t\t\tcase [{tok:DblDot}]:\r\n\t\t\t\tswitch stream {\r\n\t\t\t\t\tcase [{tok:Const(CIdent(i)), pos:p}]: {name: ':$i', pos: p};\r\n\r\n\t\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseEnumFlags() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Kwd(KwdEnum), pos:p}]: {flags: [], pos: p};\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseClassFlags() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Kwd(KwdClass), pos:p}]: {flags: [], pos: p};\r\n\t\t\tcase [{tok:Kwd(KwdInterface), pos:p}]: {flags: aadd([],HInterface), pos: p};\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseTypeOpt() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:DblDot}, t = parseComplexType()]: t;\r\n\t\t\tcase _: null;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseComplexType() {\r\n\t\tvar t = parseComplexTypeInner();\r\n\t\treturn parseComplexTypeNext(t);\r\n\t}\r\n\r\n\tfunction parseComplexTypeInner():ComplexType {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:POpen}, t = parseComplexType(), {tok:PClose}]: TParent(t);\r\n\t\t\tcase [{tok:BrOpen, pos: p1}]:\r\n\t\t\t\tswitch stream {\r\n\t\t\t\t\tcase [l = parseTypeAnonymous(false)]: TAnonymous(l);\r\n\t\t\t\t\tcase [{tok:Binop(OpGt)}, t = parseTypePath(), {tok:Comma}]:\r\n\t\t\t\t\t\tswitch stream {\r\n\t\t\t\t\t\t\tcase [l = parseTypeAnonymous(false)]: TExtend([t],l);\r\n\t\t\t\t\t\t\tcase [fl = parseClassFields(true, p1)]: TExtend([t], fl.fields);\r\n\t\t\t\t\t\t\tcase _: unexpected();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\tcase [l = parseClassFields(true, p1)]: TAnonymous(l.fields);\r\n\t\t\t\t\tcase _: unexpected();\r\n\t\t\t\t}\r\n\t\t\tcase [{tok:Question}, t = parseComplexTypeInner()]:\r\n\t\t\t\tTOptional(t);\r\n\t\t\tcase [t = parseTypePath()]:\r\n\t\t\t\tTPath(t);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseTypePath() {\r\n\t\treturn parseTypePath1([]);\r\n\t}\r\n\r\n\tfunction parseTypePath1(pack:Array<String>) {\r\n\t\treturn switch stream {\r\n\t\t\tcase [ident = dollarIdentMacro(pack)]:\r\n\t\t\t\tif (isLowerIdent(ident.name)) {\r\n\t\t\t\t\tswitch stream {\r\n\t\t\t\t\t\tcase [{tok:Dot}]:\r\n\t\t\t\t\t\t\tparseTypePath1(aadd(pack, ident.name));\r\n\t\t\t\t\t\tcase [{tok:Semicolon}]:\r\n\t\t\t\t\t\t\tthrow {\r\n\t\t\t\t\t\t\t\tmsg: Custom(\"Type name should start with an uppercase letter\"),\r\n\t\t\t\t\t\t\t\tpos: ident.pos\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase _: unexpected();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar sub = switch stream {\r\n\t\t\t\t\t\tcase [{tok:Dot}]:\r\n\t\t\t\t\t\t\tswitch stream {\r\n\t\t\t\t\t\t\t\tcase [{tok:Const(CIdent(name))} && !isLowerIdent(name)]: name;\r\n\t\t\t\t\t\t\t\tcase _: unexpected();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase _:\r\n\t\t\t\t\t\t\tnull;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar params = switch stream {\r\n\t\t\t\t\t\tcase [{tok:Binop(OpLt)}, l = psep(Comma, parseTypePathOrConst), {tok:Binop(OpGt)}]: l;\r\n\t\t\t\t\t\tcase _: [];\r\n\t\t\t\t\t}\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tpack: pack,\r\n\t\t\t\t\t\tname: ident.name,\r\n\t\t\t\t\t\tparams: params,\r\n\t\t\t\t\t\tsub: sub\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction typeName() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok: Const(CIdent(name)), pos:p}]:\r\n\t\t\t\tif (isLowerIdent(name)) throw {\r\n\t\t\t\t\tmsg: Custom(\"Type name should start with an uppercase letter\"),\r\n\t\t\t\t\tpos: p\r\n\t\t\t\t}\r\n\t\t\t\telse name;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseTypePathOrConst() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:BkOpen, pos: p1}, l = parseArrayDecl(), {tok:BkClose, pos:p2}]: TPExpr({expr: EArrayDecl(l), pos:punion(p1,p2)});\r\n\t\t\tcase [t = parseComplexType()]: TPType(t);\r\n\t\t\tcase [{tok:Const(c), pos:p}]: TPExpr({expr:EConst(c), pos:p});\r\n\t\t\tcase [e = expr()]: TPExpr(e);\r\n\t\t\tcase _: unexpected();\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseComplexTypeNext(t:ComplexType) {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Arrow}, t2 = parseComplexType()]:\r\n\t\t\t\tswitch(t2) {\r\n\t\t\t\t\tcase TFunction(args,r):\r\n\t\t\t\t\t\tTFunction(aadd(args,t),r);\r\n\t\t\t\t\tcase _:\r\n\t\t\t\t\t\tTFunction([t],t2);\r\n\t\t\t\t}\r\n\t\t\tcase _: t;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseTypeAnonymous(opt:Bool):Array<Field> {\r\n\t\treturn switch stream {\r\n\t\t\tcase [id = ident(), {tok:DblDot}, t = parseComplexType()]:\r\n\t\t\t\tfunction next(p2,acc) {\r\n\t\t\t\t\tvar t = !opt ? t : switch(t) {\r\n\t\t\t\t\t\tcase TPath({pack:[], name:\"Null\"}): t;\r\n\t\t\t\t\t\tcase _: TPath({pack:[], name:\"Null\", sub:null, params:[TPType(t)]});\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn aadd(acc, {\r\n\t\t\t\t\t\tname: id.name,\r\n\t\t\t\t\t\tmeta: opt ? [{name:\":optional\",params:[], pos:id.pos}] : [],\r\n\t\t\t\t\t\taccess: [],\r\n\t\t\t\t\t\tdoc: null,\r\n\t\t\t\t\t\tkind: FVar(t,null),\r\n\t\t\t\t\t\tpos: punion(id.pos, p2)\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tswitch stream {\r\n\t\t\t\t\tcase [{tok:BrClose, pos:p2}]: next(p2, []);\r\n\t\t\t\t\tcase [{tok:Comma, pos:p2}]:\r\n\t\t\t\t\t\tswitch stream {\r\n\t\t\t\t\t\t\tcase [{tok:BrClose}]: next(p2, []);\r\n\t\t\t\t\t\t\tcase [l = parseTypeAnonymous(false)]: next(p2, l);\r\n\t\t\t\t\t\t\tcase _: unexpected();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\tcase _: unexpected();\r\n\t\t\t\t}\r\n\t\t\tcase [{tok:Question} && !opt]: parseTypeAnonymous(true);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseEnum() {\r\n\t\tdoc = null;\r\n\t\tvar meta = parseMeta();\r\n\t\treturn switch stream {\r\n\t\t\tcase [name = anyEnumIdent(), doc = getDoc(), params = parseConstraintParams()]:\r\n\t\t\t\tvar args = switch stream {\r\n\t\t\t\t\tcase [{tok:POpen}, l = psep(Comma, parseEnumParam), {tok:PClose}]: l;\r\n\t\t\t\t\tcase _: [];\r\n\t\t\t\t}\r\n\t\t\t\tvar t = switch stream {\r\n\t\t\t\t\tcase [{tok:DblDot}, t = parseComplexType()]: t;\r\n\t\t\t\t\tcase _: null;\r\n\t\t\t\t}\r\n\t\t\t\tvar p2 = switch stream {\r\n\t\t\t\t\tcase [p = semicolon()]: p;\r\n\t\t\t\t\tcase _: unexpected();\r\n\t\t\t\t}\r\n\t\t\t\t{\r\n\t\t\t\t\tname: name.name,\r\n\t\t\t\t\tdoc: doc,\r\n\t\t\t\t\tmeta: meta,\r\n\t\t\t\t\targs: args,\r\n\t\t\t\t\tparams: params,\r\n\t\t\t\t\ttype: t,\r\n\t\t\t\t\tpos: punion(name.pos, p2)\r\n\t\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseEnumParam() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Question}, name = ident(), {tok:DblDot}, t = parseComplexType()]: { name: name.name, opt: true, type: t};\r\n\t\t\tcase [name = ident(), {tok:DblDot}, t = parseComplexType()]: { name: name.name, opt: false, type: t };\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseClassField():Field {\r\n\t\tdoc = null;\r\n\t\treturn switch stream {\r\n\t\t\tcase [meta = parseMeta(), al = parseCfRights(true,[]), doc = getDoc()]:\r\n\t\t\t\tvar data = switch stream {\r\n\t\t\t\t\tcase [{tok:Kwd(KwdVar), pos:p1}, name = ident()]:\r\n\t\t\t\t\t\tswitch stream {\r\n\t\t\t\t\t\t\tcase [{tok:POpen}, i1 = propertyIdent(), {tok:Comma}, i2 = propertyIdent(), {tok:PClose}]:\r\n\t\t\t\t\t\t\t\tvar t = switch stream {\r\n\t\t\t\t\t\t\t\t\tcase [{tok:DblDot}, t = parseComplexType()]: t;\r\n\t\t\t\t\t\t\t\t\tcase _: null;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvar e = switch stream {\r\n\t\t\t\t\t\t\t\t\tcase [{tok:Binop(OpAssign)}, e = toplevelExpr(), p2 = semicolon()]: { expr: e, pos: p2 };\r\n\t\t\t\t\t\t\t\t\tcase [{tok:Semicolon, pos:p2}]: { expr: null, pos: p2 };\r\n\t\t\t\t\t\t\t\t\tcase _: unexpected();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tname: name.name,\r\n\t\t\t\t\t\t\t\t\tpos: punion(p1,e.pos),\r\n\t\t\t\t\t\t\t\t\tkind: FProp(i1,i2,t,e.expr)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase [t = parseTypeOpt()]:\r\n\t\t\t\t\t\t\t\tvar e = switch stream {\r\n\t\t\t\t\t\t\t\t\tcase [{tok:Binop(OpAssign)}, e = toplevelExpr(), p2 = semicolon()]: { expr: e, pos: p2 };\r\n\t\t\t\t\t\t\t\t\tcase [{tok:Semicolon, pos:p2}]: { expr: null, pos: p2 };\r\n\t\t\t\t\t\t\t\t\tcase _: unexpected();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tname: name.name,\r\n\t\t\t\t\t\t\t\t\tpos: punion(p1,e.pos),\r\n\t\t\t\t\t\t\t\t\tkind: FVar(t,e.expr)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\tcase [{tok:Kwd(KwdFunction), pos:p1}, name = parseFunName(), pl = parseConstraintParams(), {tok:POpen}, al = psep(Comma, parseFunParam), {tok:PClose}, t = parseTypeOpt()]:\r\n\t\t\t\t\t\tvar e = switch stream {\r\n\t\t\t\t\t\t\tcase [e = toplevelExpr(), _ = semicolon()]:\r\n\t\t\t\t\t\t\t\t{ expr: e, pos: e.pos };\r\n\t\t\t\t\t\t\tcase [{tok: Semicolon,pos:p}]:\r\n\t\t\t\t\t\t\t\t{ expr: null, pos: p}\r\n\t\t\t\t\t\t\tcase _: unexpected();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar f = {\r\n\t\t\t\t\t\t\tparams: pl,\r\n\t\t\t\t\t\t\targs: al,\r\n\t\t\t\t\t\t\tret: t,\r\n\t\t\t\t\t\t\texpr: e.expr\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\tpos: punion(p1, e.pos),\r\n\t\t\t\t\t\t\tkind: FFun(f)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\tcase _:\r\n\t\t\t\t\t\tif (al.length == 0)\r\n\t\t\t\t\t\t\tthrow noMatch();\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\tunexpected();\r\n\t\t\t\t}\r\n\t\t\t{\r\n\t\t\t\tname: data.name,\r\n\t\t\t\tdoc: doc,\r\n\t\t\t\tmeta: meta,\r\n\t\t\t\taccess: al,\r\n\t\t\t\tpos: data.pos,\r\n\t\t\t\tkind: data.kind\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseCfRights(allowStatic:Bool, l:Array<Access>) {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Kwd(KwdStatic)} && allowStatic, l = parseCfRights(false, aadd(l, AStatic))]: l;\r\n\t\t\tcase [{tok:Kwd(KwdMacro)} && !l.has(AMacro), l = parseCfRights(allowStatic, aadd(l, AMacro))]: l;\r\n\t\t\tcase [{tok:Kwd(KwdPublic)} && !(l.has(APublic) || l.has(APrivate)), l = parseCfRights(allowStatic, aadd(l, APublic))]: l;\r\n\t\t\tcase [{tok:Kwd(KwdPrivate)} && !(l.has(APublic) || l.has(APrivate)), l = parseCfRights(allowStatic, aadd(l, APrivate))]: l;\r\n\t\t\tcase [{tok:Kwd(KwdOverride)} && !l.has(AOverride), l = parseCfRights(false, aadd(l, AOverride))]: l;\r\n\t\t\tcase [{tok:Kwd(KwdDynamic)} && !l.has(ADynamic), l = parseCfRights(allowStatic, aadd(l, ADynamic))]: l;\r\n\t\t\tcase [{tok:Kwd(KwdInline)}, l = parseCfRights(allowStatic, aadd(l, AInline))]: l;\r\n\t\t\tcase _: l;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseFunName() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Const(CIdent(name))}]: name;\r\n\t\t\tcase [{tok:Kwd(KwdNew)}]: \"new\";\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseFunParam() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Question}, id = ident(), t = parseTypeOpt(), c = parseFunParamValue()]: { name: id.name, opt: true, type: t, value: c};\r\n\t\t\tcase [id = ident(), t = parseTypeOpt(), c = parseFunParamValue()]: { name: id.name, opt: false, type: t, value: c};\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseFunParamValue() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Binop(OpAssign)}, e = toplevelExpr()]: e;\r\n\t\t\tcase _: null;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseFunParamType() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Question}, id = ident(), {tok:DblDot}, t = parseComplexType()]: { name: id.name, opt: true, type: t};\r\n\t\t\tcase [ id = ident(), {tok:DblDot}, t = parseComplexType()]: { name: id.name, opt: false, type: t};\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseConstraintParams() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Binop(OpLt)}, l = psep(Comma, parseConstraintParam), {tok:Binop((OpGt))}]: l;\r\n\t\t\tcase _: [];\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseConstraintParam() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [name = typeName()]:\r\n\t\t\t\tvar params = [];\r\n\t\t\t\tvar ctl = switch stream {\r\n\t\t\t\t\tcase [{tok:DblDot}]:\r\n\t\t\t\t\t\tswitch stream {\r\n\t\t\t\t\t\t\tcase [{tok:POpen}, l = psep(Comma, parseComplexType), {tok:PClose}]: l;\r\n\t\t\t\t\t\t\tcase [t = parseComplexType()]: [t];\r\n\t\t\t\t\t\t\tcase _: unexpected();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\tcase _: [];\r\n\t\t\t\t}\r\n\t\t\t\t{\r\n\t\t\t\t\tname: name,\r\n\t\t\t\t\tparams: params,\r\n\t\t\t\t\tconstraints: ctl\r\n\t\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseClassHerit() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Kwd(KwdExtends)}, t = parseTypePath()]: HExtends(t);\r\n\t\t\tcase [{tok:Kwd(KwdImplements)}, t = parseTypePath()]: HImplements(t);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction block1() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Const(CIdent(name)), pos:p}]: block2(name, CIdent(name), p);\r\n\t\t\tcase [{tok:Const(CString(name)), pos:p}]: block2(quoteIdent(name), CString(name), p);\r\n\t\t\tcase [b = block([])]: EBlock(b);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction block2(name:String, ident:Constant, p:Position) {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:DblDot}, e = expr(), l = parseObjDecl()]:\r\n\t\t\t\tl.unshift({field:name, expr:e});\r\n\t\t\t\tEObjectDecl(l);\r\n\t\t\tcase _:\r\n\t\t\t\tvar e = exprNext({expr:EConst(ident), pos: p});\r\n\t\t\t\tvar _ = semicolon();\r\n\t\t\t\tvar b = block([e]);\r\n\t\t\t\tEBlock(b);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction block(acc:Array<Expr>) {\r\n\t\ttry {\r\n\t\t\tvar e = parseBlockElt();\r\n\t\t\treturn block(aadd(acc,e));\r\n\t\t} catch(e:hxparse.NoMatch<Dynamic>) {\r\n\t\t\treturn acc;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseBlockElt() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Kwd(KwdVar), pos:p1}, vl = psep(Comma, parseVarDecl), p2 = semicolon()]: { expr: EVars(vl), pos:punion(p1,p2)};\r\n\t\t\tcase [e = expr(), _ = semicolon()]: e;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseObjDecl() {\r\n\t\tvar acc = [];\r\n\t\twhile(true) {\r\n\t\t\tswitch stream {\r\n\t\t\t\tcase [{tok:Comma}]:\r\n\t\t\t\t\tswitch stream {\r\n\t\t\t\t\t\tcase [id = ident(), {tok:DblDot}, e = expr()]:\r\n\t\t\t\t\t\t\tacc.push({field:id.name, expr: e});\r\n\t\t\t\t\t\tcase [{tok:Const(CString(name))}, {tok:DblDot}, e = expr()]:\r\n\t\t\t\t\t\t\t//aadd(l,{field:quoteIdent(name), expr: e});\r\n\t\t\t\t\t\t\tacc.push({field:quoteIdent(name), expr: e});\r\n\t\t\t\t\t\tcase _:\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\tcase _:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn acc;\r\n\t}\r\n\r\n\tfunction parseArrayDecl() {\r\n\t\tvar acc = [];\r\n\t\tvar br = false;\r\n\t\twhile(true) {\r\n\t\t\tswitch stream {\r\n\t\t\t\tcase [e = expr()]:\r\n\t\t\t\t\tacc.push(e);\r\n\t\t\t\t\tswitch stream {\r\n\t\t\t\t\t\tcase [{tok: Comma}]:\r\n\t\t\t\t\t\tcase _: br = true;\r\n\t\t\t\t\t}\r\n\t\t\t\tcase _: br = true;\r\n\t\t\t}\r\n\t\t\tif (br) break;\r\n\t\t}\r\n\t\treturn acc;\r\n\t}\r\n\r\n\tfunction parseVarDecl() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [id = dollarIdent(), t = parseTypeOpt()]:\r\n\t\t\t\tswitch stream {\r\n\t\t\t\t\tcase [{tok:Binop(OpAssign)}, e = expr()]: { name: id.name, type: t, expr: e};\r\n\t\t\t\t\tcase _: { name: id.name, type:t, expr: null};\r\n\t\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction inlineFunction() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Kwd(KwdInline)}, {tok:Kwd(KwdFunction), pos:p1}]: { isInline: true, pos: p1};\r\n\t\t\tcase [{tok:Kwd(KwdFunction), pos: p1}]: { isInline: false, pos: p1};\r\n\t\t}\r\n\t}\r\n\r\n\tfunction reify(inMacro:Bool) {\r\n\t\t// TODO\r\n\t\treturn {\r\n\t\t\ttoExpr: function(e) return null,\r\n\t\t\ttoType: function(t,p) return null,\r\n\t\t\ttoTypeDef: function(t) return null,\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction reifyExpr(e:Expr) {\r\n\t\tvar toExpr = reify(inMacro).toExpr;\r\n\t\tvar e = toExpr(e);\r\n\t\treturn { expr: ECheckType(e, TPath( {pack:[\"haxe\",\"macro\"], name:\"Expr\", sub:null, params: []})), pos: e.pos};\r\n\t}\r\n\r\n\tfunction parseMacroExpr(p:Position) {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:DblDot}, t = parseComplexType()]:\r\n\t\t\t\tvar toType = reify(inMacro).toType;\r\n\t\t\t\tvar t = toType(t,p);\r\n\t\t\t\t{ expr: ECheckType(t, TPath( {pack:[\"haxe\",\"macro\"], name:\"Expr\", sub:\"ComplexType\", params: []})), pos: p};\r\n\t\t\tcase [{tok:Kwd(KwdVar), pos:p1}, vl = psep(Comma, parseVarDecl)]:\r\n\t\t\t\treifyExpr({expr:EVars(vl), pos:p1});\r\n\t\t\tcase [{tok:BkOpen}, d = parseClass([],[],false)]:\r\n\t\t\t\tvar toType = reify(inMacro).toTypeDef;\r\n\t\t\t\t{ expr: ECheckType(toType(d), TPath( {pack:[\"haxe\",\"macro\"], name:\"Expr\", sub:\"TypeDefinition\", params: []})), pos: p};\r\n\t\t\tcase [e = secureExpr()]:\r\n\t\t\t\treifyExpr(e);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic function expr():Expr {\r\n\t\treturn switch stream {\r\n\t\t\tcase [meta = parseMetaEntry()]:\r\n\t\t\t\tmakeMeta(meta.name, meta.params, secureExpr(), meta.pos);\r\n\t\t\tcase [{tok:BrOpen, pos:p1}, b = block1(), {tok:BrClose, pos:p2}]:\r\n\t\t\t\tvar e = { expr: b, pos: punion(p1, p2)};\r\n\t\t\t\tswitch(b) {\r\n\t\t\t\t\tcase EObjectDecl(_): exprNext(e);\r\n\t\t\t\t\tcase _: e;\r\n\t\t\t\t}\r\n\t\t\tcase [{tok:Kwd(KwdMacro), pos:p}]:\r\n\t\t\t\tparseMacroExpr(p);\r\n\t\t\tcase [{tok:Kwd(KwdVar), pos: p1}, v = parseVarDecl()]: { expr: EVars([v]), pos: p1};\r\n\t\t\tcase [{tok:Const(c), pos:p}]: exprNext({expr:EConst(c), pos:p});\r\n\t\t\tcase [{tok:Kwd(KwdThis), pos:p}]: exprNext({expr: EConst(CIdent(\"this\")), pos:p});\r\n\t\t\tcase [{tok:Kwd(KwdTrue), pos:p}]: exprNext({expr: EConst(CIdent(\"true\")), pos:p});\r\n\t\t\tcase [{tok:Kwd(KwdFalse), pos:p}]: exprNext({expr: EConst(CIdent(\"false\")), pos:p});\r\n\t\t\tcase [{tok:Kwd(KwdNull), pos:p}]: exprNext({expr: EConst(CIdent(\"null\")), pos:p});\r\n\t\t\tcase [{tok:Kwd(KwdCast), pos:p1}]:\r\n\t\t\t\tswitch stream {\r\n\t\t\t\t\tcase [{tok:POpen}, e = expr()]:\r\n\t\t\t\t\t\tswitch stream {\r\n\t\t\t\t\t\t\tcase [{tok:Comma}, t = parseComplexType(), {tok:PClose, pos:p2}]: exprNext({expr:ECast(e,t), pos: punion(p1,p2)});\r\n\t\t\t\t\t\t\tcase [{tok:PClose, pos:p2}]: exprNext({expr:ECast(e,null),pos:punion(p1,p2)});\r\n\t\t\t\t\t\t\tcase _: unexpected();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\tcase [e = secureExpr()]: exprNext({expr:ECast(e,null), pos:punion(p1, e.pos)});\r\n\t\t\t\t}\r\n\t\t\tcase [{tok:Kwd(KwdThrow), pos:p}, e = expr()]: { expr: EThrow(e), pos: p};\r\n\t\t\tcase [{tok:Kwd(KwdNew), pos:p1}, t = parseTypePath(), {tok:POpen, pos:_}]:\r\n\t\t\t\tswitch stream {\r\n\t\t\t\t\tcase [al = psep(Comma, expr), {tok:PClose, pos:p2}]: exprNext({expr:ENew(t,al), pos:punion(p1, p2)});\r\n\t\t\t\t\tcase _: unexpected();\r\n\t\t\t\t}\r\n\t\t\tcase [{tok:POpen, pos: p1}, e = expr(), {tok:PClose, pos:p2}]: exprNext({expr:EParenthesis(e), pos:punion(p1, p2)});\r\n\t\t\tcase [{tok:BkOpen, pos:p1}, l = parseArrayDecl(), {tok:BkClose, pos:p2}]: exprNext({expr: EArrayDecl(l), pos:punion(p1,p2)});\r\n\t\t\tcase [inl = inlineFunction(), name = parseOptional(dollarIdent), pl = parseConstraintParams(), {tok:POpen}, al = psep(Comma,parseFunParam), {tok:PClose}, t = parseTypeOpt()]:\r\n\t\t\t\tfunction make(e) {\r\n\t\t\t\t\tvar f = {\r\n\t\t\t\t\t\tparams: pl,\r\n\t\t\t\t\t\tret: t,\r\n\t\t\t\t\t\targs: al,\r\n\t\t\t\t\t\texpr: e\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn { expr: EFunction(name == null ? null : inl.isInline ? \"inline_\" + name.name : name.name, f), pos: punion(inl.pos, e.pos)};\r\n\t\t\t\t}\r\n\t\t\t\texprNext(make(secureExpr()));\r\n\t\t\tcase [{tok:Unop(op), pos:p1}, e = expr()]: makeUnop(op,e,p1);\r\n\t\t\tcase [{tok:Binop(OpSub), pos:p1}, e = expr()]:\r\n\t\t\t\tfunction neg(s:String) {\r\n\t\t\t\t\treturn s.charCodeAt(0) == '-'.code\r\n\t\t\t\t\t\t? s.substr(1)\r\n\t\t\t\t\t\t: \"-\" + s;\r\n\t\t\t\t}\r\n\t\t\t\tswitch (makeUnop(OpNeg,e,p1)) {\r\n\t\t\t\t\tcase {expr:EUnop(OpNeg,false,{expr:EConst(CInt(i))}), pos:p}:\r\n\t\t\t\t\t\t{expr:EConst(CInt(neg(i))), pos:p};\r\n\t\t\t\t\tcase {expr:EUnop(OpNeg,false,{expr:EConst(CFloat(j))}), pos:p}:\r\n\t\t\t\t\t\t{expr:EConst(CFloat(neg(j))), pos:p};\r\n\t\t\t\t\tcase e: e;\r\n\t\t\t\t}\r\n\t\t\tcase [{tok:Kwd(KwdFor), pos:p}, {tok:POpen}, it = expr(), {tok:PClose}]:\r\n\t\t\t\tvar e = secureExpr();\r\n\t\t\t\t{ expr: EFor(it,e), pos:punion(p, e.pos)};\r\n\t\t\tcase [{tok:Kwd(KwdIf), pos:p}, {tok:POpen}, cond = expr(), {tok:PClose}, e1 = expr()]:\r\n\t\t\t\tvar e2 = switch stream {\r\n\t\t\t\t\tcase [{tok:Kwd(KwdElse)}, e2 = expr()]: e2;\r\n\t\t\t\t\tcase _:\r\n\t\t\t\t\t\tswitch [peek(0),peek(1)] {\r\n\t\t\t\t\t\t\tcase [{tok:Semicolon}, {tok:Kwd(KwdElse)}]:\r\n\t\t\t\t\t\t\t\tjunk();\r\n\t\t\t\t\t\t\t\tjunk();\r\n\t\t\t\t\t\t\t\tsecureExpr();\r\n\t\t\t\t\t\t\tcase _: null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t{ expr: EIf(cond,e1,e2), pos:punion(p, e2 == null ? e1.pos : e2.pos)};\r\n\t\t\tcase [{tok:Kwd(KwdReturn), pos:p}, e = parseOptional(expr)]: { expr: EReturn(e), pos: e == null ? p : punion(p,e.pos)};\r\n\t\t\tcase [{tok:Kwd(KwdBreak), pos:p}]: { expr: EBreak, pos: p };\r\n\t\t\tcase [{tok:Kwd(KwdContinue), pos:p}]: { expr: EContinue, pos: p};\r\n\t\t\tcase [{tok:Kwd(KwdWhile), pos:p1}, {tok:POpen}, cond = expr(), {tok:PClose}]:\r\n\t\t\t\tvar e = secureExpr();\r\n\t\t\t\t{ expr: EWhile(cond, e, true), pos: punion(p1, e.pos)};\r\n\t\t\tcase [{tok:Kwd(KwdDo), pos:p1}, e = expr(), {tok:Kwd(KwdWhile)}, {tok:POpen}, cond = expr(), {tok:PClose}]: { expr: EWhile(cond,e,false), pos:punion(p1, e.pos)};\r\n\t\t\tcase [{tok:Kwd(KwdSwitch), pos:p1}, e = expr(), {tok:BrOpen}, cases = parseSwitchCases(), {tok:BrClose, pos:p2}]:\r\n\t\t\t\t{ expr: ESwitch(e,cases.cases,cases.def), pos:punion(p1,p2)};\r\n\t\t\tcase [{tok:Kwd(KwdTry), pos:p1}, e = expr(), cl = parseRepeat(parseCatch)]:\r\n\t\t\t\t{ expr: ETry(e,cl), pos:p1};\r\n\t\t\tcase [{tok:IntInterval(i), pos:p1}, e2 = expr()]: makeBinop(OpInterval,{expr:EConst(CInt(i)), pos:p1}, e2);\r\n\t\t\tcase [{tok:Kwd(KwdUntyped), pos:p1}, e = expr()]: { expr: EUntyped(e), pos:punion(p1,e.pos)};\r\n\t\t\tcase [{tok:Dollar(v), pos:p}]: exprNext({expr:EConst(CIdent(\"$\" + v)), pos:p});\r\n\t\t}\r\n\t}\r\n\r\n\tfunction toplevelExpr():Expr {\r\n\t\treturn expr();\r\n\t}\r\n\r\n\tfunction exprNext(e1:Expr):Expr {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Dot, pos:p}]:\r\n\t\t\t\tswitch stream {\r\n\t\t\t\t\tcase [{tok:Dollar(v), pos:p2}]:\r\n\t\t\t\t\t\texprNext({expr:EField(e1, \"$\" + v), pos:punion(e1.pos, p2)});\r\n\t\t\t\t\tcase [{tok:Const(CIdent(f)), pos:p2} && p.max == p2.min]:\r\n\t\t\t\t\t\texprNext({expr:EField(e1,f), pos:punion(e1.pos,p2)});\r\n\t\t\t\t\tcase [{tok:Kwd(KwdMacro), pos:p2} && p.max == p2.min]:\r\n\t\t\t\t\t\texprNext({expr:EField(e1,\"macro\"), pos:punion(e1.pos,p2)});\r\n\t\t\t\t\tcase _:\r\n\t\t\t\t\t\tswitch(e1) {\r\n\t\t\t\t\t\t\tcase {expr: EConst(CInt(v)), pos:p2} if (p2.max == p.min):\r\n\t\t\t\t\t\t\t\texprNext({expr:EConst(CFloat(v + \".\")), pos:punion(p,p2)});\r\n\t\t\t\t\t\t\tcase _: unexpected();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\tcase [{tok:POpen, pos:_}]:\r\n\t\t\t\tswitch stream {\r\n\t\t\t\t\tcase [params = parseCallParams(), {tok:PClose, pos:p2}]:\r\n\t\t\t\t\t\texprNext({expr:ECall(e1,params),pos:punion(e1.pos,p2)});\r\n\t\t\t\t\tcase _: unexpected();\r\n\t\t\t\t}\r\n\t\t\tcase [{tok:BkOpen}, e2 = expr(), {tok:BkClose, pos:p2}]:\r\n\t\t\t\texprNext({expr:EArray(e1,e2), pos:punion(e1.pos,p2)});\r\n\t\t\tcase [{tok:Binop(OpGt)}]:\r\n\t\t\t\tswitch stream {\r\n\t\t\t\t\tcase [{tok:Binop(OpGt)}]:\r\n\t\t\t\t\t\tswitch stream {\r\n\t\t\t\t\t\t\tcase [{tok:Binop(OpGt)}]:\r\n\t\t\t\t\t\t\t\tswitch stream {\r\n\t\t\t\t\t\t\t\t\tcase [{tok:Binop(OpAssign)}, e2 = expr()]:\r\n\t\t\t\t\t\t\t\t\t\tmakeBinop(OpAssignOp(OpUShr),e1,e2);\r\n\t\t\t\t\t\t\t\t\tcase [e2 = secureExpr()]: makeBinop(OpUShr,e1,e2);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase [{tok:Binop(OpAssign)}, e2 = expr()]:\r\n\t\t\t\t\t\t\t\tmakeBinop(OpAssignOp(OpShr),e1,e2);\r\n\t\t\t\t\t\t\tcase [e2 = secureExpr()]:\r\n\t\t\t\t\t\t\t\tmakeBinop(OpShr,e1,e2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\tcase [{tok:Binop(OpAssign)}]:\r\n\t\t\t\t\t\tmakeBinop(OpGte,e1,secureExpr());\r\n\t\t\t\t\tcase [e2 = secureExpr()]:\r\n\t\t\t\t\t\tmakeBinop(OpGt,e1,e2);\r\n\t\t\t\t}\r\n\t\t\tcase [{tok:Binop(op)}, e2 = expr()]:\r\n\t\t\t\tmakeBinop(op,e1,e2);\r\n\t\t\tcase [{tok:Question}, e2 = expr(), {tok:DblDot}, e3 = expr()]:\r\n\t\t\t\t{ expr: ETernary(e1,e2,e3), pos: punion(e1.pos, e3.pos)};\r\n\t\t\tcase [{tok:Kwd(KwdIn)}, e2 = expr()]:\r\n\t\t\t\t{expr:EIn(e1,e2), pos:punion(e1.pos, e2.pos)};\r\n\t\t\tcase [{tok:Unop(op), pos:p} && isPostfix(e1,op)]:\r\n\t\t\t\texprNext({expr:EUnop(op,true,e1), pos:punion(e1.pos, p)});\r\n\t\t\tcase [{tok:BrOpen, pos:p1} && isDollarIdent(e1), eparam = expr(), {tok:BrClose,pos:p2}]:\r\n\t\t\t\tswitch (e1.expr) {\r\n\t\t\t\t\tcase EConst(CIdent(n)):\r\n\t\t\t\t\t\texprNext({expr: EMeta({name:n, params:[], pos:e1.pos},eparam), pos:punion(p1,p2)});\r\n\t\t\t\t\tcase _: throw false;\r\n\t\t\t\t}\r\n\t\t\tcase _: e1;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseGuard() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Kwd(KwdIf)}, {tok:POpen}, e = expr(), {tok:PClose}]:\r\n\t\t\t\te;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseSwitchCases() {\r\n\t\tvar cases = [];\r\n\t\tvar def = null;\r\n\t\tfunction caseBlock(b:Array<Expr>, p:Position) {\r\n\t\t\treturn if (b.length == 0) {\r\n\t\t\t\tnull;\r\n\t\t\t} else switch(b) {\r\n\t\t\t\tcase [e = macro $b{el}]: e;\r\n\t\t\t\tcase _: { expr: EBlock(b), pos: p};\r\n\t\t\t}\r\n\t\t}\r\n\t\twhile(true) {\r\n\t\t\tswitch stream {\r\n\t\t\t\tcase [{tok:Kwd(KwdDefault), pos:p1}, {tok:DblDot}]:\r\n\t\t\t\t\tvar b = block([]);\r\n\t\t\t\t\tvar e = caseBlock(b, p1);\r\n\t\t\t\t\tif (e == null) {\r\n\t\t\t\t\t\te = { expr: null, pos: p1 };\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (def != null) {\r\n\t\t\t\t\t\tthrow {\r\n\t\t\t\t\t\t\tmsg: DuplicateDefault,\r\n\t\t\t\t\t\t\tpos: p1\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdef = e;\r\n\t\t\t\tcase [{tok:Kwd(KwdCase), pos:p1}, el = psep(Comma,expr), eg = parseOptional(parseGuard), {tok:DblDot}]:\r\n\t\t\t\t\tvar b = block([]);\r\n\t\t\t\t\tvar e = caseBlock(b, p1);\r\n\t\t\t\t\tcases.push({values:el,guard:eg,expr:e});\r\n\t\t\t\tcase _:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tcases: cases,\r\n\t\t\tdef: def\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction parseCatch() {\r\n\t\treturn switch stream {\r\n\t\t\tcase [{tok:Kwd(KwdCatch), pos:p}, {tok:POpen}, id = ident(), ]:\r\n\t\t\t\tswitch stream {\r\n\t\t\t\t\tcase [{tok:DblDot}, t = parseComplexType(), {tok:PClose}]:\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tname: id.name,\r\n\t\t\t\t\t\t\ttype: t,\r\n\t\t\t\t\t\t\texpr: secureExpr()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\tcase _:\r\n\t\t\t\t\t\tthrow {\r\n\t\t\t\t\t\t\tmsg: MissingType,\r\n\t\t\t\t\t\t\tpos: p\r\n\t\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseCallParams() {\r\n\t\tvar ret = [];\r\n\t\tswitch stream {\r\n\t\t\tcase [e = expr()]: ret.push(e);\r\n\t\t\tcase _: return [];\r\n\t\t}\r\n\t\twhile(true) {\r\n\t\t\tswitch stream {\r\n\t\t\t\tcase [{tok: Comma}, e = expr()]: ret.push(e);\r\n\t\t\t\tcase _: break;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tfunction secureExpr() {\r\n\t\treturn expr();\r\n\t}\r\n}","package hxparse;\r\n\r\nimport haxe.macro.Context;\r\nimport haxe.macro.Expr;\r\n\r\nusing haxe.macro.Tools;\r\nusing Lambda;\r\n\r\nprivate typedef ParserCase = {\r\n\texpr: Expr,\r\n\thead: Expr,\r\n\ttail: Array<Expr>\r\n}\r\n\r\nprivate enum CaseGroup {\r\n\tSimple(group:Array<ParserCase>);\r\n\tComplex(c:ParserCase);\r\n}\r\n\r\nclass ParserBuilderImpl {\r\n\tstatic public function build():Array<haxe.macro.Field> {\r\n\t\tvar fields = Context.getBuildFields();\r\n\t\tfor (field in fields) {\r\n\t\t\tswitch(field.kind) {\r\n\t\t\t\tcase FFun(fun) if (fun.expr != null):\r\n\t\t\t\t\tfun.expr = map(true, fun.expr);\r\n\t\t\t\tcase _:\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn fields;\r\n\t}\r\n\t\r\n\tstatic function punion(p1:Position, p2:Position) {\r\n\t\tvar p1 = Context.getPosInfos(p1);\r\n\t\tvar p2 = Context.getPosInfos(p2);\r\n\t\treturn Context.makePosition({\r\n\t\t\tfile: p1.file,\r\n\t\t\tmin: p1.min < p2.min ? p1.min : p2.min,\r\n\t\t\tmax: p1.max > p2.max ? p1.max : p2.max\r\n\t\t});\r\n\t}\r\n\t\r\n\tstatic function map(needVal:Bool, e:Expr) {\r\n\t\treturn switch(e.expr) {\r\n\t\t\tcase ESwitch({expr: EConst(CIdent(\"stream\"))}, cl, edef):\r\n\t\t\t\tif (edef != null)\r\n\t\t\t\t\tcl.push({values: [macro _], expr: edef, guard: null});\r\n\t\t\t\tvar ce = transformCases(needVal, cl);\r\n\t\t\t\tce;\r\n\t\t\tcase EBlock([]):\r\n\t\t\t\te;\r\n\t\t\tcase EBlock(el):\r\n\t\t\t\tvar elast = el.pop();\r\n\t\t\t\tvar el = el.map(map.bind(false));\r\n\t\t\t\tel.push(map(true, elast));\r\n\t\t\t\tmacro @:pos(e.pos) $b{el};\r\n\t\t\tcase _: e.map(map.bind(true));\r\n\t\t}\r\n\t}\r\n\t\r\n\tstatic function transformCases(needVal:Bool, cl:Array<Case>) {\r\n\t\tvar groups = [];\r\n\t\tvar group = [];\r\n\t\tvar def = noMatch;\r\n\t\tfor (c in cl) {\r\n\t\t\tswitch(c.values) {\r\n\t\t\t\tcase [{expr:EArrayDecl(el)}]:\r\n\t\t\t\t\tvar head = el.shift();\r\n\t\t\t\t\tvar chead = {head:head, tail: el, expr:c.expr == null ? macro null : map(true,c.expr)};\r\n\t\t\t\t\tswitch(head.expr) {\r\n\t\t\t\t\t\tcase EBinop(_):\r\n\t\t\t\t\t\t\tif (group.length > 0) groups.push(Simple(group));\r\n\t\t\t\t\t\t\tgroups.push(Complex(chead));\r\n\t\t\t\t\t\t\tgroup = [];\r\n\t\t\t\t\t\tcase _:\r\n\t\t\t\t\t\t\tgroup.push(chead);\r\n\t\t\t\t\t}\r\n\t\t\t\tcase [{expr:EConst(CIdent(\"_\"))}]:\r\n\t\t\t\t\tdef = c.expr == null ? macro null : map(true, c.expr);\r\n\t\t\t\tcase [e]:\r\n\t\t\t\t\tContext.error(\"Expected [ patterns ]\", e.pos);\r\n\t\t\t\tcase _:\r\n\t\t\t\t\tContext.error(\"Comma notation is not allowed while matching streams\", punion(c.values[0].pos, c.values[c.values.length - 1].pos));\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (group.length > 0)\r\n\t\t\tgroups.push(Simple(group));\r\n\t\t\t\r\n\t\tvar last = groups.pop();\r\n\t\tvar elast = makeCase(last,def);\r\n\t\twhile (groups.length > 0) {\r\n\t\t\telast = makeCase(groups.pop(), elast);\r\n\t\t}\r\n\t\treturn elast;\r\n\t}\r\n\t\r\n\tstatic var unexpected = macro unexpected();\r\n\tstatic var noMatch = macro throw noMatch();\r\n\t\t\r\n\tstatic function makeCase(g:CaseGroup, def:Expr) {\r\n\t\treturn switch(g) {\r\n\t\t\tcase Simple(group):\r\n\t\t\t\tvar cl = group.map(makeInner);\r\n\t\t\t\tcl.iter(function(c) {\r\n\t\t\t\t\tc.expr = macro @:pos(c.expr.pos) { junk(); ${c.expr}; };\r\n\t\t\t\t});\r\n\t\t\t\t{\r\n\t\t\t\t\tpos: def.pos,\r\n\t\t\t\t\texpr: ESwitch(macro peek(0), cl, def)\r\n\t\t\t\t}\r\n\t\t\tcase Complex(c):\r\n\t\t\t\tvar inner = makeInner(c);\r\n\t\t\t\tmakePattern(c.head, inner.expr, def);\r\n\t\t}\r\n\t}\r\n\t\r\n\tstatic function makeInner(c:ParserCase) {\r\n\t\tvar last = c.tail.pop();\r\n\t\tif (last == null) {\r\n\t\t\treturn {values:[c.head], guard:null, expr: c.expr};\r\n\t\t}\r\n\t\tvar elast = makePattern(last, c.expr, unexpected);\r\n\t\twhile (c.tail.length > 0)\r\n\t\t\telast = makePattern(c.tail.pop(), elast, unexpected);\r\n\t\treturn {values: [c.head], guard: null, expr: elast};\r\n\t}\r\n\t\r\n\tstatic function makePattern(pat:Expr, e:Expr, def:Expr) {\r\n\t\treturn switch(pat.expr) {\r\n\t\t\tcase EBinop(OpAssign, {expr: EConst(CIdent(s))}, e2):\r\n\t\t\t\tif (def == unexpected || def == noMatch) {\r\n\t\t\t\t\tvar e1 = s == \"_\" ? e2 : macro var $s = $e2;\r\n\t\t\t\t\tmacro {\r\n\t\t\t\t\t\t$e1;\r\n\t\t\t\t\t\t$e;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tbuildExtractor(pat, e, e2, s, def);\r\n\t\t\t\t}\r\n\t\t\tcase EBinop(OpBoolAnd, e1, e2):\r\n\t\t\t\tmacro @:pos(pat.pos) {\r\n\t\t\t\t\tfunction def() return $def;\r\n\t\t\t\t\tswitch peek(0) {\r\n\t\t\t\t\t\tcase $e1 if ($e2):\r\n\t\t\t\t\t\t\tjunk();\r\n\t\t\t\t\t\t\t$e;\r\n\t\t\t\t\t\tcase _: def();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\tcase EBinop(OpBoolOr, e1, e2):\r\n\t\t\t\tmakePattern(e1, e, macro throw stream.curPos() + \": \" +$e2);\r\n\t\t\tcase _:\r\n\t\t\t\tmacro @:pos(pat.pos) switch peek(0) {\r\n\t\t\t\t\tcase $pat:\r\n\t\t\t\t\t\tjunk();\r\n\t\t\t\t\t\t$e;\r\n\t\t\t\t\tcase _: $def;\r\n\t\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tstatic function buildExtractor(pat, e, e2, s, def) {\r\n\t\tvar e1 = s == \"_\" ? e2 : macro var $s = $e2;\r\n\t\treturn macro @:pos(pat.pos) {\r\n\t\t\ttry {\r\n\t\t\t\t$e1;\r\n\t\t\t\t$e;\r\n\t\t\t} catch (_:hxparse.NoMatch<Dynamic>) {\r\n\t\t\t\t$def;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","package haxeprinter;\n\nimport haxeparser.Data;\nimport haxe.macro.Expr;\nusing haxe.macro.Tools;\n\nclass Printer\n{\n\tpublic var config:Dynamic;\n\n\tvar buf:StringBuf;\n\tvar line:StringBuf;\n\tvar lineLen:Int;\n\tvar indentLevel:Int;\n\tvar indent:String;\n\tvar col:Int;\n\n\tpublic function new()\n\t{\n\t\tconfig = haxe.Json.parse(haxe.Resource.getString('config'));\n\t}\n\t\n\tfunction setIndent(level:Int)\n\t{\n\t\tindentLevel = level;\n\t\tif (config.indent_with_tabs) indent = StringTools.lpad('', '\\t', indentLevel);\n\t\telse indent = StringTools.lpad('', ' ', Std.int(indentLevel * config.tab_width));\n\t}\n\n\tfunction newline()\n\t{\n\t\tbuf.add(line.toString() + '\\n');\n\t\tline = new StringBuf();\n\t\tcol = 0;\n\t\tlineLen = 0;\n\t}\n\n\tfunction print(s:String, ?style:Style)\n\t{\n\t\tif (style == null) style = SNormal;\n\n\t\tlineLen += s.length;\n\t\t#if (js && !noStyle)\n\t\tvar style = Std.string(style).substr(1).toLowerCase();\n\t\tline.add('<span class=\"$style\">$s</span>');\n\t\t#else\n\t\tline.add(s);\n\t\t#end\n\t}\n\n\tfunction breakPoint(force:Bool=false)\n\t{\n\t\tif (col > 0 && (force || col + lineLen > config.maximum_line_length))\n\t\t{\n\t\t\tbuf.add('\\n');\n\t\t\tsetIndent(indentLevel + 1);\n\t\t\tbuf.add(indent);\n\t\t\tcol = indent.length;\n\t\t\tsetIndent(indentLevel - 1);\n\t\t}\n\t\t\n\t\tcol += lineLen;\n\t\tbuf.add(line.toString());\n\t\tline = new StringBuf();\n\t\tlineLen = 0;\n\t}\n\n\n\tpublic function printAST(ast:{pack:Array<String>, decls:Array<TypeDef>})\n\t{\n\t\tindentLevel = 0;\n\t\tindent = '';\n\t\tcol = 0;\n\t\tbuf = new StringBuf();\n\t\tline = new StringBuf();\n\t\tlineLen = 0;\n\n\t\tprintPackage(ast.pack);\n\t\tfor (type in ast.decls) printType(type);\n\n\t\treturn buf.toString();\n\t}\n\n\tfunction printPackage(pack:Array<String>)\n\t{\n\t\tif (pack.length == 0 && !config.print_root_package) return;\n\n\t\tprint('package', SDirective);\n\t\tfor (i in 0...pack.length)\n\t\t{\n\t\t\tif (i == 0) print(' ');\n\t\t\tprint(pack[i], SType);\n\t\t\tif (i < pack.length - 1) print('.');\n\t\t}\n\n\t\tprint(';');\n\t\tnewline();\n\t\tif (config.empty_line_after_package) newline();\n\t}\n\n\tfunction printType(type:TypeDef)\n\t{\n\t\tswitch (type)\n\t\t{\n\t\t\tcase EImport(sl, mode): printImport(sl, mode);\n\t\t\tcase EUsing(path): printUsing(path);\n\n\t\t\tcase EAbstract(data): printAbstract(data);\n\t\t\tcase EClass(data): printClass(data);\n\t\t\tcase EEnum(data): printEnum(data);\n\t\t\tcase ETypedef(data): printTypedef(data);\n\t\t}\n\t}\n\n\tfunction printImport(path:Array<{pack:String, pos:Position}>, mode:ImportMode)\n\t{\n\t\tprint('import', SDirective);\n\t\tfor (i in 0...path.length)\n\t\t{\n\t\t\tif (i == 0) print(' ');\n\t\t\tprint(path[i].pack, SType);\n\t\t\tif (i < path.length - 1) print('.');\n\t\t}\n\n\t\tswitch (mode)\n\t\t{\n\t\t\tcase IAll:\n\t\t\t\tprint('.');\n\t\t\t\tprint('*', SOperator);\n\t\t\tcase IAsName(s):\n\t\t\t\tprint(' ');\n\t\t\t\tprint('in', SKeyword);\n\t\t\t\tprint(' ');\n\t\t\t\tprint(s);\n\t\t\tcase o:\n\t\t}\n\n\t\tprint(';');\n\t\tnewline();\n\t\tif (config.empty_line_after_import) newline();\n\t}\n\n\tfunction printUsing(path:TypePath)\n\t{\n\t\tprint('using', SDirective);\n\t\tprint(' ');\n\t\tprintTypePath(path);\n\t\tprint(';');\n\t\tnewline();\n\t\tif (config.empty_line_after_import) newline();\n\t}\n\n\tfunction printAbstract(data:Definition<AbstractFlag, Array<Field>>)\n\t{\n\t\ttrace(data);\n\t}\n\n\tfunction printClass(type:Definition<ClassFlag, Array<Field>>)\n\t{\n\t\tif (buf.length > 0 && config.empty_line_before_type) newline();\n\n\t\tvar isInterface = false;\n\t\tvar modifiers = [];\n\t\tvar ext = null;\n\t\tvar impls = [];\n\n\t\tfor (flag in type.flags) switch flag\n\t\t{\n\t\t\tcase HInterface: isInterface = true;\n\t\t\tcase HExtern: modifiers.push('extern');\n\t\t\tcase HPrivate: modifiers.push('private');\n\t\t\tcase HExtends(t): ext = t;\n\t\t\tcase HImplements(t): impls.push(t);\n\t\t}\n\n\t\tprintModifiers(modifiers);\n\t\tprint(isInterface ? 'interface' : 'class', SDirective);\n\t\tprint(' ');\n\t\tprint(type.name, SType);\n\n\t\t// type params\n\t\tprintTypeParamDecls(type.params);\n\n\t\t// extends\n\t\tif (ext != null)\n\t\t{\n\t\t\tprint(' ');\n\t\t\tbreakPoint();\n\t\t\tprint('extends', SKeyword);\n\t\t\tprint(' ');\n\t\t\tprintTypePath(ext);\n\t\t\tbreakPoint(config.extends_on_newline);\n\t\t}\n\n\t\t// implements\n\t\tif (impls.length > 0)\n\t\t{\n\t\t\tfor (impl in impls)\n\t\t\t{\n\t\t\t\tprint(' ');\n\t\t\t\tbreakPoint();\n\t\t\t\tprint('implements', SKeyword);\n\t\t\t\tprint(' ');\n\t\t\t\tprintTypePath(impl);\n\t\t\t\tbreakPoint(config.implements_on_newline);\n\t\t\t}\n\t\t}\n\n\t\t// if empty type just print {}\n\t\tif (type.data.length == 0 && config.inline_empty_braces)\n\t\t{\n\t\t\tprint(' {}');\n\t\t\tnewline();\n\t\t\treturn;\n\t\t}\n\n\t\tif (config.cuddle_type_braces)\n\t\t{\n\t\t\tprint(' {');\n\t\t\tnewline();\n\t\t\tbreakPoint();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tbreakPoint();\n\t\t\tnewline();\n\t\t\tprint('{');\n\t\t\tnewline();\n\t\t}\n\n\t\tsetIndent(indentLevel + 1);\n\t\tfor (i in 0...type.data.length)\n\t\t{\n\t\t\tprintClassField(type.data[i]);\n\t\t\tif (i < type.data.length - 1 && config.empty_line_between_fields) newline();\n\t\t}\n\t\tsetIndent(indentLevel - 1);\n\n\t\tprint('}');\n\t\tnewline();\n\t}\n\n\tfunction printClassField(field:Field)\n\t{\n\t\tprint(indent);\n\n\t\tvar modifiers = field.access.map(function(a) return Std.string(a).substr(1).toLowerCase());\n\t\tif (config.remove_private_field_modifier) modifiers.remove('private');\n\t\tprintModifiers(modifiers);\n\n\t\tswitch (field.kind)\n\t\t{\n\t\t\tcase FFun(f): printFunction(field, f);\n\t\t\tcase FVar(t, e): printProp(field, null, null, t, e);\n\t\t\tcase FProp(get, set, t, e): printProp(field, get, set, t, e);\n\t\t}\n\t}\n\n\tfunction printEnum(type:Definition<EnumFlag, Array<EnumConstructor>>)\n\t{\n\t\tif (config.empty_line_before_type) newline();\n\n\t\t// modifiers\n\t\tvar modifiers = type.flags.map(function(flag) return Std.string(flag).substr(1).toLowerCase());\n\t\tprintModifiers(modifiers);\n\n\t\t// declaration\n\t\tprint('enum', SDirective);\n\t\tprint(' ');\n\t\tprint(type.name, SType);\n\n\t\t// type params\n\t\tprintTypeParamDecls(type.params);\n\n\t\t// if empty type just print {}\n\t\tif (type.data.length == 0 && config.inline_empty_braces)\n\t\t{\n\t\t\tprint(' {}');\n\t\t\tnewline();\n\t\t\treturn;\n\t\t}\n\n\t\tif (config.cuddle_type_braces)\n\t\t{\n\t\t\tprint(' {');\n\t\t\tnewline();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewline();\n\t\t\tprint('{');\n\t\t\tnewline();\n\t\t}\n\n\t\tsetIndent(indentLevel + 1);\n\t\tfor (i in 0...type.data.length)\n\t\t{\n\t\t\tprintEnumConstructor(type.data[i]);\n\t\t\tif (i < type.data.length - 1 && config.empty_line_between_enum_constructors) \n\t\t\t\tnewline();\n\t\t}\n\t\tsetIndent(indentLevel - 1);\n\n\t\tprint('}');\n\t\tnewline();\n\t}\n\n\tfunction printEnumConstructor(ctor:EnumConstructor)\n\t{\n\t\tprint(indent);\n\t\tprint(ctor.name, SType);\n\t\tprintTypeParamDecls(ctor.params);\n\t\tprintEnumConstructorArgs(ctor.args);\n\t\tprint(';');\n\t\tnewline();\n\t}\n\n\tfunction printEnumConstructorArgs(args:Array<{name:String, opt:Bool, type:ComplexType}>)\n\t{\n\t\tif (args.length == 0) return;\n\t\tprint('(');\n\t\tfor (i in 0...args.length)\n\t\t{\n\t\t\tvar arg = args[i];\n\n\t\t\tif (arg.opt) print('?');\n\t\t\tprint(arg.name, SIdent);\n\t\t\tprint(':');\n\t\t\tprintComplexType(arg.type);\n\t\t\t\n\t\t\tif (i < args.length - 1)\n\t\t\t{\n\t\t\t\tif (config.space_between_enum_constructor_args) print(', ');\n\t\t\t\telse print(',');\n\t\t\t}\n\t\t}\n\t\tprint(')');\n\t}\n\n\tfunction printTypedef(type:Definition<EnumFlag, ComplexType>)\n\t{\n\t\tif (config.empty_line_before_type) newline();\n\n\t\t// modifiers\n\t\tvar modifiers = type.flags.map(function(flag) return Std.string(flag).substr(1).toLowerCase());\n\t\tprintModifiers(modifiers);\n\n\t\t// declaration\n\t\tprint('typedef', SDirective);\n\t\tprint(' ');\n\t\tprint(type.name, SType);\n\t\tprintTypeParamDecls(type.params);\n\t\tprint(' = ');\n\n\t\tswitch (type.data)\n\t\t{\n\t\t\tcase TAnonymous(fields): printAnonFields(fields);\n\t\t\tcase TPath(path): printTypePath(path);\n\t\t\tcase _: throw 'todo: ' + type.data;\n\t\t}\n\n\t\tnewline();\n\t}\n\n\tfunction printAnonFields(fields:Array<Dynamic>)\n\t{\n\t\t// if empty type just print {}\n\t\tif (fields.length == 0 && config.inline_empty_braces)\n\t\t{\n\t\t\tprint(' {}');\n\t\t\treturn;\n\t\t}\n\n\t\tif (config.cuddle_type_braces)\n\t\t{\n\t\t\tprint(' {');\n\t\t\tnewline();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewline();\n\t\t\tprint('{');\n\t\t\tnewline();\n\t\t}\n\n\t\tsetIndent(indentLevel + 1);\n\t\tfor (i in 0...fields.length)\n\t\t{\n\t\t\tvar field = fields[i];\n\t\t\t\n\t\t\tprint(indent);\n\t\t\tprint(field.name, SIdent);\n\t\t\tprint(':');\n\n\t\t\tswitch (field.kind)\n\t\t\t{\n\t\t\t\tcase FVar(t, _): printComplexType(t);\n\t\t\t\tcase _: throw 'todo: ' + field.kind;\n\t\t\t}\n\n\t\t\tif (i < fields.length - 1)\n\t\t\t{\n\t\t\t\tprint(',');\n\t\t\t\tif (config.empty_line_between_typedef_fields) newline();\n\t\t\t}\n\t\t\tnewline();\n\t\t}\n\t\tsetIndent(indentLevel - 1);\n\n\t\tprint('}');\n\t}\n\n\tfunction printFunction(field:Field, f:Function)\n\t{\n\t\tprint('function', SKeyword);\n\t\tprint(' ');\n\t\tprint(field.name, SIdent);\n\t\tprintTypeParamDecls(f.params);\n\t\tprintFunctionArgs(f.args);\n\n\t\tif (f.ret != null)\n\t\t{\n\t\t\tprint(':');\n\t\t\tprintComplexType(f.ret);\n\t\t}\n\n\t\tif (config.cuddle_method_braces)\n\t\t{\n\t\t\tprint(' ');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewline();\n\t\t\tprint(indent);\n\t\t}\n\t\t\n\t\tprintExpr(f.expr);\n\t\tnewline();\n\t}\n\n\tfunction printProp(field:Field, get:Null<String>, set:Null<String>, type:Null<ComplexType>, expr:Null<Expr>)\n\t{\n\t\tprint('var', SKeyword);\n\t\tprint(' ');\n\t\tprint(field.name, SIdent);\n\t\t\n\t\tif (get != null && set != null)\n\t\t{\n\t\t\tprint('(');\n\t\t\tprint(get, SModifier);\n\t\t\t\n\t\t\tif (config.space_betwen_property_get_set) print(', ');\n\t\t\telse print(',');\n\n\t\t\tprint(set, SModifier);\n\t\t\tprint(')');\n\t\t}\n\n\t\tif (type != null)\n\t\t{\n\t\t\tprint(':');\n\t\t\tprintComplexType(type);\n\t\t}\n\n\t\tif (expr != null)\n\t\t{\n\t\t\tif (config.space_around_property_assign) print(' = ');\n\t\t\telse print('=');\n\t\t\tprintExpr(expr);\n\t\t}\n\n\t\tprint(';');\n\t\tnewline();\n\t}\n\n\tfunction printExpr(expr:Expr)\n\t{\n\t\tprint(expr.toString().split('\\n').join('\\n'+indent));\n\t}\n\n\tfunction printFunctionArgs(args:Array<FunctionArg>)\n\t{\n\t\tprint('(');\n\t\tbreakPoint(config.function_arg_on_newline);\n\n\t\tfor (i in 0...args.length)\n\t\t{\n\t\t\tbreakPoint(config.function_arg_on_newline);\n\n\t\t\tvar arg = args[i];\n\t\t\tif (arg.opt) print('?');\n\t\t\tprint(arg.name, SIdent);\n\t\t\t\n\t\t\tif (arg.type != null)\n\t\t\t{\n\t\t\t\tprint(':');\n\t\t\t\tprintComplexType(arg.type);\n\t\t\t}\n\n\t\t\tif (arg.value != null)\n\t\t\t{\n\t\t\t\tif (config.space_around_function_arg_assign) print(' = ');\n\t\t\t\telse print('=');\n\t\t\t\tprintExpr(arg.value);\n\t\t\t}\n\n\t\t\tif (i < args.length - 1)\n\t\t\t{\n\t\t\t\tprint(',');\n\t\t\t\tif (config.space_between_function_args) print(' ');\n\t\t\t\tbreakPoint();\n\t\t\t}\n\t\t}\n\t\tprint(')');\n\t\tbreakPoint();\n\t}\n\n\tfunction printModifiers(modifiers:Array<String>)\n\t{\n\t\tif (modifiers.length == 0) return;\n\t\tvar order:Array<String> = config.modifier_order;\n\t\tmodifiers.sort(function(a,b) return order.indexOf(a) - order.indexOf(b));\n\t\t\n\t\tfor (modifier in modifiers)\n\t\t{\n\t\t\tprint(modifier, SModifier);\n\t\t\tprint(' ');\n\t\t}\n\t}\n\n\tfunction printTypePath(path:TypePath)\n\t{\n\t\tvar pack = path.pack.concat([path.name]);\n\t\tfor (i in 0...pack.length)\n\t\t{\n\t\t\tprint(pack[i], SType);\n\t\t\tif (i < pack.length - 1) print('.');\n\t\t}\n\n\t\tvar params = path.params;\n\t\tif (params.length == 0) return;\n\t\t\n\t\tprint('<');\n\t\tfor (i in 0...params.length)\n\t\t{\n\t\t\tprintTypeParam(params[i]);\n\t\t\tif (i < params.length - 1)\n\t\t\t{\n\t\t\t\tif (config.space_between_type_params) print(', ');\n\t\t\t\telse print(',');\n\t\t\t}\n\t\t}\n\t\tprint('>');\n\t}\n\n\tfunction printTypeParamDecls(params:Array<TypeParamDecl>)\n\t{\n\t\tif (params.length == 0) return;\n\n\t\tprint('<');\n\t\tfor (i in 0...params.length)\n\t\t{\n\t\t\tprintTypeParamDecl(params[i]);\n\t\t\tif (i < params.length - 1)\n\t\t\t{\n\t\t\t\tif (config.space_between_type_params) print(', ');\n\t\t\t\telse print(',');\n\t\t\t}\n\t\t}\n\t\tprint('>');\n\t}\n\n\tfunction printTypeParamDecl(param:TypeParamDecl)\n\t{\n\t\tprint(param.name, SType);\n\t\t\n\t\tvar constraints = param.constraints;\n\t\tif (constraints.length == 0) return;\n\n\t\tprint(':');\n\t\tif (constraints.length > 1) print('(');\n\t\tfor (i in 0...constraints.length)\n\t\t{\n\t\t\tprintComplexType(constraints[i]);\n\t\t\tif (i < constraints.length - 1)\n\t\t\t{\n\t\t\t\tif (config.space_between_type_param_constraints) print(', ');\n\t\t\t\telse print(',');\n\t\t\t}\n\t\t}\n\t\tif (constraints.length > 1) print(')');\n\t}\n\n\tfunction printTypeParam(param:TypeParam)\n\t{\n\t\tswitch (param)\n\t\t{\n\t\t\tcase TPType(type): printComplexType(type);\n\t\t\tcase _: throw 'todo: $param';\n\t\t}\n\t}\n\n\tfunction printComplexType(type:ComplexType)\n\t{\n\t\tswitch (type)\n\t\t{\n\t\t\tcase TPath(path): printTypePath(path);\n\t\t\tcase TAnonymous(fields): printAnonType(fields);\n\t\t\tcase _: throw 'todo: $type';\n\t\t}\n\t}\n\n\tfunction printAnonType(fields:Array<Field>)\n\t{\n\t\tprint('{');\n\t\tfor (i in 0...fields.length)\n\t\t{\n\t\t\tvar field = fields[i];\n\t\t\tprint(field.name, SIdent);\n\t\t\tprint(':');\n\n\t\t\tswitch (field.kind)\n\t\t\t{\n\t\t\t\tcase FVar(t, _): printComplexType(t);\n\t\t\t\tcase _: throw 'todo: ' + field.kind;\n\t\t\t}\n\n\t\t\tif (i < fields.length - 1)\n\t\t\t{\n\t\t\t\tif (config.space_between_anon_type_fields) print(', ');\n\t\t\t\telse print(',');\n\t\t\t}\n\t\t}\n\t\tprint('}');\n\t}\n}\n\nenum Style\n{\n\tSNormal;\n\tSDirective;\n\tSOperator;\n\tSKeyword;\n\tSIdent;\n\tSString;\n\tSNumber;\n\tSType;\n\tSModifier;\n}\n","package haxeproject;\r\nimport core.FileTools;\r\nimport filetree.FileTree;\r\nimport js.Browser;\r\nimport js.html.TextAreaElement;\r\nimport newprojectdialog.NewProjectDialog;\r\nimport projectaccess.Project;\r\nimport projectaccess.ProjectAccess;\r\nimport projectaccess.ProjectOptions;\r\nimport tabmanager.TabManager;\r\n\r\n/**\r\n * ...\r\n * @author AS3Boyan\r\n */\r\nclass HaxeProject\r\n{\r\n\tprivate static var code:String;\r\n\tprivate static var indexPageCode:String;\r\n\t\r\n\t//If this plugin is selected as active in HIDE, then HIDE will call this function once on load\t\r\n\tpublic static function load():Void\r\n\t{\r\n\t\t\tNewProjectDialog.getCategory(\"Haxe\", 1).addItem(\"Flash Project\", createFlashProject);\t\t\t\r\n\t\t\tNewProjectDialog.getCategory(\"Haxe\").addItem(\"JavaScript Project\", createJavaScriptProject);\r\n\t\t\tNewProjectDialog.getCategory(\"Haxe\").addItem(\"Neko Project\", createNekoProject);\r\n\t\t\tNewProjectDialog.getCategory(\"Haxe\").addItem(\"PHP Project\", createPhpProject);\r\n\t\t\tNewProjectDialog.getCategory(\"Haxe\").addItem(\"C++ Project\", createCppProject);\r\n\t\t\tNewProjectDialog.getCategory(\"Haxe\").addItem(\"Java Project\", createJavaProject);\r\n\t\t\tNewProjectDialog.getCategory(\"Haxe\").addItem(\"C# Project\", createCSharpProject);\r\n\t\t\t\r\n\t\t\t//NewProjectDialog.getCategory(\"Haxe\").select();\r\n\t\t\t\r\n\t\t\tHIDE.readFile(null, \"templates/Main.hx\", function (data:String):Void\r\n\t\t\t{\t\t\t\t\r\n\t\t\t\tcode = data;\r\n\t\t\t}\r\n\t\t\t);\r\n\t\t\t\r\n\t\t\tHIDE.readFile(null, \"templates/index.html\", function (data:String):Void\r\n\t\t\t{\r\n\t\t\t\tindexPageCode = data;\r\n\t\t\t}\r\n\t\t\t);\r\n\t}\r\n\t\r\n\tprivate static function createCSharpProject(data:Dynamic):Void \r\n\t{\r\n\t\tcreateHaxeProject(data, Project.CSHARP);\r\n\t}\r\n\t\r\n\tprivate static function createJavaProject(data:Dynamic):Void\r\n\t{\r\n\t\tcreateHaxeProject(data, Project.JAVA);\r\n\t}\r\n\t\r\n\tprivate static function createCppProject(data:Dynamic):Void\r\n\t{\r\n\t\tcreateHaxeProject(data, Project.CPP);\r\n\t}\r\n\t\r\n\tprivate static function createPhpProject(data:Dynamic):Void\r\n\t{\r\n\t\tcreateHaxeProject(data, Project.PHP);\r\n\t}\r\n\t\r\n\tprivate static function createNekoProject(data:Dynamic):Void\r\n\t{\r\n\t\tcreateHaxeProject(data, Project.NEKO);\r\n\t}\r\n\t\r\n\tprivate static function createFlashProject(data:Dynamic):Void\r\n\t{\r\n\t\tcreateHaxeProject(data, Project.FLASH);\r\n\t}\r\n\t\r\n\tprivate static function createJavaScriptProject(data:Dynamic):Void\r\n\t{\r\n\t\tcreateHaxeProject(data, Project.JAVASCRIPT);\r\n\t}\r\n\t\r\n\tprivate static function createHaxeProject(data:Dynamic, target:Int):Void\r\n\t{\r\n\t\tFileTools.createDirectoryRecursively(data.projectLocation, [data.projectName, \"src\"], function ():Void\r\n\t\t{\r\n\t\t\tvar pathToProject:String  = data.projectLocation;\r\n\t\t\t\r\n\t\t\tif (data.createDirectory)\r\n\t\t\t{\r\n\t\t\t\tpathToProject = js.Node.path.join(pathToProject, data.projectName);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar pathToMain:String = pathToProject;\r\n\t\t\t\r\n\t\t\tpathToMain = js.Node.path.join(pathToMain, \"src\", \"Main.hx\");\r\n\t\t\t\r\n\t\t\tjs.Node.fs.writeFile(pathToMain, code, function (error:js.Node.NodeErr):Void\r\n\t\t\t{\r\n\t\t\t\tif (error != null)\r\n\t\t\t\t{\r\n\t\t\t\t\ttrace(error);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tjs.Node.fs.exists(pathToMain, function (exists:Bool):Void\r\n\t\t\t\t{\r\n\t\t\t\t\tif (exists)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tTabManager.openFileInNewTab(pathToMain);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttrace(pathToMain + \" file was not generated\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\t);\r\n\t\t\t\r\n\t\t\tvar project:Project = new Project();\r\n\t\t\tproject.name = data.projectName;\r\n\t\t\tproject.projectPackage = data.projectPackage;\r\n\t\t\tproject.company = data.projectCompany;\r\n\t\t\tproject.license = data.projectLicense;\r\n\t\t\tproject.url = data.projectURL;\r\n\t\t\tproject.type = Project.HAXE;\r\n\t\t\tproject.target = target;\r\n\t\t\tproject.path = pathToProject;\r\n\t\t\tproject.buildActionCommand = [\"haxe\", \"--connect\", \"5000\", \"--cwd\", '\"%path%\"'].join(\" \");\r\n\t\t\t\r\n\t\t\tvar pathToBin:String = js.Node.path.join(pathToProject, \"bin\");\r\n\t\t\t\r\n\t\t\tjs.Node.fs.mkdir(pathToBin, function (error):Void\r\n\t\t\t{\r\n\t\t\t\tvar args:String = \"-cp src\\n-main Main\\n\"; \r\n\t\t\t\r\n\t\t\t\tswitch (project.target) \r\n\t\t\t\t{\r\n\t\t\t\t\tcase Project.FLASH:\r\n\t\t\t\t\t\tvar pathToFile:String = \"bin/\" + project.name + \".swf\";\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\targs += \"-swf \" + pathToFile + \"\\n\";\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tproject.runActionType = Project.FILE;\r\n\t\t\t\t\t\tproject.runActionText = pathToFile;\r\n\t\t\t\t\tcase Project.JAVASCRIPT:\r\n\t\t\t\t\t\tvar pathToFile:String = \"bin/\" +  project.name + \".js\";\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\targs += \"-js \" + pathToFile + \"\\n\";\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar updatedPageCode:String = StringTools.replace(indexPageCode, \"::title::\", project.name);\r\n\t\t\t\t\t\tupdatedPageCode = StringTools.replace(updatedPageCode, \"::script::\", project.name + \".js\");\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar pathToWebPage:String = js.Node.path.join(pathToBin, \"index.html\");\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tjs.Node.fs.writeFile(pathToWebPage, updatedPageCode, js.Node.NodeC.UTF8, function (error:js.Node.NodeErr):Void\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tproject.runActionType = Project.FILE;\r\n\t\t\t\t\t\tproject.runActionText = js.Node.path.join(\"bin\", \"index.html\");\r\n\t\t\t\t\tcase Project.NEKO:\r\n\t\t\t\t\t\tvar pathToFile:String  = \"bin/\" + project.name + \".n\";\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\targs += \"-neko \" + pathToFile +  \"\\n\";\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tproject.runActionType = Project.COMMAND;\r\n\t\t\t\t\t\tproject.runActionText = \"neko \" + js.Node.path.join(project.path, pathToFile);\r\n\t\t\t\t\tcase Project.PHP:\r\n\t\t\t\t\t\targs += \"-php \" + \"bin/\" + project.name + \".php\\n\";\r\n\t\t\t\t\tcase Project.CPP:\r\n\t\t\t\t\t\tvar pathToFile:String = \"bin/\" + project.name + \".exe\";\r\n\t\t\t\t\t\targs += \"-cpp \" + pathToFile + \"\\n\";\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tproject.runActionType = Project.COMMAND;\r\n\t\t\t\t\t\tproject.runActionText = js.Node.path.join(project.path, pathToFile);\r\n\t\t\t\t\tcase Project.JAVA:\r\n\t\t\t\t\t\targs += \"-java \" + \"bin/\" + project.name + \".jar\\n\";\r\n\t\t\t\t\tcase Project.CSHARP:\r\n\t\t\t\t\t\targs += \"-cs \" + \"bin/\" + project.name + \".exe\\n\";\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\targs += \"-debug\\n -dce full\";\r\n\t\t\t\t\r\n\t\t\t\tproject.args = args.split(\"\\n\");\r\n\t\t\t\t\r\n\t\t\t\tvar path:String = js.Node.path.join(pathToProject, \"project.json\");\r\n\t\t\t\tBrowser.getLocalStorage().setItem(\"pathToLastProject\", path);\r\n\t\t\t\t\r\n\t\t\t\tProjectAccess.currentProject = project;\r\n\t\t\t\t\r\n\t\t\t\tProjectAccess.save(function ()\r\n\t\t\t\t{\r\n\t\t\t\t\tFileTree.load(project.name, pathToProject);\r\n\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t\t\r\n\t\t\t\tProjectOptions.updateProjectOptions();\r\n\t\t\t});\r\n\t\t}\r\n\t\t);\r\n\t}\r\n\t\r\n}","package hxparse;\r\n\r\n/**\r\n\tA NoMatch exception is thrown if an outer token matching fails.\r\n\t\r\n\tMatching can continue because no tokens have been consumed.\r\n**/\r\nclass NoMatch<T> {\r\n\t\r\n\t/**\r\n\t\tThe position where no matching could be made.\r\n\t**/\r\n\tpublic var pos(default, null):Position;\r\n\t\r\n\t/**\r\n\t\tThe token which was encountered and could not be matched.\r\n\t**/\r\n\tpublic var token(default, null):T;\r\n\t\r\n\t/**\r\n\t\tCreates a new NoMatch exception.\r\n\t**/\r\n\tpublic function new(pos:hxparse.Position, token:T) {\r\n\t\tthis.pos = pos;\r\n\t\tthis.token = token;\r\n\t}\r\n\t\r\n\tpublic function toString() {\r\n\t\treturn '$pos: No match: $token';\r\n\t}\r\n}","package hxparse;\r\n\r\n/**\r\n\tRepresents a state in the state machine generated by the `LexEngine`.\r\n**/\r\nclass State {\r\n\t/**\r\n\t\tThe transition vector, where the index corresponds to a char code.\r\n\t**/\r\n\tpublic var trans:haxe.ds.Vector<State>;\r\n\t\r\n\t/**\r\n\t\tThe ids of the final states.\r\n\t**/\r\n\tpublic var final:Int;\r\n\t\r\n\t/**\r\n\t\tCreates a new State.\r\n\t**/\r\n\tpublic function new() {\r\n\t\tfinal = -1;\r\n\t\ttrans = new haxe.ds.Vector(256);\r\n\t}\r\n}","package hxparse;\r\n\r\n/**\r\n\tUnexpected is thrown by `Parser.serror`, which is invoked when an inner\r\n\ttoken matching fails.\r\n\t\r\n\tUnlike `NoMatch`, this exception denotes that the stream is in an\r\n\tirrecoverable state because tokens have been consumed.\r\n**/\r\nclass Unexpected<Token> {\r\n\t\r\n\t/**\r\n\t\tThe token which was found.\r\n\t**/\r\n\tpublic var token:Token;\r\n\t\r\n\t/**\r\n\t\tThe position in the input where `this` exception occured.\r\n\t**/\r\n\tpublic var pos:Position;\r\n\t\r\n\t/**\r\n\t\tCreates a new instance of Unexpected.\r\n\t**/\r\n\tpublic function new(token:Token, pos) {\r\n\t\tthis.token = token;\r\n\t\tthis.pos = pos;\r\n\t}\r\n\t\r\n\t/**\r\n\t\tReturns a readable representation of `this` exception.\r\n\t**/\r\n\tpublic function toString() {\r\n\t\treturn 'Unexpected $token at $pos';\r\n\t}\r\n}","package hxparse;\r\n\r\n/**\r\n\tUnexpectedChar is thrown by `Lexer.token` if it encounters a character for\r\n\twhich no state transition is defined.\r\n**/\r\nclass UnexpectedChar {\r\n\t\r\n\t/**\r\n\t\tThe character which caused `this` exception.\r\n\t**/\r\n\tpublic var char:String;\r\n\t\r\n\t/**\r\n\t\tThe position in the input where `this` exception occured.\r\n\t**/\r\n\tpublic var pos:Position;\r\n\t\r\n\t/**\r\n\t\tCreates a new instance of UnexpectedChar.\r\n\t**/\r\n\tpublic function new(char, pos) {\r\n\t\tthis.char = char;\r\n\t\tthis.pos = pos;\r\n\t}\r\n\t\r\n\t/**\r\n\t\tReturns a readable representation of `this` exception.\r\n\t**/\r\n\tpublic function toString() {\r\n\t\treturn '$pos: Unexpected $char';\r\n\t}\r\n}","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage js;\n\nimport js.html.Storage;\nimport js.html.XMLHttpRequest;\n\nclass Browser {\n\tpublic static var window(get, never):js.html.DOMWindow;\n\tinline static function get_window() return untyped __js__(\"window\");\n\n\tpublic static var document(get, never):js.html.Document;\n\tinline static function get_document() return untyped __js__(\"window.document\");\n\n\tpublic static var location(get, never):js.html.Location;\n\tinline static function get_location() return untyped __js__(\"window.location\");\n\n\tpublic static var navigator(get, never):js.html.Navigator;\n\tinline static function get_navigator() return untyped __js__(\"window.navigator\");\n\t\n\t/**\n\t * True if a window object exists, false otherwise.\n\t *\n\t * This can be used to check if the code is being executed in a non-browser\n\t * environment such as node.js.\n\t */\n\tpublic static var supported(get, never):Bool;\n\tpublic static function get_supported() return untyped __js__(\"typeof window != \\\"undefined\\\"\");\n\t\n\t/**\n\t * Safely gets the browser's local storage, or returns null if localStorage is unsupported or\n\t * disabled.\n\t */\n\tpublic static function getLocalStorage() : Storage\n\t{\n\t\ttry {\n\t\t\tvar s = window.localStorage;\n\t\t\ts.getItem(\"\");\n\t\t\treturn s;\n\t\t} catch( e : Dynamic ) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t/**\n\t * Safely gets the browser's session storage, or returns null if sessionStorage is unsupported\n\t * or disabled.\n\t */\n\tpublic static function getSessionStorage() : Storage\n\t{\n\t\ttry {\n\t\t\tvar s = window.sessionStorage;\n\t\t\ts.getItem(\"\");\n\t\t\treturn s;\n\t\t} catch( e : Dynamic ) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t/**\n\t * Creates an XMLHttpRequest, with a fallback to ActiveXObject for ancient versions of Internet\n\t * Explorer.\n\t */\n\tpublic static function createXMLHttpRequest() : XMLHttpRequest\n\t{\n\t\tif( untyped __js__(\"typeof XMLHttpRequest\") != \"undefined\" ) {\n\t\t\treturn new XMLHttpRequest();\n\t\t}\n\t\tif( untyped __js__(\"typeof ActiveXObject\") != \"undefined\" ) {\n\t\t\treturn untyped __new__(\"ActiveXObject\",\"Microsoft.XMLHTTP\");\n\t\t}\n\t\tthrow \"Unable to create XMLHttpRequest object.\";\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage js;\n\nclass Lib {\n\n\t/**\n\t\tInserts a 'debugger' statement that will make a breakpoint if a debugger is available.\n\t**/\n\tpublic static inline function debug() {\n\t\tuntyped __js__(\"debugger\");\n\t}\n\n\t/**\n\t\tDisplay an alert message box containing the given message\n\t**/\n\tpublic static function alert( v : Dynamic ) {\n\t\tuntyped __js__(\"alert\")(js.Boot.__string_rec(v,\"\"));\n\t}\n\n\tpublic static inline function eval( code : String ) : Dynamic {\n\t\treturn untyped __js__(\"eval\")(code);\n\t}\n\n}\n","package menu;\nimport haxe.ds.StringMap.StringMap;\nimport js.Browser;\nimport js.html.AnchorElement;\nimport js.html.DivElement;\nimport js.html.UListElement;\nimport js.Node;\nimport js.Node.NodeFsFileOptions;\nimport js.html.Element;\n\n/**\n * ...\n * @author AS3Boyan\n */\n\n//@:expose makes this class available in global scope\n//@:keepSub prevents -dce full from deleting unused functions, so they still can be used in other plugins\n//more info about meta tags can be obtained at Haxe website: \n//http://haxe.org/manual/tips_and_tricks\n@:keepSub @:expose(\"BootstrapMenu\") class BootstrapMenu\n{\n\tprivate static var menus:StringMap<Menu> = new StringMap();\n\tprivate static var menuArray:Array<Menu> = new Array();\n\t\t\n\tpublic static function createMenuBar():Void\n\t{\n\t\t//We use overflow: hidden; to hide window scrollbars\n\t\tBrowser.document.body.style.overflow = \"hidden\";\n\t\t\t\n\t\tvar navbar:DivElement = Browser.document.createDivElement();\n\t\tnavbar.className = \"navbar navbar-default navbar-inverse navbar-fixed-top\";\n\t\t\n\t\tvar navbarHeader:DivElement = Browser.document.createDivElement();\n\t\tnavbarHeader.className = \"navbar-header\";\n\t\tnavbar.appendChild(navbarHeader);\n\t\t\n\t\tvar a:AnchorElement = Browser.document.createAnchorElement();\n\t\ta.className = \"navbar-brand\";\n\t\ta.href = \"#\";\n\t\ta.innerText = \"HIDE\";\n\t\t\t\n\t\tnavbarHeader.appendChild(a);\n\t\t\t\n\t\tvar div:DivElement = Browser.document.createDivElement();\n\t\tdiv.className = \"navbar-collapse collapse\";\n\t\t\n\t\tvar ul:UListElement = Browser.document.createUListElement();\n\t\tul.id = \"position-navbar\";\n\t\tul.className = \"nav navbar-nav\";\n\t\t\t\n\t\tdiv.appendChild(ul);\n\t\t\t\t\n\t\tnavbar.appendChild(div);\n\t\t\n\t\tBrowser.document.body.appendChild(navbar);\n\t}\n\t\n\tpublic static function getMenu(name:String, ?position:Int):Menu\n\t{\n\t\tvar menu:Menu;\n\n\t\tif (!menus.exists(name))\n\t\t{\n\t\t\tmenu = new Menu(name);\n\n\t\t\tmenu.setPosition(position);\n\n\t\t\taddMenuToDocument(menu);\n\n\t\t\tmenus.set(name, menu);\t\t\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmenu = menus.get(name);\n\n\t\t\tif (position != null && menu.position != position)\t\n\t\t\t{\n\t\t\t\tmenu.removeFromDocument();\n\t\t\t\tmenus.remove(name);\n\n\t\t\t\tmenu.setPosition(position);\n\n\t\t\t\taddMenuToDocument(menu);\n\n\t\t\t\tmenus.set(name, menu);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn menu;\n\t}\n\n\tpublic static function addMenuToDocument(menu:Menu):Void\n\t{\n\t\tvar div:Element = cast(Browser.document.getElementById(\"position-navbar\"), Element);\n\n\t\tif (menu.position != null && menuArray.length > 0 && div.childNodes.length > 0)\n\t\t{\n\t\t\tvar currentMenu:Menu;\n\n\t\t\tvar added:Bool = false;\n\n\t\t\tfor (i in 0...menuArray.length)\n\t\t\t{\n\t\t\t\tcurrentMenu = menuArray[i];\n\n\t\t\t\tif (currentMenu != menu && currentMenu.position == null || menu.position < currentMenu.position)\n\t\t\t\t{\n\t\t\t\t\tdiv.insertBefore(menu.getElement(), currentMenu.getElement());\n\t\t\t\t\tmenuArray.insert(i, menu);\n\t\t\t\t\tadded = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!added)\n\t\t\t{\n\t\t\t\tmenu.addToDocument();\n\t\t\t\tmenuArray.push(menu);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmenu.addToDocument();\n\t\t\tmenuArray.push(menu);\n\t\t}\n\t}\n}","package menu;\nimport core.Hotkeys;\nimport haxe.ds.StringMap.StringMap;\nimport js.Browser;\nimport js.html.AnchorElement;\nimport js.html.DivElement;\nimport js.html.Element;\nimport js.html.LIElement;\nimport js.html.LinkElement;\nimport js.html.MouseEvent;\nimport js.html.NodeList;\nimport js.html.SpanElement;\nimport js.html.UListElement;\nimport js.Node;\n\n/**\n * ...\n * @author AS3Boyan\n */\n\ninterface MenuItem\n{\n\tpublic function getElement():Element;\n}\n\n//@:keepSub prevents -dce full from deleting unused functions, so they still can be used in other plugins\n//alternatively you can just remove -dce full flag from plugin.hxml\n//more info about meta tags can be obtained at Haxe website: \n//http://haxe.org/manual/tips_and_tricks\n@:keepSub class MenuButtonItem implements MenuItem\n{\t\n\tvar li:LIElement;\n\tpublic var position:Int;\n\t\n\tpublic function new(_menu:String, _text:String, _onClickFunction:Dynamic, ?_hotkey:String = \"\")\n\t{\t\t\n\t\tvar hotkeyText:String = _hotkey;\n\t\t\n\t\tvar menuItem:String = _menu + \"->\" + _text;\n\t\t\n\t\tvar span:SpanElement = Browser.document.createSpanElement();\n\t\tspan.style.color = \"silver\";\n\t\tspan.style.float = \"right\";\n\t\t\n\t\tHotkeys.add(menuItem, hotkeyText, span, _onClickFunction);\n\t\t\n\t\tli = Browser.document.createLIElement();\t\n\t\tli.classList.add(\"menu-item\");\n\t\t\n\t\tvar a:AnchorElement = Browser.document.createAnchorElement();\n\t\ta.style.left = \"0\";\n\t\ta.setAttribute(\"text\", _text);\n\t\t\n\t\tif (_onClickFunction != null) \n\t\t{\n\t\t\ta.onclick = function (e)\n\t\t\t{\n\t\t\t\tif (li.className != \"disabled\")\n\t\t\t\t{\n\t\t\t\t\t_onClickFunction();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\t\n\t\ta.innerText = _text;\n\n\t\ta.appendChild(span);\n\t\t\n\t\tli.appendChild(a);\n\t}\n\t\n\tpublic function getElement():LIElement\n\t{\n\t\treturn li;\n\t}\n}\n\n//@:keepSub prevents -dce full from deleting unused functions, so they still can be used in other plugins\n@:keepSub class Separator implements MenuItem\n{\n\tvar li:LIElement;\n\t\n\tpublic function new()\n\t{\n\t\tli = Browser.document.createLIElement();\n\t\tli.className = \"divider\";\n\t}\n\t\n\tpublic function getElement():Element\n\t{\n\t\treturn li;\n\t}\n}\n\n@:keepSub @:expose(\"ui.menu.basic.Submenu\") class Submenu\n{\n\tvar ul:UListElement;\n\tvar li:LIElement;\n\tvar name:String;\n\tvar parentMenu:String;\n\t\n\tpublic function new(_parentMenu:String, _name:String)\n\t{\n\t\tname = _name;\n\t\tparentMenu = _parentMenu;\n\t\t\n\t\t//http://stackoverflow.com/questions/18023493/bootstrap-3-dropdown-sub-menu-missing\n\t\t\n\t\tvar li2:LIElement = Browser.document.createLIElement();\n\t\tli2.classList.add(\"menu-item\");\n\t\tli2.classList.add(\"dropdown\");\n\t\tli2.classList.add(\"dropdown-submenu\");\n\t\t\n\t\tli = li2;\n\t\t\n\t\tul = Browser.document.createUListElement();\n\t\t\n\t\tvar a2:AnchorElement = Browser.document.createAnchorElement();\n\t\ta2.href = \"#\";\n\t\ta2.classList.add(\"dropdown-toggle\");\n\t\ta2.setAttribute(\"data-toggle\", \"dropdown\");\n\t\ta2.innerHTML = name;\n\t\ta2.onclick = function (event:MouseEvent)\n\t\t{\n\t\t\t// Avoid following the href location when clicking\n\t\t\tevent.preventDefault(); \n\t\t\t// Avoid having the menu to close when clicking\n\t\t\tevent.stopPropagation(); \n\t\t\t// If a menu is already open we close it\n\t\t\t//$('ul.dropdown-menu [data-toggle=dropdown]').parent().removeClass('open');\n\t\t\t// opening the one you clicked on\n\t\t\t\n\t\t\tli2.classList.add('open');\n\n\t\t\tvar menu:UListElement = ul;\n\t\t\tvar newpos:Int;\n\t\t\t\n\t\t\tif ((menu.offsetLeft + menu.clientWidth) + 30 > Browser.window.innerWidth) \n\t\t\t{\n\t\t\t\tnewpos = -menu.clientWidth;\n\t\t\t}\n\t\t\telse \n\t\t\t{\n\t\t\t\tnewpos = li2.clientWidth;\n\t\t\t}\n\t\t\t\n\t\t\tmenu.style.left = Std.string(newpos) + \"px\";\n\t\t}\n\t\t\n\t\tli2.appendChild(a2);\n\t\t\n\t\tul.classList.add(\"dropdown-menu\");\n\t\tli2.appendChild(ul);\n\t}\n\t\n\tpublic function addMenuItem(_text:String, _position:Int, _onClickFunction:Dynamic, ?_hotkey:String):Void\n\t{\n\t\tvar menuButtonItem:MenuButtonItem = new MenuButtonItem(parentMenu + \"->\" + name, _text, _onClickFunction, _hotkey);\n\t\tul.appendChild(menuButtonItem.getElement());\n\t}\n\t\n\tpublic function getElement():Element\n\t{\n\t\treturn li;\n\t}\n}\n \n//@:expose makes this class available in global scope\n//@:keepSub prevents -dce full from deleting unused functions, so they still can be used in other plugins\n@:keepSub @:expose(\"ui.menu.basic.Menu\") class Menu\n{\n\tvar li:LIElement;\n\tvar ul:UListElement;\n\tvar items:Array<MenuButtonItem>;\n\tvar name:String;\n\tvar submenus:StringMap<Submenu>;\n\tpublic var position:Int;\n\t\n\tpublic function new(_text:String, ?_headerText:String) \n\t{\n\t\tname = _text;\n\t\t\n\t\tli = Browser.document.createLIElement();\n\t\tli.className = \"dropdown\";\n\t\t\n\t\tvar a:AnchorElement = Browser.document.createAnchorElement();\n\t\ta.href = \"#\";\n\t\ta.className = \"dropdown-toggle\";\n\t\ta.setAttribute(\"data-toggle\", \"dropdown\");\n\t\ta.innerText = _text;\n\t\tli.appendChild(a);\n\t\t\n\t\tul = Browser.document.createUListElement();\n\t\tul.className = \"dropdown-menu\";\n\t\tul.classList.add(\"dropdown-menu-form\");\n\t\t\n\t\tif (_headerText != null)\n\t\t{\n\t\t\tvar li_header:LIElement = Browser.document.createLIElement();\n\t\t\tli_header.className = \"dropdown-header\";\n\t\t\tli_header.innerText = _headerText;\n\t\t\tul.appendChild(li_header);\n\t\t}\n\t\t\n\t\tli.appendChild(ul);\n\t\t\n\t\titems = new Array();\n\t\tsubmenus = new StringMap();\n\t}\n\t\n\tpublic function addMenuItem(_text:String, _position:Int, _onClickFunction:Dynamic, ?_hotkey:String):Void\n\t{\n\t\tvar menuButtonItem:MenuButtonItem = new MenuButtonItem(name, _text, _onClickFunction, _hotkey);\n\t\t\t\t\n\t\tmenuButtonItem.position = _position;\n\t\t\n\t\tif (menuButtonItem.position != null && items.length > 0 && ul.childNodes.length > 0)\n\t\t{\n\t\t\tvar currentMenuButtonItem:MenuButtonItem;\n\n\t\t\tvar added:Bool = false;\n\n\t\t\tfor (i in 0...items.length)\n\t\t\t{\n\t\t\t\tcurrentMenuButtonItem = items[i];\n\n\t\t\t\tif (currentMenuButtonItem != menuButtonItem && currentMenuButtonItem.position == null || menuButtonItem.position < currentMenuButtonItem.position)\n\t\t\t\t{\n\t\t\t\t\tul.insertBefore(menuButtonItem.getElement(), currentMenuButtonItem.getElement());\n\t\t\t\t\titems.insert(i, menuButtonItem);\n\t\t\t\t\tadded = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!added)\n\t\t\t{\n\t\t\t\tul.appendChild(menuButtonItem.getElement());\n\t\t\t\titems.push(menuButtonItem);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tul.appendChild(menuButtonItem.getElement());\n\t\t\titems.push(menuButtonItem);\n\t\t}\n\t}\n\t\n\tpublic function addSeparator():Void\n\t{\n\t\tul.appendChild(new Separator().getElement());\n\t}\n\t\n\tpublic function addSubmenu(_text:String):Submenu\n\t{\n\t\tvar submenu = new Submenu(name, _text);\n\t\tul.appendChild(submenu.getElement());\n\t\treturn submenu;\n\t}\n\t\n\tpublic function addToDocument():Void\n\t{\t\n\t\tvar div:Element = cast(Browser.document.getElementById(\"position-navbar\"), Element);\n\t\tdiv.appendChild(li);\n\t}\n\n\tpublic function removeFromDocument():Void\n\t{\n\t\tli.remove();\n\t}\n\n\tpublic function setPosition(_position:Int):Void\n\t{\n\t\tposition = _position;\n\t}\n\t\n\tpublic function setDisabled(menuItemNames:Array<String>):Void\n\t{\n\t\tvar childNodes:NodeList = ul.childNodes;\n\t\t\n\t\tfor (i in 0...childNodes.length)\n\t\t{\n\t\t\tvar child:Element = cast(childNodes[i], Element);\n\t\t\t\n\t\t\tif (child.className != \"divider\")\n\t\t\t{\t\t\t\t\n\t\t\t\tvar a:AnchorElement = cast(child.firstChild, AnchorElement);\n\t\t\t\t\t\t\t\t\n\t\t\t\tif (Lambda.indexOf(menuItemNames, a.getAttribute(\"text\")) == -1)\n\t\t\t\t{\n\t\t\t\t\tchild.className = \"\";\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tchild.className = \"disabled\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tpublic function setMenuEnabled(enabled:Bool):Void\n\t{\n\t\tvar childNodes:NodeList = ul.childNodes;\n\t\t\n\t\tfor (i in 0...childNodes.length)\n\t\t{\n\t\t\tvar child:Element = cast(childNodes[i], Element);\n\t\t\t\n\t\t\tif (child.className != \"divider\")\n\t\t\t{\n\t\t\t\tif (enabled)\n\t\t\t\t{\n\t\t\t\t\tchild.className = \"\";\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tchild.className = \"disabled\";\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t}\n\t}\n\t\n\tpublic function getSubmenu(name:String):Submenu\n\t{\n\t\tif (!submenus.exists(name)) \n\t\t{\n\t\t\tsubmenus.set(name, addSubmenu(name));\n\t\t}\n\t\t\n\t\treturn submenus.get(name);\n\t}\n\t\n\tpublic function getElement():Element\n\t{\n\t\treturn li;\n\t}\n}","package newprojectdialog;\nimport haxe.ds.StringMap.StringMap;\nimport js.html.AnchorElement;\nimport js.html.LIElement;\nimport jQuery.JQuery;\n\n/**\n * ...\n * @author AS3Boyan\n */\n@:keepSub @:expose class Category\n{\n\tpublic var element:LIElement;\n\tpublic var items:Array<Item>;\n\tpublic var subcategories:StringMap<Category>;\n\tpublic var position:Int;\n\tpublic var name:String;\n\tpublic var parent:Category;\n\t\n\tpublic function new(_name:String, _element:LIElement) \n\t{\n\t\telement = _element;\n\t\tsubcategories = new StringMap();\n\t\titems  = new Array();\n\t\tname = _name;\n\t}\n\t\n\tpublic function getCategory(name:String):Category\n\t{\n\t\tif (!subcategories.exists(name))\n\t\t{\n\t\t\tNewProjectDialog.createSubcategory(name, this);\n\t\t}\n\t\t\n\t\treturn subcategories.get(name);\n\t}\n\t\n\tpublic function addItem(name:String, ?createProjectFunction:Dynamic, ?showCreateDirectoryOption:Bool = true, ?nameLocked:Bool = false):Void\n\t{\n\t\titems.push(new Item(name, createProjectFunction, showCreateDirectoryOption, nameLocked));\n\t\tNewProjectDialog.loadProjectCategory();\n\t}\n\t\n\tpublic function getItems():Array<String>\n\t{\n\t\tvar itemNames:Array<String> = new Array();\n\t\t\t\t\n\t\tfor (item in items)\n\t\t{\n\t\t\titemNames.push(item.name);\n\t\t}\n\t\t\n\t\treturn itemNames;\n\t}\n\t\n\tpublic function select(?item:String):Void\n\t{\n\t\tNewProjectDialog.updateListItems(this, item);\n\t}\n\t\n\tpublic function getItem(name:String):Item\n\t{\n\t\tvar currentItem:Item = null;\n\t\t\n\t\tfor (item in items)\n\t\t{\n\t\t\tif (name == item.name)\n\t\t\t{\n\t\t\t\tcurrentItem = item;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn currentItem;\n\t}\n\t\n\tpublic function setPosition(_position:Int):Void\n\t{\n\t\tposition = _position;\n\t}\n\t\n\tpublic function getElement():LIElement\n\t{\n\t\treturn element;\n\t}\n}","package newprojectdialog;\r\n\r\n/**\r\n * ...\r\n * @author AS3Boyan\r\n */\r\n@:keepSub @:expose class Item\r\n{\r\n\tpublic var name:String;\r\n\tpublic var showCreateDirectoryOption:Bool;\r\n\tpublic var nameLocked:Bool;\r\n\tpublic var createProjectFunction:Dynamic;\r\n\r\n\tpublic function new(_name:String, ?_createProjectFunction:Dynamic, ?_showCreateDirectoryOption:Bool = true, ?_nameLocked:Bool = false) \r\n\t{\r\n\t\tname = _name;\r\n\t\tshowCreateDirectoryOption = _showCreateDirectoryOption;\r\n\t\tnameLocked = _nameLocked;\r\n\t\tcreateProjectFunction = _createProjectFunction;\r\n\t}\r\n\t\r\n}","package newprojectdialog;\r\nimport core.FileDialog;\r\nimport haxe.ds.StringMap;\r\nimport haxe.Timer;\r\nimport jQuery.JQuery;\r\nimport js.Browser;\r\nimport js.html.AnchorElement;\r\nimport js.html.ButtonElement;\r\nimport js.html.DivElement;\r\nimport js.html.Event;\r\nimport js.html.HeadingElement;\r\nimport js.html.InputElement;\r\nimport js.html.LabelElement;\r\nimport js.html.LIElement;\r\nimport js.html.MouseEvent;\r\nimport js.html.OptionElement;\r\nimport js.html.ParagraphElement;\r\nimport js.html.SelectElement;\r\nimport js.html.SpanElement;\r\nimport js.html.UListElement;\r\n\r\n/**\r\n * ...\r\n * @author AS3Boyan\r\n */\r\n@:keepSub @:expose class NewProjectDialog\r\n{\r\n\tprivate static var modal:DivElement;\r\n\tprivate static var list:SelectElement;\r\n\tprivate static var selectedCategory:Category;\r\n\tprivate static var description:ParagraphElement;\r\n\tprivate static var helpBlock:ParagraphElement;\r\n\tprivate static var projectName:InputElement;\r\n\tprivate static var projectLocation:InputElement;\r\n\tprivate static var createDirectoryForProject:InputElement;\r\n\tprivate static var page1:DivElement;\r\n\tprivate static var page2:DivElement;\r\n\tprivate static var backButton:ButtonElement;\r\n\tprivate static var textfieldsWithCheckboxes:StringMap<InputElement>;\r\n\tprivate static var checkboxes:StringMap<InputElement>;\r\n\tprivate static var nextButton:ButtonElement;\r\n\t\r\n\tprivate static var categories:StringMap<Category> = new StringMap();\r\n\tprivate static var tree:UListElement;\r\n\t\r\n\tprivate static var categoriesArray:Array<Category> = new Array();\r\n\tstatic private var lastProjectCategoryPath:String;\r\n\t\r\n\tpublic static function create():Void\r\n\t{\r\n\t\tmodal = Browser.document.createDivElement();\r\n\t\tmodal.className = \"modal fade\";\r\n\t\t\r\n\t\tvar dialog:DivElement = Browser.document.createDivElement();\r\n\t\tdialog.className = \"modal-dialog\";\r\n\t\tmodal.appendChild(dialog);\r\n\t\t\r\n\t\tvar content:DivElement = Browser.document.createDivElement();\r\n\t\tcontent.className = \"modal-content\";\r\n\t\tdialog.appendChild(content);\r\n\t\t\r\n\t\tvar header:DivElement = Browser.document.createDivElement();\r\n\t\theader.className = \"modal-header\";\r\n\t\tcontent.appendChild(header);\r\n\t\t\r\n\t\tvar button:ButtonElement = Browser.document.createButtonElement();\r\n\t\tbutton.type = \"button\";\r\n\t\tbutton.className = \"close\";\r\n\t\tbutton.setAttribute(\"data-dismiss\", \"modal\");\r\n\t\tbutton.setAttribute(\"aria-hidden\", \"true\");\r\n\t\tbutton.innerHTML = \"&times;\";\r\n\t\theader.appendChild(button);\r\n\t\t\r\n\t\tvar h4:HeadingElement = cast(Browser.document.createElement(\"h4\"), HeadingElement);\r\n\t\th4.className = \"modal-title\";\r\n\t\th4.textContent = \"New Project\";\r\n\t\theader.appendChild(h4);\r\n\t\t\r\n\t\tvar body:DivElement = Browser.document.createDivElement();\r\n\t\tbody.className = \"modal-body\";\r\n\t\tbody.style.overflow = \"hidden\";\r\n\t\tcontent.appendChild(body);\r\n\t\t\r\n\t\ttextfieldsWithCheckboxes = new StringMap();\r\n\t\tcheckboxes = new StringMap();\r\n\t\t\r\n\t\tcreatePage1();\r\n\t\tbody.appendChild(page1);\r\n\t\t\r\n\t\tcreatePage2();\r\n\t\tpage2.style.display = \"none\";\r\n\t\tbody.appendChild(page2);\r\n\t\t\r\n\t\tvar footer:DivElement = Browser.document.createDivElement();\r\n\t\tfooter.className = \"modal-footer\";\r\n\t\tcontent.appendChild(footer);\r\n\t\t\r\n\t\tbackButton = Browser.document.createButtonElement();\r\n\t\tbackButton.type = \"button\";\r\n\t\tbackButton.className = \"btn btn-default disabled\";\r\n\t\tbackButton.textContent = \"Back\";\r\n\t\t\r\n\t\tfooter.appendChild(backButton);\r\n\t\t\r\n\t\tnextButton = Browser.document.createButtonElement();\r\n\t\tnextButton.type = \"button\";\r\n\t\tnextButton.className = \"btn btn-default\";\r\n\t\tnextButton.textContent = \"Next\";\r\n\t\t\r\n\t\tbackButton.onclick = function (e:MouseEvent)\r\n\t\t{\r\n\t\t\tif (backButton.className.indexOf(\"disabled\") == -1)\r\n\t\t\t{\r\n\t\t\t\tshowPage1();\r\n\t\t\t}\r\n\t\t}\r\n\t\t;\r\n\t\t\r\n\t\tnextButton.onclick = function (e:MouseEvent)\r\n\t\t{\r\n\t\t\tif (nextButton.className.indexOf(\"disabled\") == -1)\r\n\t\t\t{\r\n\t\t\t\tshowPage2();\r\n\t\t\t}\r\n\t\t}\r\n\t\t;\r\n\t\t\r\n\t\tfooter.appendChild(nextButton);\r\n\t\t\r\n\t\tvar finishButton:ButtonElement = Browser.document.createButtonElement();\r\n\t\tfinishButton.type = \"button\";\r\n\t\tfinishButton.className = \"btn btn-default\";\r\n\t\tfinishButton.textContent = \"Finish\";\r\n\t\t\r\n\t\tfinishButton.onclick = function (e:MouseEvent)\r\n\t\t{\r\n\t\t\tif (page1.style.display != \"none\" || projectName.value == \"\" )\r\n\t\t\t{\r\n\t\t\t\tgenerateProjectName(createProject);\r\n\t\t\t}\r\n\t\t\telse \r\n\t\t\t{\r\n\t\t\t\tcreateProject();\r\n\t\t\t}\r\n\t\t}\r\n\t\t;\r\n\t\t\r\n\t\tfooter.appendChild(finishButton);\r\n\t\t\r\n\t\tvar cancelButton:ButtonElement = Browser.document.createButtonElement();\r\n\t\tcancelButton.type = \"button\";\r\n\t\tcancelButton.className = \"btn btn-default\";\r\n\t\tcancelButton.setAttribute(\"data-dismiss\", \"modal\");\r\n\t\tcancelButton.textContent = \"Cancel\";\r\n\t\t\r\n\t\tfooter.appendChild(cancelButton);\r\n\t\t\r\n\t\tBrowser.document.body.appendChild(modal);\r\n\t\t\r\n\t\tBrowser.window.addEventListener(\"keyup\", function (e)\r\n\t\t{\r\n\t\t\tif (e.keyCode == 27)\r\n\t\t\t{\r\n\t\t\t\tuntyped new JQuery(modal).modal(\"hide\");\r\n\t\t\t}\r\n\t\t}\r\n\t\t);\r\n\t\t\r\n\t\tvar location:String = Browser.getLocalStorage().getItem(\"Location\");\r\n\t\t\r\n\t\tif (location != null)\r\n\t\t{\r\n\t\t\tprojectLocation.value = location;\r\n\t\t}\r\n\t\t\r\n\t\tloadData(\"Package\");\r\n\t\tloadData(\"Company\");\r\n\t\tloadData(\"License\");\r\n\t\tloadData(\"URL\");\r\n\t\t\r\n\t\tloadCheckboxState(\"Package\");\r\n\t\tloadCheckboxState(\"Company\");\r\n\t\tloadCheckboxState(\"License\");\r\n\t\tloadCheckboxState(\"URL\");\r\n\t\tloadCheckboxState(\"CreateDirectory\");\r\n\t\t\r\n\t\tlastProjectCategoryPath = Browser.getLocalStorage().getItem(\"lastProject\");\r\n\t}\r\n\t\r\n\tprivate static function showPage1() \r\n\t{\r\n\t\tnew JQuery(page1).show(300);\r\n\t\tnew JQuery(page2).hide(300);\r\n\t\tbackButton.className = \"btn btn-default disabled\";\r\n\t\tnextButton.className = \"btn btn-default\";\r\n\t}\r\n\t\r\n\tprivate static function showPage2() \r\n\t{\r\n\t\tgenerateProjectName();\r\n\t\t\t\t\r\n\t\tnew JQuery(page1).hide(300);\r\n\t\tnew JQuery(page2).show(300);\r\n\t\tbackButton.className = \"btn btn-default\";\r\n\t\tnextButton.className = \"btn btn-default disabled\";\r\n\t}\r\n\t\r\n\tinline private static function getCheckboxData(key:String):String\r\n\t{\r\n\t\tvar data:String = \"\";\r\n\t\t\r\n\t\tif (checkboxes.get(key).checked)\r\n\t\t{\r\n\t\t\tdata = textfieldsWithCheckboxes.get(key).value;\r\n\t\t}\r\n\t\t\r\n\t\treturn data;\r\n\t}\r\n\t\r\n\tprivate static function createProject():Void\r\n\t{\t\t\r\n\t\tif (projectLocation.value != \"\" && projectName.value != \"\")\r\n\t\t{\r\n\t\t\tjs.Node.fs.exists(projectLocation.value, function (exists:Bool):Void\r\n\t\t\t{\r\n\t\t\t\tif (exists)\r\n\t\t\t\t{\r\n\t\t\t\t\t//js.Node.process.chdir(projectLocation.value);\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar item:Item = selectedCategory.getItem(list.value);\r\n\t\t\t\t\t\r\n\t\t\t\t\tsaveProjectCategory();\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (item.createProjectFunction != null)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar projectPackage:String = getCheckboxData(\"Package\");\r\n\t\t\t\t\t\tvar projectCompany:String = getCheckboxData(\"Company\");\r\n\t\t\t\t\t\tvar projectLicense:String = getCheckboxData(\"License\");\r\n\t\t\t\t\t\tvar projectURL:String = getCheckboxData(\"URL\");\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\titem.createProjectFunction( { \r\n\t\t\t\t\t\t\tprojectName: projectName.value,\r\n\t\t\t\t\t\t\tprojectLocation: projectLocation.value,\r\n\t\t\t\t\t\t\tprojectPackage: projectPackage,\r\n\t\t\t\t\t\t\tprojectCompany: projectCompany,\r\n\t\t\t\t\t\t\tprojectLicense: projectLicense,\r\n\t\t\t\t\t\t\tprojectURL: projectURL,\r\n\t\t\t\t\t\t\tcreateDirectory: !selectedCategory.getItem(list.value).showCreateDirectoryOption || createDirectoryForProject.checked\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tBrowser.getLocalStorage().setItem(\"Location\", projectLocation.value);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t//switch (selectedCategory) \r\n\t\t\t\t\t//{\r\n\t\t\t\t\t\t//case \"Haxe\":\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\t//project.type = Project.HAXE;\r\n\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\t//switch (list.value) \r\n\t\t\t\t\t\t\t//{\r\n\t\t\t\t\t\t\t\t//case \"Flash Project\":\r\n\t\t\t\t\t\t\t\t\t//project.target = \"flash\";\r\n\t\t\t\t\t\t\t\t//case \"JavaScript Project\":\r\n\t\t\t\t\t\t\t\t\t//project.target = \"html5\";\r\n\t\t\t\t\t\t\t\t//case \"Neko Project\":\r\n\t\t\t\t\t\t\t\t\t//project.target = \"neko\";\r\n\t\t\t\t\t\t\t\t//case \"PHP Project\":\r\n\t\t\t\t\t\t\t\t\t//project.target = \"php\";\r\n\t\t\t\t\t\t\t\t//case \"C++ Project\":\r\n\t\t\t\t\t\t\t\t\t//project.target = \"cpp\";\r\n\t\t\t\t\t\t\t\t//case \"Java Project\":\r\n\t\t\t\t\t\t\t\t\t//project.target = \"java\";\r\n\t\t\t\t\t\t\t\t//case \"C# Project\":\r\n\t\t\t\t\t\t\t\t\t//project.target = \"csharp\";\r\n\t\t\t\t\t\t\t\t//default:\r\n\t\t\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\t//}\r\n\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\t//var pathToMain:String  = js.Node.path.join(projectName.value, \"src\");\r\n\t\t\t\t\t\t\t//pathToMain = js.Node.path.join(pathToMain, \"Main.hx\");\r\n\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\t//project.main = pathToMain;\r\n\t\t\t\t\t\t//case \"OpenFL\":\r\n\t\t\t\t\t\t\t//switch (list.value) \r\n\t\t\t\t\t\t\t//{\r\n\t\t\t\t\t\t\t\t//case \"OpenFL Project\":\t\t\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t//case \"OpenFL Extension\":\r\n\t\t\t\t\t\t\t\t\t//createOpenFLProject([\"extension\", projectName.value]);\r\n\t\t\t\t\t\t\t\t//default:\r\n\t\t\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\t//}\r\n\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\t//project.type = Project.OPENFL;\r\n\t\t\t\t\t\t\t//project.target = \"html5\";\r\n\t\t\t\t\t\t\t//project.main = \"project.xml\";\r\n\t\t\t\t\t\t//case \"OpenFL/Samples\":\r\n\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\t//createOpenFLProject([list.value]);\r\n\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\t//project.type = Project.OPENFL;\r\n\t\t\t\t\t\t\t//project.target = \"html5\";\r\n\t\t\t\t\t\t\t//project.main = \"project.xml\";\r\n\t\t\t\t\t\t//default:\r\n\t\t\t\t\t\t\t//\r\n\t\t\t\t\t//}\r\n\t\t\t\t\t\r\n\t\t\t\t\t//Main.updateMenu();\r\n\t\t\t\t\t\r\n\t\t\t\t\tsaveData(\"Package\");\r\n\t\t\t\t\tsaveData(\"Company\");\r\n\t\t\t\t\tsaveData(\"License\");\r\n\t\t\t\t\tsaveData(\"URL\");\r\n\t\t\t\t\t\r\n\t\t\t\t\tsaveCheckboxState(\"Package\");\r\n\t\t\t\t\tsaveCheckboxState(\"Company\");\r\n\t\t\t\t\tsaveCheckboxState(\"License\");\r\n\t\t\t\t\tsaveCheckboxState(\"URL\");\r\n\t\t\t\t\tsaveCheckboxState(\"CreateDirectory\");\r\n\t\t\t\t\t\r\n\t\t\t\t\thide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\t\r\n\tstatic private function saveProjectCategory():Void\r\n\t{\r\n\t\tvar fullCategoryPath:String = \"\";\r\n\t\t\r\n\t\tvar root:Bool = false;\r\n\t\t\r\n\t\tvar parentCategory = selectedCategory;\r\n\t\t\r\n\t\twhile (!root)\r\n\t\t{\r\n\t\t\tfullCategoryPath = parentCategory.name + \"/\" + fullCategoryPath;\r\n\t\t\tif (parentCategory.parent != null)\r\n\t\t\t{\r\n\t\t\t\tparentCategory = parentCategory.parent;\r\n\t\t\t}\r\n\t\t\telse \r\n\t\t\t{\r\n\t\t\t\troot = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tfullCategoryPath += list.value;\r\n\t\t\r\n\t\tBrowser.getLocalStorage().setItem(\"lastProject\", fullCategoryPath);\r\n\t}\r\n\t\r\n\tprivate static function generateProjectName(?onGenerated:Dynamic):Void\r\n\t{\t\t\r\n\t\tif (selectedCategory.getItem(list.value).nameLocked == false)\r\n\t\t{\r\n\t\t\tvar value:String = StringTools.replace(list.value, \"+\", \"p\");\r\n\t\t\tvalue = StringTools.replace(value, \"#\", \"sharp\");\r\n\t\t\tvalue = StringTools.replace(value, \" \", \"\");\r\n\t\t\t//\r\n\t\t\t//if (selectedCategory != \"OpenFL\")\r\n\t\t\t//{\r\n\t\t\t//\tvalue = StringTools.replace(selectedCategory, \"/\", \"\") + value;\r\n\t\t\t//}\r\n\t\t\t//\r\n\t\t\t\r\n\t\t\tgenerateFolderName(projectLocation.value, value, 1, onGenerated);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tprojectName.value = list.value;\r\n\t\t\tupdateHelpBlock();\r\n\t\t\t\r\n\t\t\tif (onGenerated != null)\r\n\t\t\t{\r\n\t\t\t\tonGenerated();\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\tif (selectedCategory.getItem(list.value).showCreateDirectoryOption)\r\n\t\t{\r\n\t\t\tcreateDirectoryForProject.parentElement.parentElement.style.display = \"block\";\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tcreateDirectoryForProject.parentElement.parentElement.style.display = \"none\";\r\n\t\t}\r\n\t\t\r\n\t\tprojectName.disabled = selectedCategory.getItem(list.value).nameLocked;\r\n\t}\r\n\t\r\n\tpublic static function show():Void\r\n\t{\t\t\r\n\t\tif (page1.style.display == \"none\")\r\n\t\t{\r\n\t\t\tbackButton.click();\r\n\t\t}\r\n\t\t\r\n\t\tif (selectedCategory == null && categoriesArray.length > 0)\r\n\t\t{\r\n\t\t\tcategoriesArray[0].select();\r\n\t\t}\r\n\t\telse \r\n\t\t{\r\n\t\t\tselectedCategory.select(list.value);\r\n\t\t}\r\n\t\t\r\n\t\tuntyped new JQuery(modal).modal(\"show\");\r\n\t}\r\n\t\r\n\tpublic static function hide():Void\r\n\t{\r\n\t\tuntyped new JQuery(modal).modal(\"hide\");\r\n\t}\r\n\t\r\n\tpublic static function getCategory(name:String, ?position:Int):Category\r\n\t{\r\n\t\tvar category:Category;\r\n\t\t\r\n\t\tif (!categories.exists(name))\r\n\t\t{\r\n\t\t\tcategory = createCategory(name);\r\n\t\t\tcategories.set(name, category);\r\n\t\t\t\r\n\t\t\tcategory.setPosition(position);\r\n\t\t\taddCategoryToDocument(category);\r\n\t\t}\r\n\t\telse \r\n\t\t{\r\n\t\t\tcategory = categories.get(name);\r\n\t\t\t\r\n\t\t\tif (position != null && category.position != position)\r\n\t\t\t{\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif (position != null && category.position != position)\t\r\n\t\t{\r\n\t\t\tcategory.getElement().remove();\r\n\t\t\tcategories.remove(name);\r\n\r\n\t\t\tcategory.setPosition(position);\r\n\r\n\t\t\taddCategoryToDocument(category);\r\n\r\n\t\t\tcategories.set(name, category);\r\n\t\t}\r\n\t\t\r\n\t\treturn category;\r\n\t}\r\n\t\r\n\tpublic static function loadProjectCategory():Void\r\n\t{\r\n\t\tif (lastProjectCategoryPath != null)\r\n\t\t{\t\t\t\r\n\t\t\tvar categoryNames:Array<String> = lastProjectCategoryPath.split(\"/\");\r\n\t\t\t\r\n\t\t\t\tif (categories.exists(categoryNames[0]))\r\n\t\t\t\t{\r\n\t\t\t\t\tvar category:Category = categories.get(categoryNames[0]);\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (categoryNames.length > 2)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfor (i in 1...categoryNames.length - 1)\r\n\t\t\t\t\t\t{\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (category.subcategories.exists(categoryNames[i]))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tcategory = category.subcategories.get(categoryNames[i]);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif (Lambda.has(category.getItems(), categoryNames[categoryNames.length - 1]))\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tcategory.select(categoryNames[categoryNames.length - 1]);\r\n\t\t\t\t\t\t\t\t\tlastProjectCategoryPath = null;\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tnew JQuery(category.element).children('ul.tree').show(300);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse \r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (Lambda.has(category.getItems(), categoryNames[categoryNames.length - 1]))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tcategory.select(categoryNames[categoryNames.length - 1]);\r\n\t\t\t\t\t\t\tlastProjectCategoryPath = null;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tnew JQuery(category.element).children('ul.tree').show(300);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t//for (category in categories.iterator())\r\n\t\t\t\t\t//{\r\n\t\t\t\t\t\t//if (Lambda.count(category.subcategories) > 0)\r\n\t\t\t\t\t\t//{\r\n\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t//}\r\n\t\t\t\t\t\t//trace(category);\r\n\t\t\t\t\t//}\r\n\t\t\t\t\t\r\n\t\t\t\t\t//trace(list.value);\r\n\t}\r\n\t\r\n\tpublic static function addCategoryToDocument(category:Category):Void\r\n\t{\r\n\t\tif (category.position != null && categoriesArray.length > 0 && tree.childNodes.length > 0)\r\n\t\t{\r\n\t\t\tvar currentCategory:Category;\r\n\r\n\t\t\tvar added:Bool = false;\r\n\r\n\t\t\tfor (i in 0...categoriesArray.length)\r\n\t\t\t{\r\n\t\t\t\tcurrentCategory = categoriesArray[i];\r\n\r\n\t\t\t\tif (currentCategory != category && currentCategory.position == null || category.position < currentCategory.position)\r\n\t\t\t\t{\r\n\t\t\t\t\ttree.insertBefore(category.getElement(), currentCategory.getElement());\r\n\t\t\t\t\tcategoriesArray.insert(i, category);\r\n\t\t\t\t\tadded = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!added)\r\n\t\t\t{\r\n\t\t\t\ttree.appendChild(category.getElement());\r\n\t\t\t\tcategoriesArray.push(category);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\ttree.appendChild(category.getElement());\r\n\t\t\tcategoriesArray.push(category);\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate static function generateFolderName(path:String, folder:String, n:Int, ?onGenerated:Dynamic):Void\r\n\t{\t\t\r\n\t\tif (path != \"\" && folder != \"\")\r\n\t\t{\r\n\t\t\tjs.Node.fs.exists(js.Node.path.join(path, folder + Std.string(n)), function (exists:Bool):Void\r\n\t\t\t{\r\n\t\t\t\tif (exists)\r\n\t\t\t\t{\r\n\t\t\t\t\tgenerateFolderName(path, folder, n + 1, onGenerated);\r\n\t\t\t\t}\r\n\t\t\t\telse \r\n\t\t\t\t{\r\n\t\t\t\t\tprojectName.value = folder + Std.string(n);\r\n\t\t\t\t\tupdateHelpBlock();\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (onGenerated != null)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tonGenerated();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tprojectName.value = folder + Std.string(n);\r\n\t\t\tupdateHelpBlock();\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate static function loadData(_text:String):Void\r\n\t{\r\n\t\tvar text:String = Browser.getLocalStorage().getItem(_text);\r\n\t\t\r\n\t\tif (text != null)\r\n\t\t{\r\n\t\t\ttextfieldsWithCheckboxes.get(_text).value = text;\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate static function saveData(_text:String):Void\r\n\t{\r\n\t\tif (checkboxes.get(_text).checked)\r\n\t\t{\r\n\t\t\tvar value:String = textfieldsWithCheckboxes.get(_text).value;\r\n\t\t\t\r\n\t\t\tif (value != \"\")\r\n\t\t\t{\r\n\t\t\t\tBrowser.getLocalStorage().setItem(_text, value);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate static function loadCheckboxState(_text:String):Void\r\n\t{\r\n\t\tvar text:String = Browser.getLocalStorage().getItem(_text + \"Checkbox\");\r\n\t\t\r\n\t\tif (text != null)\r\n\t\t{\r\n\t\t\tcheckboxes.get(_text).checked = js.Node.parse(text);\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate static function saveCheckboxState(_text:String):Void\r\n\t{\r\n\t\tBrowser.getLocalStorage().setItem(_text + \"Checkbox\", js.Node.stringify(checkboxes.get(_text).checked));\r\n\t}\r\n\t\r\n\tprivate static function createPage1():DivElement\r\n\t{\r\n\t\tpage1 = Browser.document.createDivElement();\r\n\t\t\r\n\t\tvar well:DivElement = Browser.document.createDivElement();\r\n\t\twell.id = \"new-project-dialog-well\";\r\n\t\twell.className = \"well\";\r\n\t\t//well.style.overflow = \"auto\";\r\n\t\t//well.classList.add(\"pull-left\");\r\n\t\twell.style.float = \"left\";\r\n\t\twell.style.width = \"50%\";\r\n\t\twell.style.height = \"250px\";\r\n\t\twell.style.marginBottom = \"0\";\r\n\t\tpage1.appendChild(well);\r\n\t\t\r\n\t\ttree = Browser.document.createUListElement();\r\n\t\ttree.className = \"nav nav-list\";\r\n\t\twell.appendChild(tree);\r\n\t\t\r\n\t\tlist = createList();\r\n\t\tlist.style.float = \"left\";\r\n\t\tlist.style.width = \"50%\";\r\n\t\tlist.style.height = \"250px\";\r\n\t\t\r\n\t\tpage1.appendChild(list);\r\n\t\t\r\n\t\tpage1.appendChild(Browser.document.createBRElement());\r\n\t\t\r\n\t\tdescription = Browser.document.createParagraphElement();\r\n\t\tdescription.style.width = \"100%\";\r\n\t\tdescription.style.height = \"50px\";\r\n\t\tdescription.style.overflow = \"auto\";\r\n\t\tdescription.textContent = \"Description\";\r\n\t\t\r\n\t\tpage1.appendChild(description);\r\n\t\t\r\n\t\treturn page1;\r\n\t}\r\n\t\r\n\tprivate static function createPage2():DivElement\r\n\t{\r\n\t\tpage2 = Browser.document.createDivElement();\r\n\t\tpage2.style.padding = \"15px\";\r\n\t\t\r\n\t\tvar row:DivElement = Browser.document.createDivElement();\r\n\t\trow.className = \"row\";\r\n\t\t\r\n\t\tprojectName = Browser.document.createInputElement();\r\n\t\tprojectName.type = \"text\";\r\n\t\tprojectName.className = \"form-control\";\r\n\t\tprojectName.placeholder = \"Name\";\r\n\t\tprojectName.style.width = \"100%\";\r\n\t\trow.appendChild(projectName);\r\n\t\t\r\n\t\tpage2.appendChild(row);\r\n\t\t\r\n\t\trow = Browser.document.createDivElement();\r\n\t\trow.className = \"row\";\r\n\t\t\r\n\t\tvar inputGroup:DivElement = Browser.document.createDivElement();\r\n\t\tinputGroup.className = \"input-group\";\r\n\t\tinputGroup.style.display = \"inline\";\r\n\t\trow.appendChild(inputGroup);\r\n\t\t\r\n\t\tprojectLocation = Browser.document.createInputElement();\r\n\t\tprojectLocation.type = \"text\";\r\n\t\tprojectLocation.className = \"form-control\";\r\n\t\tprojectLocation.placeholder = \"Location\";\r\n\t\tprojectLocation.style.width = \"80%\";\r\n\t\tinputGroup.appendChild(projectLocation);\r\n\t\t\r\n\t\tvar browseButton:ButtonElement = Browser.document.createButtonElement();\r\n\t\tbrowseButton.type = \"button\";\r\n\t\tbrowseButton.className = \"btn btn-default\";\r\n\t\tbrowseButton.textContent = \"Browse...\";\r\n\t\tbrowseButton.style.width = \"20%\";\r\n\t\t\r\n\t\tbrowseButton.onclick = function (e:MouseEvent)\r\n\t\t{\r\n\t\t\tFileDialog.openFolder(function (path:String):Void\r\n\t\t\t{\r\n\t\t\t\tprojectLocation.value = path;\r\n\t\t\t\tupdateHelpBlock();\r\n\t\t\t\t\r\n\t\t\t\tBrowser.getLocalStorage().setItem(\"Location\", path);\r\n\t\t\t}\r\n\t\t\t);\r\n\t\t};\r\n\t\t\r\n\t\tinputGroup.appendChild(browseButton);\r\n\t\t\r\n\t\tpage2.appendChild(row);\r\n\t\t\r\n\t\tcreateTextWithCheckbox(page2, \"Package\");\r\n\t\tcreateTextWithCheckbox(page2, \"Company\");\r\n\t\tcreateTextWithCheckbox(page2, \"License\");\r\n\t\tcreateTextWithCheckbox(page2, \"URL\");\r\n\t\t\r\n\t\trow = Browser.document.createDivElement();\r\n\t\trow.className = \"row\";\r\n\t\t\r\n\t\tvar checkboxDiv:DivElement = Browser.document.createDivElement();\r\n\t\tcheckboxDiv.className = \"checkbox\";\r\n\t\trow.appendChild(checkboxDiv);\r\n\t\t\r\n\t\tvar label:LabelElement = Browser.document.createLabelElement();\r\n\t\tcheckboxDiv.appendChild(label);\r\n\t\t\r\n\t\tcreateDirectoryForProject = Browser.document.createInputElement();\r\n\t\tcreateDirectoryForProject.type = \"checkbox\";\r\n\t\tcreateDirectoryForProject.checked = true;\r\n\t\tlabel.appendChild(createDirectoryForProject);\r\n\t\t\r\n\t\tcheckboxes.set(\"CreateDirectory\", createDirectoryForProject);\r\n\t\t\r\n\t\tcreateDirectoryForProject.onchange = function (e):Void\r\n\t\t{\r\n\t\t\tupdateHelpBlock();\r\n\t\t};\r\n\t\t\r\n\t\tlabel.appendChild(Browser.document.createTextNode(\"Create directory for project\"));\r\n\t\t\r\n\t\tpage2.appendChild(row);\r\n\t\t\r\n\t\trow = Browser.document.createDivElement();\r\n\t\t\r\n\t\thelpBlock = Browser.document.createParagraphElement();\r\n\t\thelpBlock.className = \"help-block\";\r\n\t\trow.appendChild(helpBlock);\r\n\t\t\r\n\t\tprojectLocation.onchange = function (e):Void\r\n\t\t{\r\n\t\t\tupdateHelpBlock();\r\n\t\t\tgenerateFolderName(projectLocation.value, projectName.value, 1);\r\n\t\t};\r\n\t\t\r\n\t\tprojectName.onchange = function (e):Void\r\n\t\t{\t\t\t\r\n\t\t\tprojectName.value = projectName.value.substr(0, 1).toUpperCase() + projectName.value.substr(1);\r\n\t\t\tupdateHelpBlock();\r\n\t\t}\r\n\t\t\r\n\t\tpage2.appendChild(row);\r\n\t\t\r\n\t\treturn page2;\r\n\t}\r\n\t\r\n\tprivate static function updateHelpBlock():Void\r\n\t{\r\n\t\tif (projectLocation.value != \"\")\r\n\t\t{\r\n\t\t\tvar str:String = \"\";\r\n\t\t\t\r\n\t\t\t//(selectedCategory != \"Haxe\" ||\r\n\t\t\tif ((!selectedCategory.getItem(list.value).showCreateDirectoryOption || createDirectoryForProject.checked == true) && projectName.value != \"\")\r\n\t\t\t{\r\n\t\t\t\tstr = projectName.value;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\thelpBlock.innerText = \"Project will be created in: \" + js.Node.path.join(projectLocation.value, str);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\thelpBlock.innerText = \"\";\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate static function createTextWithCheckbox(_page2:DivElement, _text:String):Void\r\n\t{\r\n\t\tvar row:DivElement = Browser.document.createDivElement();\r\n\t\trow.className = \"row\";\r\n\t\t\r\n\t\tvar inputGroup:DivElement = Browser.document.createDivElement();\r\n\t\tinputGroup.className = \"input-group\";\r\n\t\trow.appendChild(inputGroup);\r\n\t\t\r\n\t\tvar inputGroupAddon:SpanElement = Browser.document.createSpanElement();\r\n\t\tinputGroupAddon.className = \"input-group-addon\";\r\n\t\tinputGroup.appendChild(inputGroupAddon);\r\n\t\t\r\n\t\tvar checkbox:InputElement = Browser.document.createInputElement();\r\n\t\tcheckbox.type = \"checkbox\";\r\n\t\tcheckbox.checked = true;\r\n\t\tinputGroupAddon.appendChild(checkbox);\r\n\t\t\r\n\t\tcheckboxes.set(_text, checkbox);\r\n\t\t\r\n\t\tvar text:InputElement = Browser.document.createInputElement();\r\n\t\ttext.type = \"text\";\r\n\t\ttext.className = \"form-control\";\r\n\t\ttext.placeholder = _text;\r\n\t\t\r\n\t\ttextfieldsWithCheckboxes.set(_text, text);\r\n\t\t\r\n\t\tcheckbox.onchange = function (e)\r\n\t\t{\r\n\t\t\tif (checkbox.checked)\r\n\t\t\t{\r\n\t\t\t\ttext.disabled = false;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\ttext.disabled = true;\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tinputGroup.appendChild(text);\r\n\t\t\r\n\t\t_page2.appendChild(row);\r\n\t}\r\n\t\r\n\tprivate static function createCategory(text:String):Category\r\n\t{\t\t\r\n\t\tvar li:LIElement = Browser.document.createLIElement();\r\n\t\t\r\n\t\tvar category:Category = new Category(text, li);\r\n\t\t\t\r\n\t\tvar a:AnchorElement = Browser.document.createAnchorElement();\r\n\t\ta.href = \"#\";\r\n\t\t\r\n\t\ta.addEventListener(\"click\", function (e:MouseEvent):Void\r\n\t\t{\r\n\t\t\tupdateListItems(category);\r\n\t\t}\r\n\t\t);\r\n\t\t\r\n\t\tvar span = Browser.document.createSpanElement();\r\n\t\tspan.className = \"glyphicon glyphicon-folder-open\";\r\n\t\ta.appendChild(span);\r\n\t\t\r\n\t\tspan = Browser.document.createSpanElement();\r\n\t\tspan.textContent = text;\r\n\t\tspan.style.marginLeft = \"5px\";\r\n\t\ta.appendChild(span);\r\n\t\t\r\n\t\tli.appendChild(a);\r\n\t\t\r\n\t\treturn category;\r\n\t}\r\n\t\r\n\tpublic static function createSubcategory(text:String, category:Category):Void\r\n\t{\r\n\t\tvar a:AnchorElement = cast(category.element.getElementsByTagName(\"a\")[0], AnchorElement);\r\n\t\ta.className = \"tree-toggler nav-header\";\r\n\t\t\r\n\t\ta.onclick = function (e:MouseEvent):Void\r\n\t\t{\r\n\t\t\tnew JQuery(category.element).children('ul.tree').toggle(300);\r\n\t\t};\r\n\t\t\r\n\t\tvar ul:UListElement = Browser.document.createUListElement();\r\n\t\tul.className = \"nav nav-list tree\";\r\n\t\tcategory.element.appendChild(ul);\r\n\t\t\r\n\t\tcategory.element.onclick = function (e:MouseEvent):Void\r\n\t\t{\r\n\t\t\tfor (subcategory in category.subcategories.keys())\r\n\t\t\t{\r\n\t\t\t\tul.appendChild(category.subcategories.get(subcategory).element);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\te.stopPropagation();\r\n\t\t\te.preventDefault();\r\n\t\t\tcategory.element.onclick = null;\r\n\t\t\t\r\n\t\t\tnew JQuery(ul).show(300);\r\n\t\t};\r\n\t\t\r\n\t\tvar subcategory:Category = createCategory(text);\r\n\t\tsubcategory.parent = category;\r\n\t\tcategory.subcategories.set(text, subcategory);\r\n\t}\r\n\t\r\n\tpublic static function updateListItems(category:Category, ?item:String):Void\r\n\t{\t\t\r\n\t\tselectedCategory = category;\r\n\t\t\r\n\t\tnew JQuery(list).children().remove();\r\n\t\t\r\n\t\tsetListItems(list, category.getItems(), item);\r\n\t\t\r\n\t\tcheckSelectedOptions();\r\n\t}\r\n\t\r\n\tpublic static function createCategoryWithSubcategories(text:String, subcategories:Array<String>):LIElement\r\n\t{\r\n\t\tvar li:LIElement = Browser.document.createLIElement();\r\n\t\t\r\n\t\tvar category:Category = createCategory(text);\r\n\t\t\r\n\t\tvar a:AnchorElement = cast(li.getElementsByTagName(\"a\")[0], AnchorElement);\r\n\t\ta.className = \"tree-toggler nav-header\";\r\n\t\t\r\n\t\ta.onclick = function (e:MouseEvent):Void\r\n\t\t{\r\n\t\t\tnew JQuery(li).children('ul.tree').toggle(300);\r\n\t\t};\r\n\t\t\r\n\t\tvar ul:UListElement = Browser.document.createUListElement();\r\n\t\tul.className = \"nav nav-list tree\";\r\n\t\tli.appendChild(ul);\r\n\t\t\r\n\t\tli.onclick = function (e:MouseEvent):Void\r\n\t\t{\r\n\t\t\tfor (subcategory in subcategories)\r\n\t\t\t{\r\n\t\t\t\tul.appendChild(createCategory(subcategory).element);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\te.stopPropagation();\r\n\t\t\te.preventDefault();\r\n\t\t\tli.onclick = null;\r\n\t\t\t\r\n\t\t\tnew JQuery(ul).show(300);\r\n\t\t};\r\n\t\t\r\n\t\treturn li;\r\n\t}\r\n\t\r\n\tprivate static function createList():SelectElement\r\n\t{\r\n\t\tvar select:SelectElement = Browser.document.createSelectElement();\r\n\t\tselect.size = 10;\t\t\r\n\t\t\r\n\t\tselect.onchange = function (e):Void\r\n\t\t{\r\n\t\t\tcheckSelectedOptions();\r\n\t\t};\r\n\t\t\r\n\t\tselect.ondblclick = function (e):Void\r\n\t\t{\r\n\t\t\tshowPage2();\r\n\t\t};\r\n\t\t\r\n\t\treturn select;\r\n\t}\r\n\t\r\n\tprivate static function checkSelectedOptions():Void\r\n\t{\r\n\t\tif (list.selectedOptions.length > 0)\r\n\t\t{\r\n\t\t\tvar option:OptionElement = cast(list.selectedOptions[0], OptionElement);\r\n\t\t\t//updateDescription(selectedCategory, option.label);\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate static function updateDescription(category:String, selectedOption:String):Void\r\n\t{\r\n\t\t//switch (category) \r\n\t\t//{\r\n\t\t\t//case \"Haxe\":\r\n\t\t\t\t//switch (selectedOption) \r\n\t\t\t\t//{\r\n\t\t\t\t\t//[\"Flash Project\", \"JavaScript Project\", \"Neko Project\", \"PHP Project\", \"C++ Project\", \"Java Project\", \"C# Project\"]\r\n\t\t\t\t\t//case \"Flash Project\":\r\n\t\t\t\t\t\t//description.textContent = selectedOption;\r\n\t\t\t\t\t//default:\r\n\t\t\t\t\t\t//\r\n\t\t\t\t//}\r\n\t\t\t//case \"OpenFL\":\r\n\t\t\t//case \"OpenFL/Samples\":\r\n\t\t\t\t//\r\n\t\t\t//default:\r\n\t\t\t\t//\r\n\t\t//}\r\n\t\t\r\n\t\tdescription.textContent = selectedOption;\r\n\t}\r\n\t\r\n\tprivate static function setListItems(list:SelectElement, items:Array<String>, ?selectedItem:String):Void\r\n\t{\r\n\t\tfor (item in items)\r\n\t\t{\r\n\t\t\tlist.appendChild(createListItem(item));\r\n\t\t\t\r\n\t\t\t//if (items[i] == selectedItem)\r\n\t\t\t//{\r\n\t\t\t\t//list.selectedIndex = i;\r\n\t\t\t//}\r\n\t\t}\r\n\t\t\r\n\t\t//if (selectedItem == null)\r\n\t\t//{\r\n\t\t\tlist.selectedIndex = 0;\r\n\t\t//}\r\n\t\t\r\n\t\tcheckSelectedOptions();\r\n\t}\r\n\t\r\n\tprivate static function createListItem(text:String):OptionElement\r\n\t{\t\t\r\n\t\tvar option:OptionElement = Browser.document.createOptionElement();\r\n\t\toption.textContent = text;\r\n\t\toption.value = text;\r\n\t\treturn option;\r\n\t}\r\n\t\r\n}","package newprojectdialog;\nimport menu.BootstrapMenu;\n\n/**\n * ...\n * @author AS3Boyan\n */\nclass NewProjectDialogLoader\n{\n\tpublic static function load():Void\n\t{\t\t\n\t\tNewProjectDialog.create();\n\t\tBootstrapMenu.getMenu(\"File\", 1).addMenuItem(\"New Project...\", 1, NewProjectDialog.show, \"Ctrl-Shift-N\");\n\t}\n\t\n}","package openflproject;\r\n\r\n/**\r\n * ...\r\n * @author AS3Boyan\r\n */\r\nclass CreateOpenFLProject\r\n{\r\n\r\n\tpublic function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic static function createOpenFLProject(params:Array<String>, path:String, ?onComplete:Dynamic):Void\r\n\t{\t\r\n\t\tvar args = [\"haxelib\", \"run\", \"openfl\", \"create\"].concat(params).join(\" \");\r\n\t\t\r\n\t\ttrace(args);\r\n\t\t\r\n\t\tvar OpenFLTools:js.Node.NodeChildProcess = js.Node.child_process.exec(args, { cwd: path }, function (error, stdout, stderr) \r\n\t\t{\r\n\t\t\ttrace(stderr);\r\n\t\t}\r\n\t\t);\r\n\t\t\r\n\t\tOpenFLTools.on(\"close\", function (code:Int)\r\n\t\t{\r\n\t\t\ttrace(\"exit code: \" + Std.string(code));\r\n\t\t\t\r\n\t\t\tif (code == 0 && onComplete != null) \r\n\t\t\t{\r\n\t\t\t\tonComplete();\r\n\t\t\t}\r\n\t\t}\r\n\t\t);\r\n\t}\r\n\t\r\n}","package openflproject;\r\nimport filetree.FileTree;\r\nimport js.Browser;\r\nimport js.html.TextAreaElement;\r\nimport newprojectdialog.NewProjectDialog;\r\nimport projectaccess.Project;\r\nimport projectaccess.ProjectAccess;\r\nimport projectaccess.ProjectOptions;\r\nimport tabmanager.TabManager;\r\n\r\n/**\r\n * ...\r\n * @author AS3Boyan\r\n */\r\nclass OpenFLProject\r\n{\r\n\tpublic static function load():Void\r\n\t{\r\n\t\tNewProjectDialog.getCategory(\"OpenFL\", 2).addItem(\"OpenFL Project\", createOpenFLProject, false);\r\n\t\tNewProjectDialog.getCategory(\"OpenFL\").addItem(\"OpenFL Extension\", createOpenFLExtension, false);\r\n\t\t\r\n\t\tvar samples: Array<String> = [\r\n\t\t\"ActuateExample\",\r\n\t\t\"AddingAnimation\",\r\n\t\t\"AddingText\",\r\n\t\t\"DisplayingABitmap\",\r\n\t\t\"HandlingKeyboardEvents\",\r\n\t\t\"HandlingMouseEvent\",\r\n\t\t\"HerokuShaders\",\r\n\t\t\"PiratePig\",\r\n\t\t\"PlayingSound\",\r\n\t\t\"SimpleBox2D\",\r\n\t\t\"SimpleOpenGLView\",\r\n\t\t];\r\n\t\t\r\n\t\tfor (sample in samples)\r\n\t\t{\r\n\t\t\tNewProjectDialog.getCategory(\"OpenFL\").getCategory(\"Samples\").addItem(sample, function (data:Dynamic):Void\r\n\t\t\t{\r\n\t\t\t\t//data.projectName = sample;\r\n\t\t\t\tcreateOpenFLProject(data, true);\r\n\t\t\t}\r\n\t\t\t, false, true);\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic static function createOpenFLProject(data:Dynamic, sample:Bool = false):Void\r\n\t{\t\r\n\t\tvar params:Array<String>;\r\n\t\t\r\n\t\tif (!sample)\r\n\t\t{\r\n\t\t\tvar str:String = \"\";\r\n\t\t\r\n\t\t\tif (data.projectPackage != \"\")\r\n\t\t\t{\r\n\t\t\t\tstr = data.projectPackage + \".\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tparams = [\"project\", \"\\\"\" + str + data.projectName + \"\\\"\"];\r\n\t\t\t\r\n\t\t\tif (data.projectCompany != \"\")\r\n\t\t\t{\r\n\t\t\t\tparams.push(\"\\\"\" + data.projectCompany + \"\\\"\");\r\n\t\t\t}\r\n\t\t}\r\n\t\telse \r\n\t\t{\r\n\t\t\tparams = [data.projectName];\r\n\t\t}\r\n\t\t\t\t\r\n\t\tCreateOpenFLProject.createOpenFLProject(params, data.projectLocation, function ()\r\n\t\t{\t\r\n\t\t\tvar pathToProject:String = js.Node.path.join(data.projectLocation, data.projectName);\r\n\t\t\t\r\n\t\t\tcreateProject(data);\r\n\t\t\t\r\n\t\t\tTabManager.openFileInNewTab(js.Node.path.join(pathToProject, \"Source\", \"Main.hx\"));\r\n\t\t}\r\n\t\t);\r\n\t}\r\n\t\r\n\tpublic static function createOpenFLExtension(data:Dynamic):Void\r\n\t{\r\n\t\tCreateOpenFLProject.createOpenFLProject([\"extension\", data.projectName], data.projectLocation, function ()\r\n\t\t{\r\n\t\t\tcreateProject(data);\r\n\t\t}\r\n\t\t);\r\n\t}\r\n\t\r\n\tprivate static function createProject(data:Dynamic):Void\r\n\t{\r\n\t\tvar pathToProject:String = js.Node.path.join(data.projectLocation, data.projectName);\r\n\t\t\t\r\n\t\tvar project:Project = new Project();\r\n\t\tproject.name = data.projectName;\r\n\t\tproject.projectPackage = data.projectPackage;\r\n\t\tproject.company = data.projectCompany;\r\n\t\tproject.license = data.projectLicense;\r\n\t\tproject.url = data.projectURL;\r\n\t\tproject.type = Project.OPENFL;\r\n\t\t//project.target = target;\r\n\t\tproject.openFLTarget = \"flash\";\r\n\t\tproject.path = pathToProject;\r\n\t\tproject.buildActionCommand = [\"haxelib\", \"run\", \"openfl\", \"build\", '\"%join%(%path%,project.xml)\"', project.openFLTarget].join(\" \");\r\n\t\tproject.runActionType = Project.COMMAND;\r\n\t\tproject.runActionText = [\"haxelib\", \"run\", \"openfl\", \"run\", '\"%join%(%path%,project.xml)\"', project.openFLTarget].join(\" \");\r\n\t\t\r\n\t\tProjectAccess.currentProject = project;\r\n\t\t\r\n\t\tOpenFLTools.getParams(project.path, project.openFLTarget, function (stdout:String)\r\n\t\t{\r\n\t\t\tvar args:Array<String> = [];\r\n\t\t\t\r\n\t\t\tvar currentLine:String;\r\n\t\t\t\r\n\t\t\tfor (line in stdout.split(\"\\n\"))\r\n\t\t\t{\r\n\t\t\t\tcurrentLine = StringTools.trim(line);\r\n\t\t\t\t\r\n\t\t\t\tif (!StringTools.startsWith(currentLine, \"#\"))\r\n\t\t\t\t{\r\n\t\t\t\t\targs.push(currentLine);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tproject.args = args;\r\n\t\t\tProjectOptions.updateProjectOptions();\r\n\t\t\t\r\n\t\t\tvar path:String = js.Node.path.join(pathToProject, \"project.json\");\r\n\t\t\tBrowser.getLocalStorage().setItem(\"pathToLastProject\", path);\r\n\t\t\t\r\n\t\t\tProjectAccess.save(function ()\r\n\t\t\t{\r\n\t\t\t\tFileTree.load(project.name, pathToProject);\r\n\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t\t);\r\n\t}\r\n\t\r\n}","package openflproject;\r\nimport js.Browser;\r\nimport js.html.TextAreaElement;\r\n\r\n/**\r\n * ...\r\n * @author AS3Boyan\r\n */\r\n@:keepSub @:expose class OpenFLTools\r\n{\t\r\n\tprivate static var processStdout:String;\r\n\tprivate static var processStderr:String;\r\n\t\r\n\tpublic static function getParams(path:String, target:String, onLoaded:Dynamic):Void\r\n\t{\r\n\t\tprocessStdout = \"\";\r\n\t\tprocessStderr = \"\";\r\n\t\t\r\n\t\tvar openFLTools:js.Node.NodeChildProcess = js.Node.child_process.exec([\"haxelib\", \"run\", \"openfl\", \"display\", target].join(\" \"), { cwd: path }, function (error, stdout, stderr)\r\n\t\t{\r\n\t\t\tprocessStdout = stdout;\r\n\t\t\tprocessStderr = stderr;\r\n\t\t}\r\n\t\t);\r\n\t\t\r\n\t\topenFLTools.on(\"close\", function (code:Int)\r\n\t\t{\r\n\t\t\ttrace('OpenFL tools process exit code ' + code);\r\n\t\t\t\r\n\t\t\tvar textarea = cast(Browser.document.getElementById(\"output\"), TextAreaElement);\r\n\t\t\ttextarea.value += \"OUTPUT: \" + processStdout;\r\n\t\t\t\r\n\t\t\tif (processStderr != \"\")\r\n\t\t\t{\r\n\t\t\t\ttextarea.value += \"ERROR: \" + processStderr;\r\n\t\t\t}\t\t\t\r\n\t\t\t\r\n\t\t\tif (code == 0)\r\n\t\t\t{\r\n\t\t\t\tif (onLoaded != null)\r\n\t\t\t\t{\r\n\t\t\t\t\tonLoaded(processStdout);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t);\r\n\t}\r\n}","package openproject;\nimport core.FileDialog;\nimport filetree.FileTree;\nimport haxe.Serializer;\nimport haxe.Unserializer;\nimport js.Browser;\nimport js.html.TextAreaElement;\nimport js.Node;\nimport openflproject.OpenFLTools;\nimport projectaccess.Project;\nimport projectaccess.ProjectAccess;\nimport projectaccess.ProjectOptions;\nimport tabmanager.TabManager;\nimport tjson.TJSON;\n\n/**\n * ...\n * @author AS3Boyan\n */\nclass OpenProject\n{\n\n\tpublic function new() \n\t{\n\t\t\n\t}\n\t\n\tpublic static function openProject(?pathToProject:String):Void\n\t{\n\t\tif (pathToProject == null)\n\t\t{\n\t\t\tFileDialog.openFile(parseProject);\n\t\t}\n\t\telse \n\t\t{\n\t\t\tcheckIfFileExists(pathToProject);\n\t\t}\n\t}\n\t\n\tprivate static function checkIfFileExists(path:String):Void\n\t{\n\t\tjs.Node.fs.exists(path, function (exists:Bool)\n\t\t{\n\t\t\tif (exists) \n\t\t\t{\n\t\t\t\tparseProject(path);\n\t\t\t}\n\t\t\telse \n\t\t\t{\n\t\t\t\ttrace(\"previously opened project: \" + path + \" was not found\");\n\t\t\t}\n\t\t}\n\t\t);\n\t}\n\t\n\tprivate static function parseProject(path:String):Void\n\t{\t\n\t\ttrace(\"open: \" + path);\n\t\t\n\t\tvar filename:String = js.Node.path.basename(path);\n\t\t\t\n\t\tswitch (filename) \n\t\t{\n\t\t\tcase \"project.json\":\n\t\t\t\tvar options:js.Node.NodeFsFileOptions = { };\n\t\t\t\toptions.encoding = js.Node.NodeC.UTF8;\n\t\t\t\t\n\t\t\t\tjs.Node.fs.readFile(path, options, function (error:js.Node.NodeErr, data:String):Void\n\t\t\t\t{\n\t\t\t\t\tvar pathToProject:String = js.Node.path.dirname(path);\n\t\t\t\t\t\n\t\t\t\t\tProjectAccess.currentProject = TJSON.parse(data);\n\t\t\t\t\tProjectAccess.currentProject.path = pathToProject;\n\t\t\t\t\t\n\t\t\t\t\tif (ProjectAccess.currentProject.type == Project.HXML) \n\t\t\t\t\t{\n\t\t\t\t\t\tTabManager.openFileInNewTab(Node.path.join(ProjectAccess.currentProject.path, ProjectAccess.currentProject.main));\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (ProjectAccess.currentProject.files == null) \n\t\t\t\t\t{\n\t\t\t\t\t\tProjectAccess.currentProject.files = [];\n\t\t\t\t\t}\n\t\t\t\t\telse \n\t\t\t\t\t{\n\t\t\t\t\t\tfor (file in ProjectAccess.currentProject.files) \n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar fullPath:String = Node.path.join(pathToProject, file);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tNode.fs.exists(fullPath, function (exists:Bool) \n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (exists) \n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tTabManager.openFileInNewTab(fullPath);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar activeFile = ProjectAccess.currentProject.activeFile;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (activeFile != null) \n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tNode.fs.exists(activeFile, function (exists:Bool)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (exists) \n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tTabManager.selectDocByPath(Node.path.join(pathToProject, activeFile));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tProjectOptions.updateProjectOptions();\n\t\t\t\t\tFileTree.load(ProjectAccess.currentProject.name, pathToProject);\n\t\t\t\t\t\n\t\t\t\t\tBrowser.getLocalStorage().setItem(\"pathToLastProject\", path);\n\t\t\t\t}\n\t\t\t\t);\n\t\t\tcase \"project.xml\", \"application.xml\":\n\t\t\t\tvar pathToProject:String = js.Node.path.dirname(path);\n\t\t\t\t\n\t\t\t\tvar project:Project = new Project();\n\t\t\t\tproject.name = pathToProject.substr(pathToProject.lastIndexOf(js.Node.path.sep));\n\t\t\t\tproject.type = Project.OPENFL;\n\t\t\t\tproject.openFLTarget = \"flash\";\n\t\t\t\tproject.path = pathToProject;\n\t\t\t\t\n\t\t\t\tOpenFLTools.getParams(pathToProject, project.openFLTarget, function (stdout:String)\n\t\t\t\t{\t\t\t\t\t\t\t\t\t\n\t\t\t\t\tvar args:Array<String> = [];\n\t\t\t\t\n\t\t\t\t\tvar currentLine:String;\n\t\t\t\t\t\n\t\t\t\t\tfor (line in stdout.split(\"\\n\"))\n\t\t\t\t\t{\n\t\t\t\t\t\tcurrentLine = StringTools.trim(line);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (!StringTools.startsWith(currentLine, \"#\"))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\targs.push(currentLine);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tproject.args = args;\n\t\t\t\t\t\n\t\t\t\t\tvar pathToProjectHide:String = js.Node.path.join(pathToProject, \"project.json\");\n\t\t\t\t\t\n\t\t\t\t\tProjectAccess.currentProject = project;\n\t\t\t\t\t\n\t\t\t\t\tProjectOptions.updateProjectOptions();\n\t\t\t\t\t\n\t\t\t\t\tProjectAccess.save(function ()\n\t\t\t\t\t{\n\t\t\t\t\t\tFileTree.load(project.name, pathToProject);\n\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\t\n\t\t\t\t\tBrowser.getLocalStorage().setItem(\"pathToLastProject\", pathToProjectHide);\n\t\t\t\t}\n\t\t\t\t);\n\t\t\tdefault:\t\t\t\t\n\t\t\t\tvar extension:String = js.Node.path.extname(filename);\n\t\t\n\t\t\t\tswitch (extension) \n\t\t\t\t{\n\t\t\t\t\tcase \".hxml\":\n\t\t\t\t\t\t//js.Node.fs.readFile(path, js.Node.NodeC.UTF8, function (error:js.Node.NodeErr, data:String)\n\t\t\t\t\t\t//{\n\t\t\t\t\t\t\tvar pathToProject:String = js.Node.path.dirname(path);\n\t\t\t\t//\n\t\t\t\t\t\t\tvar project:Project = new Project();\n\t\t\t\t\t\t\tproject.name = pathToProject.substr(pathToProject.lastIndexOf(js.Node.path.sep));\n\t\t\t\t\t\t\tproject.type = Project.HXML;\n\t\t\t\t\t\t\t//project.args = data.split(\"\\n\");\n\t\t\t\t\t\t\tproject.path = pathToProject;\n\t\t\t\t\t\t\tproject.main = Node.path.basename(path);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tProjectAccess.currentProject = project;\n\t\t\t\t\t\t\tProjectOptions.updateProjectOptions();\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar pathToProjectHide:String = js.Node.path.join(pathToProject, \"project.json\");\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tProjectAccess.save(function ()\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tFileTree.load(project.name, pathToProject);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tBrowser.getLocalStorage().setItem(\"pathToLastProject\", pathToProjectHide);\n\t\t\t\t\t\t//}\n\t\t\t\t\t\t//);\n\t\t\t\t\t//case \".hx\":\n\t\t\t\t\t\t//\n\t\t\t\t\t//case \".xml\":\n\t\t\t\t\t\t//\n\t\t\t\t\tdefault:\n\t\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tTabManager.openFileInNewTab(path);\n\t\t}\n\t}\n\t\n\tpublic static function searchForLastProject():Void\n\t{\t\t\n\t\tvar pathToLastProject:String = Browser.getLocalStorage().getItem(\"pathToLastProject\");\n\t\tif (pathToLastProject != null)\n\t\t{\n\t\t\topenProject(pathToLastProject);\n\t\t}\n\t}\n\t\n}","package openproject;\nimport haxe.Timer;\nimport menu.BootstrapMenu;\n\n/**\n * ...\n * @author AS3Boyan\n */\nclass OpenProjectLoader\n{\t\n\tpublic static function load():Void\n\t{\t\t\n\t\tBootstrapMenu.getMenu(\"File\").addMenuItem(\"Open...\", 2, OpenProject.openProject, \"Ctrl-O\");\n\t\tOpenProject.searchForLastProject();\n\t}\n\t\n}","package projectaccess;\n\n/**\n * ...\n * @author AS3Boyan\n */\n \n@:keepSub @:expose class Project\n{\n\tinline public static var HAXE:Int = 0;\n\tinline public static var OPENFL:Int = 1;\n\tinline public static var HXML:Int = 2;\n\t\n\tinline public static var FLASH:Int = 0;\n\tinline public static var JAVASCRIPT:Int = 1;\n\tinline public static var PHP:Int = 2;\n\tinline public static var CPP:Int = 3;\n\tinline public static var JAVA:Int = 4;\n\tinline public static var CSHARP:Int = 5;\n\tinline public static var NEKO:Int = 6;\n\t\n\tinline public static var URL:Int = 0;\n\tinline public static var FILE:Int = 1;\n\tinline public static var COMMAND:Int = 2;\n\t//inline public static var WEBSERVER:Int = 3;\n\t//inline public static var URL_IN_HIDE:Int = 4;\n\t\n\tpublic var type:Int;\n\tpublic var target:Int;\n\t\n\tpublic var name:String;\n\tpublic var main:String;\n\tpublic var projectPackage:String;\n\tpublic var company:String;\n\tpublic var license:String;\n\tpublic var url:String;\n\t\n\tpublic var args:Array<String>;\n\t\n\tpublic var files:Array<String>;\n\tpublic var activeFile:String;\n\t\n\tpublic var path:String;\n\t\n\tpublic var openFLTarget:String;\n\t\n\tpublic var runActionType:Int;\n\tpublic var runActionText:String;\n\tpublic var buildActionCommand:String;\n\t\n\tpublic function new() \n\t{\n\t\targs = [];\n\t\tfiles = [];\n\t}\n\t\n}","package projectaccess;\r\nimport haxe.Json;\r\nimport js.Browser;\r\nimport js.Node;\r\nimport nodejs.webkit.Window;\r\nimport tjson.TJSON;\r\n\r\n/**\r\n * ...\r\n * @author AS3Boyan\r\n */\r\n@:keepSub @:expose class ProjectAccess\r\n{\r\n\tpublic static var currentProject:Project = new Project();\r\n\t\r\n\tpublic static function registerSaveOnCloseListener():Void\r\n\t{\r\n\t\tvar window = Window.get();\r\n\t\t\r\n\t\twindow.on(\"close\", function ():Void \r\n\t\t{\r\n\t\t\tsave(null, true);\r\n\t\t\twindow.close();\r\n\t\t\t\r\n\t\t});\r\n\t}\r\n\t\r\n\tpublic static function save(?onComplete:Dynamic, ?sync:Bool = false):Void\r\n\t{\t\t\r\n\t\tif (ProjectAccess.currentProject.path != null)\r\n\t\t{\r\n\t\t\tvar pathToProjectHide:String = js.Node.path.join(ProjectAccess.currentProject.path, \"project.json\");\r\n\t\t\r\n\t\t\tvar data:String = TJSON.encode(ProjectAccess.currentProject, 'fancy');\r\n\t\t\t\r\n\t\t\tif (sync) \r\n\t\t\t{\r\n\t\t\t\tNode.fs.writeFileSync(pathToProjectHide, data, js.Node.NodeC.UTF8);\r\n\t\t\t}\r\n\t\t\telse \r\n\t\t\t{\r\n\t\t\t\tjs.Node.fs.writeFile(pathToProjectHide, data, js.Node.NodeC.UTF8, function (error:js.Node.NodeErr)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (onComplete != null)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tonComplete();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse \r\n\t\t{\r\n\t\t\ttrace(\"project path is null\");\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic static function load(path:String, ?onComplete:Dynamic):Void\r\n\t{\r\n\t\t//trace(js.Node.parse());\r\n\t}\r\n}","package projectaccess;\nimport core.Splitpane;\nimport js.Browser;\nimport js.html.DivElement;\nimport js.html.OptionElement;\nimport js.html.ParagraphElement;\nimport js.html.SelectElement;\nimport js.html.TextAreaElement;\n\n/**\n * ...\n * @author AS3Boyan\n */\n@:keepSub @:expose class ProjectOptions\n{\t\n\tprivate static var textarea:TextAreaElement;\n\tprivate static var projectTargetList:SelectElement;\n\tprivate static var projectTargetText:ParagraphElement;\n\tprivate static var projectOptionsText:ParagraphElement;\n\tprivate static var openFLTargetList:SelectElement;\n\tprivate static var openFLTargetText:ParagraphElement;\n\tprivate static var openFLTargets:Array<String>;\n\tprivate static var buildActionTextArea:TextAreaElement;\n\tprivate static var actionTextArea:TextAreaElement;\n\tprivate static var runActionList:SelectElement;\n\tprivate static var runActionTextAreaDescription:ParagraphElement;\n\tstatic private var buildActionDescription:ParagraphElement;\n\tstatic private var runActionDescription:ParagraphElement;\n\t\n\tpublic static function create():Void\n\t{\n\t\tvar page:DivElement = Browser.document.createDivElement();\n\t\t\n\t\tprojectOptionsText = Browser.document.createParagraphElement();\n\t\tprojectOptionsText.id = \"project-options-text\";\n\t\tprojectOptionsText.className = \"custom-font-size\";\n\t\tprojectOptionsText.innerText = \"Project arguments:\";\n\t\t\n\t\ttextarea = Browser.document.createTextAreaElement();\n\t\ttextarea.id = \"project-options-textarea\";\n\t\ttextarea.className = \"custom-font-size\";\n\t\ttextarea.onchange = function (e)\n\t\t{\n\t\t\tProjectAccess.currentProject.args = textarea.value.split(\"\\n\");\n\t\t\tProjectAccess.save();\n\t\t};\n\t\t\n\t\tprojectTargetText = Browser.document.createParagraphElement();\n\t\tprojectTargetText.innerText = \"Project target:\";\n\t\tprojectTargetText.className = \"custom-font-size\";\n\t\tpage.appendChild(projectTargetText);\n\t\t\n\t\tprojectTargetList = Browser.document.createSelectElement();\n\t\tprojectTargetList.id = \"project-options-project-target\";\n\t\tprojectTargetList.className = \"custom-font-size\";\n\t\tprojectTargetList.style.width = \"100%\";\n\t\t\n\t\topenFLTargetList = Browser.document.createSelectElement();\n\t\topenFLTargetList.id = \"project-options-openfl-target\";\n\t\topenFLTargetList.className = \"custom-font-size\";\n\t\topenFLTargetList.style.width = \"100%\";\n\t\t\n\t\topenFLTargetText = Browser.document.createParagraphElement();\n\t\topenFLTargetText.innerText = \"OpenFL target:\";\n\t\topenFLTargetText.className = \"custom-font-size\";\n\t\t\n\t\tfor (target in [\"Flash\", \"JavaScript\", \"Neko\", \"OpenFL\", \"PHP\", \"C++\", \"Java\", \"C#\"])\n\t\t{\n\t\t\tprojectTargetList.appendChild(createListItem(target));\n\t\t}\n\t\t\n\t\tprojectTargetList.disabled = true;\n\t\tprojectTargetList.onchange = update;\n\t\t\n\t\topenFLTargets = [\"flash\", \"html5\", \"neko\", \"android\", \"blackberry\", \"emscripten\", \"webos\", \"tizen\", \"ios\", \"windows\", \"mac\", \"linux\"];\n\t\t\n\t\tfor (target in openFLTargets)\n\t\t{\n\t\t\topenFLTargetList.appendChild(createListItem(target));\n\t\t}\n\t\t\n\t\topenFLTargetList.onchange = function (_)\n\t\t{\n\t\t\tProjectAccess.currentProject.openFLTarget = openFLTargets[openFLTargetList.selectedIndex];\n\t\t\t\n\t\t\tProjectAccess.currentProject.buildActionCommand = [\"haxelib\", \"run\", \"openfl\", \"build\", HIDE.surroundWithQuotes(js.Node.path.join(ProjectAccess.currentProject.path, \"project.xml\")), ProjectAccess.currentProject.openFLTarget].join(\" \");\n\t\t\tProjectAccess.currentProject.runActionType = Project.COMMAND;\n\t\t\tProjectAccess.currentProject.runActionText = [\"haxelib\", \"run\", \"openfl\", \"test\", HIDE.surroundWithQuotes(js.Node.path.join(ProjectAccess.currentProject.path, \"project.xml\")), ProjectAccess.currentProject.openFLTarget].join(\" \");\n\t\t\t\n\t\t\tupdateProjectOptions();\n\t\t};\n\t\t\n\t\trunActionDescription = Browser.document.createParagraphElement();\n\t\trunActionDescription.className = \"custom-font-size\";\n\t\trunActionDescription.innerText = \"Run action:\";\n\t\t\n\t\trunActionTextAreaDescription = Browser.document.createParagraphElement();\n\t\trunActionTextAreaDescription.innerText = \"URL:\";\n\t\trunActionTextAreaDescription.className = \"custom-font-size\";\n\t\t\n\t\tvar actions:Array<String> = [\"Open URL\", \"Open File\", \"Run command\"];\n\t\t\n\t\trunActionList = Browser.document.createSelectElement();\n\t\trunActionList.style.width = \"100%\";\n\t\t\n\t\trunActionList.onchange = update;\n\t\t\n\t\tfor (action in actions)\n\t\t{\n\t\t\trunActionList.appendChild(createListItem(action));\n\t\t}\n\t\t\n\t\tactionTextArea = Browser.document.createTextAreaElement();\n\t\tactionTextArea.id = \"project-options-action-textarea\";\n\t\tactionTextArea.className = \"custom-font-size\";\n\t\tactionTextArea.onchange = function (e)\n\t\t{\t\t\t\n\t\t\tProjectAccess.currentProject.runActionText = actionTextArea.value;\n\t\t\tupdate(null);\n\t\t};\n\t\t\n\t\tbuildActionDescription = Browser.document.createParagraphElement();\n\t\tbuildActionDescription.className = \"custom-font-size\";\n\t\tbuildActionDescription.innerText = \"Build command:\";\n\t\t\n\t\tbuildActionTextArea = Browser.document.createTextAreaElement();\n\t\tbuildActionTextArea.id = \"project-options-build-action-textarea\";\n\t\tbuildActionTextArea.className = \"custom-font-size\";\n\t\tbuildActionTextArea.onchange = function (e)\n\t\t{\n\t\t\tProjectAccess.currentProject.buildActionCommand = buildActionTextArea.value;\n\t\t\tProjectAccess.save();\n\t\t};\n\t\t\n\t\tpage.appendChild(projectTargetList);\n\t\tpage.appendChild(Browser.document.createBRElement());\n\t\tpage.appendChild(Browser.document.createBRElement());\n\t\tpage.appendChild(buildActionDescription);\n\t\tpage.appendChild(buildActionTextArea);\n\t\tpage.appendChild(Browser.document.createBRElement());\n\t\tpage.appendChild(Browser.document.createBRElement());\n\t\tpage.appendChild(projectOptionsText);\n\t\tpage.appendChild(textarea);\n\t\tpage.appendChild(Browser.document.createBRElement());\n\t\tpage.appendChild(openFLTargetText);\n\t\tpage.appendChild(openFLTargetList);\n\t\tpage.appendChild(Browser.document.createBRElement());\n\t\tpage.appendChild(Browser.document.createBRElement());\n\t\tpage.appendChild(runActionDescription);\n\t\tpage.appendChild(runActionList);\n\t\tpage.appendChild(Browser.document.createBRElement());\n\t\tpage.appendChild(Browser.document.createBRElement());\n\t\tpage.appendChild(runActionTextAreaDescription);\n\t\tpage.appendChild(actionTextArea);\n\t\t\n\t\tSplitpane.components[3].appendChild(page);\n\t}\n\t\n\tpublic static function getProjectArguments():String\n\t{\n\t\treturn textarea.value;\n\t}\n\t\n\tprivate static function update(_):Void\n\t{\n\t\tif (projectTargetList.selectedIndex == 3)\n\t\t{\n\t\t\topenFLTargetList.style.display = \"\";\n\t\t\topenFLTargetText.style.display = \"\";\n\t\t\ttextarea.style.display = \"none\";\n\t\t\tprojectOptionsText.style.display = \"none\";\n\t\t}\n\t\telse \n\t\t{\n\t\t\topenFLTargetList.style.display = \"none\";\n\t\t\topenFLTargetText.style.display = \"none\";\n\t\t\ttextarea.style.display = \"\";\n\t\t\tprojectOptionsText.style.display = \"\";\n\t\t}\n\t\t\n\t\tif (ProjectAccess.currentProject.type == Project.HXML) \n\t\t{\n\t\t\topenFLTargetList.style.display = \"none\";\n\t\t\topenFLTargetText.style.display = \"none\";\n\t\t\ttextarea.style.display = \"none\";\n\t\t\tprojectOptionsText.style.display = \"none\";\n\t\t\t\n\t\t\tbuildActionTextArea.style.display = \"none\";\n\t\t\tbuildActionDescription.style.display = \"none\";\n\t\t\t//runActionTextAreaDescription.style.display = \"none\";\n\t\t\t//runActionList.style.display = \"none\";\n\t\t\t//runActionDescription.style.display = \"none\";\n\t\t\tprojectTargetList.style.display = \"none\";\n\t\t\tprojectTargetText.style.display = \"none\";\n\t\t\t//actionTextArea.style.display = \"none\";\n\t\t}\n\t\telse \n\t\t{\n\t\t\tbuildActionTextArea.style.display = \"\";\n\t\t\tbuildActionDescription.style.display = \"\";\n\t\t\trunActionTextAreaDescription.style.display = \"\";\n\t\t\trunActionList.style.display = \"\";\n\t\t\trunActionDescription.style.display = \"\";\n\t\t\tprojectTargetList.style.display = \"\";\n\t\t\tprojectTargetText.style.display = \"\";\n\t\t\tactionTextArea.style.display = \"\";\n\t\t}\n\t\t\n\t\tswitch (runActionList.selectedIndex) \n\t\t{\n\t\t\tcase 0:\n\t\t\t\trunActionTextAreaDescription.innerText = \"URL: \";\n\t\t\t\tProjectAccess.currentProject.runActionType = Project.URL;\n\t\t\tcase 1:\n\t\t\t\trunActionTextAreaDescription.innerText = \"Path: \";\n\t\t\t\tProjectAccess.currentProject.runActionType = Project.FILE;\n\t\t\tcase 2:\n\t\t\t\trunActionTextAreaDescription.innerText = \"Command: \";\n\t\t\t\tProjectAccess.currentProject.runActionType = Project.COMMAND;\n\t\t\t\t\n\t\t\tdefault:\n\t\t\t\t\n\t\t}\n\t\t\n\t\tProjectAccess.save();\n\t}\n\t\n\tpublic static function updateProjectOptions():Void\n\t{\t\t\n\t\tif (ProjectAccess.currentProject.type == Project.OPENFL)\n\t\t{\n\t\t\tprojectTargetList.selectedIndex = 3;\n\t\t\t\n\t\t\tvar i:Int = Lambda.indexOf(openFLTargets, ProjectAccess.currentProject.openFLTarget);\n\t\t\tif (i != -1)\n\t\t\t{\n\t\t\t\topenFLTargetList.selectedIndex = i;\n\t\t\t}\n\t\t\telse \n\t\t\t{\n\t\t\t\topenFLTargetList.selectedIndex = 0;\n\t\t\t}\n\t\t}\n\t\telse \n\t\t{\t\t\t\n\t\t\tswitch (ProjectAccess.currentProject.target) \n\t\t\t{\n\t\t\t\tcase Project.FLASH:\n\t\t\t\t\tprojectTargetList.selectedIndex = 0;\n\t\t\t\tcase Project.JAVASCRIPT:\n\t\t\t\t\tprojectTargetList.selectedIndex = 1;\n\t\t\t\tcase Project.NEKO:\n\t\t\t\t\tprojectTargetList.selectedIndex = 2;\n\t\t\t\tcase Project.PHP:\n\t\t\t\t\tprojectTargetList.selectedIndex = 4;\n\t\t\t\tcase Project.CPP:\n\t\t\t\t\tprojectTargetList.selectedIndex = 5;\n\t\t\t\tcase Project.JAVA:\n\t\t\t\t\tprojectTargetList.selectedIndex = 6;\n\t\t\t\tcase Project.CSHARP:\n\t\t\t\t\tprojectTargetList.selectedIndex = 7;\n\t\t\t\tdefault:\n\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\ttextarea.value = ProjectAccess.currentProject.args.join(\"\\n\");\n\t\t}\n\t\t\n\t\tbuildActionTextArea.value = ProjectAccess.currentProject.buildActionCommand;\n\t\t\n\t\tswitch (ProjectAccess.currentProject.runActionType) \n\t\t{\n\t\t\tcase Project.URL:\n\t\t\t\trunActionList.selectedIndex = 0;\n\t\t\tcase Project.FILE:\n\t\t\t\trunActionList.selectedIndex = 1;\n\t\t\tcase Project.COMMAND:\n\t\t\t\trunActionList.selectedIndex = 2;\n\t\t\tdefault:\n\t\t\t\t\n\t\t}\n\t\t\n\t\tvar runActionText:String = ProjectAccess.currentProject.runActionText;\n\t\tif (runActionText == null) \n\t\t{\n\t\t\trunActionText = \"\";\n\t\t}\n\t\tactionTextArea.value = runActionText;\n\t\t\n\t\tupdate(null);\n\t}\n\t\n\tprivate static function createListItem(text:String):OptionElement\n\t{\t\t\n\t\tvar option:OptionElement = Browser.document.createOptionElement();\n\t\toption.textContent = text;\n\t\toption.value = text;\n\t\treturn option;\n\t}\n}","package tabmanager;\r\nimport cm.CMDoc;\r\nimport cm.CodeMirrorEditor;\r\nimport core.FileDialog;\r\nimport core.Splitpane;\r\nimport haxe.Timer;\r\nimport js.Browser;\r\nimport js.html.AnchorElement;\r\nimport js.html.DivElement;\r\nimport js.html.Element;\r\nimport js.html.LIElement;\r\nimport js.html.MouseEvent;\r\nimport js.html.SpanElement;\r\nimport js.html.UListElement;\r\nimport js.Node;\r\nimport projectaccess.ProjectAccess;\r\n\r\n/**\r\n * ...\r\n * @author AS3Boyan\r\n */\r\n@:keepSub @:expose class TabManager\r\n{\r\n\tpublic static var tabs:UListElement;\r\n\tpublic static var curDoc:CMDoc;\r\n\tprivate static var docs:Array<CMDoc>;\r\n\t\r\n\tprivate static var filesSavedCount:Int;\r\n\t\r\n\tpublic static function init():Void\r\n\t{\r\n\t\t//<ul class=\"tabs\" id=\"docs\" style=\"-webkit-touch-callout: none; -webkit-user-select: none; user-select: none;\"></ul>\r\n\t\t\r\n\t\ttabs = Browser.document.createUListElement();\r\n\t\ttabs.className = \"tabs no-select\";\r\n\t\t\r\n\t\ttabs.onclick = function(e):Void\r\n\t\t{\r\n\t\t\tvar target:Dynamic = e.target || e.srcElement;\r\n\t\t\tif (target.nodeName.toLowerCase() != \"li\") return;\r\n\r\n\t\t\tvar i = 0;\r\n\t\t\tvar c:Dynamic = target.parentNode.firstChild;\r\n\r\n\t\t\tif (c == target)\r\n\t\t\t{\r\n\t\t\t\treturn TabManager.selectDoc(0);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\twhile (true)\r\n\t\t\t\t{\r\n\t\t\t\t\ti++;\r\n\t\t\t\t\tc = c.nextSibling;\r\n\t\t\t\t\tif (c == target) return TabManager.selectDoc(i);\r\n\t\t\t\t}\r\n\t\t\t}                        \r\n\t\t};\r\n\t\t\r\n\t\tTabManagerContextMenu.createContextMenu();\r\n\t\t\r\n\t\tdocs = [];\r\n\t\t\r\n\t\tSplitpane.components[1].appendChild(tabs);\r\n\t}\r\n\t\r\n\tpublic static function createNewTab(name:String, path:String):Void\r\n\t{\r\n\t\tvar li:LIElement = Browser.document.createLIElement();\r\n\t\tli.title = path;\r\n\t\tli.innerText = name + \"\\t\";\r\n\t\tli.setAttribute(\"path\", path);\r\n\r\n\t\tvar span:SpanElement = Browser.document.createSpanElement();\r\n\t\tspan.style.position = \"relative\";\r\n\t\tspan.style.top = \"2px\";\r\n\r\n\t\tspan.onclick = function (e):Void\r\n\t\t{\r\n\t\t\tTabManager.closeTab(path);\r\n\t\t}\r\n\r\n\t\tvar span2:SpanElement = Browser.document.createSpanElement();\r\n\t\tspan2.className = \"glyphicon glyphicon-remove-circle\";\r\n\t\tspan.appendChild(span2);\r\n\r\n\t\tli.appendChild(span);\r\n\r\n\t\ttabs.appendChild(li);\r\n\t\t\r\n\t\tvar relativePath = Node.path.relative(ProjectAccess.currentProject.path, path);\r\n\t\t\r\n\t\tif (ProjectAccess.currentProject.files.indexOf(relativePath) == -1) \r\n\t\t{\r\n\t\t\tProjectAccess.currentProject.files.push(relativePath);\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic static function openFileInNewTab(path:String, ?show:Bool = true):Void\r\n\t{\r\n\t\t//path = js.Node.require('path').relative(js.Node.process.cwd(), path);\r\n\t\tpath = StringTools.replace(path, \"\\\\\", js.Node.path.sep); \r\n\t\t\r\n\t\tif (isAlreadyOpened(path, show))\r\n\t\t{\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tvar options:js.Node.NodeFsFileOptions = { };\r\n\t\toptions.encoding = js.Node.NodeC.UTF8;\r\n\t\t\r\n\t\tjs.Node.fs.readFile(path, options, function (error:js.Node.NodeErr, code:String):Void\r\n\t\t{\r\n\t\t\tif (error != null)\r\n\t\t\t{\r\n\t\t\t\ttrace(error);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (isAlreadyOpened(path, show))\r\n\t\t\t{\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (code != null)\r\n\t\t\t{\r\n\t\t\t\tvar mode:String = getMode(path);\r\n\t\t\t\tvar name:String = js.Node.path.basename(path);\r\n\t\t\t\t\r\n\t\t\t\tdocs.push(new CMDoc(name, new CodeMirror.Doc(code, mode), path));\r\n\t\t\t\t\r\n\t\t\t\tcreateNewTab(name, path);\r\n\t\t\t\t\r\n\t\t\t\tselectDoc(docs.length - 1);\r\n\t\t\t\t\r\n\t\t\t\tcheckTabsCount();\r\n\t\t\t}\r\n\t\t\telse \r\n\t\t\t{\r\n\t\t\t\ttrace(\"boyan.bootstrap.tab-manager: can't load file \" + path);\r\n\t\t\t}\r\n\t\t}\r\n\t\t);\r\n\t}\r\n\t\r\n\tpublic static function createFileInNewTab():Void\r\n\t{\r\n\t\tFileDialog.saveFile(function (path:String)\r\n\t\t{\t\t\t\r\n\t\t\t//var path:String = convertPathToUnixFormat(value);\r\n\t\r\n\t\t\t//if (isAlreadyOpened(path))\r\n\t\t\t//{\r\n\t\t\t\t//return;\r\n\t\t\t//}\r\n\t\t\t\r\n\t\t\tvar name:String = js.Node.path.basename(path);\r\n\t\t\tvar mode:String = getMode(name);\r\n\t\t\t\r\n\t\t\tvar code:String = \"\";\r\n\t\t\t\r\n\t\t\tif (js.Node.path.extname(name) == \".hx\")\r\n\t\t\t{\r\n\t\t\t\tpath = path.substr(0, path.length - name.length) + name.substr(0, 1).toUpperCase() + name.substr(1); // + Utils.capitalize(name)\r\n\t\t\t\t\r\n\t\t\t\tcode = \"package ;\\n\\nclass \" + js.Node.path.basename(name) + \"\\n{\\n\\n}\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdocs.push(new CMDoc(name, new CodeMirror.Doc(code, mode), path));\r\n\t\t\t\r\n\t\t\tcreateNewTab(name, path);\r\n\t\t\t\r\n\t\t\tselectDoc(docs.length - 1);\r\n\t\t\t\r\n\t\t\tcheckTabsCount();\r\n\t\t}\r\n\t\t);\r\n\t}\r\n\t\r\n\tprivate static function checkTabsCount():Void\r\n\t{\r\n\t\tif (CodeMirrorEditor.editor != null)\r\n\t\t{\t\t\t\t\r\n\t\t\tif (CodeMirrorEditor.editor.getWrapperElement().style.display == \"none\" && docs.length > 0)\r\n\t\t\t{\r\n\t\t\t\tCodeMirrorEditor.editor.getWrapperElement().style.display = \"block\";\r\n\r\n\t\t\t\tCodeMirrorEditor.editor.refresh();\r\n\t\t\t\t\r\n\t\t\t\t//Main.updateMenu();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic static function closeAll():Void\r\n\t{\r\n\t\tfor (i in 0...docs.length)\r\n\t\t{\r\n\t\t\tif (docs[i] != null)\r\n\t\t\t{\r\n\t\t\t\tcloseTab(docs[i].path, false);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif (docs.length > 0)\r\n\t\t{\r\n\t\t\tTimer.delay(function ()\r\n\t\t\t{\r\n\t\t\t\tcloseAll();\r\n\t\t\t}\r\n\t\t\t,300);\r\n\t\t}\r\n\t}\r\n        \r\n\tpublic static function closeOthers(path:String):Void\r\n\t{\t\t\r\n\t\tfor (doc in docs) \r\n\t\t{\r\n\t\t\tif (doc.path != TabManagerContextMenu.selectedDocumentPath) \r\n\t\t\t{\r\n\t\t\t\tcloseTab(path, false);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif (docs.length > 1)\r\n\t\t{\r\n\t\t\tTimer.delay(function ()\r\n\t\t\t{\r\n\t\t\t\tcloseOthers(path);\r\n\t\t\t}\r\n\t\t\t,300);\r\n\t\t}\r\n\t\telse \r\n\t\t{\r\n\t\t\tshowNextTab();\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic static function closeTab(path:String, ?switchToTab:Bool = true):Void\r\n\t{\r\n\t\tvar j:Int = -1;\r\n\t\t\r\n\t\tfor (i in 0...docs.length)\r\n\t\t{                                \r\n\t\t\tif (docs[i] != null && docs[i].path == path)\r\n\t\t\t{\r\n\t\t\t\tj = i;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif (j != -1) \r\n\t\t{\r\n\t\t\tsaveDoc(docs[j], function ()\r\n\t\t\t{\r\n\t\t\t\tdocs.splice(j, 1);\r\n\t\t\t\tcast(tabs.children.item(j), Element).remove();\r\n\t\t\t\t\r\n\t\t\t\tif (docs.length > 0)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (switchToTab)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tshowPreviousTab();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse \r\n\t\t\t\t{\r\n\t\t\t\t\tif (CodeMirrorEditor.editor != null)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tCodeMirrorEditor.editor.getWrapperElement().style.display = \"none\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tcurDoc = null;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tvar pathToDocument:String = Node.path.relative(ProjectAccess.currentProject.path, path);\r\n\t\t\t\tProjectAccess.currentProject.files.remove(pathToDocument);\r\n\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic static function closeActiveTab():Void\r\n\t{\r\n\t\tsaveActiveFile(function ()\r\n\t\t{\r\n\t\t\tcloseTab(curDoc.path);\r\n\t\t\t\r\n\t\t\t//var n = -1;\r\n\t\t//\r\n\t\t\t//if (curDoc != null)\r\n\t\t\t//{\r\n\t\t\t\t//n = Lambda.indexOf(docs, curDoc);\r\n\t\t\t//}\t\r\n\t\t\t//\r\n\t\t\t//if (n != -1)\r\n\t\t\t//{\r\n\t\t\t\t//docs.splice(n, 1);\r\n\t\t\t\t//cast(tabs.children.item(n), Element).remove();\r\n\t\t\t\t//\r\n\t\t\t\t//if (docs.length > 0)\r\n\t\t\t\t//{\r\n\t\t\t\t\t//showPreviousTab();\r\n\t\t\t\t//}\r\n\t\t\t\t//else \r\n\t\t\t\t//{\r\n\t\t\t\t\t//if (CodeMirrorEditor.editor != null)\r\n\t\t\t\t\t//{\r\n\t\t\t\t\t\t//CodeMirrorEditor.editor.getWrapperElement().style.display = \"none\";\r\n\t\t\t\t\t//}\r\n\t\t\t\t\t//\r\n\t\t\t\t\t//curDoc = null;\r\n\t\t\t\t//}\r\n\t\t\t//}\r\n\t\t}\r\n\t\t);\r\n\t}\r\n\t\r\n\tpublic static function showNextTab():Void\r\n\t{\r\n\t\tvar n = Lambda.indexOf(docs, curDoc);\r\n\t\t\r\n\t\tn++;\r\n\t\t\r\n\t\tif (n > docs.length - 1)\r\n\t\t{\r\n\t\t\tn = 0;\r\n\t\t}\r\n\t\t\r\n\t\tselectDoc(n);\r\n\t}\r\n\t\r\n\tpublic static function showPreviousTab():Void\r\n\t{\r\n\t\tvar n = Lambda.indexOf(docs, curDoc);\r\n\t\t\r\n\t\tn--;\r\n\t\t\r\n\t\tif (n < 0)\r\n\t\t{\r\n\t\t\tn = docs.length - 1;\r\n\t\t}\r\n\t\t\r\n\t\tselectDoc(n);\r\n\t}\r\n\r\n\tprivate static function isAlreadyOpened(path:String, ?show:Bool = true):Bool\r\n\t{\r\n\t\tvar opened:Bool = false;\r\n\t\t\r\n\t\tfor (i in 0...docs.length)\r\n\t\t{\r\n\t\t\tif (docs[i].path == path)\r\n\t\t\t{\t\t\t\t\r\n\t\t\t\tif (show) \r\n\t\t\t\t{\r\n\t\t\t\t\tselectDoc(i);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\topened = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn opened;\r\n\t}\r\n\t\r\n\tprivate static function getMode(path:String):String\r\n\t{\r\n\t\tvar mode:String = \"haxe\";\r\n\t\t\t\t\r\n\t\tswitch (js.Node.path.extname(path)) \r\n\t\t{\r\n\t\t\tcase \".js\":\r\n\t\t\t\t\tmode = \"javascript\";\r\n\t\t\tcase \".css\":\r\n\t\t\t\t\tmode = \"css\";\r\n\t\t\tcase \".xml\":\r\n\t\t\t\t\tmode = \"xml\";\r\n\t\t\tcase \".html\":\r\n\t\t\t\t\tmode = \"text/html\";\r\n\t\t\tcase \".md\":\r\n\t\t\t\t\tmode = \"markdown\";\r\n\t\t\tcase \".sh\", \".bat\":\r\n\t\t\t\t\tmode = \"shell\";\r\n\t\t\tcase \".ml\":\r\n\t\t\t\t\tmode = \"ocaml\";\r\n\t\t\tdefault:\r\n\t\t\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\treturn mode;\r\n\t}\r\n\t\r\n\tpublic static function selectDoc(pos:Int):Void\r\n\t{\r\n\t\tfor (i in 0...tabs.childNodes.length)\r\n\t\t{\r\n\t\t\tvar child:Element = cast(tabs.childNodes[i], Element);\r\n          \r\n\t\t\tif (pos == i)\r\n\t\t\t{\r\n\t\t\t\tchild.className = \"selected\";\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tchild.className = \"\";\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tcurDoc = docs[pos];\r\n\t\t\r\n\t\tif (ProjectAccess.currentProject.path != null) \r\n\t\t{\r\n\t\t\tProjectAccess.currentProject.activeFile = Node.path.relative(ProjectAccess.currentProject.path, curDoc.path);\r\n\t\t}\r\n\t\t\r\n\t\tCodeMirrorEditor.editor.swapDoc(curDoc.doc);\r\n\t}\r\n\t\r\n\tpublic static function selectDocByPath(path:String):Void\r\n\t{\r\n\t\tvar j = -1;\r\n\t\t\r\n\t\tfor (i in 0...docs.length) \r\n\t\t{\r\n\t\t\tif (docs[i] != null && docs[i].path == path) \r\n\t\t\t{\r\n\t\t\t\tj = i;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif (j != -1) \r\n\t\t{\r\n\t\t\tselectDoc(j);\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic static function getCurrentDocumentPath():String\r\n\t{\r\n\t\tvar path:String = null;\r\n\t\t\r\n\t\tif (curDoc != null)\r\n\t\t{\r\n\t\t\tpath = curDoc.path;\r\n\t\t}\r\n\t\t\r\n\t\treturn path;\r\n\t}\r\n\t\r\n\tpublic static function getCurrentDocument():CMDoc\r\n\t{\r\n\t\treturn curDoc;\r\n\t}\r\n\t\r\n\tpublic static function saveDoc(doc:CMDoc, ?onComplete:Dynamic):Void\r\n\t{\r\n\t\tif (doc != null)\r\n\t\t{\r\n\t\t\tNode.fs.writeFileSync(doc.path, doc.doc.getValue(), js.Node.NodeC.UTF8);\r\n\t\t\t//js.Node.fs.writeFile(doc.path, doc.doc.getValue(), js.Node.NodeC.UTF8, function (error:js.Node.NodeErr)\r\n\t\t\t//{\t\t\t\t\r\n\t\t\tif (onComplete != null)\r\n\t\t\t{\r\n\t\t\t\tonComplete();\r\n\t\t\t}\r\n\t\t\t//}\r\n\t\t\t//);\t\r\n\t\t}\t\r\n\t}\r\n\t\r\n\tpublic static function saveActiveFile(?onComplete:Dynamic):Void\r\n\t{\r\n\t\tsaveDoc(curDoc, onComplete);\r\n\t}\r\n\t\r\n\tpublic static function saveActiveFileAs():Void\r\n\t{\r\n\t\tFileDialog.saveFile(function (path:String):Void\r\n\t\t{\r\n\t\t\tcurDoc.path = path;\r\n\t\t\tsaveDoc(curDoc);\r\n\t\t}\r\n\t\t, curDoc.name);\r\n\t}\r\n\t\r\n\tpublic static function saveAll(?onComplete:Dynamic):Void\r\n\t{\t\t\r\n\t\tfilesSavedCount = 0;\r\n\t\t\r\n\t\tif (docs.length > 0)\r\n\t\t{\r\n\t\t\tfor (doc in docs)\r\n\t\t\t{\r\n\t\t\t\tif (doc != null)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (doc.doc.getValue() == \"\") \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tjs.Node.console.warn(doc.path + \" will be empty\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\ttrace(doc.path + \" file saved.\");\r\n\t\t\t\t\t\r\n\t\t\t\t\tsaveDoc(doc, function ()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfilesSavedCount++;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (filesSavedCount == docs.length)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (onComplete != null)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tonComplete();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse \r\n\t\t{\r\n\t\t\tif (onComplete != null)\r\n\t\t\t{\r\n\t\t\t\tonComplete();\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t}\r\n}","package tabmanager;\r\nimport cm.CMDoc;\r\nimport js.Browser;\r\nimport js.html.AnchorElement;\r\nimport js.html.DivElement;\r\nimport js.html.LIElement;\r\nimport js.html.MouseEvent;\r\nimport js.html.UListElement;\r\n\r\n/**\r\n * ...\r\n * @author AS3Boyan\r\n */\r\nclass TabManagerContextMenu\r\n{\r\n\tpublic static var selectedDocumentPath:String;\r\n\t\r\n\tpublic static function createContextMenu():Void\r\n\t{\r\n\t\tvar contextMenu:DivElement = Browser.document.createDivElement();\r\n\t\tcontextMenu.className = \"dropdown\";\r\n\t\tcontextMenu.style.position = \"absolute\";\r\n\t\tcontextMenu.style.display = \"none\";\r\n\t\t\r\n\t\tBrowser.document.addEventListener(\"click\", function (e:MouseEvent)\r\n\t\t{\r\n\t\t\tcontextMenu.style.display = \"none\";\r\n\t\t}\r\n\t\t);\r\n\t\t\r\n\t\tvar ul:UListElement = Browser.document.createUListElement();\r\n\t\tul.className = \"dropdown-menu\";\r\n\t\tul.style.display = \"block\";\r\n\t\t\r\n\t\tul.appendChild(createContextMenuItem(\"New File...\", TabManager.createFileInNewTab));\r\n\t\t\r\n\t\tvar li:LIElement = Browser.document.createLIElement();\r\n\t\tli.className = \"divider\";\r\n\t\t\r\n\t\tul.appendChild(li);\r\n\t\tul.appendChild(createContextMenuItem(\"Close\", function ()\r\n\t\t{\r\n\t\t\tTabManager.closeTab(contextMenu.getAttribute(\"path\"));\r\n\t\t}\r\n\t\t));\r\n\t\tul.appendChild(createContextMenuItem(\"Close All\", function ()\r\n\t\t{\r\n\t\t\tTabManager.closeAll();\r\n\t\t}\r\n\t\t));\r\n\t\t\r\n\t\tul.appendChild(createContextMenuItem(\"Close Other\", function ()\r\n\t\t{\r\n\t\t\tvar path = contextMenu.getAttribute(\"path\");\r\n\t\t\tTabManager.closeOthers(path);\r\n\t\t}\r\n\t\t));\r\n\t\t\r\n\t\tcontextMenu.appendChild(ul);\r\n\t\t\r\n\t\tBrowser.document.body.appendChild(contextMenu);\r\n\t\t\r\n\t\tTabManager.tabs.addEventListener('contextmenu', function(ev:MouseEvent) \r\n\t\t{ \r\n\t\t\tev.preventDefault();\r\n\t\t\t\r\n\t\t\tvar clickedOnTab:Bool = false;\r\n\t\t\t\r\n\t\t\tfor (li in TabManager.tabs.childNodes)\r\n\t\t\t{\r\n\t\t\t\tvar tabHeader = cast(li, LIElement);\r\n\t\t\t\t\r\n\t\t\t\tif (ev.target == li)\r\n\t\t\t\t{\r\n\t\t\t\t\tclickedOnTab = true;\r\n\t\t\t\t\tselectedDocumentPath = tabHeader.getAttribute(\"path\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (clickedOnTab)\r\n\t\t\t{\r\n\t\t\t\tvar li:LIElement = cast(ev.target, LIElement);\r\n\t\t\t\tcontextMenu.setAttribute(\"path\", li.getAttribute(\"path\"));\r\n\t\t\t\t\r\n\t\t\t\tcontextMenu.style.display = \"block\";\r\n\t\t\t\tcontextMenu.style.left = Std.string(ev.pageX) + \"px\";\r\n\t\t\t\tcontextMenu.style.top = Std.string(ev.pageY) + \"px\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t);\r\n\t}\r\n\t\r\n\tpublic static function createContextMenuItem(text:String, onClick:Dynamic):LIElement\r\n\t{\r\n\t\tvar li:LIElement = Browser.document.createLIElement();\r\n\t\tli.onclick = function (e:MouseEvent):Void\r\n\t\t{\r\n\t\t\tonClick();\r\n\t\t};\r\n\t\t\r\n\t\tvar a:AnchorElement = Browser.document.createAnchorElement();\r\n\t\ta.href = \"#\";\r\n\t\ta.textContent = text;\r\n\t\tli.appendChild(a);\r\n\t\t\r\n\t\treturn li;\r\n\t}\r\n}","package tabmanager;\r\nimport core.Hotkeys;\r\nimport filetree.FileTree;\r\nimport js.Browser;\r\nimport js.html.Element;\r\nimport js.html.UListElement;\r\nimport js.Node;\r\nimport menu.BootstrapMenu;\r\nimport nodejs.webkit.Window;\r\n\r\n/**\r\n * ...\r\n * @author AS3Boyan\r\n */\r\nclass TabManagerMain\r\n{\t\r\n\tpublic static function load():Void\r\n\t{\r\n\t\tTabManager.init();\r\n\t\t\r\n\t\tFileTree.onFileClick = TabManager.openFileInNewTab;\r\n\t\t\r\n\t\t//Ctrl-Tab\r\n\t\tHotkeys.add(\"Tab Manager->Show Next Tab\", \"Ctrl-Tab\", null, TabManager.showNextTab);\r\n\t\t\r\n\t\t//Ctrl-Shift-Tab\r\n\t\tHotkeys.add(\"Tab Manager->Show Previous Tab\", \"Ctrl-Shift-Tab\", null, TabManager.showPreviousTab);\r\n\t\t\r\n\t\t//Ctrl-N\r\n\t\tBootstrapMenu.getMenu(\"File\").addMenuItem(\"New File...\", 3, TabManager.createFileInNewTab, \"Ctrl-N\");\r\n\t\t\r\n\t\t//Ctrl-S\r\n\t\tBootstrapMenu.getMenu(\"File\").addMenuItem(\"Save\", 4, TabManager.saveActiveFile, \"Ctrl-S\");\r\n\t\t\r\n\t\t//Ctrl-Shift-S\r\n\t\tBootstrapMenu.getMenu(\"File\").addMenuItem(\"Save As...\", 5, TabManager.saveActiveFileAs, \"Ctrl-Shift-S\");\r\n\t\t\r\n\t\tBootstrapMenu.getMenu(\"File\").addMenuItem(\"Save All\", 6, TabManager.saveAll);\r\n\t\t\r\n\t\t//Ctrl-W\r\n\t\tBootstrapMenu.getMenu(\"File\").addMenuItem(\"Close File\", 7, TabManager.closeActiveTab, \"Ctrl-W\");\r\n\t\t\r\n\t\tWindow.get().on('close', TabManager.saveAll);\r\n\t\t\r\n\t\tBootstrapMenu.getMenu(\"Options\", 90).addMenuItem(\"Open hotkey configuration file\", 1, TabManager.openFileInNewTab.bind(\"hotkeys.json\"));\r\n\t}\r\n}","\npackage tjson;\nusing StringTools;\nclass TJSON {\n\n\tstatic var pos:Int;\n\tstatic var json:String;\n\tstatic var lastSymbolQuoted:Bool; //true if the last symbol was in quotes.\n\tstatic var fileName:String;\n\tstatic var currentLine:Int;\n\tstatic var floatRegex;\n\tstatic var intRegex;\n\n\tstatic var strProcessor:String->Dynamic;\n\n\t/**\n\t * Parses a JSON string into a haxe dynamic object or array.\n\t * @param String - The JSON string to parse\n\t * @param String the file name to whic the JSON code belongs. Used for generating nice error messages.\n\t */\n\tpublic static function parse(json:String, ?fileName:String=\"JSON Data\", ?stringProcessor:String->Dynamic = null):Dynamic{\n\t\tfloatRegex = ~/^-?[0-9]*\\.[0-9]+$/;\n\t\tintRegex = ~/^-?[0-9]+$/;\n\t\tTJSON.json = json;\n\t\tTJSON.fileName = fileName;\n\t\tTJSON.currentLine = 1;\n\t\tpos = 0;\n\t\tstrProcessor = (stringProcessor==null? defaultStringProcessor : stringProcessor);\n\t\t\n\t\ttry{\n\t\t\treturn doParse();\n\t\t}catch(e:String){\n\t\t\tthrow fileName+\" on line \"+currentLine+\": \"+e;\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t * Serializes a dynamic object or an array into a JSON string.\n\t * @param Dynamic - The object to be serialized\n\t * @param Dynamic - The style to use. Either an object implementing EncodeStyle interface or the strings 'fancy' or 'simple'.\n\t */\n\tpublic static function encode(obj:Dynamic, ?style:Dynamic=null):String{\n\t\tif(!Reflect.isObject(obj)){\n\t\t\tthrow(\"Provided object is not an object.\");\n\t\t}\n\t\tvar st:EncodeStyle;\n\t\tif(Std.is(style, EncodeStyle)){\n\t\t\tst = style;\n\t\t}\n\t\telse if(style == 'fancy'){\n\t\t\tst = new FancyStyle();\n\t\t}\n\t\telse st = new SimpleStyle();\n\t\tvar buffer = new StringBuf();\n\t\tif(Std.is(obj,Array) || Std.is(obj,List)) {\n\t\t\tencodeIterable(buffer, obj, st, 0);\n\t\t} else {\n\t\t\tencodeAnonymousObject(buffer, obj, st, 0);\n\t\t}\n\t\treturn buffer.toString();\n\t\t\n\t\t \n\t}\n\n\tprivate static function defaultStringProcessor(str:String):Dynamic{\n\t\treturn str;\n\t}\n\n\tprivate static function doParse():Dynamic{\n\t\t//determine if objector array\n\t\tvar s = getNextSymbol();\n\t\tif(s == '{'){\n\t\t\treturn doObject();\n\t\t}\n\n\t\tif(s == '['){\n\t\t\treturn doArray();\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate static function doObject():Dynamic{\n\t\tvar o:Dynamic = { };\n\t\tvar val:Dynamic ='';\n\t\tvar key:String;\n\t\twhile((key = getNextSymbol()) != \"\"){\n\t\t\tif(key == \",\" && !lastSymbolQuoted)continue;\n\t\t\tif(key == \"}\" && !lastSymbolQuoted){\n\n\t\t\t\treturn o;\n\t\t\t}\n\t\t\tvar seperator = getNextSymbol();\n\t\t\tif(seperator != \":\"){\n\t\t\t\tthrow(\"Expected ':' but got '\"+seperator+\"' instead.\");\n\t\t\t}\n\n\t\t\tvar v = getNextSymbol();\n\t\t\tif(v == \"{\" && !lastSymbolQuoted){\n\t\t\t\tval = doObject();\n\t\t\t}else if(v == \"[\" && !lastSymbolQuoted){\n\t\t\t\tval = doArray();\n\t\t\t}else{\n\t\t\t\tval = convertSymbolToProperType(v);\n\t\t\t}\n\t\t\tReflect.setField(o,key,val);\n\t\t}\n\t\tthrow \"Unexpected end of file. Expected '}'\";\n\t\t\n\t}\n\n\tprivate static function doArray():Dynamic{\n\t\tvar a:Array<Dynamic> = new Array<Dynamic>();\n\t\tvar val:Dynamic;\n\t\twhile((val=getNextSymbol()) != \"\"){\n\t\t\tif(val == ',' && !lastSymbolQuoted){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse if(val == ']' && !lastSymbolQuoted){\n\t\t\t\treturn a;\n\t\t\t}\n\t\t\telse if(val == \"{\" && !lastSymbolQuoted){\n\t\t\t\tval = doObject();\n\t\t\t}else if(val == \"[\" && !lastSymbolQuoted){\n\t\t\t\tval = doArray();\n\t\t\t}else{\n\t\t\t\tval = convertSymbolToProperType(val);\n\t\t\t}\n\t\t\ta.push(val);\n\t\t}\n\t\tthrow \"Unexpected end of file. Expected ']'\";\n\t}\n\n\tprivate static function convertSymbolToProperType(symbol):Dynamic{\n\t\tif(lastSymbolQuoted) return symbol; //things is quotes are always strings\n\t\tif(looksLikeFloat(symbol)){\n\t\t\treturn Std.parseFloat(symbol);\n\t\t}\n\t\tif(looksLikeInt(symbol)){\n\t\t\treturn Std.parseInt(symbol);\n\t\t}\n\t\tif(symbol.toLowerCase() == \"true\"){\n\t\t\treturn true;\n\t\t}\n\t\tif(symbol.toLowerCase() == \"false\"){\n\t\t\treturn false;\n\t\t}\n\t\treturn symbol;\n\t}\n\n\n\tprivate static function looksLikeFloat(s:String):Bool{\n\t\treturn floatRegex.match(s);\n\t}\n\n\tprivate static function looksLikeInt(s:String):Bool{\n\t\treturn intRegex.match(s);\n\t}\n\n\tprivate static function getNextSymbol(){\n\t\tlastSymbolQuoted=false;\n\t\tvar c:String = '';\n\t\tvar inQuote:Bool = false;\n\t\tvar quoteType:String=\"\";\n\t\tvar symbol:String = '';\n\t\tvar inEscape:Bool = false;\n\t\tvar inSymbol:Bool = false;\n\t\tvar inLineComment = false;\n\t\tvar inBlockComment = false;\n\n\t\twhile(pos < json.length){\n\t\t\tc = json.charAt(pos++);\n\t\t\tif(c == \"\\n\" && !inSymbol)\n\t\t\t\tcurrentLine++;\n\t\t\tif(inLineComment){\n\t\t\t\tif(c == \"\\n\" || c == \"\\r\"){\n\t\t\t\t\tinLineComment = false;\n\t\t\t\t\tpos++;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(inBlockComment){\n\t\t\t\tif(c==\"*\" && json.charAt(pos) == \"/\"){\n\t\t\t\t\tinBlockComment = false;\n\t\t\t\t\tpos++;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(inQuote){\n\t\t\t\tif(inEscape){\n\t\t\t\t\tinEscape = false;\n\t\t\t\t\tif(c==\"'\" || c=='\"'){\n\t\t\t\t\t\tsymbol += c;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif(c==\"t\"){\n\t\t\t\t\t\tsymbol += \"\\t\";\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif(c==\"n\"){\n\t\t\t\t\t\tsymbol += \"\\n\";\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif(c==\"\\\\\"){\n\t\t\t\t\t\tsymbol += \"\\\\\";\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif(c==\"r\"){\n\t\t\t\t\t\tsymbol += \"\\r\";\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif(c==\"/\"){\n\t\t\t\t\t\tsymbol += \"/\";\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tthrow \"Invalid escape sequence '\\\\\"+c+\"'\";\n\t\t\t\t}else{\n\t\t\t\t\tif(c == \"\\\\\"){\n\t\t\t\t\t\tinEscape = true;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif(c == quoteType){\n\t\t\t\t\t\treturn symbol;\n\t\t\t\t\t}\n\t\t\t\t\tsymbol+=c;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\n\t\t\t//handle comments\n\t\t\telse if(c == \"/\"){\n\t\t\t\tvar c2 = json.charAt(pos);\n\t\t\t\t//handle single line comments.\n\t\t\t\t//These can even interrupt a symbol.\n\t\t\t\tif(c2 == \"/\"){\n\t\t\t\t\tinLineComment=true;\n\t\t\t\t\tpos++;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t//handle block comments.\n\t\t\t\t//These can even interrupt a symbol.\n\t\t\t\telse if(c2 == \"*\"){\n\t\t\t\t\tinBlockComment=true;\n\t\t\t\t\tpos++;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t\n\n\t\t\tif (inSymbol){\n\t\t\t\tif(c==' ' || c==\"\\n\" || c==\"\\r\" || c==\"\\t\" || c==',' || c==\":\" || c==\"}\" || c==\"]\"){ //end of symbol, return it\n\t\t\t\t\tpos--;\n\t\t\t\t\treturn symbol;\n\t\t\t\t}else{\n\t\t\t\t\tsymbol+=c;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif(c==' ' || c==\"\\t\" || c==\"\\n\" || c==\"\\r\"){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif(c==\"{\" || c==\"}\" || c==\"[\" || c==\"]\" || c==\",\" || c == \":\"){\n\t\t\t\t\treturn c;\n\t\t\t\t}\n\n\n\n\t\t\t\tif(c==\"'\" || c=='\"'){\n\t\t\t\t\tinQuote = true;\n\t\t\t\t\tquoteType = c;\n\t\t\t\t\tlastSymbolQuoted = true;\n\t\t\t\t\tcontinue;\n\t\t\t\t}else{\n\t\t\t\t\tinSymbol=true;\n\t\t\t\t\tsymbol = c;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\n\t\t\t}\n\t\t} // end of while. We have reached EOF if we are here.\n\t\tif(inQuote){\n\t\t\tthrow \"Unexpected end of data. Expected ( \"+quoteType+\" )\";\n\t\t}\n\t\treturn symbol;\n\t}\n\n\tprivate static function encodeAnonymousObject(buffer:StringBuf, obj:Dynamic,style:EncodeStyle,depth:Int):Void {\n\t\tbuffer.add(style.beginObject(depth));\n\t\tvar fieldCount = 0;\n\t\tfor (field in Reflect.fields(obj)){\n\t\t\tif(fieldCount++ > 0) buffer.add(style.entrySeperator(depth));\n\t\t\telse buffer.add(style.firstEntry(depth));\n\t\t\tvar value:Dynamic = Reflect.field(obj,field);\n\t\t\tbuffer.add('\"'+field+'\"'+style.keyValueSeperator(depth));\n\t\t\tencodeValue(buffer, value, style, depth);\n\t\t}\n\t\tbuffer.add(style.endObject(depth));\n\t}\n\n\tprivate static function encodeIterable(buffer:StringBuf, obj:Iterable<Dynamic>, style:EncodeStyle, depth:Int):Void {\n\t\tbuffer.add(style.beginArray(depth));\n\t\tvar fieldCount = 0;\n\t\tfor (value in obj){\n\t\t\tif(fieldCount++ >0) buffer.add(style.entrySeperator(depth));\n\t\t\telse buffer.add(style.firstEntry(depth));\n\t\t\tencodeValue(buffer, value, style, depth);\n\t\t\t\n\t\t}\n\t\tbuffer.add(style.endArray(depth));\n\t}\n\n\tprivate static function encodeValue(buffer:StringBuf, value:Dynamic, style:EncodeStyle, depth:Int):Void {\n\t\tif(Std.is(value, Int) || Std.is(value,Float)){\n\t\t\t\tbuffer.add(value);\n\t\t}\n\t\telse if(Std.is(value,Array) || Std.is(value,List)){\n\t\t\tvar v: Array<Dynamic> = value;\n\t\t\tencodeIterable(buffer,v,style,depth+1);\n\t\t}\n\t\telse if(Std.is(value,List)){\n\t\t\tvar v: List<Dynamic> = value;\n\t\t\tencodeIterable(buffer,v,style,depth+1);\n\t\t}\n\t\telse if(Std.is(value,String)){\n\t\t\tbuffer.add('\"'+Std.string(value).replace(\"\\\\\",\"\\\\\\\\\").replace(\"\\n\",\"\\\\n\").replace(\"\\r\",\"\\\\r\").replace('\"','\\\\\"')+'\"');\n\t\t}\n\t\telse if(Std.is(value,Bool)){\n\t\t\tbuffer.add(value);\n\t\t}\n\t\telse if(Reflect.isObject(value)){\n\t\t\tencodeAnonymousObject(buffer,value,style,depth+1);\n\t\t}\n\t\telse{\n\t\t\tthrow \"Unsupported field type: \"+Std.string(value);\n\t\t}\n\t}\n\n\t\n\n\n}\n\n\n\ninterface EncodeStyle{\n\t\n\tpublic function beginObject(depth:Int):String;\n\tpublic function endObject(depth:Int):String;\n\tpublic function beginArray(depth:Int):String;\n\tpublic function endArray(depth:Int):String;\n\tpublic function firstEntry(depth:Int):String;\n\tpublic function entrySeperator(depth:Int):String;\n\tpublic function keyValueSeperator(depth:Int):String;\n\n}\n\nclass SimpleStyle implements EncodeStyle{\n\tpublic function new(){\n\n\t}\n\tpublic function beginObject(depth:Int):String{\n\t\treturn \"{\";\n\t}\n\tpublic function endObject(depth:Int):String{\n\t\treturn \"}\";\n\t}\n\tpublic function beginArray(depth:Int):String{\n\t\treturn \"[\";\n\t}\n\tpublic function endArray(depth:Int):String{\n\t\treturn \"]\";\n\t}\n\tpublic function firstEntry(depth:Int):String{\n\t\treturn \"\";\n\t}\n\tpublic function entrySeperator(depth:Int):String{\n\t\treturn \",\";\n\t}\n\tpublic function keyValueSeperator(depth:Int):String{\n\t\treturn \":\";\n\t}\n\t\n}\n\n\nclass FancyStyle implements EncodeStyle{\n\tpublic var tab(default, null):String;\n\tpublic function new(tab:String = \"    \"){\n\t\tthis.tab = tab;\n\t\tcharTimesNCache = [\"\"];\n\t}\n\tpublic function beginObject(depth:Int):String{\n\t\treturn \"{\\n\";\n\t}\n\tpublic function endObject(depth:Int):String{\n\t\treturn \"\\n\"+charTimesN(depth)+\"}\";\n\t}\n\tpublic function beginArray(depth:Int):String{\n\t\treturn \"[\\n\";\n\t}\n\tpublic function endArray(depth:Int):String{\n\t\treturn \"\\n\"+charTimesN(depth)+\"]\";\n\t}\n\tpublic function firstEntry(depth:Int):String{\n\t\treturn charTimesN(depth+1)+' ';\n\t}\n\tpublic function entrySeperator(depth:Int):String{\n\t\treturn \"\\n\"+charTimesN(depth+1)+\",\";\n\t}\n\tpublic function keyValueSeperator(depth:Int):String{\n\t\treturn \" : \";\n\t}\n\tprivate var charTimesNCache:Array<String>;\n\tprivate function charTimesN(n:Int):String{\n\t\treturn if (n < charTimesNCache.length) {\n\t\t\tcharTimesNCache[n];\n\t\t} else {\n\t\t\tcharTimesNCache[n] = charTimesN(n-1) + tab;\n\t\t}\n\t}\n\t\n}\n\n\n\n\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n/**\n\tThis class defines mathematical functions and constants.\n**/\n#if cpp @:include(\"hxMath\") #end\nextern class Math\n{\n\tstatic var PI(default,null) : Float;\n\n\t/**\n\t\tA special Float constant which denotes negative infinity.\n\n\t\tFor example, this is the result of -1.0 / 0.0.\n\n\t\tOperations with NEGATIVE_INFINITY as an operand may result in\n\t\tOperations with NEGATIVE_INFINITY as an operand may result in\n\t\tNEGATIVE_INFINITY, POSITIVE_INFINITY or NaN. For detailed information,\n\t\tsee ...\n\n\t\tIf this constant is converted to an Int, e.g. through Std.int(), the\n\t\tresult is unspecified.\n\t**/\n\tstatic var NEGATIVE_INFINITY(default, null) : Float;\n\t/**\n\t\tA special Float constant which denotes negative infinity.\n\n\t\tFor example, this is the result of 1.0 / 0.0.\n\n\t\tOperations with POSITIVE_INFINITY as an operand may result in\n\t\tNEGATIVE_INFINITY, POSITIVE_INFINITY or NaN. For detailed information,\n\t\tsee ...\n\n\t\tIf this constant is converted to an Int, e.g. through Std.int(), the\n\t\tresult is unspecified.\n\t**/\n\tstatic var POSITIVE_INFINITY(default,null) : Float;\n\n\t/**\n\t\tA special Float constant which denotes an invalid number.\n\n\t\tNaN stands for \"Not a Number\". It occurs when a mathematically incorrect\n\t\toperation is executed, such as taking the square root of a negative\n\t\tnumber: Math.sqrt(-1).\n\n\t\tAll further operations with NaN as an operand will result in NaN.\n\n\t\tIf this constant is converted to an Int, e.g. through Std.int(), the\n\t\tresult is unspecified.\n\n\t\tIn order to test if a value is NaN, you should use Math.isNaN() function.\n\n\t\t(Php) In PHP versions prior to 5.3.1 VC 9 there may be unexpected\n\t\tresults when performing arithmetic operations with NaN on Windows, see:\n\t\t\thttps://bugs.php.net/bug.php?id=42143\n\t**/\n\tstatic var NaN(default, null) : Float;\n\n\t/**\n\t\tReturns the absolute value of `v`.\n\n\t\tIf `v` is positive or 0, the result is unchanged. Otherwise the result\n\t\tis -`v`.\n\n\t\tIf `v` is NEGATIVE_INFINITY or POSITIVE_INFINITY, the result is\n\t\tPOSITIVE_INFINITY.\n\n\t\tIf `v` is NaN, the result is NaN.\n\t**/\n\tstatic function abs(v:Float):Float;\n\n\t/**\n\t\tReturns the smaller of values `a` and `b`.\n\n\t\tIf `a` or `b` are NaN, the result is NaN.\n\n\t\tIf `a` or `b` are NEGATIVE_INFINITY, the result is NEGATIVE_INFINITY.\n\n\t\tIf `a` and `b` are POSITIVE_INFINITY, the result is POSITIVE_INFINITY.\n\t**/\n\tstatic function min(a:Float, b:Float):Float;\n\n\t/**\n\t\tReturns the greater of values `a` and `b`.\n\n\t\tIf `a` or `b` are NaN, the result is NaN.\n\n\t\tIf `a` or `b` are POSITIVE_INFINITY, the result is POSITIVE_INFINITY.\n\n\t\tIf `a` and `b` are NEGATIVE_INFINITY, the result is NEGATIVE_INFINITY.\n\t**/\n\tstatic function max(a:Float, b:Float):Float;\n\n\t/**\n\t\tReturns the trigonometric sine of `v`.\n\n\t\tThe unit of `v` is radians.\n\n\t\tIf `v` is NaN or infinite, the result is NaN.\n\t**/\n\tstatic function sin(v:Float):Float;\n\n\t/**\n\t\tReturns the trigonometric cosine of `v`.\n\n\t\tThe unit of `v` is radians.\n\n\t\tIf `v` is NaN or infinite, the result is NaN.\n\t**/\n\tstatic function cos(v:Float):Float;\n\n\t// TODO\n\tstatic function tan(v:Float):Float;\n\tstatic function asin(v:Float):Float;\n\tstatic function acos(v:Float):Float;\n\tstatic function atan(v:Float):Float;\n\tstatic function atan2(y:Float, x:Float):Float;\n\n\t/**\n\t\tReturns Euler's number, raised to the power of `v`.\n\n\t\texp(1.0) is approximately 2.718281828459.\n\n\t\tIf `v` is POSITIVE_INFINITY, the result is POSITIVE_INFINITY.\n\n\t\tIf `v` is NEGATIVE_INFINITY, the result is 0.0.\n\n\t\tIf `v` is NaN, the result is NaN.\n\t**/\n\tstatic function exp(v:Float):Float;\n\n\t/**\n\t\tReturns the natural logarithm of `v`.\n\n\t\tIf `v` is negative (including NEGATIVE_INFINITY) or NaN, the result is\n\t\tNaN.\n\n\t\tIf `v` is POSITIVE_INFINITY, the result is POSITIVE_INFINITY.\n\n\t\tIf `v` is 0.0, the result is NEGATIVE_INFINITY.\n\n\t\tThis is the inverse operation of exp, i.e. log(exp(v)) == v always\n\t\tholds.\n\t**/\n\tstatic function log(v:Float):Float;\n\n\t// TODO\n\t// http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Math.html#pow(double, double) <-- wtf?\n\tstatic function pow(v:Float, exp:Float):Float;\n\n\t/**\n\t\tReturns the square root of `v`.\n\n\t\tIf `v` is negative (including NEGATIVE_INFINITY) or NaN, the result is\n\t\tNaN.\n\n\t\tIf `v` is POSITIVE_INFINITY, the result is POSITIVE_INFINITY.\n\n\t\tIf `v` is 0.0, the result is 0.0.\n\t**/\n\tstatic function sqrt(v:Float):Float;\n\n\t/**\n\t\tRounds `v` to the nearest Int value.\n\n\t\tIf v is outside of the signed Int32 range, or is NaN, NEGATIVE_INFINITY or POSITIVE_INFINITY, the result is unspecified.\n\n\t\tTODO: need spec\n\t**/\n\tstatic function round(v:Float):Int;\n\n\t/**\n\t\tReturns the largest Int value that is not greater than `v`.\n\n\t\tIf v is outside of the signed Int32 range, or is NaN, NEGATIVE_INFINITY or POSITIVE_INFINITY, the result is unspecified.\n\n\t\tTODO: need spec\n\t**/\n\tstatic function floor(v:Float):Int;\n\n\t/**\n\t\tReturns the smallest Int value that is not less than `v`.\n\n\t\tIf v is outside of the signed Int32 range, or is NaN, NEGATIVE_INFINITY or POSITIVE_INFINITY, the result is unspecified.\n\n\t\tTODO: need spec\n\t**/\n\tstatic function ceil(v:Float):Int;\n\n\t/**\n\t\tReturns a pseudo-random number which is greater than or equal to 0.0,\n\t\tand less than 1.0.\n\t**/\n\tstatic function random() : Float;\n\n\t#if ((flash9 && !as3) || cpp)\n\n\tstatic function ffloor( v : Float ) : Float;\n\tstatic function fceil( v : Float ) : Float;\n\tstatic function fround( v : Float ) : Float;\n\n\t#else\n\n\tstatic inline function ffloor( v : Float ) : Float {\n\t\treturn floor(v);\n\t}\n\n\tstatic inline function fceil( v : Float ) : Float {\n\t\treturn ceil(v);\n\t}\n\n\tstatic inline function fround( v : Float ) : Float {\n\t\treturn round(v);\n\t}\n\n\t#end\n\n\n\t/**\n\t\tTells if `f` is a finite number.\n\n\t\tIf `f` is POSITIVE_INFINITY, NEGATIVE_INFINITY or NaN, the result is\n\t\tfalse.\n\n\t\tOtherwise the result is true.\n\t**/\n\tstatic function isFinite( f : Float ) : Bool;\n\n\t/**\n\t\tTells if `f` is not a valid number.\n\n\t\tIf `f` is NaN, the result is true.\n\n\t\tOtherwise the result is false. In particular, both POSITIVE_INFINITY and\n\t\tNEGATIVE_INFINITY are not considered NaN.\n\t**/\n\tstatic function isNaN( f : Float ) : Bool;\n\n\tprivate static function __init__() : Void untyped {\n\t#if flash9\n\t\tNaN = __global__[\"Number\"].NaN;\n\t\tNEGATIVE_INFINITY = __global__[\"Number\"].NEGATIVE_INFINITY;\n\t\tPOSITIVE_INFINITY = __global__[\"Number\"].POSITIVE_INFINITY;\n\t#else\n\t\t#if !js // genjs.ml will insert this only if necessary.\n\t\t\tMath.__name__ = [\"Math\"];\n\t\t#end\n\t\tMath.NaN = Number[\"NaN\"];\n\t\tMath.NEGATIVE_INFINITY = Number[\"NEGATIVE_INFINITY\"];\n\t\tMath.POSITIVE_INFINITY = Number[\"POSITIVE_INFINITY\"];\n\t#end\n\t#if js\n\t\t__feature__(\"Type.resolveClass\",$hxClasses['Math'] = Math);\n\t#end\n\t\tMath.isFinite = function(i) {\n\t\t\treturn\n\t\t\t#if flash9\n\t\t\t__global__[\"isFinite\"](i);\n\t\t\t#elseif flash\n\t\t\t_global[\"isFinite\"](i);\n\t\t\t#elseif js\n\t\t\t__js__(\"isFinite\")(i);\n\t\t\t#else\n\t\t\tfalse;\n\t\t\t#end\n\t\t};\n\t\tMath.isNaN = function(i) {\n\t\t\treturn\n\t\t\t#if flash9\n\t\t\t__global__[\"isNaN\"](i);\n\t\t\t#elseif flash\n\t\t\t_global[\"isNaN\"](i);\n\t\t\t#elseif js\n\t\t\t__js__(\"isNaN\")(i);\n\t\t\t#else\n\t\t\tfalse;\n\t\t\t#end\n\t\t};\n\t}\n\n}\n\n\n","package nodejs.webkit;\r\n\r\n@:native('nodejs.webkit.$ui')\r\nclass UI {\r\n\t\r\n\tstatic function __init__() : Void untyped {\r\n\t\t__js__(\"nodejs.webkit.$ui = require('nw.gui')\");\r\n\t}\r\n}\r\n","package nodejs.webkit;\r\n\r\nextern class Window {\r\n\tpublic var window : js.html.DOMWindow;\r\n\tpublic var x : Int;\r\n\tpublic var y : Int;\r\n\tpublic var width : Int;\r\n\tpublic var height : Int;\r\n\tpublic var title : String;\r\n\tpublic var isFullScreen : Bool;\r\n\tpublic var isKioskMode : Bool;\r\n\tpublic var zoomLevel : Int;\r\n\tpublic var menu : Menu;\r\n\tpublic function moveTo( x : Int, y : Int ) : Void;\r\n\tpublic function moveBy( x : Int, y : Int ) : Void;\r\n\tpublic function resizeTo( w : Int, h : Int ) : Void;\r\n\tpublic function resizeBy( w : Int, h : Int ) : Void;\r\n\tpublic function focus() : Void;\r\n\tpublic function blur() : Void;\r\n\tpublic function show() : Void;\r\n\tpublic function hide() : Void;\r\n\tpublic function close( ?force : Bool ) : Void;\r\n\tpublic function reload() : Void;\r\n\tpublic function reloadIgnoringCache() : Void;\r\n\tpublic function maximize() : Void;\r\n\tpublic function unmaximize() : Void;\r\n\tpublic function minimize() : Void;\r\n\tpublic function restore() : Void;\r\n\tpublic function enterFullscreen() : Void;\r\n\tpublic function leavFullscreen() : Void;\r\n\tpublic function showDevTools( ?id : String, ?headless : Bool ) : Void;\r\n\tpublic function closeDevTools() : Void;\r\n\tpublic function toggleFullscreen() : Void;\r\n\t\r\n\t@:overload(function( event : String, callb : Dynamic -> Dynamic ) : Void {})\r\n\t@:overload(function( event : String, callb : Void -> Dynamic ) : Void {})\r\n\t@:overload(function( event : String, callb : Dynamic -> Void ) : Void {})\r\n\tpublic function on( event : String, callb : Void -> Void ) : Void;\r\n\t\r\n\tpublic static function get() : Window;\r\n\tpublic static function open( url : String, ?options : { } ) : Window;\r\n\t\r\n\tstatic function __init__() : Void untyped {\r\n\t\tWindow = UI.Window;\r\n\t}\r\n}\r\n","/* Same license as Node.js\r\n\r\n\tMaintainer: Dion Amago, dion@transition9.com\r\n\r\n\tCopied from Ritchie Turner's (blackdog@cloudshift.cl) repo due to a lack of contact with Ritchie and a desire to\r\n\tkeep node.js libraries updated\r\n\r\n\tFrom Ritchie's docs:\r\n\t\"Node.js 0.8 api without haXe embellishments so that other apis may be implemented\r\n\ton top without being hindered by design choices here.\r\n\tDomain not added.\"\r\n*/\r\n\r\npackage js;\r\n\r\ntypedef NodeListener = Dynamic;\r\ntypedef NodeErr = Null<String>;\r\n\r\n/*\r\n\t emits: newListener\r\n */\r\ntypedef NodeEventEmitter = {\r\n\tfunction addListener(event:String,fn:NodeListener):Dynamic;\r\n\tfunction on(event:String,fn:NodeListener):Dynamic;\r\n\tfunction once(event:String,fn:NodeListener):Void;\r\n\tfunction removeListener(event:String,listener:NodeListener):Void;\r\n\tfunction removeAllListeners(event:String):Void;\r\n\tfunction listeners(event:String):Array<NodeListener>;\r\n\tfunction setMaxListeners(m:Int):Void;\r\n\tfunction emit(event:String,?arg1:Dynamic,?arg2:Dynamic,?arg3:Dynamic):Void;\r\n}\r\n\r\ntypedef NodeWatchOpt = {\r\n\t@:optional\r\n\tvar persistent:Bool;\r\n\t@:optional\r\n\tvar interval:Int;\r\n};\r\n\r\ntypedef NodeExecOpt = {\r\n\tvar encoding:String;\r\n\tvar timeout:Int;\r\n\tvar maxBuffer:Int;\r\n\tvar killSignal:String;\r\n\tvar env:Dynamic;\r\n\tvar cwd:String;\r\n}\r\n\r\ntypedef NodeSpawnOpt = {\r\n\tvar cwd:String;\r\n\tvar env:Dynamic;\r\n\tvar customFds:Array<Int>;\r\n\tvar setsid:Bool;\r\n}\r\n\r\n/* note:can't spec multiple optional args, so adding an arbitrary 3 */\r\ntypedef NodeConsole = {\r\n\tfunction log(s:String,?a1:Dynamic,?a2:Dynamic,?a3:Dynamic):Void;\r\n\tfunction info(s:String,?a1:Dynamic,?a2:Dynamic,?a3:Dynamic):Void;\r\n\tfunction warn(s:String,?a1:Dynamic,?a2:Dynamic,?a3:Dynamic):Void;\r\n\tfunction error(s:String,?a1:Dynamic,?a2:Dynamic,?a3:Dynamic):Void;\r\n\tfunction time(label:String):Void;\r\n\tfunction timeEnd(label:String):Void;\r\n\tfunction dir(obj:Dynamic):Void;\r\n\tfunction trace():Void;\r\n\tfunction assert():Void;\r\n}\r\n\r\ntypedef NodePath = {\r\n\tfunction join(?p1:String,?p2:String,?p3:String):String;\r\n\tfunction normalize(p:String):String;\r\n\tfunction resolve(?from:Array<String>,to:String):String;\r\n\tfunction dirname(p:String):String;\r\n\tfunction basename(p:String,?ext:String):String;\r\n\tfunction extname(p:String):String;\r\n\tfunction relative(?p1:String,?p2:String,?p3:String):String;\r\n\tvar sep :String;\r\n\tvar delimiter :String;\r\n}\r\n\r\ntypedef NodeUrlObj = {\r\n\tvar href:String;\r\n\tvar host:String;\r\n\tvar protocol:String;\r\n\tvar auth:String;\r\n\tvar hostname:String;\r\n\tvar port:String;\r\n\tvar pathname:String;\r\n\tvar search:String;\r\n\tvar query:Dynamic;\r\n\tvar hash:String;\r\n}\r\n\r\ntypedef NodeUrl = {\r\n\tfunction parse(p:String,?andQueryString:Bool):NodeUrlObj;\r\n\tfunction format(o:NodeUrlObj):String;\r\n\tfunction resolve(from:Array<String>,to:String):String;\r\n}\r\n\r\ntypedef NodeQueryString = {\r\n\tfunction parse(s:String,?sep:String,?eq:String,?options:{maxKeys:Int}):Dynamic;\r\n\tfunction escape(s:String):String;\r\n\tfunction unescape(s:String):String;\r\n\tfunction stringify(obj:Dynamic,?sep:String,?eq:String):String;\r\n}\r\n\r\n@:native(\"Buffer\") extern class NodeBuffer implements ArrayAccess<Int> {\r\n\r\n\t@:overload(function(str:String,?enc:String):Void {})\r\n\t@:overload(function(arr:Array<Int>):Void {})\r\n\tfunction new(size:Int):Void;\r\n\r\n\tvar length(default,null) : Int;\r\n\tvar INSPECT_MAX_BYTES:Int;\r\n\r\n\tfunction copy(targetBuffer:NodeBuffer,targetStart:Int,sourceStart:Int,sourceEnd:Int):Void;\r\n\tfunction slice(start:Int,end:Int):NodeBuffer;\r\n\tfunction write(s:String,?offset:Int,?length:Int,?enc:String):Int;\r\n\tfunction toString(enc:String,?start:Int,?end:Int):String;\r\n\tfunction fill(value:Float,offset:Int,?end:Int):Void;\r\n\tstatic function isBuffer(o:Dynamic):Bool;\r\n\tstatic function byteLength(s:String,?enc:String):Int;\r\n\tstatic function concat(list:Array<NodeBuffer>, ?totalLength:Float):NodeBuffer;\r\n\r\n\tfunction readUInt8(offset:Int,?noAssert:Bool):Int;\r\n\tfunction readUInt16LE(offset:Int,?noAssert:Bool):Int;\r\n\tfunction readUInt16BE(offset:Int,?noAssert:Bool):Int;\r\n\tfunction readUInt32LE(offset:Int,?noAssert:Bool):Int;\r\n\tfunction readUInt32BE(offset:Int,?noAssert:Bool):Int;\r\n\r\n\tfunction readInt8(offset:Int,?noAssert:Bool):Int;\r\n\tfunction readInt16LE(offset:Int,?noAssert:Bool):Int;\r\n\tfunction readInt16BE(offset:Int,?noAssert:Bool):Int;\r\n\tfunction readInt32LE(offset:Int,?noAssert:Bool):Int;\r\n\tfunction readInt32BE(offset:Int,?noAssert:Bool):Int;\r\n\r\n\tfunction readFloatLE(offset:Int,?noAssert:Bool):Float;\r\n\tfunction readFloatBE(offset:Int,?noAssert:Bool):Float;\r\n\tfunction readDoubleLE(offset:Int,?noAssert:Bool):Float; // is this right?\r\n\tfunction readDoubleBE(offset:Int,?noAssert:Bool):Float; // is this right?\r\n\r\n\tfunction writeUInt8(value:Int,offset:Int,?noAssert:Bool):Void;\r\n\tfunction writeUInt16LE(value:Int,offset:Int,?noAssert:Bool):Void;\r\n\tfunction writeUInt16BE(value:Int,offset:Int,?noAssert:Bool):Void;\r\n\tfunction writeUInt32LE(value:Int,offset:Int,?noAssert:Bool):Void;\r\n\tfunction writeUInt32BE(value:Int,offset:Int,?noAssert:Bool):Void;\r\n\r\n\tfunction writeInt8(value:Int,offset:Int,?noAssert:Bool):Void;\r\n\tfunction writeInt16LE(value:Int,offset:Int,?noAssert:Bool):Void;\r\n\tfunction writeInt16BE(value:Int,offset:Int,?noAssert:Bool):Void;\r\n\tfunction writeInt32LE(value:Int,offset:Int,?noAssert:Bool):Void;\r\n\tfunction writeInt32BE(value:Int,offset:Int,?noAssert:Bool):Void;\r\n\r\n\tfunction writeFloatLE(value:Float,offset:Int,?noAssert:Bool):Void;\r\n\tfunction writeFloatBE(value:Float,offset:Int,?noAssert:Bool):Void;\r\n\tfunction writeDoubleLE(value:Float,offset:Int,?noAssert:Bool):Void; // is this right?\r\n\tfunction writeDoubleBE(value:Float,offset:Int,?noAssert:Bool):Void; // is this right?\r\n}\r\n\r\ntypedef NodeScript = {\r\n\tfunction runInThisContext():Dynamic;\r\n\tfunction runInNewContext(?sandbox:Dynamic):Void;\r\n}\r\n\r\ntypedef NodeVM = {\r\n\tfunction runInThisContext(code:String,?fileName:String):Dynamic;\r\n\tfunction runInNewContext(?sandbox:Dynamic):Void;\r\n\tfunction createScript(code:Dynamic,?fileName:String):NodeScript;\r\n}\r\n\r\ntypedef ReadStreamOpt = {\r\n\tflags:String,\r\n\tencoding:String,\r\n\tfd:Null<Int>,\r\n\tmode:Int,\r\n\tbufferSize:Int,\r\n\t?start:Int,\r\n\t?end:Int\r\n}\r\n\r\ntypedef WriteStreamOpt = {\r\n\tvar flags:String;\r\n\tvar encoding:String;\r\n\tvar mode:Int;\r\n}\r\n\r\n/*\r\n\t Emits:\r\n\t data,end,error,close\r\n*/\r\ntypedef NodeReadStream = { > NodeEventEmitter,\r\n\tvar readable:Bool;\r\n\tfunction pause():Void;\r\n\tfunction resume():Void;\r\n\tfunction destroy():Void;\r\n\tfunction destroySoon():Void;\r\n\tfunction setEncoding(enc:String):Void;\r\n\tfunction pipe(dest:NodeWriteStream,?opts:{end:Bool}):Void;\r\n}\r\n\r\n/*\r\n\t Emits:\r\n\t drain,error,close,pipe\r\n*/\r\ntypedef NodeWriteStream = { > NodeEventEmitter,\r\n\tvar writeable:Bool;\r\n\t@:overload(function(chunk:NodeBuffer):Bool {})\r\n\tfunction write(d:String,?enc:String,?fd:Int):Bool;\r\n\t@:overload(function(b:NodeBuffer):Void {})\r\n\tfunction end(?s:String,?enc:String):Void;\r\n\tfunction destroy():Void;\r\n\tfunction destroySoon():Void;\r\n}\r\n\r\ntypedef NodeNetworkInterface = {\r\n\tvar address :String;\r\n\tvar family :String;\r\n\tvar internal :Bool;\r\n}\r\n\r\ntypedef NodeOs = {\r\n\tfunction hostname():String;\r\n\tfunction type():String;\r\n\tfunction release():String;\r\n\tfunction uptime():Int;\r\n\tfunction loadavg():Array<Float>;\r\n\tfunction totalmem():Int;\r\n\tfunction freemem():Int;\r\n\tfunction cpus():Int;\r\n\tfunction platform():String;\r\n\tfunction arch():String;\r\n\tfunction networkInterfaces():Dynamic;\r\n}\r\n\r\n\r\ntypedef NodeJsDate = {\r\n\t\tfunction getTime():Int;\r\n\t\tfunction toDateString():String;\r\n\t\tfunction toUTCString():String;\r\n}\r\n\r\ntypedef NodeStat = {\r\n\tvar dev:Int;\r\n\tvar ino:Int;\r\n\tvar mode:Int;\r\n\tvar nlink:Int;\r\n\tvar uid:Int;\r\n\tvar gid:Int;\r\n\tvar rdev:Int;\r\n\tvar size:Int;\r\n\tvar blkSize:Int;\r\n\tvar blocks:Int;\r\n\tvar atime:NodeJsDate;\r\n\tvar mtime:NodeJsDate;\r\n\tvar ctime:NodeJsDate;\r\n\r\n\tfunction isFile():Bool;\r\n\tfunction isDirectory():Bool;\r\n\tfunction isBlockDevice():Bool;\r\n\tfunction isCharacterDevice():Bool;\r\n\tfunction isSymbolicLink():Bool;\r\n\tfunction isFIFO():Bool;\r\n\tfunction isSocket():Bool;\r\n}\r\n\r\n/*\r\n\tEmits: error,change\r\n */\r\ntypedef NodeFSWatcher = { > NodeEventEmitter,\r\n\t function close():Void;\r\n}\r\n\r\ntypedef NodeFsFileOptions = {\r\n\t@:optional var encoding :String;\r\n\t@:optional var flag :String;\r\n}\r\n\r\ntypedef NodeFS = {\r\n\tfunction rename(from:String,to:String,cb:NodeErr->Void):Void;\r\n\tfunction renameSync(from:String,to:String):Void;\r\n\r\n\tfunction stat(path:String,cb:NodeErr->NodeStat->Void):Void;\r\n\tfunction statSync(path:String):NodeStat;\r\n\r\n\tfunction lstat(path:Dynamic,cb:NodeErr->NodeStat->Void):Void;\r\n\tfunction lstatSync(path:String):NodeStat;\r\n\r\n\tfunction fstat(fd:Int,cb:NodeErr->NodeStat->Void):Void;\r\n\tfunction fstatSync(fd:Int):NodeStat;\r\n\r\n\tfunction link(srcPath:String,dstPath:String,cb:NodeErr->Void):Void;\r\n\tfunction linkSync(srcPath:String,dstPath:String):Void;\r\n\r\n\tfunction unlink(path:String,cn:NodeErr->Void):Void;\r\n\tfunction unlinkSync(path:String):Void;\r\n\r\n\tfunction symlink(linkData:Dynamic,path:String,?type:String,?cb:NodeErr->Void):Void;\r\n\tfunction symlinkSync(linkData:Dynamic,path:String,?type:String):Void;\r\n\r\n\tfunction readlink(path:String,cb:NodeErr->String->Void):Void;\r\n\tfunction readlinkSync(path:String):String;\r\n\r\n\tfunction realpath(path:String,cb:NodeErr->String->Void):Void;\r\n\tfunction realpathSync(path:String):String;\r\n\r\n\tfunction chmod(path:String,mode:Int,cb:NodeErr->Void):Void;\r\n\tfunction chmodSync(path:String,?mode:Int):Void;\r\n\r\n\tfunction fchmod(fd:Int,mode:Int,cb:NodeErr->Void):Void;\r\n\tfunction fchmodSync(fd:Int,?mode:Int):Void;\r\n\r\n\tfunction chown(path:String,uid:Int,gid:Int,cb:NodeErr->Void):Void ;\r\n\tfunction chownSync(path:String,uid:Int,gid:Int):Void;\r\n\r\n\tfunction fchown(fd:Int,uid:Int,gid:Int,cb:NodeErr->Void):Void ;\r\n\tfunction fchownSync(fd:Int,uid:Int,gid:Int):Void;\r\n\r\n\tfunction rmdir(path:String,cb:NodeErr->Void):Void;\r\n\tfunction rmdirSync(path:String):Void;\r\n\r\n\tfunction mkdir(path:String,?mode:Int,?cb:NodeErr->Void):Void;\r\n\tfunction mkdirSync(path:String,?mode:Int):Void;\r\n\r\n\tfunction readdir(path:String,cb:NodeErr->Array<String>->Void):Void;\r\n\tfunction readdirSync(path:String):Array<String>;\r\n\r\n\tfunction close(fd:Int,cb:NodeErr->Void):Void;\r\n\tfunction closeSync(fd:Int):Void;\r\n\r\n\tfunction open(path:String,flags:String,?mode:Int,cb:NodeErr->Int->Void):Void;\r\n\r\n\tfunction openSync(path:String,flags:String,?mode:Int):Int;\r\n\r\n\tfunction write(fd:Int,bufOrStr:Dynamic,offset:Int,length:Int,position:Null<Int>,?cb:NodeErr->Int->Void):Void;\r\n\tfunction writeSync(fd:Int,bufOrStr:Dynamic,offset:Int,length:Int,position:Null<Int>):Int;\r\n\r\n\tfunction read(fd:Int,buffer:NodeBuffer,offset:Int,length:Int,position:Int,cb:NodeErr->Int->NodeBuffer->Void):Void;\r\n\tfunction readSync(fd:Int,buffer:NodeBuffer,offset:Int,length:Int,position:Int):Int;\r\n\r\n\tfunction truncate(fd:Int,len:Int,cb:NodeErr->Void):Void;\r\n\tfunction truncateSync(fd:Int,len:Int):NodeErr;\r\n\r\n\t@:overload(function(path:String,cb:NodeErr->String->Void):Void {})\r\n\tfunction readFile(path:String,?options:NodeFsFileOptions,cb:NodeErr->Dynamic->Void):Void;\r\n\tfunction readFileSync(path:String,?options:NodeFsFileOptions):Dynamic;\r\n\r\n\t@:overload(function(fileName:String,data:NodeBuffer,cb:NodeErr->Void):Void {})\r\n\tfunction writeFile(fileName:String,contents:String,?enc:String,cb:NodeErr->Void):Void;\r\n\t@:overload(function(fileName:String,data:NodeBuffer):Void {})\r\n\tfunction writeFileSync(fileName:String,contents:String,?enc:String):Void;\r\n\r\n\t@:overload(function(fileName:String,data:NodeBuffer,cb:NodeErr->Void):Void {})\r\n\tfunction appendFile(fileName:String,contents:String,?enc:String,cb:NodeErr->Void):Void;\r\n\r\n\t@:overload(function(fileName:String,data:NodeBuffer):Void {})\r\n\tfunction appendFileSync(fileName:String,contents:String,?enc:String):Void;\r\n\r\n\r\n\tfunction utimes(path:String,atime:Dynamic,mtime:Dynamic,cb:NodeErr->Void):Void;\r\n\tfunction utimeSync(path:String,atime:Dynamic,mtime:Dynamic):Void;\r\n\r\n\tfunction futimes(fd:Int,atime:Dynamic,mtime:Dynamic,cb:NodeErr->Void):Void;\r\n\tfunction futimeSync(fd:Int,atime:Dynamic,mtime:Dynamic):Void;\r\n\r\n\tfunction fsync(fd:Int,cb:NodeErr->Void):Void;\r\n\tfunction fsyncSync(fd:Int):Void;\r\n\r\n\tfunction watchFile(fileName:String,?options:NodeWatchOpt,listener:NodeStat->NodeStat->Void):Void;\r\n\tfunction unwatchFile(fileName:String):Void;\r\n\tfunction watch(fileName:String,?options:NodeWatchOpt,listener:String->String->Void):NodeFSWatcher;\r\n\tfunction createReadStream(path:String,?options:ReadStreamOpt):NodeReadStream;\r\n\tfunction createWriteStream(path:String,?options:WriteStreamOpt):NodeWriteStream;\r\n\r\n\tfunction exists(p:String,cb:Bool->Void):Void;\r\n\tfunction existsSync(p:String):Bool;\r\n}\r\n\r\ntypedef NodeUtil = {\r\n\tfunction debug(s:String):Void;\r\n\tfunction inspect(o:Dynamic,?showHidden:Bool,?depth:Int):Void;\r\n\tfunction log(s:String):Void;\r\n\tfunction pump(rs:NodeReadStream,ws:NodeWriteStream,cb:Dynamic->Void):Void;\r\n\tfunction inherits(constructor:Dynamic,superConstructor:Dynamic):Void;\r\n\tfunction isArray(o:Dynamic):Bool;\r\n\tfunction isRegExp(o:Dynamic):Bool;\r\n\tfunction isDate(o:Dynamic):Bool;\r\n\tfunction isError(o:Dynamic):Bool;\r\n\tfunction format(out:String,?a1:Dynamic,?a2:Dynamic,?a3:Dynamic):Void; // should be arbitrary # of args\r\n}\r\n\r\n/*\r\n\tEmits:\r\n\texit, uncaughtException + SIGNAL events (SIGINT etc)\r\n */\r\ntypedef NodeProcess = { > NodeEventEmitter,\r\n\tvar stdout:NodeWriteStream;\r\n\tvar stdin:NodeReadStream;\r\n\tvar stderr:NodeWriteStream;\r\n\tvar argv:Array<String>;\r\n\tvar env:Dynamic;\r\n\tvar pid:Int;\r\n\tvar title:String;\r\n\tvar arch:String;\r\n\tvar platform:String;\r\n\tvar installPrefix:String;\r\n\tvar execPath:String;\r\n\tvar version:String;\r\n\tvar versions:Dynamic;\r\n\r\n\tfunction memoryUsage():{rss:Int,vsize:Int,heapUsed:Int,heapTotal:Int};\r\n\tfunction nextTick(fn:Void->Void):Void;\r\n\tfunction exit(code:Int):Void;\r\n\tfunction cwd():String;\r\n\tfunction getuid():Int;\r\n\tfunction getgid():Int;\r\n\tfunction setuid(u:Int):Void;\r\n\tfunction setgid(g:Int):Void;\r\n\tfunction umask(?m:Int):Int;\r\n\tfunction chdir(d:String):Void;\r\n\tfunction kill(pid:Int,?signal:String):Void;\r\n\tfunction uptime():Int;\r\n\tfunction abort():Void;\r\n\tfunction hrtime():Array<Int>;\r\n}\r\n\r\n/*\r\n\tEmits: exit,close\r\n*/\r\ntypedef NodeChildProcess = { > NodeEventEmitter,\r\n\tvar stdin:NodeWriteStream;\r\n\tvar stdout:NodeReadStream;\r\n\tvar stderr:NodeReadStream;\r\n\tvar pid:Int;\r\n\tfunction kill(?signal:String):Void;\r\n}\r\n\r\n/*\r\n\tEmits: message\r\n*/\r\ntypedef NodeChildForkProcess = { > NodeChildProcess,\r\n\t @:overload(function(o:Dynamic,?socket:NodeNetSocket):Void {})\r\n\t function send(o:Dynamic,?server:NodeNetServer):Void;\r\n}\r\n\r\ntypedef NodeChildProcessCommands = {\r\n\tfunction spawn(command: String,args: Array<String>,?options: Dynamic ) : NodeChildProcess;\r\n\tfunction exec(command: String,?options:Dynamic,cb: {code:Int}->String->String->Void ): NodeChildProcess;\r\n\tfunction execFile(command: String,?options:Dynamic,cb: {code:Int}->String->String->Void ): NodeChildProcess;\r\n\tfunction fork(path:String,?args:Dynamic,?options:Dynamic):NodeChildForkProcess;\r\n}\r\n\r\ntypedef NodeClusterSettings = {\r\n\tvar exec:String;\r\n\tvar args:Array<String>;\r\n\tvar silent:Bool;\r\n}\r\n\r\n\r\n/* emits: message, online,listening,disconnect,exit, setup */\r\ntypedef NodeWorker = { > NodeEventEmitter,\r\n\tvar uniqueID:String; // indexes into cluster.workers\r\n\tvar process:NodeChildProcess;\r\n\tvar suicide:Bool;\r\n\tfunction send(message:Dynamic,?sendHandle:Dynamic):Void;\r\n\tfunction destroy():Void;\r\n}\r\n\r\n/* Emits: death,message, fork, online, listening\t*/\r\ntypedef NodeCluster = { > NodeEventEmitter,\r\n\tvar isMaster:Bool;\r\n\tvar isWorker:Bool;\r\n\tvar workers:Array<NodeWorker>;\r\n\tfunction fork(?env:Dynamic):NodeWorker;\r\n\tfunction send(o:Dynamic):Void;\r\n\tfunction setupMaster(?settings:NodeClusterSettings):Void;\r\n\tfunction disconnect(?cb:Void->Void):Void;\r\n}\r\n\r\n\r\n/* NET ............................................. */\r\n\r\n/*\r\n\t Emits:\r\n\t connection\r\n*/\r\ntypedef NodeNet = { > NodeEventEmitter,\r\n\tfunction createServer(?options:{allowHalfOpen:Bool},fn:NodeNetSocket->Void):NodeNetServer;\r\n\t@:overload(function(cs:String):NodeNetSocket {})\r\n\tfunction createConnection(port:Int,host:String):NodeNetSocket;\r\n\t@:overload(function(cs:String):NodeNetSocket {})\r\n\tfunction connect(port:Int,host:String):NodeNetSocket;\r\n\tfunction isIP(input:String):Int; // 4 or 6\r\n\tfunction isIPv4(input:String):Bool;\r\n\tfunction isIPv6(input:String):Bool;\r\n}\r\n\r\n/*\r\n\t Emits:\r\n\t connection,close,error,listening\r\n*/\r\ntypedef NodeNetServer = { > NodeEventEmitter,\r\n\tvar maxConnections:Int;\r\n\tvar connections:Int;\r\n\r\n\t@:overload(function(path:String,?cb:Void->Void):Void {})\r\n\t@:overload(function(fd:Int,?cb:Void->Void):Void {})\r\n\tfunction listen(port:Int,?host:String,?cb:Void->Void):Void;\r\n\tfunction close(cb:Void->Void):Void;\r\n\tfunction address():Void;\r\n\tfunction pause(msecs:Int):Void;\r\n}\r\n\r\ntypedef NodeConnectionOpt = {\r\n\tport:Int,\r\n\t?host:String,\r\n\t?localAddress:String\r\n}\r\n\r\n/*\r\n\r\n\tEmits:\r\n\tconnect,data,end,timeout,drain,error,close\r\n\r\n\timplements a duplex stream interface\r\n*/\r\ntypedef NodeNetSocket = { > NodeEventEmitter,\r\n\tvar remoteAddress:String;\r\n\tvar remotePort:Int;\r\n\tvar bufferSize:Int;\r\n\tvar bytesRead:Int;\r\n\tvar bytesWritten:Int;\r\n\r\n\t@:overload(function(path:String,?cb:Void->Void):Void {})\r\n\t@:overload(function(options:NodeConnectionOpt,connectionListener:Void->Void):Void {})\r\n\tfunction connect(port:Int,?host:String,?cb:Void->Void):Void;\r\n\tfunction setEncoding(enc:String):Void;\r\n\tfunction setSecure():Void;\r\n\t@:overload(function(data:Dynamic,?enc:String,?fileDesc:Int,?cb:Void->Void):Bool {})\r\n\tfunction write(data:Dynamic,?enc:String,?cb:Void->Void):Bool;\r\n\tfunction end(?data:Dynamic,?enc:String):Void;\r\n\tfunction destroy():Void;\r\n\tfunction pause():Void;\r\n\tfunction resume():Void;\r\n\tfunction setTimeout(timeout:Int,?cb:Void->Void):Void;\r\n\tfunction setNoDelay(?noDelay:Bool):Void;\r\n\tfunction setKeepAlive(enable:Bool,?delay:Int):Void;\r\n\tfunction address():{address:String,port:Int};\r\n}\r\n\r\n/* HTTP ............................................*/\r\n\r\n\r\n/*\r\n\t Emits:\r\n\t data,end,close\r\n */\r\ntypedef NodeHttpServerReq = { > NodeReadStream,\r\n\tvar method:String;\r\n\tvar url:String;\r\n\tvar headers:Dynamic;\r\n\tvar trailers:Dynamic;\r\n\tvar httpVersion:String;\r\n\tvar connection:NodeNetSocket;\r\n}\r\n\r\n/*\r\n */\r\ntypedef NodeHttpServerResp = { > NodeWriteStream,\r\n\tvar statusCode:Int;\r\n\tfunction writeContinue():Void;\r\n\t@:overload(function(statusCode:Int,?reasonPhrase:String,?headers:Dynamic):Void {})\r\n\tfunction writeHead(statusCode:Int,headers:Dynamic):Void;\r\n\tfunction setHeader(name:String,value:Dynamic):Void;\r\n\tfunction getHeader(name:String):Dynamic;\r\n\tfunction removeHeader(name:String):Void;\r\n\tfunction addTrailers(headers:Dynamic):Void;\r\n}\r\n\r\n/* Emits:\r\n\t continue,response\r\n*/\r\ntypedef NodeHttpClientReq = { > NodeWriteStream,\r\n}\r\n\r\n/* Emits:\r\n\t data,end,close\r\n*/\r\ntypedef NodeHttpClientResp = { > NodeReadStream,\r\n\tvar statusCode:Int;\r\n\tvar httpVersion:String;\r\n\tvar headers:Dynamic;\r\n\tvar client:NodeHttpClient;\r\n}\r\n\r\n\r\ntypedef NodeHttpClient = { > NodeEventEmitter,\r\n\tfunction request(method:String,path:String,?headers:Dynamic):NodeHttpClientReq;\r\n\tfunction verifyPeer():Bool;\r\n\tfunction getPeerCertificate():NodePeerCert;\r\n}\r\n\r\n/*\r\n\t Emits:\r\n\t request,connection,checkContinue,connect,clientError,close\r\n */\r\ntypedef NodeHttpServer = { > NodeEventEmitter,\r\n\t@:overload(function(path:String,?cb:Void->Void):Void {})\r\n\tfunction listen(port:Int,?host:String,?cb:Void->Void):Void;\r\n\tfunction close(?cb:Void->Void):Void;\r\n}\r\n\r\n/*\r\n */\r\ntypedef NodeHttpReqOpt = {\r\n\tvar host:String;\r\n\tvar port:Int;\r\n\tvar path:String;\r\n\tvar method:String;\r\n\tvar headers:Dynamic;\r\n}\r\n\r\ntypedef NodeHttpsReqOpt = { > NodeHttpReqOpt,\r\n\tvar ciphers:Dynamic;\r\n\tvar rejectUnauthorized:Dynamic;\r\n}\r\n\r\n/*\r\n\t Emits:\r\n\t upgrade,continue\r\n*/\r\ntypedef NodeAgent = { > NodeEventEmitter,\r\n\tvar maxSockets:Int;\r\n\tvar sockets:Array<NodeNetSocket>;\r\n\tvar queue:Array<NodeHttpServerReq>;\r\n}\r\n\r\ntypedef NodeHttp = {\r\n\tfunction createServer(listener:NodeHttpServerReq->NodeHttpServerResp->Void):NodeHttpServer;\r\n\tfunction createClient(port:Int,host:String):NodeHttpClient;\r\n\t@:overload(function(parsedUrl:NodeUrlObj,res:NodeHttpClientResp->Void):NodeHttpClientReq {})\r\n\tfunction request(options:NodeHttpReqOpt,res:NodeHttpClientResp->Void):NodeHttpClientReq;\r\n\t@:overload(function(parsedUrl:NodeUrlObj,res:NodeHttpClientResp->Void):Void {})\r\n\tfunction get(options:NodeHttpReqOpt,res:NodeHttpClientResp->Void):Void;\r\n\tfunction getAgent(host:String,port:Int):NodeAgent;\r\n}\r\n\r\ntypedef NodeHttps = {\r\n\tfunction createServer(options:{key:String,cert:String},\r\n\t\t\t\t\t\t\t\t\t\t\t\tlistener:NodeHttpServerReq->NodeHttpServerResp->Void):NodeHttpServer;\r\n\tfunction request(options:NodeHttpsReqOpt,res:NodeHttpClientResp->Void):NodeHttpClientReq;\r\n\tfunction get(options:NodeHttpsReqOpt,res:NodeHttpClientResp->Void):Void;\r\n}\r\n\r\ntypedef NodeDns = {\r\n\tfunction resolve(domain:String,?rrtype:String,cb:NodeErr->Array<Dynamic>->Void):Void;\r\n\tfunction resolveNs(domain:String,cb:NodeErr->Array<Dynamic>->Void):Void;\r\n\tfunction resolve4(domain:String,cb:NodeErr->Array<String>->Void):Void;\r\n\tfunction resolve6(domain:String,cb:NodeErr->Array<String>->Void):Void;\r\n\tfunction resolveMx(domain:String,cb:NodeErr->Array<{priority:Int,exchange:String}>->Void):Void;\r\n\tfunction resolveSrv(domain:String,cb:NodeErr->Array<{priority:Int,weight:Int,port:Int,name:String}->Void>):Void;\r\n\tfunction resolveCname(domain:String,cb:NodeErr->Array<String>->Void):Void;\r\n\tfunction reverse(ip:String,cb:NodeErr->Array<String>->Void):Void;\r\n\tfunction resolveTxt(domain:String,cb:NodeErr->Array<String>->Void):Void;\r\n\tfunction lookup(domain:String,?family:String,cb:NodeErr->String->Int->Void):Void;\r\n}\r\n\r\n/* UDP ........................................ */\r\n\r\ntypedef NodeUDPCallback = NodeErr->haxe.io.Bytes->Void;\r\n\r\ntypedef NodeUDP = {\r\n\t// Valid types: udp6, and unix_dgram.\r\n\tfunction createSocket(type:String,cb:NodeUDPCallback):NodeDGSocket;\r\n}\r\n\r\n/*\r\n\t Emits: message,listening,close\r\n*/\r\ntypedef NodeDGSocket = { > NodeEventEmitter,\r\n\tfunction send(buf:NodeBuffer,offset:Int,length:Int,port:Int,address:String,cb:NodeUDPCallback):Void;\r\n\tfunction bind(port:Int,?address:String):Void;\r\n\tfunction close():Void;\r\n\tfunction address():Dynamic;\r\n\tfunction setBroadcast(flag:Bool):Void;\r\n\tfunction setTTL(ttl:Int):Void;\r\n\tfunction setMulticastTTL(ttl:Int):Void;\r\n\tfunction setMulticastLoopback(flag:Bool):Void;\r\n\tfunction addMembership(multicastAddress:String,?multicastInterface:String):Void;\r\n\tfunction dropMembership(multicastAddress:String,?multicastInterface:String):Void;\r\n}\r\n\r\n\r\n/* CRYPTO ..................................... */\r\n\r\ntypedef NodeCredDetails = {\r\n\tvar key:String;\r\n\tvar cert:String;\r\n\tvar ca:Array<String>;\r\n\t/*\r\n\t\tTODO\r\n\t*/\r\n}\r\n\r\ntypedef NodePeerCert = {\r\n\tvar subject:String;\r\n\tvar issuer:String;\r\n\tvar valid_from:String;\r\n\tvar valid_to:String;\r\n}\r\n\r\ntypedef NodeCreds = Dynamic;\r\n\r\ntypedef NodeHmac = {\r\n\tfunction update(data:Dynamic):Void;\r\n\tfunction digest(?enc:String):String;\r\n}\r\n\r\ntypedef NodeHash = {\r\n\tfunction update(data:Dynamic):NodeHash;\r\n\tfunction digest(?enc:String):String;\r\n\tfunction createHmac(algo:String,key:String):NodeHmac;\r\n}\r\n\r\ntypedef NodeCipher = {\r\n\tfunction update(data:Dynamic,?input_enc:String,?output_enc:String):Dynamic;\r\n\tfunction final(output_enc:String):Void;\r\n\tfunction setAutoPadding(padding:Bool):Void; // default true\r\n}\r\n\r\ntypedef NodeDecipher = {\r\n\tfunction update(data:Dynamic,?input_enc:String,?output_enc:String):Dynamic;\r\n\tfunction final(?output_enc:String):Dynamic;\r\n\tfunction setAutoPadding(padding:Bool):Void; // default true\r\n}\r\n\r\ntypedef NodeSigner = {\r\n\tfunction update(data:Dynamic):Void;\r\n\tfunction sign(private_key:String,?output_format:String):Dynamic;\r\n}\r\n\r\ntypedef NodeVerify = {\r\n\tfunction update(data:Dynamic):Void;\r\n\tfunction verify(cert:String,?sig_format:String):Bool;\r\n}\r\n\r\ntypedef NodeDiffieHellman = {\r\n\tfunction generateKeys(?enc:String):String;\r\n\tfunction computeSecret(otherPublicKey:String,?inputEnc:String,?outputEnc:String):String;\r\n\tfunction getPrime(?enc:String):Int;\r\n\tfunction getGenerator(?enc:String):String;\r\n\tfunction getPublicKey(?enc:String):String;\r\n\tfunction getPrivateKey(?enc:String):String;\r\n\tfunction setPublicKey(pubKey:String,?enc:String):Void;\r\n\tfunction setPrivateKey(privKey:String,?enc:String):Void;\r\n}\r\n\r\ntypedef NodeCrypto = {\r\n\tfunction createCredentials(details:NodeCredDetails):NodeCreds;\r\n\tfunction createHash(algo:String):NodeHash; // 'sha1', 'md5', 'sha256', 'sha512'\r\n\tfunction createCipher(algo:String,password:String):NodeCipher;\r\n\tfunction createCipheriv(algo:String,key:String,iv:String):NodeCipher;\r\n\tfunction createDecipher(algo:String,key:String):NodeDecipher;\r\n\tfunction createDecipheriv(algo:String,key:String,iv:String):NodeDecipher;\r\n\tfunction createSign(algo:String):NodeSigner;\r\n\tfunction createVerify(algo:String):NodeVerify;\r\n\t@:overload(function(prime_length:Int):NodeDiffieHellman {})\r\n\tfunction createDiffieHellman(prime:String,?enc:String):NodeDiffieHellman;\r\n\tfunction getDiffieHellman(groupName:String):NodeDiffieHellman;\r\n\tfunction pbkdf2(password:String,salt:String,iterations:Int,keylen:Int,cb:NodeErr->String):Void;\r\n\tfunction randomBytes(size:Int,cb:NodeErr->NodeBuffer):Void;\r\n\r\n}\r\n\r\n/* TLS/SSL ................................................ */\r\n\r\n/*\r\n\t Emits:\r\n\t secureConnection\r\n*/\r\ntypedef NodeTLSServer =\t{ > NodeNetServer,\r\n\t\tfunction addContext(hostName:String,credentials:NodeCreds):Void;\r\n\r\n}\r\n\r\n/* Emits: secure */\r\ntypedef NodeSecurePair = { > NodeEventEmitter,\r\n\t // ?? todo\r\n}\r\ntypedef NodeTLS ={\r\n\tfunction connect(port:Int,host:String,opts:Dynamic,cb:Void->Void):Void;\r\n\tfunction createServer(opts:Dynamic,cb:NodeTLSServer->Void):Void;\r\n\tfunction createSecurePair(creds:NodeCreds,isServer:Bool,requestCert:Bool,rejectUnauthorized:Bool):NodeSecurePair;\r\n}\r\n\r\n/*\r\n\tSnarfed from Tong's version ...\r\n */\r\ntypedef NodeAssert = {\r\n\tfunction fail(actual:Dynamic,expected:Dynamic,message:Dynamic,operator:Dynamic): Void;\r\n\tfunction ok(value:Dynamic,?message:Dynamic):Void;\r\n\tfunction equal(actual:Dynamic,expected:Dynamic,?message:Dynamic):Void;\r\n\tfunction notEqual(actual:Dynamic,expected:Dynamic,?message:Dynamic):Void;\r\n\tfunction deepEqual(actual:Dynamic,expected:Dynamic,?message:Dynamic):Void;\r\n\tfunction notDeepEqual(actual:Dynamic,expected:Dynamic,?message:Dynamic):Void;\r\n\tfunction strictEqual(actual:Dynamic,expected:Dynamic,?message:Dynamic):Void;\r\n\tfunction notStrictEqual(actual:Dynamic,expected:Dynamic,?message:Dynamic):Void;\r\n\tfunction throws(block:Dynamic,error:Dynamic,?message:Dynamic):Void;\r\n\tfunction doesNotThrow(block:Dynamic,error:Dynamic,?message:Dynamic):Void;\r\n\tfunction ifError(value:Dynamic):Void;\r\n}\r\n\r\ntypedef NodeREPL = {\r\n\tfunction start( prompt : String, ?stream : Dynamic ) : Void;\r\n}\r\n\r\ntypedef NodeGZip = {}\r\ntypedef NodeGUnzip = {}\r\ntypedef NodeDeflate = {}\r\ntypedef NodeInflate = {}\r\ntypedef NodeDeflateRaw = {}\r\ntypedef NodeInflateRaw = {}\r\ntypedef NodeUnzip = {}\r\n\r\n\r\ntypedef NodeZLib = {\r\n\tfunction createGzip(?options:Dynamic):NodeGZip;\r\n\tfunction createGunzip(?options:Dynamic):NodeGUnzip;\r\n\tfunction createDeflate(?options:Dynamic):NodeDeflate;\r\n\tfunction createInflate(?options:Dynamic):NodeInflate;\r\n\tfunction createInflateRaw(?options:Dynamic):NodeInflateRaw;\r\n\tfunction createDeflateRaw(?options:Dynamic):NodeDeflateRaw;\r\n\tfunction createUnzip(?options:Dynamic):NodeUnzip;\r\n\r\n\t// convenience\r\n\t@:overload(function (str:String,cb:NodeErr->Dynamic->Void):Void {})\r\n\tfunction deflate(buf:NodeBuffer,cb:NodeErr->Dynamic->Void):Void;\r\n\t@:overload(function (str:String,cb:NodeErr->Dynamic->Void):Void {})\r\n\tfunction deflateRaw(buf:NodeBuffer,cb:NodeErr->Dynamic->Void):Void;\r\n\t@:overload(function (str:String,cb:NodeErr->Dynamic->Void):Void {})\r\n\tfunction gzip(buf:NodeBuffer,cb:NodeErr->Dynamic->Void):Void;\r\n\t@:overload(function (str:String,cb:NodeErr->Dynamic->Void):Void {})\r\n\tfunction gunzip(buf:NodeBuffer,cb:NodeErr->Dynamic->Void):Void;\r\n\t@:overload(function (str:String,cb:NodeErr->Dynamic->Void):Void {})\r\n\tfunction inflate(buf:NodeBuffer,cb:NodeErr->Dynamic->Void):Void;\r\n\t@:overload(function (str:String,cb:NodeErr->Dynamic->Void):Void {})\r\n\tfunction inflateRaw(buf:NodeBuffer,cb:NodeErr->Dynamic->Void):Void;\r\n\t@:overload(function (str:String,cb:NodeErr->Dynamic->Void):Void {})\r\n\tfunction unzip(buf:NodeBuffer,cb:NodeErr->Dynamic->Void):Void;\r\n}\r\n\r\ntypedef NodeJson = {\r\n\tfunction stringify(obj :Dynamic, ?replacer :Dynamic, ?space :Dynamic):String;\r\n\tfunction parse(text :String) :Dynamic;\r\n}\r\n\r\n@:native(\"Error\")\r\nextern class Error\r\n{\r\n\tpublic function new(msg : String) : Void;\r\n}\r\n\r\n// Node Constants\r\nclass NodeC {\r\n\tpublic static inline var UTF8 = \"utf8\";\r\n\tpublic static inline var ASCII = \"ascii\";\r\n\tpublic static inline var BINARY = \"binary\";\r\n\tpublic static inline var BASE64 = \"base64\";\r\n\tpublic static inline var HEX = \"hex\";\r\n\r\n\t//events - thanks tmedema\r\n\tpublic static inline var EVENT_EVENTEMITTER_NEWLISTENER = \"newListener\";\r\n\tpublic static inline var EVENT_EVENTEMITTER_ERROR = \"error\";\r\n\r\n\tpublic static inline var EVENT_STREAM_DATA = \"data\";\r\n\tpublic static inline var EVENT_STREAM_END = \"end\";\r\n\tpublic static inline var EVENT_STREAM_ERROR = \"error\";\r\n\tpublic static inline var EVENT_STREAM_CLOSE = \"close\";\r\n\tpublic static inline var EVENT_STREAM_DRAIN = \"drain\";\r\n\tpublic static inline var EVENT_STREAM_CONNECT = \"connect\";\r\n\tpublic static inline var EVENT_STREAM_SECURE = \"secure\";\r\n\tpublic static inline var EVENT_STREAM_TIMEOUT = \"timeout\";\r\n\tpublic static inline var EVENT_STREAM_PIPE = \"pipe\";\r\n\r\n\tpublic static inline var EVENT_PROCESS_EXIT = \"exit\";\r\n\tpublic static inline var EVENT_PROCESS_UNCAUGHTEXCEPTION = \"uncaughtException\";\r\n\tpublic static inline var EVENT_PROCESS_SIGINT = \"SIGINT\";\r\n\tpublic static inline var EVENT_PROCESS_SIGUSR1 = \"SIGUSR1\";\r\n\tpublic static inline var EVENT_CHILDPROCESS_EXIT = \"exit\";\r\n\tpublic static inline var EVENT_HTTPSERVER_REQUEST = \"request\";\r\n\tpublic static inline var EVENT_HTTPSERVER_CONNECTION = \"connection\";\r\n\tpublic static inline var EVENT_HTTPSERVER_CLOSE = \"close\";\r\n\tpublic static inline var EVENT_HTTPSERVER_UPGRADE = \"upgrade\";\r\n\tpublic static inline var EVENT_HTTPSERVER_CLIENTERROR = \"clientError\";\r\n\tpublic static inline var EVENT_HTTPSERVERREQUEST_DATA = \"data\";\r\n\tpublic static inline var EVENT_HTTPSERVERREQUEST_END = \"end\";\r\n\tpublic static inline var EVENT_CLIENTREQUEST_RESPONSE = \"response\";\r\n\tpublic static inline var EVENT_CLIENTRESPONSE_DATA = \"data\";\r\n\tpublic static inline var EVENT_CLIENTRESPONSE_END = \"end\";\r\n\tpublic static inline var EVENT_NETSERVER_CONNECTION = \"connection\";\r\n\tpublic static inline var EVENT_NETSERVER_CLOSE = \"close\";\r\n\r\n\tpublic static inline var FILE_READ = \"r\";\r\n\tpublic static inline var FILE_READ_APPEND = \"r+\";\r\n\tpublic static inline var FILE_WRITE = \"w\";\r\n\tpublic static inline var FILE_WRITE_APPEND = \"a+\";\r\n\tpublic static inline var FILE_READWRITE = \"a\";\r\n\tpublic static inline var FILE_READWRITE_APPEND = \"a+\";\r\n}\r\n\r\nclass Node {\r\n\tpublic static var assert(get,null) : NodeAssert;\r\n\tpublic static var child_process(get,null) : NodeChildProcessCommands;\r\n\tpublic static var cluster(get,null) : NodeCluster;\r\n\tpublic static var console(default,null) : NodeConsole;\r\n\tpublic static var crypto(get,null) : NodeCrypto;\r\n\tpublic static var dgram(get,null) :NodeUDP ;\r\n\tpublic static var dns(get,null) : NodeDns;\r\n\tpublic static var fs(get,null) : NodeFS;\r\n\tpublic static var http(get,null) : NodeHttp;\r\n\tpublic static var https(get,null) : NodeHttps;\r\n\tpublic static var net(get,null) : NodeNet;\r\n\tpublic static var os(get,null) : NodeOs;\r\n\tpublic static var path(get,null) : NodePath;\r\n\tpublic static var process(default,null) : NodeProcess;\r\n\tpublic static var querystring(get,null) : NodeQueryString;\r\n\tpublic static var repl(get,null) : NodeREPL;\r\n\tpublic static var require(default,null) : String->Dynamic;\r\n\tpublic static var tls(get,null) : NodeTLS;\r\n\tpublic static var url(get,null) : NodeUrl;\r\n\tpublic static var util(get,null) : NodeUtil;\r\n\tpublic static var vm(get,null) : NodeVM;\r\n\tpublic static var json(get,null) : NodeJson;\r\n\tpublic static var zlib(get,null) : NodeZLib;\r\n\r\n\r\n\t//\tpublic static var paths:Array<String>;\r\n\tpublic static var setTimeout:Dynamic->Int->?Array<Dynamic>->Int;\r\n\tpublic static var clearTimeout:Int->Void;\r\n\tpublic static var setInterval:Dynamic->Int->?Array<Dynamic>->Int;\r\n\tpublic static var clearInterval:Int->Void;\r\n\tpublic static var setImmediate:Dynamic->?Array<Dynamic>->Int;\r\n\tpublic static var clearImmediate:Int->Void;\r\n\tpublic static var global:Dynamic;\r\n\r\n\tpublic static var __filename(get, null):String;\r\n\tpublic static var __dirname(get, null):String;\r\n\tpublic static var module:Dynamic;\r\n\tpublic static var stringify:Dynamic->?Dynamic->?Dynamic->String;\r\n\tpublic static var parse:String->Dynamic;\r\n\tpublic static var queryString:NodeQueryString;\r\n\r\n\tstatic inline function get_assert() : NodeAssert return require(\"assert\");\r\n\tstatic inline function get_child_process() : NodeChildProcessCommands return require(\"child_process\");\r\n\tstatic inline function get_cluster() : NodeCluster return require(\"cluster\");\r\n\tstatic inline function get_crypto() : NodeCrypto return require(\"crypto\");\r\n\tstatic inline function get_dgram() : NodeUDP return require(\"dgram\");\r\n\tstatic inline function get_dns() : NodeDns return require(\"dns\");\r\n\tstatic inline function get_fs() : NodeFS return require(\"fs\");\r\n\tstatic inline function get_http() : NodeHttp return require(\"http\");\r\n\tstatic inline function get_https() : NodeHttps return require(\"https\");\r\n\tstatic inline function get_net() : NodeNet return require(\"net\");\r\n\tstatic inline function get_os() : NodeOs return require(\"os\");\r\n\tstatic inline function get_path() : NodePath return require(\"path\");\r\n\tstatic inline function get_querystring() : NodeQueryString return require(\"querystring\");\r\n\tstatic inline function get_repl() : NodeREPL return require(\"repl\");\r\n\tstatic inline function get_tls() : NodeTLS return require(\"tls\");\r\n\tstatic inline function get_url() : NodeUrl return require(\"url\");\r\n\tstatic inline function get_util() : NodeUtil return require(\"util\");\r\n\tstatic inline function get_vm() : NodeVM return require(\"vm\");\r\n\tstatic inline function get_zlib() : NodeZLib return require(\"zlib\");\r\n\r\n\tstatic inline function get___filename() : String return untyped __js__('__filename');\r\n\tstatic inline function get___dirname() : String return untyped __js__('__dirname');\r\n\tstatic inline function get_json() : NodeJson return untyped __js__('JSON');\r\n\r\n\tpublic static function newSocket(?options):NodeNetSocket {\r\n\t\treturn untyped __js__(\"new js.Node.net.Socket(options)\");\r\n\t}\r\n\r\n\t#if !macro\r\n\tpublic static function __init__()\r\n\t{\r\n\t\tuntyped __js__(\"var module, setImmediate, clearImmediate\");\r\n\t\tsetTimeout = untyped __js__('setTimeout');\r\n\t\tclearTimeout = untyped __js__('clearTimeout');\r\n\t\tsetInterval = untyped __js__('setInterval');\r\n\t\tclearInterval = untyped __js__('clearInterval');\r\n\t\tglobal = untyped __js__('global');\r\n\t\tprocess = untyped __js__('process');\r\n\t\trequire = untyped __js__('require');\r\n\t\tconsole = untyped __js__('console');\r\n\t\tmodule = untyped __js__('module');\t// ref to the current module\r\n\t\tstringify = untyped __js__('JSON.stringify');\r\n\t\tparse = untyped __js__('JSON.parse');\r\n\t\t// Not present in Node < 0.9\r\n\t\tvar version = process.version.substr(1).split(\".\").map(Std.parseInt);\r\n\t\tif (version[0] > 0 || version[1] >= 9) {\r\n\t\t\tsetImmediate = untyped __js__('setImmediate');\r\n\t\t\tclearImmediate = untyped __js__('clearImmediate');\r\n\t\t}\r\n\t}\r\n\t#end\r\n}\r\n\r\n\r\n","package nodejs.webkit;\r\n\r\nextern class Menu {\r\n\r\n\tvar items(default, null) : Array<MenuItem>;\r\n\t\r\n\tfunction new( ?t : { type : String } ) : Void;\r\n\tfunction append( it : MenuItem ) : Void;\r\n\tfunction insert( it : MenuItem, pos : Int ) : Void;\r\n\tfunction remove( it : MenuItem ) : Void;\r\n\tfunction removeAt( it : MenuItem, pos : Int ) : Void;\r\n\tfunction popup( x : Int, y : Int ) : Void;\r\n\t\r\n\tstatic inline function createWindowMenu() : Menu {\r\n\t\treturn new Menu( { type : \"menubar\" } );\r\n\t}\r\n\t\r\n\tstatic function __init__() : Void untyped {\r\n\t\tMenu = UI.Menu;\r\n\t}\r\n\t\r\n}","package nodejs.webkit;\r\n\r\nextern class MenuItem {\r\n\t\r\n\tvar type(default, null) : MenuItemType;\r\n\tvar label : String;\r\n\tvar icon : String;\r\n\tvar tooltip : String;\r\n\tvar checked : Bool;\r\n\tvar enabled : Bool;\r\n\tvar submenu : Menu;\r\n\r\n\tfunction new( ?t : { ?label : String, ?icon : String, ?type : MenuItemType } ) : Void;\r\n\t\r\n\tdynamic function click() : Void;\r\n\tfunction on( event : String, callb : Void -> Void ) : Void;\r\n\t\r\n\tstatic function __init__() : Void untyped {\r\n\t\tMenuItem = UI.MenuItem;\r\n\t}\r\n\t\r\n}","package nodejs.webkit;\r\n\r\nextern class Shell\r\n{\r\n\tstatic public function openExternal(url:String):Void;\r\n\tstatic public function openItem(path:String):Void;\r\n\tstatic public function showItemInFolder(Path:String):Void;\r\n\r\n\tstatic function __init__() : Void untyped {\r\n\t\tShell = UI.Shell;\r\n\t}\r\n\t\r\n}","package hxparse;\r\n\r\nimport haxe.macro.Context;\r\nimport haxe.macro.Expr;\r\n\r\nusing Lambda;\r\nusing haxe.macro.Tools;\r\n\r\n/**\r\n\tThe RuleBuilder interfaces provides syntactic shortcuts for writing lexer\r\n\trules.\r\n**/\r\n#if !macro\r\n@:autoBuild(hxparse.RuleBuilderImpl.build())\r\n#end\r\ninterface RuleBuilder { }\r\n\r\nclass RuleBuilderImpl {\r\n\tmacro static public function build():Array<Field> {\r\n\t\tvar fields = Context.getBuildFields();\r\n\t\tvar fieldExprs = new Map();\r\n\t\tvar delays = [];\r\n\t\tvar ret = [];\r\n\t\tfor (field in fields) {\r\n\t\t\tif (field.access.exists(function(a) return a == AStatic))\r\n\t\t\t\tswitch(field.kind) {\r\n\t\t\t\t\tcase FVar(t, e) if (e != null):\r\n\t\t\t\t\t\tswitch(e.expr) {\r\n\t\t\t\t\t\t\tcase EMeta({name: \":rule\"}, e):\r\n\t\t\t\t\t\t\t\tdelays.push(transformRule.bind(field, e, t, fieldExprs));\r\n\t\t\t\t\t\t\tcase EMeta({name: \":mapping\", params: args}, e):\r\n\t\t\t\t\t\t\t\tvar offset = switch(args) {\r\n\t\t\t\t\t\t\t\t\tcase [{expr: EConst(CInt(i))}]: Std.parseInt(i);\r\n\t\t\t\t\t\t\t\t\tcase _: 0;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tdelays.push(transformMapping.bind(field, e, offset));\r\n\t\t\t\t\t\t\tcase _:\r\n\t\t\t\t\t\t\t\tfieldExprs.set(field.name, e);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\tcase _:\r\n\t\t\t\t}\r\n\t\t\tif (!field.meta.exists(function(m) return m.name == \":ruleHelper\")) {\r\n\t\t\t\tret.push(field);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (delay in delays)\r\n\t\t\tdelay();\r\n\t\treturn ret;\r\n\t}\r\n\t\r\n\t#if macro\r\n\t\r\n\tstatic function makeRule(fields:Map<String,Expr>, rule:Expr):String {\r\n\t\treturn switch(rule.expr) {\r\n\t\t\tcase EConst(CString(s)): s;\r\n\t\t\tcase EConst(CIdent(i)): makeRule(fields, fields.get(i));\r\n\t\t\tcase EBinop(OpAdd,e1,e2): \"(\" + makeRule(fields, e1) +\")(\" + makeRule(fields, e2) +\")\";\r\n\t\t\tcase _: Context.error(\"Invalid rule\", rule.pos);\r\n\t\t}\r\n\t}\r\n\t\r\n\tstatic function transformRule(field:Field, e:Expr, t:ComplexType, fields:Map<String,Expr>) {\r\n\t\tvar el = switch(e.expr) {\r\n\t\t\tcase EArrayDecl(el): el;\r\n\t\t\tcase _: Context.error(\"Expected pattern => function map declaration\", e.pos);\r\n\t\t}\r\n\t\tvar el = el.map(function(e) {\r\n\t\t\tfunction loop(e:Expr) {\r\n\t\t\t\treturn switch(e.expr) {\r\n\t\t\t\t\tcase EBinop(OpArrow, rule, e):\r\n\t\t\t\t\t\tmacro @:pos(e.pos) {rule:$v{makeRule(fields, rule)}, func:function(lexer:hxparse.Lexer):$t return $e};\r\n\t\t\t\t\tcase EConst(CIdent(s)) if (fields.exists(s)):\r\n\t\t\t\t\t\tloop(fields.get(s));\r\n\t\t\t\t\tcase _:\r\n\t\t\t\t\t\tContext.error(\"Expected pattern => function\", e.pos);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn loop(e);\r\n\t\t});\r\n\t\tvar e = macro $a{el};\r\n\t\tvar e = macro hxparse.Lexer.buildRuleset($e);\r\n\t\tfield.kind = FVar(null, e);\r\n\t\treturn e;\r\n\t}\r\n\t\r\n\tstatic function transformMapping(field:Field, e:Expr, offset:Int) {\r\n\t\tvar t = Context.typeof(e).follow();\r\n\t\tvar sl = [];\r\n\t\tswitch(t) {\r\n\t\t\tcase TAnonymous(a):\r\n\t\t\t\tfor (f in a.get().fields) {\r\n\t\t\t\t\tvar name = macro @:pos(e.pos) $i{f.name};\r\n\t\t\t\t\tvar cName = f.name.charAt(offset).toLowerCase() + f.name.substr(offset + 1);\r\n\t\t\t\t\tsl.push(macro $v{cName} => $name);\r\n\t\t\t\t}\r\n\t\t\tcase _:\r\n\t\t\t\tContext.error(\"Invalid mapping type\", e.pos);\r\n\t\t}\r\n\t\tvar e = macro $a{sl};\r\n\t\tfield.kind = FVar(null, e);\r\n\t\treturn e;\r\n\t}\r\n\t\r\n\t#end\r\n}"],
"names":[],
"mappings":"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"
}